2008-02-01  Chong Yidong  <cyd@stupidchicken.com>

	* progmodes/etags.el (next-file): Improve revert message.

2008-02-01  Andreas Schwab  <schwab@suse.de>

	* loadup.el: Load language/burmese instead of language/myanmar.

2008-02-01  Richard Stallman  <rms@gnu.org>

	* language/burmese.el: Rename from myanmar.el.
	("Burmese"): Rename from "Myanmar".

2008-02-01  Kenichi Handa  <handa@ni.aist.go.jp>

	* international/fontset.el (script-representative-chars): Add cham
	and tai-viet.
	(setup-default-fontset): Add iso10646-1 font for latin and ipa.
	Add fontconfig spec for cjk-misc.  Explicitly specify font
	for U+E000..U+F8FF.

	* international/characters.el (script-list): Add cham.

	* language/cham.el: New file.

2008-02-01  Mark A. Hershberger  <mah@everybody.org>

	* xml.el (xml-escape-string): Don't do any encoding changes on the
	string.

2008-02-01  Kenichi Handa  <handa@ni.aist.go.jp>

	* language/ind-util.el (in-is13194-post-read-conversion):
	Delete unnecessary call of indian-compose-region.

2008-02-01  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el: Some face attributes (like :strike-through) were not
	being recognized.  Reported by Leo <sdl.web@gmail.com>.
	(ps-print-version): New version 7.3.2.
	(ps-screen-to-bit-face): Fix code.  Call ps-face-strikeout-p,
	ps-face-overline-p and ps-face-box-p functions.

	* ps-def.el (ps-face-strikeout-p, ps-face-overline-p, ps-face-box-p):
	New functions.

2008-02-01  Kenichi Handa  <handa@ni.aist.go.jp>

	* international/fontset.el (font-encoding-alist): Add an entry for
	iso8859-16.
	(setup-default-fontset): Add iso8859-16 to latin.

	* descr-text.el (describe-char-display): Convert a GLYPH-CODE to a
	hexadigit string.
	(describe-char): Adjust for the above change.

2008-02-01  Kenichi Handa  <handa@ni.aist.go.jp>

	* international/fontset.el (font-encoding-alist): Don't set the
	repertory of GB18030 fonts.

2008-02-01  Kenichi Handa  <handa@ni.aist.go.jp>

	* language/indian.el: Set font-shape-text for all Indic characters
	in composition-function-table.

	* language/khmer.el: New file.

	* language/myanmar.el: New file.

	* loadup.el: Load "language/khmer" and "language/myanmar".

2008-02-01  Kenichi Handa  <handa@ni.aist.go.jp>

	* international/fontset.el (setup-default-fontset): Fix lao OTF
	script name.

2008-02-01  Kenichi Handa  <handa@ni.aist.go.jp>

	* composite.el (terminal-composition-modification): Delete it.

2008-02-01  Kenichi Handa  <handa@ni.aist.go.jp>

	* international/fontset.el (x-complement-fontset-spec):
	Complement size too.

2008-02-01  Kenichi Handa  <handa@ni.aist.go.jp>

	* international/fontset.el (font-encoding-charset-alist):
	Initialize it.
	(otf-script-alist): Fix typo of canadian-aboriginal.
	(setup-default-fontset): Specify font-specs for many more scripts.
	(x-complement-fontset-spec): Change the first argument to a
	font-spec object.
	(create-fontset-from-fontset-spec): Adjust for the above change.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* language/devanagari.el: Register font-shape-text in
	composition-function-table.

	* language/tibetan.el: Register font-shape-text in
	composition-function-table.

	* language/thai-util.el (thai-composition-function): Fix arguments.

	* language/tamil.el: Register font-shape-text in
	composition-function-table.

	* language/malayalam.el: Register font-shape-text in
	composition-function-table.

	* language/lao.el: Register font-shape-text in
	composition-function-table.

	* language/kannada.el: Register font-shape-text in
	composition-function-table.

	* language/european.el (diacritic-composition-function): Fix arguments.

	* language/ethio-util.el (ethio-composition-function): Fix arguments.

	* language/tv-util.el (tai-viet-composition-function): Fix arguments.

	* composite.el (composition-function-table): Fix docstring.
	(terminal-composition-function): Fix arguments.
	(auto-compose-current-font): Delete it.
	(auto-compose-chars): Adjust for the change of
	composition-function-table.

2008-02-01  Kenichi Handa  <handa@ni.aist.go.jp>

	* international/fontset.el (font-encoding-alist): Add the entry of
	"unicode-bmp".

2008-02-01  Kenichi Handa  <handa@ni.aist.go.jp>

	* composite.el (auto-compose-chars): Be sure to calculate
	composition at least at POS.

2008-02-01  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* printing.el: Fix pr-interface-map initialization code.
	(pr-version): New version 6.9.3.
	(pr-f-set-keymap-parents): Replace by pr-set-keymap-parents.
	(pr-f-set-keymap-name): Replace by pr-set-keymap-name.
	(pr-f-read-string): Replace by pr-read-string.
	(pr-set-keymap-parents, pr-set-keymap-name, pr-read-string):
	New function name.
	(pr-interactive-n-up, pr-interactive-regexp): Code fix.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* language/tv-util.el (tai-viet-re): Include '-'.
	(tai-viet-glyph-info): Handle '-'.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* descr-text.el (describe-char): Handle a composition of the new
	format.  Show font name.

2008-02-01  Kenichi Handa  <handa@ni.aist.go.jp>

	* language/tibet-util.el (tibetan-composition-function): Use
	font-shape-text if auto-compose-current-font is non-nil.

	* language/tibetan.el: Fix the range for recording
	tibetan-composition-function in composition-function-table.

	* language/mlm-util.el (malayalam-composition-function): Use
	font-shape-text if auto-compose-current-font is non-nil.

	* international/mule-conf.el: Flag many charsets as supplementary.

	* international/mule.el (define-charset): Update the docstring for
	:supplementary-p.

	* international/fontset.el (setup-default-fontset): Add OpenType
	fonts for malayalam and tibetan.

2008-02-01  Kenichi Handa  <handa@ni.aist.go.jp>

	* international/fontset.el (x-complement-fontset-spec): Use font-spec.

2008-02-01  Kenichi Handa  <handa@ni.aist.go.jp>

	* international/fontset.el (otf-script-alist): Make all otf tags
	4-letters.
	(setup-default-fontset): Add OpenType fonts for devanagari and tamil.

	* language/tml-util.el (tamil-composition-function): Use
	font-shape-text if auto-compose-current-font is non-nil.

	* language/devan-util.el (devanagari-composition-function): Use
	font-shape-text if auto-compose-current-font is non-nil.

	* composite.el (auto-compose-chars): Change argument font-object
	to window.

2008-02-01  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el (ps-lpr-switches): Docstring fix.
	(ps-string-list): New function.
	(ps-do-despool): Code fix.

2008-02-01  Kenichi Handa  <handa@ni.aist.go.jp>

	* international/utf-7.el (utf-7-imap-post-read-conversion)
	(utf-7-imap-pre-write-conversion): New functions.

	* international/mule-conf.el (utf-7-imap): New coding system.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* term/x-win.el (x-selection-value): If x-select-request-type is
	nil, try also STRING at last.
	(x-select-request-type): Doc fix for the change of x-selection-value.

	* select.el (selection-coding-system, next-selection-coding-system):
	Move declarations from xselect.c.
	(x-get-selection): Decode by selection-coding-system if it is non-nil.
	If it is nil, decode by a proper coding system.  Handle C_STRING.
	(ccl-check-utf-8, string-utf-8-p): Delete them.
	(xselect-convert-to-string): Fix determining data-type in the case
	that TEXT is requested.  Don't use selection-coding-system if it's
	not proper for the data-type.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* term/x-win.el (x-selection-value): If x-select-request-type is
	nil, simply try UTF8_STRING and COMPOUND-TEXT in this order.

2008-02-01  Jason Rumney  <jasonr@gnu.org>

	* term/w32-win.el (w32-initialize-window-system): Use t, not nil
	to signify default fontset.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (describe-language-environment):
	Check if the specified input method exists or not.

2008-02-01  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el (ps-begin-job): Error if ps-lpr-switches is not a list.
	(ps-face-background-name): Remove this function.  It's already defined
	in ps-def.el file.

2008-02-01  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el: Eliminate the check if ps-print was running on Lucid or
	Epoch emacsen.

2008-02-01  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el: Now detect if text foreground and background colors are
	equals and replace the foreground color by another color, so the text
	becomes visible.  Doc fix.
	(ps-print-version): New version 7.3.
	(ps-default-fg, ps-default-bg): Docstring fix.
	(ps-fg-list, ps-fg-validate-p): New options.
	(ps-foreground-list): New variable.
	(ps-generate-header-line): Replace fboundp by functionp.
	(ps-setup, ps-begin-job, ps-plot-region): Fix code.

2008-02-01  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* printing.el: Pacify byte compiler, that is, no compiler warnings.
	Move (again) some variable definitions before use, define some
	function aliases, no code change.
	(pr-version): New version 6.9.2.
	(pr-path-style, pr-auto-region, pr-menu-char-height)
	(pr-menu-char-width, pr-menu-lock, pr-ps-printer-alist)
	(pr-txt-printer-alist, pr-ps-utility-alist): Options declaration
	via (defvar VAR).
	(pr-menu-lookup, pr-menu-lock, pr-menu-alist, pr-even-or-odd-pages)
	(pr-menu-get-item, pr-menu-set-item-name, pr-menu-set-utility-title)
	(pr-menu-set-ps-title, pr-menu-set-txt-title, pr-region-active-p)
	(pr-do-update-menus, pr-update-mode-line, pr-f-read-string)
	(pr-f-set-keymap-parents, pr-keep-region-active): Function aliases.
	(pr-menu-print-item, pr-ps-printer-menu-modified)
	(pr-txt-printer-menu-modified, pr-ps-utility-menu-modified)
	(pr-even-or-odd-alist): Move variable definitions.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* language/chinese.el (cp936): Delete duplicated alias.

	* international/mule-diag.el (list-block-of-chars): Don't insert
	non-Unicode characters.

2008-02-01  Jason Rumney  <jasonr@gnu.org>

	* loadup.el [windows-nt]: Don't load code-pages and ccl.
	* term/w32-win.el: Don't require code-pages.

2008-02-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	Fix up multi-tty merge.

	* version.el (emacs-version): Bump to 23.0.60.

	* term/x-win.el (x-initialize-window-system): Don't try to create
	a fontset from a font-specification anymore.  This was removed on the
	unicode branch and mistakenly re-added by the multi-tty merge.

	* term/w32-win.el: Remove duplicate code that's now in
	w32-initialize-window-system.
	(w32-initialize-window-system): Don't try to create a fontset from
	a font-specification anymore.  This was removed on the unicode branch
	and mistakenly re-added by the multi-tty merge.

	* term/mac-win.el: Remove duplicate top-level code.

	* language/ethio-util.el:
	* international/characters.el: Use utf-8 rather than utf-8-emacs
	since it works as well and has the advantage of working with
	non-Unicode versions of Emacs.

	* international/encoded-kb.el (encoded-kbd-setup-display): Use the new
	multi-tty code, which includes the previous local change.

2008-02-01  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el (ps-print-version): New version 7.2.5.
	(ps-background, ps-begin-file, ps-build-reference-face-lists):
	Use `mapc' rather than `mapcar'.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* skeleton.el (skeleton-internal-1): Use integerp and stringp
	instead of char-or-string-p to catch -1.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (inactivate-input-method):
	Set input-method-function to nil before calling
	inactivate-current-input-method-function.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* play/gamegrid.el (gamegrid-setup-default-font): Calculate a font
	height that doesn't exceed the requested height by rounding off.

2008-02-01  Andreas Schwab  <schwab@suse.de>

	* international/mule-diag.el (print-fontset-element):
	Use fontp only if defined.

2008-02-01  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-mule.el (ps-mule-prepare-font, ps-mule-encode-region)
	(ps-mule-plot-composition, ps-mule-encode-header-string): Docstring fix.
	(ps-mule-prologue-generated): Code fix.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* dnd.el (dnd-get-local-file-name): Call replace-regexp-in-string
	with FIXEDCASE t.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule-diag.el (print-fontset-element): Fix for the
	format change of a fontset element for font-backend feature.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* descr-text.el (describe-char): Fix for the case that a component
	character is TAB.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (select-safe-coding-system-interactively):
	Fix printing of rejected and unsafe coding-systems.

	* international/fontset.el (setup-default-fontset): Add tai-viet.

	* international/characters.el: Setup syntax/category table for Tai Viet.
	(script-list): Add tai-viet.

	* loadup.el: Load "language/tai-viet".

	* language/tai-viet.el: New file.

	* language/tv-util.el: New file.

2008-02-01  Jason Rumney  <jasonr@gnu.org>

	* faces.el (font-weight-table): Use defaults on w32 that match
	LOGFONT.lfWeight.

	* term/w32-win.el: Don't create fontset from command-line font.

2008-02-01  Juanma Barranquero  <lekktu@gmail.com>

	* international/mule-cmds.el (toggle-enable-multibyte-characters)
	(sort-coding-systems, search-unencodable-char): Doc fixes.
	(default-input-method, input-method-verbose-flag)
	(input-method-highlight-flag): Remove * in defcustom's docstrings.
	(exit-language-environment-hook, set-default-coding-systems)
	(coding-system-change-eol-conversion, prefer-coding-system)
	(find-multibyte-characters, leim-list-entry-regexp)
	(set-input-method, input-method-exit-on-first-char, princ-list)
	(locale-language-names, locale-charset-language-names)
	(define-char-code-property): Fix typos in docstrings.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* disp-table.el (make-glyph-code, glyph-char, glyph-face):
	Fix for a new character code space (22-bit).

2008-02-01  Juanma Barranquero  <lekktu@gmail.com>

	* printing.el (pr-ps-fast-fire): Fix typos in docstring.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/characters.el: Add more cases/syntaxes from Latin
	characters.

2008-02-01  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-def.el (installation-directory): Must be initialized when defining
	it in XEmacs.
	(coding-system-for-read): Eliminate duplicated definition.

2008-02-01  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el: Replace some (defvar VAR) by (defvar VAR nil).

2008-02-01  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el: Replace (defvar VAR nil) by (defvar VAR).
	(ps-print-emacs-type): Eliminate variable.
	(ps-setup): Remove ps-print-emacs-type.  Print which Emacsen is
	running ps-print package.

	* ps-def.el: Replace (defvar VAR nil) by (defvar VAR).
	(ps-frame-parameter): Replace defun by defalias.
	(mark-active): Eliminate defvar.

	* ps-samp.el (ps-prsc, ps-c-prsc, ps-s-prsc): Eliminate macros.
	(ps-rmail-mode-hook, ps-vm-mode-hook, ps-gnus-summary-setup)
	(ps-jts-ps-setup): Replace macros by vector key definition.

2008-02-01  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* progmodes/ebnf-abn.el (ebnf-abn-skip-comment):
	* progmodes/ebnf-bnf.el (ebnf-bnf-skip-comment):
	* progmodes/ebnf-dtd.el (ebnf-dtd-skip-comment):
	* progmodes/ebnf-ebx.el (ebnf-ebx-skip-comment):
	* progmodes/ebnf-iso.el (ebnf-iso-skip-comment):
	* progmodes/ebnf-yac.el (ebnf-yac-skip-comment): New version.
	New command actions for EPS header and EPS footer.

	* progmodes/ebnf2ps.el: New command actions for EPS header and EPS
	footer.  Fix some problems with one-or-more, zero-or-more and
	alternative constructions generation.  Some implementation of log
	messages.  Doc fix.
	(ebnf-version): New version 4.4.
	(ebnf-eps-header-font, ebnf-eps-header, ebnf-eps-footer-font)
	(ebnf-eps-footer, ebnf-log): New options.
	(ebnf-find-style, ebnf-eps-header-footer, ebnf-eps-header)
	(ebnf-eps-footer, ebnf-eps-string, ebnf-eps-header-footer-comment)
	(ebnf-eps-header-footer-p, ebnf-eps-header-comment)
	(ebnf-eps-footer-comment, ebnf-eps-header-footer-file)
	(ebnf-eps-header-footer-set, ebnf-log-header, ebnf-log): New functions.
	(ebnf-style-custom-list, ebnf-style-database): Put new values.
	(ebnf-print-directory, ebnf-print-file, ebnf-print-buffer)
	(ebnf-print-region, ebnf-spool-directory, ebnf-spool-file)
	(ebnf-spool-buffer, ebnf-spool-region, ebnf-eps-directory)
	(ebnf-eps-file, ebnf-eps-buffer, ebnf-eps-region)
	(ebnf-syntax-directory, ebnf-syntax-file, ebnf-syntax-buffer)
	(ebnf-syntax-region, ebnf-parse-and-sort, ebnf-begin-job)
	(ebnf-dimensions, ebnf-production-dimension, ebnf-terminal-dimension)
	(ebnf-non-terminal-dimension, ebnf-special-dimension)
	(ebnf-terminal-dimension1, ebnf-repeat-dimension)
	(ebnf-except-dimension, ebnf-alternative-dimension)
	(ebnf-optional-dimension, ebnf-one-or-more-dimension)
	(ebnf-zero-or-more-dimension, ebnf-sequence-dimension):
	Insert log message function.
	(ebnf-setup, ebnf-generate-one-or-more, ebnf-generate-zero-or-more)
	(ebnf-begin-job, ebnf-begin-file, ebnf-eps-finish-and-write)
	(ebnf-insert-ebnf-prologue, ebnf-production-dimension)
	(ebnf-terminal-dimension1, ebnf-alternative-dimension)
	(ebnf-one-or-more-dimension, ebnf-zero-or-more-dimension)
	(ebnf-eps-add-context, ebnf-eps-add-production): Fix code.
	(ebnf-eps-filename, ebnf-trim-right): Replace `?\s' by `?\ ' to keep
	compatibility with Emacs 20 & 21.
	(ebnf-eps-header-comment, ebnf-eps-footer-comment)
	(ebnf-eps-file-alist, ebnf-basic-width-extra)
	(ebnf-basic-empty-height): New variables.
	(ebnf-prologue): Fix PostScript code.
	(ebnf-make-empty, ebnf-make-terminal1, ebnf-make-or-more1)
	(ebnf-make-production, ebnf-make-alternative, ebnf-make-optional)
	(ebnf-make-except, ebnf-make-repeat, ebnf-make-sequence)
	(ebnf-make-dup-sequence, ebnf-token-alternative): Add comments.

2008-02-01  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* printing.el: Group together all XEmacs/Emacs definitions.
	(pr-version): New version 6.9.
	(pr-global-menubar, pr-menu-char-height, pr-menu-char-width):
	New functions.
	(pr-menu-char-height, pr-menu-char-width): Fix initialization code.
	(pr-menu-bind): Fix code.
	(pr-e-frame-char-height, pr-e-frame-char-width)
	(pr-e-mouse-pixel-position, pr-x-add-submenu, pr-x-event-function)
	(pr-x-event-object, pr-x-find-menu-item, pr-x-font-height)
	(pr-x-font-width, pr-x-get-popup-menu-response, pr-x-make-event)
	(pr-x-misc-user-event-p, pr-x-relabel-menu-item, pr-x-event-x-pixel)
	(pr-x-event-y-pixel): Eliminate aliases.
	(pr-xemacs-global-menubar): Move macro.
	(current-menubar, current-mouse-event, zmacs-region-stays)
	(deactivate-mark, pr-menu-position, pr-menu-state, pr-ps-name-old)
	(pr-txt-name-old, pr-ps-utility-old, pr-even-or-odd-old, pr-temp-menu):
	Move variables.
	(pr-region-active-p, pr-menu-position, pr-menu-lookup, pr-menu-lock)
	(pr-update-mode-line, pr-do-update-menus, pr-menu-alist)
	(pr-relabel-menu-item, pr-menu-set-ps-title, pr-menu-set-txt-title)
	(pr-menu-set-utility-title, pr-even-or-odd-pages)
	(pr-f-set-keymap-parents, pr-f-set-keymap-name, pr-f-read-string)
	(pr-keep-region-active, pr-menu-get-item, pr-menu-set-item-name):
	Move functions.

2008-02-01  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el: The ps-print commands without face printing should not
	print background color.  Reported by Leo <sdl.web@gmail.com>.
	(ps-print-version): New version 7.2.2.
	(ps-begin-job): New arg.  Fix ps-default-background and
	ps-default-foreground initialization.
	(ps-face-attributes): Fix doc string.
	(ps-face-background, ps-generate-postscript, ps-generate): Fix code.

	* printing.el: Fix ps-print link.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule-diag.el (list-character-sets-2): Don't print width.

2008-02-01  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.ps: Fix background height.
	(ps-print-version): New version 7.2.1.

2008-02-01  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el: Split XEmacs/Emacs definitions and sample setup code
	into separate files.
	(ps-print-version): New version 7.2.
	(ps-postscript-code-directory): Fix XEmacs initialization.
	(ps-generate-postscript-with-faces):
	Call ps-generate-postscript-with-faces1 (new function).
	(ps-color-format, ps-float-format): Move variables to ps-def.el.
	(ps-xemacs-color-name, ps-mapper, ps-extent-sorter)
	(ps-xemacs-face-kind-p, ps-mark-active-p, ps-face-foreground-name)
	(ps-face-background-name, ps-frame-parameter, ps-color-device)
	(ps-color-values, ps-face-bold-p, ps-face-italic-p):
	Move functions to ps-def.el.
	(ps-prsc, ps-c-prsc, ps-s-prsc, ps-rmail-mode-hook)
	(ps-rmail-print-message-from-summary, ps-print-message-from-summary)
	(ps-article-subject, ps-article-author, ps-gnus-article-prepare-hook)
	(ps-vm-mode-hook, ps-gnus-print-article-from-summary)
	(ps-vm-print-message-from-summary, ps-gnus-summary-setup, ps-info-file)
	(ps-info-node, ps-info-mode-hook, ps-jts-ps-setup, ps-jack-setup):
	Move functions to ps-samp.el.

	* ps-bdf.el (installation-directory, coding-system-for-read):
	Move variables to ps-def.el.

	* ps-mule.el (leading-code-private-22): Move variables to ps-def.el.
	(charset-bytes, charset-dimension, charset-id, charset-width)
	(find-charset-region, char-width, chars-in-region, forward-point)
	(decompose-composite-char, encode-coding-string, coding-system-p)
	(ccl-execute-on-string, define-ccl-program, multibyte-string-p)
	(string-make-multibyte, encode-char): Move functions to ps-def.el.

	* ps-def.el: New file.  XEmacs/Emacs definitions.
	(ps-generate-postscript-with-faces1): New function.
	(ps-color-format, ps-float-format): Move variables from ps-print.el.
	(ps-xemacs-color-name, ps-mapper, ps-extent-sorter)
	(ps-xemacs-face-kind-p, ps-mark-active-p, ps-face-foreground-name)
	(ps-face-background-name, ps-frame-parameter, ps-color-device)
	(ps-color-values, ps-face-bold-p, ps-face-italic-p):
	Move functions from ps-print.el.
	(installation-directory, coding-system-for-read):
	Move variables from ps-bdf.el.
	(leading-code-private-22): Move variable from ps-mule.el.
	(charset-bytes, charset-dimension, charset-id, charset-width)
	(find-charset-region, char-width, chars-in-region, forward-point)
	(decompose-composite-char, encode-coding-string, coding-system-p)
	(ccl-execute-on-string, define-ccl-program, multibyte-string-p)
	(string-make-multibyte, encode-char): Move functions from ps-mule.el.

	* ps-samp.el: New file.  Sample setup code.
	(ps-prsc, ps-c-prsc, ps-s-prsc, ps-rmail-mode-hook)
	(ps-rmail-print-message-from-summary, ps-print-message-from-summary)
	(ps-article-subject, ps-article-author, ps-gnus-article-prepare-hook)
	(ps-vm-mode-hook, ps-gnus-print-article-from-summary)
	(ps-vm-print-message-from-summary, ps-gnus-summary-setup, ps-info-file)
	(ps-info-node, ps-info-mode-hook, ps-jts-ps-setup, ps-jack-setup):
	Move functions from ps-print.el.

2008-02-01  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el: Handle frame parameters (background and/or foreground
	colors) changing dynamically.  Reported by Leo <sdl.web@gmail.com>.
	(ps-print-version): New version 7.1.
	(ps-x-frame-property, ps-e-frame-parameter): New aliases.
	(ps-frame-parameter): New function.
	(ps-default-fg, ps-default-bg): New default value ('frame-parameter).
	Fix doc and customization.
	(ps-begin-job): Get frame parameters (background and/or foreground
	colors).
	(ps-do-despool): Ensure ps-printer-name has a valid value.

2008-02-01  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* progmodes/ebnf-abn.el:
	* progmodes/ebnf-bnf.el:
	* progmodes/ebnf-dtd.el:
	* progmodes/ebnf-ebx.el:
	* progmodes/ebnf-iso.el:
	* progmodes/ebnf-otz.el:
	* progmodes/ebnf-yac.el:
	* progmodes/ebnf2ps.el:
	* delim-col.el:
	* printing.el:
	* ps-bdf.el:
	* ps-mule.el:
	* ps-print.el: Remove 'Time-stamp' comment mark.

	* printing.el (pr-menu-bind): Replace 'easy-menu-change' by
	'easy-menu-add-item' when called in Emacs 21 or higher.

2008-02-01  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el : Fix doc.
	(ps-print-version): New version 7.0.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* mail/emacsbug.el (report-emacs-bug): Insert also the value of
	XMODIFIERS.

2008-02-01  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el: Fix maintainer email.  Eliminate function declaration
	that kept compatibility with older Emacs version.
	(ps-print-version): New version 6.7.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/quail.el (quail-get-translations):
	Make quail-current-key multibyte if not yet done.

2008-02-01  Zhang Wei  <id.brep@gmail.com>

	* language/chinese.el ("Chinese-GBK"): Add tutorial.
	("Chinese-GB18030"): Add sample-text and tutorial.

	* international/fontset.el (font-encoding-alist)
	(setup-default-fontset): Add gb18030.
	(x-pixel-size-width-font-regexp, vertical-centering-font-regexp)
	(charset-script-alist): Add gbk and gb18030.

	* international/characters.el: Put property
	preferred-coding-system on gbk and gb18030.

	* international/mule-cmds.el (locale-language-names): Add an entry
	for "zh_CN.UTF-8" and change "chs" to "Chinese-GBK".

	* faces.el (face-font-registry-alternatives): Add gb18030.

2008-02-01  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-mule.el: Fix maintainer email.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/quail.el (quail-insert-kbd-layout): Check the
	length of (cdr translation).
	(quail-get-current-str): Check the length of (cdr def).

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* ruler-mode.el (ruler-mode-ruler): Make the string `ruler' multibyte.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (ucs-insert): Re-implement.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* composite.el (terminal-composition-modification): New function.
	(terminal-composition-function): Create composition with the above
	modification function.

2008-02-01  Zhang Wei  <id.brep@gmail.com>

	* international/characters.el: Add more full-width characters in
	char-width-table.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/fontset.el (create-fontset-from-fontset-spec):
	Fix script name handling.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* composite.el (terminal-composition-function): New function.
	(terminal-composition-function-table): New variable.
	(auto-compose-chars): If running on a terminal, use
	terminal-composition-function-table.

	* loadup.el: Load "composite" after "international/characters".

	* international/characters.el: Delete codes for setting up charset
	property nospace-between-words.  Fix setting up of
	char-width-table.  Don't make ethiopic and tibetan double column.

	* textmodes/fill.el (fill-find-break-point-function-table):
	Don't set it up in defvar.
	(fill-nospace-between-words-table): New variable.
	(fill-delete-newlines): Check fill-nospace-between-words-table
	instead of charset property nospace-between-words.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* composite.el (global-auto-composition-mode): Make the initial
	value not depend on emacs-basic-display.

	* textmodes/fill.el: Don't use charset property
	`fill-find-break-point-function'.
	(fill-find-break-point-function-table): New variable.
	(fill-find-break-point): Lookup fill-find-break-point-function-table.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule.el (coding-system-list): Be sure to exclude
	subsidiary coding systems.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* composite.el (auto-composition-after-change)
	(toggle-auto-composition): Remove `auto-composed' property instead
	of setting it to nil.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* language/misc-lang.el (iso-8859-6): New coding system.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* dnd.el (dnd-get-local-file-name): Give a unibyte string to
	replace-regexp-in-string as replacement.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/fontset.el (otf-script-alist): Add byzm, math,
	musc, and nko.

	* international/characters.el (script-list): Add nko,
	byzantine-musical-symbol, musical-symbol, and mathematical.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* composite.el (auto-compose-current-font): New variable.
	(auto-compose-chars): New arg FONT-OBJECT.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/characters.el: Modify category-table and
	script-table for new Ethiopic character range.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (set-language-environment-fontset):
	Delete it.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/fontset.el (otf-script-alist): Set it.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/fontset.el (font-encoding-alist):
	Fix for "ethiopic-unicode".

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/fontset.el (script-representative-chars):
	Add an entry for latin script.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* faces.el (font-weight-table): Treat regular and normal as the
	same as medium.
	(font-slant-table): Add (roman . 100).

2008-02-01  Kenichi Handa  <handa@m17n.org>

	These changes are for the new font handling codes.

	* faces.el (font-weight-table, font-slant-table)
	(font-swidth-table): New customizable variables.

	* international/fontset.el (font-encoding-alist): Add koi8-4.
	(script-representative-chars): Set the default value.
	(create-fontset-from-x-resource): Delete `message'.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* tar-mode.el (tar-untar-buffer, tar-summarize-buffer):
	Call set-buffer-multibyte with arg `to'.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* info.el (Info-fontify-node): Check if already fontified or not
	by next-single-property-change.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule.el (ctext-pre-write-conversion): Produce
	extra designation sequence for ASCII at the end off extended segment.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule.el (ctext-non-standard-encodings-table):
	Reverse the returning list.
	(ctext-pre-write-conversion): Fix encoding with extended segments.

	* international/mule-conf.el (compound-text)
	(compound-text-with-extensions): Add long-form in :flags.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/fontset.el (create-fontset-from-fontset-spec): Fix
	regexp for paring FONTSET-SPEC (allow spaces after `:').

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/fontset.el (create-fontset-from-fontset-spec): Fix
	for the case that a charset is specified as target.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/ccl.el (ccl-embed-string): Check string length.
	Set special flag for multibyte character sequence.
	(ccl-compile-write-string, ccl-compile-write-repeat): Don't make
	str unibyte.
	(ccl-compile-write): If the character code doesn't fit in 22-bit
	(ccl-dump-write-const-string): Check special flag for multibyte
	character sequence.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* ps-mule.el (ps-mule-eight-bit-char): Delete this function.
	(ps-mule-encode-region, ps-mule-plot-composition): Don't use
	ps-mule-eight-bit-char.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* language/chinese.el ("Chinese-BIG5"):
	Set ctext-non-standard-encodings property to "big5-0".

	* international/mule.el (ctext-non-standard-encodings):
	Initialize to nil.
	(ctext-non-standard-encodings-alist): Set charset `big5' in the
	entry for "big5-0".
	(ctext-non-standard-encodings-table): Return a list instead of
	char-table.
	(ctext-pre-write-conversion): Adjust for the above change.

2008-02-01  Zhang Wei  <id.brep@gmail.com>

	* international/mule.el (ctext-non-standard-encodings-alist):
	Add an entry for gbk-0.
	(ctext-post-read-conversion): Use multibyte-char-to-unibyte to read
	a row 8-bit.

	* language/chinese.el ("Chinese-GBK"):
	Set ctext-non-standard-encodings property to "gbk-0".
	Add sample-text property.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/kkc.el (kkc-region): Use
	this-single-command-raw-keys on pushing back an unhandled key sequence.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/encoded-kb.el (encoded-kbd-mode):
	Check saved-input-mode on turning off Encoded Kbd mode.

	* composite.el (auto-composition-after-change): Use save-buffer-state.
	(turn-on-auto-composition-if-enabled): Don't turn on
	auto-composition-mode in a unibyte buffer.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* startup.el (command-line): Use custom-reevaluate-setting for
	global-auto-composition-mode.

	* composite.el (auto-composition-function): Make it buffer local.
	(auto-composition-mode): New minor mode.
	(turn-on-auto-composition-if-enabled): New function.
	(global-auto-composition-mode): New global minor mode.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* descr-text.el (describe-char): Use insert-text-button instead of
	widget-create for "customize what to show" button.

2008-02-01  Naoto Takahashi  <ntakahas@m17n.org>

	* language/ethiopic.el: Fix copyright.
	(composition-function-table): Support a new character in Unicode 4.1.

	* language/ethio-util.el (ethio-fidel-to-tex-buffer)
	(ethio-tex-to-fidel-buffer, ethio-composition-function)
	("ethiopic-tex"): Support new characters in Unicode 4.1.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/characters.el: Register characters in
	auto-fill-chars.  Put nospace-between-words to more charsets.

2008-02-01  Zhang Wei  <id.brep@gmail.com>

	* international/mule-cmds.el (locale-language-names): Add entries
	for zh_CN.GB2312, zh_CN.GBK, and zh_CN.GB18030.
	(locale-preferred-coding-systems): Fix entries for Chinese locales.

2008-02-01  Kenichi Handa  <handa@etlken>

	* international/utf-7.el: Delete the definition of utf-7.
	(utf-7-post-read-conversion, utf-7-pre-write-conversion):
	Add autoload cookies.

2008-02-01  YAMAMOTO Mitsuharu  <mituharu@math.s.chiba-u.ac.jp>

	* term/mac-win.el: Delete the code to create a fontset from the X
	resource "Font".

2008-02-01  Naoto Takahashi  <ntakahas@m17n.org>

	* international/robin.el (robin-define-package): Be sure to call
	put-char-code-property.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* language/korean.el (iso-2022-kr): Set :suitable-for-keyboard
	property to 1.

	* international/mule-conf.el (cp1125): Set :ascii-compatible-p
	property to t.

	* international/mule.el (coding-system-get):
	Check `ascii-incompatible' for backward compatibility.
	(set-file-name-coding-system): Signal an error for a coding system
	not suitable for file name.
	(set-keyboard-coding-system): Signal an error for a coding system
	not suitable for keyboard.

	* language/chinese.el (iso-2022-cn, iso-2022-cn-ext):
	Set :suitable-for-keyboard property to 1.

	* language/japanese.el (iso-2022-jp, iso-2022-jp-2)
	(iso-2022-jp-2004): Set :suitable-for-keyboard property to 1.

	* language/vietnamese.el (vietnamese-viscii, vietnamese-vscii)
	(vietnamese-tcvn): Set :suitable-for-file-name property to t.

2008-02-01  Naoto Takahashi  <ntakahas@m17n.org>

	* international/robin.el (robin-define-package): Delete redundant code.
	(robin-add-rule): Allow N-1 reverse conversion.

2008-02-01  Naoto Takahashi  <ntakahas@m17n.org>

	* international/robin.el (robin-define-package): Make the
	expanded form shorter.

2008-02-01  Zhang Wei  <id.brep@gmail.com>

	* language/chinese.el (chinese-iso-8bit): Fix mime-charset of
	chinese-iso-8bit.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* loadup.el: If we are byte-compiling unidata-gen.el or running
	unidata-ge-files, set purify-flag to nil.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* loadup.el: Load international/charprop.el with NOERROR t.

	* Makefile.in (AUTOGENEL): Add charprop.el and uni-*.el.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* term/mac-win.el (mac-centraleurroman, mac-cyrillic):
	New charsets and coding systems.
	(mac-symbol, mac-dingbats): New charsets.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/characters.el: Set syntax of NBSP to punctuation.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el: Don't require wid-edit.

2008-02-01  Naoto Takahashi  <ntakahas@m17n.org>

	* international/robin.el: New file.

	* language/ethiopic.el: Change encoding to utf-8-emacs.
	Register ethio-composition-function in composition-function-table.
	("Ethiopic"): Change coding-systems to utf-8-emacs.

	* language/ethio-util.el: Change encoding to utf-8-emacs.
	Rewrite all transliteration functions to use robin.el.
	(ethio-fidel-to-sera-map, ethio-fidel-to-tex-map)
	(ethio-sera-to-fidel-table, ethio-implicit-period-conversion)
	(ethio-prefer-ascii-punctuation): Delete variables.
	(ethio-char-to-ethiocode, ethio-convert-digit)
	(ethio-ethiocode-to-char, ethio-fidel-to-sera-mail)
	(ethio-fidel-to-sera-mail-or-marker, ethio-lone-consonant-p)
	(ethio-sera-to-fidel-english, ethio-sera-to-fidel-ethio)
	(ethio-sera-to-fidel-mail, ethio-sera-to-fidel-mail-or-marker)
	(ethio-tilde-escape, ethio-toggle-punctuation): Delete functions.
	(ethio-adjust-robin, ethio-composition-function)
	(ethio-get-consonant, ethio-prefer-amharic, ethio-process-digits)
	(ethio-sera-to-fidel-region-ethio)
	(ethio-sera-to-fidel-region-noethio)
	(ethio-use-colon-for-colon, ethio-use-three-dot-question):
	New functions.

2008-02-01  Miles Bader  <miles@gnu.org>

	* international/mule.el (auto-coding-regexp-alist)
	(ctext-pre-write-conversion): Replace embedded control characters
	with octal escapes; this prevents diff from thinking the file is binary.

2008-02-01  Miles Bader  <miles@gnu.org>

	* descr-text.el (describe-char-unidata-list):
	* emacs-lisp/bytecomp.el (byte-compile-fix-header)
	(byte-compile-insert-header):
	* international/mule.el (charset-list, set-coding-priority)
	(ignore-relative-composition):
	* international/mule-util.el (detect-coding-with-priority):
	* international/mule-diag.el:
	* international/mule-cmds.el (language-info-custom-alist):
	* international/codepage.el (codepage-setup):
	Replace references to Emacs version "22" with "23".

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* Makefile.in (DONTCOMPILE): Include charprop.el and uni-*.el.

	* international/fontset.el (font-encoding-alist): Add an entry for
	microsoft-cp1251.
	(setup-default-fontset): Add entries for microsoft-cp1251 and
	koi8-r for cyrillic.

	* international/mule-cmds.el (char-code-property-alist): New variable.
	(define-char-code-property): New function.
	(get-char-code-property, put-char-code-property): Handle a
	char-table registerd in char-code-property-alist.
	(set-language-environment): Check :ascii-compatible-p property of
	nonascii charset instead of its dimension.

	* international/uni-bidi.el, international/uni-category.el:
	* international/uni-combining.el, international/uni-comment.el:
	* international/uni-decimal.el, international/uni-decomposition.el:
	* international/uni-digit.el, international/uni-lowercase.el:
	* international/uni-mirrored.el, international/uni-name.el:
	* international/uni-numeric.el, international/uni-old-name.el:
	* international/uni-titlecase.el, international/uni-uppercase.el:
	* international/charprop.el: New files automatically generated by
	admin/unidata/Makefile.

	* loadup.el: Load international/charprop.el.

	* descr-text.el (describe-char-unidata-list): New variable.
	(describe-char-unicode-data): Use char-code-property-description.
	(describe-char): Add lines for describing Unicode-based character
	properties.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* textmodes/ispell.el: These changes are to fix the code merged
	from trunk for the change on 2008-02-01.
	(ispell-unified-chars-table): Delete it.
	(ispell-get-decoded-string): Don't check ispell-unified-chars-table.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule-util.el (char-displayable-p): Check
	:charset-list property of CODING.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (select-safe-coding-system-interactively):
	Change 'mime-charset to :mime-charset.
	(select-safe-coding-system): Use above.
	(set-language-environment): Delete unnecessary code for handling
	overriding-fontspec.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule-conf.el: New coding system aliases unix, dos,
	and mac.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/titdic-cnv.el (tit-process-header): Fix embedded
	coding tag.
	(titdic-convert): Bind coding-system-for-write to the coding
	system specified in the map file.  Remove `charset' property after
	decoding.
	(miscdic-convert): Bind coding-system-for-write to the coding
	system specified for the map file.  Fix LANGUAGE arg to
	quail-define-package.
	(batch-miscdic-convert): Check if a file is directory or not.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule.el (coding-system-equal): Move from mule-util.el.

	* international/mule-util.el (coding-system-equal): Move to mule.el.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/encoded-kb.el (encoded-kbd-decode-code-list):
	New function.
	(encoded-kbd-self-insert-charset, encoded-kbd-setup-keymap):
	Support multibyte charsets.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* language/china-util.el (hz-set-msb-table): Turn chars beyond 128
	to eight-bit chars.

	* international/mule-conf.el: Don't define coding system
	`undecided' here.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (locale-language-names): Fix for
	gb18030 and gdk.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/fontset.el (font-encoding-alist): Add gbk.
	(charset-script-alist): Add chinese-gbk.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* language/chinese.el (chinese-gbk): Include ascii in charset-list.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* language/japanese.el ("Japanese"): Fix ordering of charsets.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/encoded-kb.el (encoded-kbd-self-insert-charset)
	(encoded-kbd-self-insert-utf-8, encoded-kbd-setup-keymap)
	(encoded-kbd-mode): Adjust code merged from trunk for Unicode branch.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* descr-text.el (describe-char): Fix for the case CODE is a cons
	of integers.

2008-02-01  Steven Tamm  <steventamm@mac.com>

	* term/mac-win.el: Use mac-standard-fontset-spec to create fontset-mac.
	(mac-standard-fontset-spec): Create.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule-diag.el (unicode-data):
	Call find-file-noselect with NOWARN t.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule-conf.el (cp932-2-byte): Fix :code-space.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/characters.el: Give more CJK characters the
	category `|'.

	* descr-text.el (describe-char): Make it work on *Help* buffer.
	Suppress auto-composition on a region describing about composition.

	* language/european.el (diacritic-compose-region)
	(diacritic-compose-string, diacritic-composition-function):
	Compose diacritical marks only with a character whose syntax is
	word constituent.
	(diacritic-post-read-conversion): Delete it.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* composite.el (auto-compose-chars): Execute the main code in
	condition-case.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/fontset.el (x-complement-fontset-spec):
	Don't change CHARSET_REGISTRY and CHARSET_ENCODING fields.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/characters.el (next-word-boundary-kana):
	Handle half-width kana.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule-conf.el (indian-1-column): Fix :emacs-mule-id.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* language/japanese.el (japanese-iso-8bit): Fix order of :charset-list.

	* mail/rmail.el (rmail-decode-babyl-format):
	Use with-coding-priority instead of detect-coding-with-priority.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule.el (make-translation-table)
	(make-translation-table-from-vector): Set the second extra slot of
	the char table to 1.
	(make-translation-table-from-alist): Fix handling of multiple entries.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* language/japanese.el (jisx0213-to-unicode, unicode-to-jisx0213):
	New translation tables.

	* international/mule.el (make-translation-table-from-alist):
	New function.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule.el (translate-region): Re-implement it here.
	Make it interactive.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* ps-mule.el (ps-mule-font-info-database): Doc fix.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule-conf.el (chinese-cns11643-15): New charset.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/fontset.el (font-encoding-alist): Add entries for
	variations of cns11643 fonts.
	(setup-default-fontset): Add cns11643 fonts as fallback fonts.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule-diag.el (list-charset-chars): Put charset
	text property.

	* international/fontset.el (setup-default-fontset): Delete the
	entry for symbol script, add JISX0213 to kana script, specify
	fallback fonts.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/fontset.el (setup-default-fontset)
	(font-encoding-alist): Register "JISX0213.2004-1".

	* international/mule-diag.el (list-character-sets): Fix the first
	line message.
	(sort-listed-character-sets): Adjust for the change of
	list-characters-sets-1.
	(list-character-sets-1): List supplementary character sets in a
	different section.
	(list-charset-chars): Validate charset at early stage.

	* international/characters.el: Fix `han' script range.

	* international/mule-conf.el (japanese-jisx0213.2004-1):
	Specify :code-space.
	(cp932-2-byte): Fix :code-space.
	(unicode-smp, unicode-sip, unicode-ssp): New charsets.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule-conf.el (japanese-jisx0213.2004-1):
	Specify :dimension 2.

	* language/japanese.el (iso-2022-jp): Exclude japanese-jisx0212.
	(iso-2022-jp-2004, euc-jis-2004, japanese-shift-jis-2004):
	New coding systems.
	(iso-2022-jp-3, euc-jisx0213, shift_jis-2004): New coding system
	aliases.
	("Japanese"): Add new charsets and coding systems.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* language/japanese.el (japanese-ucs-cp932-to-jis-map):
	Rename from japanese-ucs-cp932-map.
	(japanese-ucs-jis-to-cp932-map): Rename from japanese-ucs-jis-map.
	(japanese-ucs-glibc-map): Delete this translation table.
	(japanese-ucs-glibc-to-jis-map, japanese-ucs-jis-to-glibc-map):
	New translation tables.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* cus-start.el: Handle charset-map-path, not charset-map-directory.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* term/x-win.el (x-selection-value): Optimize for ASCII only case.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* language/japanese.el: Add map #x00A6 <-> #xFFE4 to translation
	tables japanese-ucs-*-map.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/eucjp-ms.el: New file (automatically generated by
	admin/charsets/Makefile).

	* international/cp51932.el: New file (automatically generated by
	admin/charsets/Makefile).

	* language/japanese.el: Load cp51932 and eucjp-ms.
	(japanese-ucs-cp932-map, japanese-ucs-jis-map)
	(japanese-ucs-glibc-map): New translation tables.
	(eucjp-ms): New coding system.

	* international/mule.el (coding-system-put): Delete it.
	It's implemented in C now.

	* international/mule-conf.el (katakana-sjis): Fix :superset to :subset.
	(japanese-jisx0213-a): New supplementary charset.
	(japanese-jisx0213.2004-1): New charset.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* language/japanese.el (japanese-cp932): New coding system.
	(cp932): New alias of it.

	* international/mule-conf.el (katakana-sjis, cp932-2-byte)
	(cp932): New charsets.

	* international/mule.el (define-charset): If :code-space is not
	given, generate it from :dimension.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* composite.el (reference-point-alist): Doc fix.
	(encode-composition-rule, decode-composition-rule):
	Handle a rule (GREF NREF XOFF YOFF).

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* language/european.el (diacritic-composition-function): Fix for
	the case that POS is at the head.  Allow combining with more characters.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* descr-text.el (describe-char): Check `charset' property.
	Show the code point in the charset in hexadigits.

	* international/mule-diag.el (stretches-for-character-list):
	Delete it.
	(list-block-of-chars): Use tabs instead of `display' property for
	aligning characters.
	(print-fontset-element): Fix the printing of XLFD.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/encoded-kb.el (encoded-kbd-self-insert-utf-8):
	New function.
	(encoded-kbd-setup-keymap, encoded-kbd-mode): Add code for
	handling utf-8.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* faces.el (read-face-font): Include fontsets in the completion list.

	* international/mule-cmds.el (set-locale-environment):
	Insert locale-translation-file-name in a unibyte buffer.

	* international/characters.el: Fix setting of category `|'.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* language/chinese.el (chinese-gb18030): Fix :charset-list.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (select-safe-coding-system): Fix for
	the case that the first element of default-coding-system is t.
	Fix a message when some coding systems are rejected.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (set-language-environment): Put
	higher priority to charsets listed in `charset' property of the
	language environment.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* composite.el (auto-compose-chars): Don't do unnecessary
	save-exclusion and save-restriction.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule-conf.el (ctext-no-compositions):
	Remove garbage arguments.

	* international/mule.el (make-coding-system): Fix generation of
	properties.

	* international/fontset.el (setup-default-fontset): Specify fonts
	for `symbol' script.

	* international/characters.el (script-list): Include `currency'
	in `symbol'.

2008-02-01  Alex Schroeder  <alex@gnu.org>

	* timezone.el (timezone-parse-date): Fix style 8 to accept ISO
	8601 format (a capital T between the date and the time).

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule.el (private-char-area-1-min)
	(private-char-area-1-max, private-char-area-2-min)
	(private-char-area-2-max, emacs-mule-charset-table): New variables.
	(convert-define-charset-argument): New function.
	(define-charset): Handle the old calling style.
	Update emacs-mule-charset-table.
	(make-char-internal): New function.

2008-02-01  Jason Rumney  <jasonr@gnu.org>

	* w32-fns.el (w32-charset-info-alist): Define iso10646-1 always.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* composite.el (compose-region): Doc fix (delete duplicated line).

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/characters.el: Fix syntax for Ethiopic.

2008-02-01  Jason Rumney  <jasonr@gnu.org>

	* w32-fns.el (w32-charset-info-alist): Accept more charset aliases.

	* makefile.w32-in (DONTCOMPILE): Remove old languages.
	Add international/latin1-disp.el.
	(LC_ALL): Define as C.

2008-02-01  Jason Rumney  <jasonr@gnu.org>

	* term/w32-win.el: Don't set fontsets to use sjis.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* language/japanese.el (iso-2022-jp, iso-2022-jp-2)
	(japanese-iso-8bit): Fix the order of charsets in :charset-list.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* composite.el (auto-composition-chunk-size): Delete variable.
	(auto-compose-chars): Always stop after processing a newline.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule.el (define-coding-system): Fix attribute
	name :for-unibyte.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* ps-bdf.el: Largely re-write.

	* ps-mule.el: Largely re-write.

	* ps-print.el (ps-generate-string-list): Delete function.
	(ps-rh-cache, ps-lf-cache, ps-rf-cache): Delete variables.
	(ps-header-footer-string): Delete function.
	(ps-encode-header-string-function): New variable.
	(ps-generate-header-line): Call ps-encode-header-string-function.
	(ps-basic-plot-string-function): New variable.
	(ps-begin-job): Set ps-basic-plot-string-function and
	ps-encode-header-string-function.  For setting up headers and
	footers, don't use caches such as ps-rh-cache.  Don't call
	ps-mule-begin-page.
	(ps-basic-plot-str, ps-basic-plot-string, ps-control-character):
	Don't call ps-mule-prepare-ascii-font.
	(ps-plot-region): Don't pay attention to composition and
	non-ASCII characters.
	(ps-generate): Call ps-mule-end-job.
	(ps-mule-prepare-ascii-font, ps-mule-set-ascii-font)
	(ps-mule-plot-string, ps-mule-begin-page): Delete autoload.
	(ps-mule-end-job): Declare autoload.

	* composite.el (auto-compose-region): New function.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/mule-util.el
	(detect-coding-with-language-environment): Doc fix.

	* composite.el: Doc fixes.
	(auto-compose-chars): Use functionp, not fboundp.

	* international/mule-diag.el (list-charset-chars): Set buffer file
	coding system.

	* progmodes/cap-words.el (capitalized-words-mode): Add autoload
	cookie.  Doc fix.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/mule-diag.el (list-charset-chars): Set buffer file
	coding system.

	* progmodes/cap-words.el (capitalized-words-mode): Add autoload
	cookie.  Doc fix.

	* textmodes/tex-mode.el (tex-font-lock-syntactic-face-function):
	* progmodes/sh-script.el (sh-font-lock-syntactic-face-function):
	* progmodes/perl-mode.el (perl-font-lock-syntactic-face-function):
	* eshell/esh-opt.el (eshell-process-option):
	* emulation/keypad.el (keypad-setup):
	* emacs-lisp/lisp-mode.el (prin1-char):
	* emacs-lisp/generic.el (generic-mode-set-comments):
	* edmacro.el (edmacro-parse-keys):
	* disp-table.el (standard-display-default): Use characterp.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule-conf.el (utf-16-be): Make it an alias of
	utf-16be-with-signature.
	(utf-16-le): Make it an alias of utf-16le-with-signature.
	(utf-16-be-with-signature, utf-16-le-with-signature): Remove these
	coding system aliases.

	* international/utf-7.el (utf-7-decode, utf-7-encode):
	Use utf-16be, not utf-16-be.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule.el (coding-system-category): New function.
	(set-coding-priority): Re-write.
	(make-translation-table): Re-write.

	* international/mule-cmds.el (universal-coding-system-argument):
	Check the coding system type `undecided', not `t'.
	(sort-coding-systems): Fix for iso-2022 coding systems.
	(find-multibyte-characters): Fix for eight-bit chars.
	(set-language-environment): Set charset priorities according to
	the charsets supported by the coding systems of higher priorities.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* font-lock.el
	(font-lock-match-c-style-declaration-item-and-skip-to-next):
	Check (match-end 2) before going there.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule.el (ctext-non-standard-designations-alist):
	Exclude entries for iso8859-1[03456].  Fix docstring.
	(ctext-pre-write-conversion): Make it work for the case that FROM
	is a string.  Don't do unnecessary save-restriction and
	narrow-to-region.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule.el (ctext-non-standard-encodings-alist):
	Rename from non-standard-icccm-encodings-alist.
	(ctext-non-standard-encodings-regexp): New variable.
	(ctext-post-read-conversion): Full rewrite.
	(ctext-non-standard-designations-alist): Rename from
	non-standard-designations-alist.
	(ctext-pre-write-conversion): Full rewrite.
	(define-coding-system): Doc fix (escape '"' by '\').

2008-02-01  Dave Love  <fx@gnu.org>

	* international/mule-conf.el (utf-16le, utf-16be-16be)
	(utf-16le-with-signature, utf-16be-with-signature, utf-16):
	Define :mime-text-unsuitable.  Rename `utf-16{b,l}e...' from
	`-16-{b,l}e-' and define aliases for the old names.

	* international/mule.el (define-coding-system): Doc fix.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/utf-7.el: New file.

	* international/mule-conf.el (utf-7): New.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule-conf.el (utf-16): Add :endian 'big.

	* international/mule.el (define-coding-system): Fix docstring
	about :bom and :endian.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/mule-diag.el (describe-character-set):
	Fix printing dimensions.  Use `×', not `x'.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/fontset.el: Register CDAC fonts in
	face-font-rescale-alist instead of face-resizing-fonts.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule-conf.el (utf-16-le): Rename from utf-16-le-nosig.
	(utf-16-be): Rename from utf-16-be-nosig.
	(utf-16-le-with-signature): Rename from utf-16-le.
	(utf-16-be-with-signature): Rename from utf-16-be.
	(utf-16): Set :bom to (utf-16-le-with-signature .
	utf-16-be-with-signature).

2008-02-01  Dave Love  <fx@gnu.org>

	* language/georgian.el (georgian-ps, georgian-academy): New coding
	system.

	* language/chinese.el (chinese-big5-hkscs): New coding system.
	(big5-hkscs, cn-big5-hkscs): New aliases.

	* international/mule-conf.el (big5-hkscs, georgian-academy):
	New charset.
	(ibm1047): Doc fix.
	(pt154): Add mime-charset.
	(ptcp154, cp154): New aliases.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/mule.el (charset-iso-final-char, define-coding-system):
	Doc fix.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/ccl.el (define-ccl-program): Fset charset-id
	to charset-id-internal temporarily.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule-diag.el (list-block-of-chars):
	Use decode-char instead of make-char.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/fontset.el: Enable the default fontset to use
	Unicode fonts for ASCII characters.
	(x-decompose-font-name): Don't try to resolve PATTERN by
	x-resolve-font-name.
	(x-complement-fontset-spec): Never prepend an ASCII font.
	(create-fontset-from-fontset-spec): If a fontset of the same name
	already exists, override it instead of signaling an error.  Don't
	turn `ascii' into `latin'.  Don't update fontset-alias-alist here.

	* international/mule-conf.el (unicode-bmp): Delete duplicated
	definition.  Give it :code-offset 0.

	* international/mule-diag.el (print-fontset-element): New function.
	(print-fontset): Use print-fontset-element to print the elements
	of a fontset.  Use it also to print fonts fallen back to the
	default fontsets.

	* term/x-win.el: Delete the code to create a fontset from the X
	resource "Font".

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule-diag.el (print-fontset): Insert proper
	newline and indentation spaces.

2008-02-01  Dave Love  <fx@gnu.org>

	* emacs-lisp/byte-opt.el (side-effect-free-fns): Add langinfo,
	multibyte-char-to-unibyte.

	* emacs-lisp/cl-macs.el (cl-make-type-test): Use characterp.

	* international/mule-cmds.el (find-coding-systems-for-charsets):
	Use coding-system-type, coding-system-charset-list.
	(standard-keyboard-coding-systems): Delete.
	(set-locale-environment): Maybe set keyboard coding system.
	Avoid typical warning about codeset in C locale.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* international/fontset.el (x-complement-fontset-spec): If a
	fontname doesn't conform to XLFD format, try to get XLFD name by
	x-list-fonts.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/mule-conf.el (mik, pt154): New charsets.

	* language/cyrillic.el (mik, pt154): New coding systems.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/characters.el: Move parts around so that syntax
	definitions aren't overwritten wrongly.

	* international/mule-diag.el (unicode-data): Fix treatment of
	numeric-value fields.

2008-02-01  Dave Love  <fx@gnu.org>

	* progmodes/cap-words.el: New file.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	The following changes are to make character composition happen
	automatically on displaying.

	* composite.el: Remove all autoload cookies.
	(composition-function-table): Move variable declaration from
	composite.c.  Change format.
	(save-buffer-state): Copy from font-lock.el.
	(auto-composition-chunk-size): New variable.
	(auto-compose-chars): New function.  Set
	auto-composition-function to it.
	(toggle-auto-composition): New function.

	* international/characters.el: Make all characters in the
	charset tibetan to tibetan script.

	* international/mule-conf.el (tibetan): Fix :code-space property.
	(tibetan-1-column): Delete :superset property, add :code-offset
	property.

	* international/quail.el (quail-input-string-to-events): Don't
	generate compose-chars-after events.

	* language/devanagari.el: Register devanagari-composable-function
	in composition-function-table for Devanagari characters.

	* language/devan-util.el: Register devanagari-composable-pattern
	in indian-composable-pattern.
	(devanagari-composition-function): Add autoload cookie.  Change
	arguments to conform to composition-function-table.

	* language/european.el: Register combining characters in
	composition-function-table.
	(diacritic-composition-function): Change arguments to conform to
	composition-function-table.

	* language/indian.el (indian-composable-pattern): New variable.

	* language/ind-util.el (indian-compose-region): Don't call
	compose-chars-after, instead call a function registered in
	composition-function-table.

	* language/lao.el: Register lao-composition-function in
	composition-function-table for Lao vowels and tones.
	(lao): Don't use lao-post-read-conversion.

	* language/lao-util.el (lao-post-read-conversion): Delete this function.
	(lao-composition-function): Change arguments to conform to
	composition-function-table.

	* language/thai.el: Register thai-composition-function in
	composition-function-table for Thai vowels and tones.
	(thai-tis620): Don't use thai-post-read-conversion.

	* language/thai-util.el (thai-post-read-conversion): Delete function.
	(thai-composition-function): Change arguments to conform to
	composition-function-table.

	* language/tibetan.el: Register tibetan-composition-function in
	composition-function-table for Tibetan characters.

	* language/tibet-util.el (tibetan-composition-function):
	Change arguments to conform to composition-function-table.

	* loadup.el: Load composite.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/mule-diag.el (unicode-data): Find unicodedata-file
	literally.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/fontset.el: Doc fixes.
	("fontset-default"): Add iso8859-15.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/fontset.el ("fontset-default"): Add an entry for
	`indian-is13194' charset.

	* international/mule-conf.el (indian-is13194): Delete :unify-map
	property.  Don't unify this charset.
	(indian-2-column): Delete :superset property, add :code-offset property.

	* language/devan-util.el: Delete the superfluous autoload cookie
	near the head of the file.
	(devanagari-compose-region): Add autoload cookie.

	* language/ind-util.el (indian-2-column-to-ucs-region):
	Add autoload cookie.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/fontset.el ("fontset-default"): Add an entry for
	`devanagari' script and `malayalam-glyph' charset.
	(face-resizing-fonts): Register CDAC fonts.

	* international/mule-conf.el (malayalam-glyph): New charset.

2008-02-01  Dave Love  <fx@gnu.org>

	* term/x-win.el: Fix typo in loop setting x-keysym-table.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/mule-conf.el (utf-8-emacs): Delete :mime-charset.

	* term/x-win.el: Remove some ancient compatibility code.  Populate
	x-keysym-table.

	* international/mule-cmds.el (wid-edit): Require when compiling.
	(set-locale-environment): Check locale against coding system
	aliases too.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* language/indian.el (in-is13194-devanagari):
	Fix :post-read-conversion and :pre-write-conversion.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/mule-cmds.el (charset): Supply doc, :tag.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* emacs-lisp/bytecomp.el (byte-compile-lapcode): Be sure to
	return a unibyte string.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (set-locale-environment):
	Delete superfluous ')'s at the tail.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* international/mule.el (define-coding-system): Fix typo;
	"docode" -> "decode".

2008-02-01  Dave Love  <fx@gnu.org>

	* emacs-lisp/byte-opt.el (side-effect-free-fns):
	Add string-make-unibyte string-make-multibyte string-to-multibyte
	string-as-multibyte string-as-unibyte.

2008-02-01  Dave Love  <fx@gnu.org>

	* language/english.el (ibm1047, cp1047): New.

	* international/mule-conf.el (alternativnyj): Use new table.
	(cp866): Define standalone, not as alias.
	(ibm866): Change alias.
	(ibm1047): New.

	* language/cyrillic.el (cyrillic-alternativnyj):
	Remove mime-charset.  Use alternativnj charset.
	(cp866): Remove alias.  Define standalone.

2008-02-01  Dave Love  <fx@gnu.org>

	* language/european.el ("Latin-2", "Latin-5"): Doc fix.

	* language/cyrillic.el ("Bulgarian"): Fix input method and charset.
	("Tajik", "Belarusian"): Fix charset.

	* international/mule-cmds.el (describe-language-environment):
	Be case-insensitive when looking for input methods.
	(locale-name-match): Doc fix.
	(locale-charset-match-p): New.
	(set-locale-environment): Warn if coding system doesn't agree
	with system locale.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (select-safe-coding-system): If
	:mime-charset property of a coding system is not equal to that
	coding system, don't show that :mime-charset name.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/quail.el (quail-help): Fix underlining.

	* language/chinese.el (chinese-gb18030, gb18030)
	("Chinese-GB18030"): New.

	* international/mule-cmds.el (locale-language-names): Add GB18030.

	* international/swedish.el: Don't require latin-1.

2008-02-01  Dave Love  <fx@gnu.org>

	* language/czech.el ("Czech"):
	* language/slovak.el ("Slovak"):
	* language/romanian.el ("Romanian"): Remove unibyte-syntax property.

	* language/greek.el ("Greek"): Remove unibyte-syntax property.
	(cp737): New coding system.

	* language/european.el: Remove unibyte-syntax properties.
	Augment some coding-system properties.

	* international/mule-cmds.el (set-language-environment):
	Check for charset property of environment.
	(language-info-alist): Doc fix.

	* Makefile.in (DONTCOMPILE): Remove latin-N.el.

	* international/characters.el: Add Latin-1.

	* international/latin-1.el, international/latin-2.el,
	* international/latin-3.el, international/latin-4.el,
	* international/latin-5.el, international/latin-8.el,
	* international/latin-9.el: Delete.

	* loadup.el: Remove international/latin-N.el.

	* case-table.el (set-case-syntax-charset, set-case-syntax-1)
	(set-case-syntax-delims, set-case-syntax-pair, set-case-syntax):
	Undo last changes.

	* international/mule-diag.el (unicode-data): Check that
	`unicodedata-file' exists.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/fontset.el (charset-script-alist): Fix script names.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* international/latin-1.el: Bind set-case-syntax-charset to
	iso-8859-1.  Never provide latin-1.

	* international/latin-2.el: Bind set-case-syntax-charset to
	iso-8859-2.  Never provide latin-2.

	* international/latin-3.el: Bind set-case-syntax-charset to
	iso-8859-3.  Never provide latin-3.

	* international/latin-4.el: Bind set-case-syntax-charset to
	iso-8859-4.  Never provide latin-4.

	* international/latin-5.el: Bind set-case-syntax-charset to
	iso-8859-9.  Never provide latin-5.

	* international/latin-8.el: Bind set-case-syntax-charset to
	iso-8859-14.  Never provide latin-8.

	* international/latin-9.el: Bind set-case-syntax-charset to
	iso-8859-15.  Never provide latin-9.

	* case-table.el (set-case-syntax-set-multibyte): Delete variable.
	(set-case-syntax-charset): New variable.
	(set-case-syntax-1): New function.
	(set-case-syntax-delims, set-case-syntax-pair, set-case-syntax):
	Call set-case-syntax-1 on arguments.

	* international/mule-cmds.el (set-language-environment): Delete
	unnecessary setup of syntax/case for unibyte case.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* international/fontset.el (generate-fontset-menu): Exclude the
	default fontset.

	* faces.el (describe-face): Describe :fontset property too.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/characters.el: Don't set char width of CJK
	charsets generally.  Add some non-word syntax cases.
	(korean-ksc5601): Fix ranges with symbol syntax.

2008-02-01  Dave Love  <fx@gnu.org>

	* Makefile.in (DONTCOMPILE): Add indian.el.

	* language/ind-util.el:
	(ucs-bengali-to-is13194-alist, ucs-assamese-to-is13194-alist)
	(ucs-gurmukhi-to-is13194-alist, ucs-gujarati-to-is13194-alist)
	(ucs-oriya-to-is13194-alist, ucs-tamil-to-is13194-alist)
	(ucs-telugu-to-is13194-alist, ucs-malayalam-to-is13194-alist):
	Remove declarations and let-bind them in re-written top-level loop
	over scripts, including ucs-devanagari-to-is13194-alist.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/mule-cmds.el (charset): Move.
	(language-info-custom-alist): Move.  Alter :set.
	(find-coding-systems-for-charsets): Check charset type before
	getting :charset-list.

	* language/ind-util.el (iscii-to-ucs-region): Fix typo.

2008-02-01  Dave Love  <fx@gnu.org>

	* wid-edit.el (widget-string-complete): New.
	(widget-coding-system-prompt-value-history): Delete.
	(coding-system): Use coding-system-value-history.

	* international/mule-cmds.el (charset): New widget.
	(language-info-custom-alist): Use it.
	(default-input-method): Modify :type.

2008-02-01  Dave Love  <fx@gnu.org>

	* language/ind-util.el (ucs-devanagari-to-is13194-alist)
	(indian-glyph-char, indian-char-glyph): Delete.
	(is13194-default-repertory): Rename from is13194-default-repartory.
	(iscii-to-ucs-region): Hoist evals from loop.

	* language/devan-util.el (dev-charseq): Avoid indian-glyph-char.

	* language/indian.el (indian-script-table)
	(ccl-encode-indian-glyph-font): Delete.

	* international/mule-cmds.el (language-info-custom-alist): New.
	(input-method-activate-hook, input-method-inactivate-hook)
	(input-method-after-insert-chunk-hook)
	(input-method-use-echo-area, set-language-environment-hook)
	(exit-language-environment-hook): Customize.
	(find-coding-systems-for-charsets): Rewrite.
	(default-input-method): Add :link.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/mule-conf.el (eight-bit): Add :docstring,
	:short-name properties.
	(cp851): Doc fix.
	(unicode-bmp): New.

	* case-table.el (set-case-syntax-pair): Remove check on byte lengths.

	* language/european.el (cp858): New.
	("Turkish"): Add special case rules.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/characters.el: Make Ÿ and ÿ a case pair.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* international/mule-conf.el: Don't define the charset iso-8859-1
	here, just setup its properties.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* international/mule-conf.el (utf-8): Give :mime-charset property.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* international/characters.el: Remove duplicated case setting for
	Cyrillic and Greek letters.  Don't setup printable-chars here.

	* case-table.el (describe-buffer-case-table): Handle the case
	that KEY is a cons within map-char-table.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* international/characters.el: Fix categories ?A and ?C.
	Treat ASCII characters as `latin' script.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* international/fontset.el (fontset-plain-name): If the fontset
	name doesn't ends with "-fontset-*", use family name as the first
	part of the plain name.
	(create-fontset-from-ascii-font): If "fontset-startup" is not yet
	created, use that name for the fontset.  Fix arguments to
	subst-char-in-string.

2008-02-01  Dave Love  <fx@gnu.org>

	* term.el (term-char-mode): Remove generic-character-list code.

	* ruler-mode.el (ruler-mode-character-validate): Use characterp.

	* wid-edit.el (character): Use characterp.

	* international/mule-diag.el (describe-coding-system): Add utf-16 case.

	* language/viet-util.el (viet-encode-viscii-char): Use encode-char.

	* language/cyrillic.el ("Tajik", "Bulgarian", "Belarusian"):
	Add charset.
	("Ukrainian"): New.

	* language/georgian.el (georgian-ps): New coding system.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* international/mule-cmds.el (reset-language-environment):
	Don't set nonascii-translation-table and nonascii-insert-offset.
	Call set-unibyte-charset, not set-primary-charset.
	(nonascii-translation-table, nonascii-insert-offset):
	Declare these variable as obsolete ones.
	(set-language-environment): Call set-unibyte-charset, not
	set-primary-charset.  Call set-charset-priority with `charset'
	info of the language environment.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* international/characters.el (next-word-boundary-han):
	Don't treat katakana following han characters as a part of a word.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* international/characters.el: Call map-charset-chars on big5 (not
	chinese-big5-1/2) to set categories `c', `C', and `|'.
	(next-word-boundary-han, next-word-boundary-kana): New function.
	Register it in next-word-boundary-function-table.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* arc-mode.el (archive-file-name-coding-system): New variable.
	Make it permanent-local.
	(byte-after, bref, insert-unibyte): New function.  Change most of
	char-after, aref, insert to them respectively.
	(archive-mode): Set archive-file-name-coding-system.
	(archive-summarize): Don't change the buffer's multibyteness.
	(archive-extract): Inherit archive-file-name-coding-system from
	archive-superior-buffer.  Bind coding-system-for-write to
	archive-file-name-coding-system.
	(archive-*-write-file-member): Encode ENAME by
	archive-file-name-coding-system.  Bind coding-system-for-write to
	no-conversion.
	(archive-rename-entry): Encode the filename by
	archive-file-name-coding-system.
	(archive-mode-revert): Don't change the buffer's multibyteness.
	(archive-arc-summarize, archive-lzh-summarize)
	(archive-zoo-summarize): Don't change the buffer's multibyteness.
	Decode filenames by archive-file-name-coding-system.
	(archive-arc-rename-entry, archive-zip-chmod-entry): Don't change
	the buffer's multibyteness.

	* tar-mode.el (tar-file-name-coding-system): New variable.
	Make it permanent-local.
	(tar-header-block-tokenize): Decode filename and linkname by
	tar-file-name-coding-system.
	(tar-header-block-checksum): Call multibyte-char-to-unibyte to get
	the byte value of eight-bit chars.
	(tar-summarize-buffer): Call set-buffer-multibyte with METHOD
	`to'.  Delete unnecessary call of position-bytes.
	(tar-mode): Set tar-file-name-coding-system.  Delete unnecessary
	call of position-bytes.
	(tar-extract): Simplify by calling decode-coding-region with
	DESTINATION argument.  Don't toggle multibyteness of tar buffer.
	(tar-copy, tar-expunge): Don't toggle multibyteness of tar buffer.
	(tar-clear-modification-flags): Delete unnecessary call of
	position-bytes.
	(tar-rename-entry): Call tar-alter-one-field with encoded new name.
	(tar-alter-one-field): Don't toggle multibyteness of tar buffer.
	Convert new-data-string by string-to-multibyte before inserting it.
	(tar-subfile-save-buffer): Don't toggle multibyteness of tar
	buffer.  Simplify by calling encoding-coding-region with
	DESTINATION argument.
	(tar-mode-write-file): Delete unnecessary call of byte-to-position.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/titdic-cnv.el (quail-cxterm-package-ext-info): Doc fix.

	* emacs-lisp/copyright.el (copyright-regexp): Remove redundancy.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* international/characters.el: Setup char-script-table.

	* international/fontset.el: Setup the default fontset by the new
	script-based way.
	(x-complement-fontset-spec): Change the format of arg FONTLIST to
	an alist of charsets vs font name lists.
	(charset-script-alist): New variable.
	(create-fontset-from-fontset-spec): Allow script name in
	FONTSET-SPEC.  If charset is specified in FONTSET-SPEC, change it
	to the corresponding script name.
	(create-fontset-from-ascii-font): Slight tuning.

	* international/mule-conf.el (devanagari-glyph): New charset.
	Unify these charsets: korean-ksc5601, ipa, tibetan, ethiopic,
	japanese-jisx0208, japanese-jisx0212, japanese-jisx0213-1,
	japanese-jisx0213-2.

	* international/mule-diag.el (print-fontset): Use describe-vector
	to handle a char table returned by fontset-info.

	* language/indian.el: Don't register ccl-encode-indian-glyph-font
	and ccl-encode-unicode-font in font-ccl-encoder-alist.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* international/mule-util.el (detect-coding-with-priority):
	Fix the place of using `,' marker in backquote form.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/mule-conf.el (mule-unicode-e000-ffff): Set :max-code.

	* international/mule-util.el (with-coding-priority): Fix.

	* international/mule.el (set-coding-priority): Fix obsolete spec.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/mule-cmds.el (leim-list-header): Add coding tag.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/mule-cmds.el (find-coding-systems-region)
	(language-info-alist, reset-language-environment, princ-list): Doc fix.
	(input-method-verbose-flag): Fix :type.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/mule.el (set-char-table-default): Make obsolete.

2008-02-01  Dave Love  <fx@gnu.org>

	* language/devanagari.el ("Devanagari"): Fix coding-system,
	coding-priority.

	* international/mule-diag.el (describe-char-after): Modify display
	list processing.
	(unicodedata-file, unicodedata-find): New.

2008-02-01  Dave Love  <fx@gnu.org>

	* emacs-lisp/bytecomp.el (batch-byte-compile-if-not-done): Add
	autoload cookie.

	* international/ja-dic-cnv.el (skkdic-convert): Add coding tag.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/mule-util.el (detect-coding-with-priority): Rewrite.

2008-02-01  Dave Love  <fx@gnu.org>

	* composite.el (compose-string): Doc fix.

	* language/georgian.el ("Georgian"): Delete code-pages feature,
	add nonascii-translation.

	* language/european.el ("German", "French", "Spanish"):
	Add latin-9 as alternative coding system.
	("Slovenian", "Polish"): Add windows-1250 as alternative coding system.
	("Dutch"): Add latin-9 as alternative coding system.  Add input method.
	("Turkish"): Add windows-1254 and latin-3 as alternative coding systems.
	("Lithuanian", "Latvian"): Add windows-1257 as alternative coding
	system.

	* emacs-lisp/byte-opt.el (side-effect-free-fns): Add decode-char,
	encode-coding-char.
	(side-effect-and-error-free-fns): Add charsetp, max-char,
	primary-charset.

	* simple.el: Don't require cl when compiling.

	* Makefile.in (DONTCOMPILE): Fix duplicates.

	* emacs-lisp/bytecomp.el (byte-compile-insert-header): Fix typo.

	* international/mule.el: Doc fixes.
	(load-with-code-conversion): Fix coding-system-type test.

	* international/mule-cmds.el (sort-coding-systems): Comment out
	iso-2022 case.
	(encoded-string-description): Fix coding-system-type test.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/characters.el: Make korean-ksc5601 double-width.

	* international/mule.el (auto-coding-regexp-alist):
	Recognize Emacs 20/1 byte-compiled files.

	* international/mule-conf.el (file-coding-system-alist):
	Change .elc to utf-8-emacs.

	* emacs-lisp/bytecomp.el (byte-compile-fix-header): Adjust for use
	of utf-8-emacs.
	(byte-compile-insert-header): Update magic number.  Add ballast.
	(map-char-table): Use byte-compile-funarg-2.

2008-02-01  Dave Love  <fx@gnu.org>

	* language/cyrillic.el ("Belarusian"): Doc fix.
	(cp1125, koi8-t): Doc fix.

	* international/mule-cmds.el (find-multibyte-characters): Doc fix.
	(find-multibyte-characters): Don't test for charset `unknown'.
	(locale-language-names): Change or add: be, bs, cy, mk, ru.koi8,
	ru, sr_YU, tg, wa, zh.gbk.
	(locale-language-names): Change sp to Cyrillic.
	(locale-charset-language-names): Match @euro after utf-8.

2008-02-01  Dave Love  <fx@gnu.org>

	* language/chinese.el (chinese-gbk, gbk, cp936, windows-936):
	New coding systems.
	("Chinese-GBK"): New environment.

	* language/thai-util.el:
	* language/lao-util.el: Remove redundant Unicode characters
	in category-setting.

	* international/mule-conf.el (japanese-jisx0213-1)
	(japanese-jisx0213-2): Add unify-map.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* international/quail.el (quail-update-leim-list-file):
	Force writing the file by iso-2022-7bit.

	* international/titdic-cnv.el (miscdic-convert): Force writing the
	file by iso-2022-7bit.

	* international/mule.el (define-charset): Change the attribute
	:parents to :subset or :superset.

	* international/mule-conf.el: Adjust for the change of
	define-charset (:parent -> :subset or :superset).

	* international/characters.el: Fix the last change.

2008-02-01  Dave Love  <fx@gnu.org>

	* language/cyril-util.el (cyrillic-encode-koi8-r-char)
	(cyrillic-encode-alternativnyj-char): Fix.
	(standard-display-cyrillic-translit):
	Remove redundant Unicode characters.

2008-02-01  Dave Love  <fx@gnu.org>

	* language/cyrillic.el ("Tajik", "Bulgarian", "Belarusian"):
	New environments.

	* international/mule-conf.el (control-1): New charset.
	(eight-bit-control, eight-bit-graphic): Redefine to use raw-bytes space.
	(korean-ksc5601): Redefine to use code-offset and unify-map.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/mule-conf.el (tcvn-5712): New charset.

	* language/vietnamese.el (vietnamese-tcvn, tcvn): New coding system.
	("Vietnamese"): Doc fix.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/mule-conf.el (windows-936): New alias.

	* cus-start.el: Add scalable-fonts-allowed.

	* international/characters.el: Reinstate various CJK syntax and
	category setup.  Remove obsolete syntax setting in Greek section.
	Optimize the char tables.

	* language/thai.el ("Thai"): Add cp874, iso-8859-11 coding systems.

	* language/vietnamese.el ("Vietnamese"): Add windows-1258 coding system.

	* language/greek.el ("Greek"): Add windows-1253, cp851, cp869
	coding systems.

	* language/romanian.el ("Romanian"): Add iso-latin-10 coding system.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* international/characters.el (printable-chars): Setup correctly.

2008-02-01  Dave Love  <fx@gnu.org>

	* cus-start.el: Add selection-coding-system.

	* language/hebrew.el ("Hebrew"): Add windows-1255, cp862 coding systems.

	* language/china-util.el (post-read-decode-hz)
	(pre-write-encode-hz): Move from chinese.el.
	(big5-to-flat-code, flat-code-to-big5, euc-to-flat-code)
	(flat-code-to-euc, expand-euc-big5-alist, big5-to-cns): Delete.

	* language/chinese.el (post-read-decode-hz)
	(pre-write-encode-hz): Move to china-util.el.

	* case-table.el (set-case-syntax-pair): Test again for equal byte
	lengths of the pair.

	* international/characters.el: Add Vietnamese category to
	equivalent Unicode characters.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/mule-conf.el (chinese-sisheng, ipa)
	(indian-is13194, tibetan, ethiopic): Add :unify-map.

	* international/mule-diag.el (describe-character-set): Account for
	more than two dimensions of possibly different size.
	(describe-current-coding-system): Add selection-coding-system.

	* international/mule-cmds.el (unify-8859-on-encoding-mode)
	(unify-8859-on-decoding-mode): Move from mule.el.

	* international/mule.el (unify-8859-on-encoding-mode)
	(unify-8859-on-decoding-mode): Remove :init-value.
	(charset-chars): Add optional dimension arg.
	(unify-8859-on-encoding-mode, unify-8859-on-decoding-mode):
	Move to mule-cmds.el.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* international/fontset.el: Change registry for japanese-jisx0208
	to "JISX0208*" in the default fontset.
	(font-encoding-alist): Add an entry for "JISX0208.1983" and
	"ISO10646.indian-1".

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* language/japanese.el (japanese-iso-7bit-1978-irv):
	Add `designation' to :flags, `ascii' to :charset-list.

	* international/mule.el (define-charset): New args :min-code and
	:max-code.
	(coding-system-iso-2022-flags): Add use-roman, use-oldjis.

	* international/mule-conf.el (chinese-gbk): Change :code-offset to
	#x160000.
	(gb18030-2-byte, gb18030-4-byte-bmp, gb18030-4-byte-smp)
	(gb18030-4-byte-ext-1, gb18030-4-byte-ext-2, gb18030): New charsets.

2008-02-01  Dave Love  <fx@gnu.org>

	* language/thai.el (iso-8859-11): New coding system.

	* international/mule-conf.el: Doc fixes.
	(iso-8859-11): New.

2008-02-01  Dave Love  <fx@albion.dl.ac.uk>

	* cus-start.el (scalable-fonts-allowed): Add.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/mule.el (unify-8859-on-encoding-mode)
	(unify-8859-on-decoding-mode): Dummy versions.

	* international/ucs-tables.el: Remove.

	* Makefile.in (DONTCOMPILE): Add language/chinese.el,
	language/japanese.el.

	* international/mule-conf.el: Doc fixes.
	(cp936): New alias.
	(cp720, cp858): New charsets.

	* mail/sendmail.el (mail-recover-1, mail-recover): Use utf-8-emacs
	coding system, not emacs-mule.

	* files.el (revert-buffer, recover-file): Likewise.

	* desktop.el (desktop-save): Likewise.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/mule.el (with-category-table): Use make-symbol.
	(coding-system-list): Use coding-system-aliases.
	(make-translation-table): Don't deal with generic characters.

	* international/mule-util.el (coding-system-post-read-conversion)
	(coding-system-pre-write-conversion)
	(coding-system-translation-table-for-decode)
	(coding-system-translation-table-for-encode): Get the right properties.
	(with-coding-priority): New macro.
	(detect-coding-with-language-environment): Use it.
	(coding-system-equal): Use coding-system-plist.

	* international/encoded-kb.el (encoded-kbd-setup-keymap) <ccl>:
	Use :valid property.

	* international/mule-cmds.el (encode-coding-char):
	Use find-coding-systems-string.  Don't use make-char.
	(describe-language-environment): Use coding-system-aliases.
	(prefer-coding-system): Doc fix.

	* international/mule-diag.el (describe-current-coding-system):
	Fix aliases listing.
	(print-iso-2022-flags): Delete.
	(print-designation): Partial re-write.
	(describe-coding-system): Deal with iso-2022 designations, flags.
	Fix shift_jis case.
	(describe-char-after): Use characterp.  Print explicit Unicode code point.
	Remove some obsolete code.
	(print-coding-system-briefly): Fix printing aliases.
	(print-coding-system): Use coding-system-aliases.
	(mule-diag): Don't list coding categories.

	* international/mule-conf.el: Doc fixes.  Remove redundant :long-name properties.
	Re-order charset priorities.
	(binary): New alias.
	(iso-8859-16): Fix nickname.
	(define-iso-single-byte-charset): Un-define after use.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/characters.el: Additional double width specifications.

	* international/mule-diag.el (print-coding-system): Incomplete updates.
	(describe-character-set): List more properties.
	(print-fontset): Fix case of vector font-spec.
	(describe-current-coding-system): Fix iso-7, iso-7-else.

	* international/mule-conf.el (ibm866): Fix alias.
	(iso-8859-16): Fix nickname.

2008-02-01  Dave Love  <fx@gnu.org>

	* language/ind-util.el: Avoid decode-char.
	(indian--puthash-char, indian--puthash-c, indian--puthash-cv):
	Use characterp, not char-valid-p.

	* language/devan-util.el: Add coding tag, avoid decode-char.

	* international/titdic-cnv.el: Add coding tag.
	(tit-process-header): Add coding tag to output.

	* language/thai.el (cp874, ibm874): New coding systems.

	* emacs-lisp/byte-opt.el <side-effect-and-error-free-fns>:
	Add character-p.

	* language/european.el (cp852, ibm852, cp857, ibm857, cp860)
	(ibm860, cp861, ibm861, cp863, cp865, ibm865, cp437, ibm437):
	New coding systems.
	<set-language-info-alist>: Avoid decode-char.

	* language/hebrew.el (cp862, ibm862): New coding systems.

	* language/greek.el (cp851, ibm851, cp869, ibm869): New coding systems.

	* language/cyrillic.el (cp855, ibm855): New coding systems.

	* international/mule-conf.el: Avoid decode-char in top-level code
	for self-inserting multibyte chars.
	(cp437, cp737, cp775, cp851, cp852, cp855, cp857, cp855, cp857)
	(cp860, cp861, cp862, cp863, cp864, cp865, cp869, cp874):
	New charsets.

	* international/characters.el: Various simplifications and additions.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/mule-conf.el (code-pages): Provide, for compatibility.

	* international/code-pages.el: Remove.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* Makefile.in: Cancel the 2008-02-01 change of mine.

	* international/fontset.el: Add setting for Unicode font at the
	end of the default fontset.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/mule-conf.el (adobe-standard-encoding, symbol):
	Adjust :code-space.
	(ibm850): Add :ascii-compatible-p.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* international/mule-conf.el (vietnamese-viscii-lower)
	(vietnamese-viscii-upper): Supply them :code-offset, then unify by
	mapping table.

2008-02-01  Dave Love  <fx@gnu.org>

	* cus-start.el: Add charset-map-directory.

	* international/fontset.el (font-encoding-alist): Add adobe-symbol.

	* format.el (format-alist): Remove ibm, mac, hp entries (available
	natively).

	* language/romanian.el (iso-latin-10): Add :mime-charset.
	("Romanian"): Add doc.

	* international/mule-conf.el (iso-8859-10, symbol)
	(adobe-standard-encoding, ibm850): New charsets.
	(iso-8859-13): Fix IR number, final char.
	(file-coding-system-alist): Add .xml.

	* language/european.el (iso-latin-6, iso-8859-10, latin-6)
	(iso-latin-7, iso-8859-13, latin-7, hp-roman8, roman8)
	(adobe-standard-encoding, cp850, ibm850): New coding systems.
	("Latin-6", "Latin-7"): New language environments.

2008-02-01  Dave Love  <fx@gnu.org>

	* Makefile.in (DONTCOMPILE): Remove ucs-tables, utf-8,
	utf-8-subst; add vietnamese, cyrillic, czech.

	* language/romanian.el (iso-latin-10): New coding system.

	* international/mule-conf.el (emacs-mule): Set :charset-list,
	consistent with coding-system-charset-list doc.
	(iso-8859-16): New charset.

	* international/mule-diag.el (describe-coding-system): Avoid error
	for iso-2022, emacs-mule.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/codepage.el: Remove or comment out most of code.
	(codepage-setup): Re-write as trivial, obsolete function.

	* language/utf-8-lang.el ("UTF-8"): Use utf-8, not mule-utf-8.
	Remove setup function.

	* language/english.el (ebcdic-us, ebcdic-uk): New coding systems.

	* Makefile.in (DONTCOMPILE): Add language/vietnamese.el,
	language/cyrillic.el, language/czech.el.

	* language/vietnamese.el (windows-1258, cp1258): New coding systems.
	(font-ccl-encoder-alist): Remove viscii, vscii.

	* language/hebrew.el (windows-1255, cp1255): New coding systems.

	* language/european.el (windows-1254, cp1254, windows-1257)
	(cp1257, next, iso-latin-7, iso-8859-13, latin-7): New coding systems.
	("Latin-7", "Lithuanian", "Latvian"): Don't require code-pages.

	* language/greek.el (windows-1253, cp1253): New coding systems.

	* international/mule-conf.el (ebcdic-us, ebcdic-uk): Change map
	file name.
	(windows-1253, windows-1254, windows-1255, windows-1256)
	(windows-1257, windows-1258, next): New charsets.

	* international/utf-8.el, international/utf-8-subst.el: Remove.

	* international/mule.el: Doc fixes.
	(charset-list, generic-char-p, set-coding-priority): Make obsolete.
	(coding-system-get): Try to convert old-style symbol to keyword.
	(define-charset): Purecopy strings in property list.
	(define-coding-system): Purecopy docstring.

	* international/mule-diag.el (list-character-sets-2): Avoid
	charset-bytes.
	(list-iso-charset-chars, list-non-iso-charset-chars): Delete.
	(list-block-of-chars): Re-write.
	(describe-character-set): Show more properties.
	(describe-char-after): Correct codepoint display.
	(print-coding-system): Use symbolic types.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* Makefile.in: Be sure also to run emacs with LANG=C.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/mule-diag.el: Doc fixes.
	(sort-charset-list, charset-multibyte-form-string): Remove.
	(list-character-sets, list-character-sets-1)
	(list-character-sets-2): Re-write.
	(non-iso-charset-alist): Set to nil and made obsolete.
	(decode-codepage-char): Re-write and made obsolete.
	(read-charset): Don't use non-iso-charset-alist.
	(describe-coding-system): Use keyword properties.
	(describe-character-set): Re-write.

	* international/mule-conf.el (koi8-u, koi8-t, georgian-ps)
	(windows-1250, windows-1251, windows-1252, cp1125, ebcdic-us)
	(ebcdic-uk): New charsets.

	* language/cyrillic.el (koi8-u, koi8-t, windows-1251, cp1125):
	New coding systems.

	* language/european.el (windows-1252): New coding system.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* Makefile.in: By sure to run emacs with LC_ALL=C.

	* international/encoded-kb.el (encoded-kbd-handle-8bit): Call
	encoded-kbd-self-insert-iso2022-8bit with argument 1.
	(encoded-kbd-self-insert-charset): New function.
	(encoded-kbd-setup-keymap, encoded-kbd-mode): Handle a
	coding-system of type charset.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/mule-cmds.el (set-locale-environment): Comment out
	set-keyboard-coding-system stuff.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* international/mule.el (define-coding-system): Doc fix;
	sjis->shift-jis.

	* international/mule-conf.el: Use decode-char instead of make-char.

	* international/encoded-kb.el (encoded-kbd-self-insert-iso2022-8bit):
	New arg ARG.  Directly call self-insert-command.  This is a
	temporary workaround to make it work with latin-1.
	(encoded-kbd-mode): Change `sjis' to `shift-jis'.

	* international/characters.el: Setup char-width-table for CJK
	characters.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* international/ja-dic-utl.el (skkdic-jisx0208-hiragana-block):
	Fix the initial value to specify character range of
	japanese-jisx0208, not Unicode.

	* international/characters.el: Set syntax/category for
	japanese-jisx0208.

2008-02-01  Dave Love  <fx@gnu.org>

	* mail/sendmail.el (sendmail-send-it): Use :mime-charset, not
	mime-charset.

	* language/vietnamese.el, language/korean.el, language/japanese.el:
	* language/hebrew.el, language/greek.el, language/chinese.el:
	Fix :mime-charset properties.

	* language/cyrillic.el (cyrillic-iso-8bit, cyrillic-koi8)
	(cyrillic-alternativnyj): Fix :mime-charset.
	(cp878, cp866): New alias.

	* language/european.el: Fix mime-charset properties.

	* international/mule-cmds.el (sort-coding-systems)
	(select-safe-coding-system, select-message-coding-system): Use
	:mime-charset, not 'mime-charset.

	* international/mule-conf.el: Add various :mime-charset properties.

2008-02-01  Dave Love  <fx@gnu.org>

	* international/encoded-kb.el (encoded-kbd-self-insert-ccl): Fix
	getting decoder.
	(encoded-kbd-mode): Fix code for coding system type and designations.

	* international/mule-conf.el: Spelling fixes.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* international/fontset.el (fontset-plain-name): Handle the case
	that size, weight, slant are not specified in the fontset name.

2008-02-01  Yong Lu  <lyongu@asia-infonet.com>

	* language/greek.el (greek-iso-8bit): Fix typo.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* language/chinese.el (chinese-big5): Change :coding-type to `charset'.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* international/characters.el: Change encoding to utf-8-emacs.
	Remove apparent duplicate codes.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* international/fontset.el: Change the registry for
	chinese-gb2312 and add the registry for chinese-gbk.

	* international/mule.el (charset-chars): Fix typo.

	* international/mule-conf.el (chinese-gbk): New charset.

	* international/titdic-cnv.el (titdic-convert): Read into a
	unibyte buffer then make the buffer multibyte.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* international/mule-conf.el (utf-16-le, utf-16-be): Use :bom attribute
	instead of :signature.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* language/czech.el ("Czech"): Set `iso-8859-2' for
	`nonascii-translation'.

	* language/romanian.el ("Romanian"): Likewise.

	* language/slovak.el ("Slovak"): Likewise.

	* international/characters.el: Optimize calls of modify-category-entry.

2008-02-01  Kenichi Handa  <handa@etl.go.jp>

	* bindings.el: Don't bind multibyte characters to
	self-insert-command here.  It's done in mule-conf.el.

	* case-table.el (set-case-syntax-offset): Delete variable.
	(set-case-syntax-1): Delete function.  Change callers.
	(set-case-syntax-delims): Don't check byte length of characters.

	* isearch.el (isearch-mode-map): Call set-char-table-range to bind
	characters to isearch-printing-char.

	* loadup.el: Don't load "international/utf-8".  Don't call
	update-coding-systems-internal.  Bind coding-system-for-write to
	`utf-8' while writing fns-XXX.el.  Call clear-charset-maps before
	dumping.

	* emacs-lisp/regexp-opt.el (regexp-opt-charset): Adjust for the
	change of map-char-table.

	* eshell/esh-mode.el: Adjust for the change of map-char-table.

	* international/characters.el: Adjust for the deletion of
	generic characters.

	* international/code-pages.el (cp-make-translation-table)
	(cp-valid-codes, cp-fix-safe-chars): Delete.  Change caller.
	(cp-make-coding-system): Call define-coding-system.

	* international/fontset.el: Rewrite most code.

	* international/ja-dic-cnv.el (skkdic-get-kana-compact-codes):
	Call encode-char instead of split-char.

	* international/ja-dic-utl.el (skkdic-jisx0208-hiragana-block):
	Change value.
	(skkdic-lookup-key): Call encode-char instead of split-char.

	* international/titdic-cnv.el (titdic-convert): Bind
	coding-system-for-write to 'iso-2022-7bit.  Don't work on unibyte
	buffer.

	* international/latin-1.el: Don't bind set-case-syntax-offset.

	* international/latin-2.el: Don't bind set-case-syntax-offset.

	* international/latin-3.el: Don't bind set-case-syntax-offset.

	* international/latin-4.el: Don't bind set-case-syntax-offset.

	* international/latin-5.el: Don't bind set-case-syntax-offset.

	* international/latin-8.el: Don't bind set-case-syntax-offset.

	* international/latin-9.el: Don't bind set-case-syntax-offset.

	* international/mule-cmds.el: Don't use coding category.
	Call set-coding-system-priority instead of set-coding-priority.
	(sort-coding-systems, select-safe-coding-system):
	Call coding-system-priority-list to get the most preferred one.
	(reset-language-environment): Order of coding system priority
	changed.  Set primary charset to iso-8859-1.
	(set-language-environment-coding-systems):
	Call set-coding-system-priority instead of set-coding-priority.
	(get-charset-property, put-charset-property): Move to mule.el.

	* international/mule-conf.el: Full re-write.

	* international/mule-diag.el (print-designation): Change arguments.
	(print-iso-2022-flags): New function.
	(describe-coding-system, describe-current-coding-system):
	Adjust for the new structure of coding system.

	* international/mule.el (char-valid-p): Make it an alias of characterp.
	(define-charset): Full re-design.
	(charset-quoted-standard-p): Delete.
	(charsetp): Move to charset.c.
	(charset-info, charset-id, charset-bytes, charset-width)
	(charset-direction, charset-iso-graphic-plane)
	(charset-reverse-charset): Delete.
	(charset-dimension, charset-chars, charset-iso-final-char)
	(charset-description, charset-short-name, charset-long-name):
	Call charset-plist instead of charset-info.
	(charset-plist, set-charset-plist): Move to charset.c.
	(get-charset-property, put-charset-property): Move from
	mule-cmds.el.  Call charset-plist and set-charset-plist.
	(make-char): Delete.
	(generic-char-p): Make it always return nil.
	(decode-char, encode-char): Move to charset.c.
	(coding-spec-XXX-idx): Delete variables.
	(coding-system-iso-2022-flags): New variable.
	(define-coding-system): New function.
	(transform-make-coding-system-args, make-coding-system): Delete.
	(set-coding-priority): Make it obsolete.
	(after-insert-file-set-buffer-file-coding-system)
	(find-new-buffer-file-coding-system): Adjust for the new coding
	system structure.

	* language/chinese.el, language/cyrillic.el, language/european.el:
	* language/greek.el, language/hebrew.el, language/indian.el:
	* language/japanese.el, language/korean.el, language/lao.el:
	* language/thai.el, language/tibetan.el, language/vietnamese.el:
	Call define-coding-system instead of make-coding-system.
	Delete all CCL program.

	* textmodes/sgml-mode.el (sgml-mode-map): Use encode-char instead
	of make-char.
	(sgml-char-names-table): Fix iteration limit.

	* term/mac-win.el: Delete unnecessary calls of set-fontset-font.
	(ccl-encode-mac-roman-font): Delete.

	* Makefile.in (DONTCOMPILE): Add latin1-disp.el, ucs-tables.el,
	utf-8.el, and utf-8-subst.el as they can't be bytecompiled
	currently.  This is just a temporary workaround.

2008-02-01  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* whitespace.el (global-whitespace-mode): Use `find-file-hook' instead
	of `find-file-hooks'.
	(global-whitespace-toggle-options): Doc fix.

2008-02-01  Juanma Barranquero  <lekktu@gmail.com>

	* whitespace.el (whitespace): Set :version tag to 23.1.
	(whitespace-turn-off, whitespace-toggle-options): Fix typos.
	(whitespace-style, whitespace-chars, whitespace-space)
	(whitespace-hspace, whitespace-tab, whitespace-newline)
	(whitespace-trailing, whitespace-line, whitespace-space-before-tab)
	(whitespace-indentation, whitespace-empty, whitespace-space-after-tab)
	(whitespace-hspace-regexp, whitespace-space-regexp)
	(whitespace-tab-regexp, whitespace-trailing-regexp)
	(whitespace-space-before-tab-regexp, whitespace-indentation-regexp)
	(whitespace-empty-at-bob-regexp, whitespace-empty-at-eob-regexp)
	(whitespace-space-after-tab-regexp, whitespace-line-column)
	(whitespace-display-mappings, global-whitespace-toggle-options)
	(whitespace-cleanup, whitespace-cleanup-region)
	(whitespace-interactive-char): Doc fixes.

2008-02-01  Juanma Barranquero  <lekktu@gmail.com>

	* whitespace.el (global-whitespace-mode): Fix modeline lighter.
	When turning off the global mode, turn off the local modes too
	if whitespace is being unloaded.
	(whitespace-unload-function): New function.

2008-02-01  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* vc.el (vc-update): Fix bug: Specify branch tip as
	vc-checkout REVISION.  Reported by Dan Nicolaescu.

2008-02-01  Glenn Morris  <rgm@gnu.org>

	* info.el (bookmark-make-cell-function, bookmark-search-size)
	(bookmark-current-bookmark): Declare variables for compiler.
	(bookmark-buffer-file-name, bookmark-get-filename)
	(bookmark-get-front-context-string)
	(bookmark-get-rear-context-string, bookmark-get-position)
	(bookmark-get-info-node, bookmark-file-or-variation-thereof)
	(bookmark-jump-noselect): Declare functions for compiler.
	(Info-bookmark-make-cell): Fix argument list to match example of
	`bookmark-make-cell-for-text-file'.
	(Info-bookmark-jump): Don't require info inside info.el.

2008-02-01  Dan Nicolaescu  <dann@ics.uci.edu>

	* progmodes/verilog-mode.el (verilog-sk-prompt-msb)
	(verilog-sk-module, verilog-sk-function, verilog-sk-begin)
	(verilog-sk-if, verilog-sk-wire, verilog-sk-for)
	(verilog-sk-state-machine): Quote all calls to
	"auxiliary skeleton"s to prevent infloops.

2008-02-01  Jason Rumney  <jasonr@gnu.org>

	* w32-fns.el: Partially revert 2007-11-10 change.

2008-02-01  Martin Rudalics  <rudalics@gmx.at>

	* mail/rmail.el (rmail-highlight): Fix specification.
	Reported by pod <pod@herald.ox.ac.uk>.

2008-02-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* image-mode.el (image-mode-current-vscroll)
	(image-mode-current-hscroll): Make buffer-local.
	(image-set-window-vscroll, image-set-window-hscroll): Simplify.
	(image-reset-current-vhscroll): Use the latest setting when displaying
	for the first time in a window.  Apply to all windows in the frame.
	(image-mode): Don't make image-mode-current-[vh]scroll buffer-local.

	* progmodes/grep.el (grep-compute-defaults):
	Don't mix up defaults for different connections to the same host.

2008-01-31  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* blank-mode.el: Rename to whitespace.el.

	* obsolete/whitespace.el: Rename to obsolete/old-whitespace.el.

2008-01-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	* net/rcompile.el (remote-compile): Remove broken code.

2008-01-31  Jason Rumney  <jasonr@gnu.org>

	* term/w32-win.el (image-library-alist): Prefer libxpm.dll.

2008-01-31  Juanma Barranquero  <lekktu@gmail.com>

	* linum.el (linum-unload-function): New function.

2008-01-30  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-var-set-format-regexp): New constant.
	(gdb-var-set-format-handler): New function.
	(gdb-var-set-format): Use it.

2008-01-30  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/check-declare.el (check-declare-directory):
	* emacs-lisp/authors.el (authors): Use `find-program' and
	`grep-program' instead of hardcoded program names.

	* emacs-lisp/cl-loaddefs.el: Update.

2008-01-30  Tassilo Horn  <tassilo@member.fsf.org>

	* info.el (Info-bookmark-make-cell, Info-bookmark-jump): New functions.
	Implement bookmark support the new make-cell/handler way.
	(Info-mode): Bind bookmark-make-cell-function to
	Info-bookmark-make-cell buffer locally.

2008-01-30  Richard Stallman  <rms@gnu.org>

	* progmodes/etags.el (tags-query-replace): Delete unused optional args.
	Doc fix.

	* files.el (hack-local-variables): Don't query about fake variables.

2008-01-30  Markus Triska  <markus.triska@gmx.at>

	* linum.el: New file.

2008-01-29  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-methods): Use "-H" option for "sudo".
	Suggested by Trent W. Buck <trentbuck@gmail.com>.  Make ("%h")
	a single element in "plinkx".
	(tramp-handle-shell-command): Reuse "*Async Shell Command*" or
	"*Shell Command Output*" buffers.  Check, whether there is already
	an asynchronous process running.  Display always the buffer of the
	asynchronous process.
	(tramp-compute-multi-hops): Adapt error message.

2008-01-29  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-langs.el (c-specifier-key): Exclude "template"
	from this regexp; part of same fix as next change to cc-engine.el.

	* progmodes/cc-engine.el (c-guess-basic-syntax, CASE 5A.5):
	Anchor the "{" of a template function correctly on "template", not the
	following "<".

	* progmodes/cc-defs.el (c-version): Increase to 5.31.5.

2008-01-29  Tassilo Horn  <tassilo@member.fsf.org>

	* doc-view.el (doc-view-mode): Adapt to image-mode-current-vscroll
	and image-mode-current-hscroll being alists now.

	* image-mode.el (image-mode-current-vscroll)
	(image-mode-current-hscroll): Add doc strings.
	(image-set-window-vscroll, image-set-window-hscroll)
	(image-reset-current-vhscroll, image-mode): Adapt to
	image-mode-current-vscroll and image-mode-current-hscroll being
	alists now.

2008-01-29  Martin Rudalics  <rudalics@gmx.at>

	* emacs-lisp/find-func.el (find-function-search-for-symbol):
	Strip extension from .emacs.el to make sure symbol is searched
	in .emacs too.

2008-01-29  Tassilo Horn  <tassilo@member.fsf.org>

	* doc-view.el (doc-view-mode): Use facilities below to
	restore [vh]scroll when switching buffers.

	* image-mode.el (image-mode-current-vscroll)
	(image-mode-current-hscroll): New variables.
	(image-set-window-hscroll, image-set-window-vscroll): New functions.
	(image-forward-hscroll, image-next-line, image-bol, image-eol)
	(image-bob, image-eob): Use them.
	(image-reset-current-vhscroll): New function.
	(image-mode): Make new variables buffer-local and reset [vh]scroll
	on window configuration changes.

2008-01-27  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-create-define-alist): Don't call
	gdb-cpp-define-alist-program if file is nil (currently only
	" *partial-output-...").

2008-01-27  Richard Stallman  <rms@gnu.org>

	* allout.el: Many doc fixes.
	(allout-encrypt-string): Fix error message.

2008-01-26  Eli Zaretskii  <eliz@gnu.org>

	* progmodes/etags.el (tags-query-replace): Doc fix.

2008-01-25  Juanma Barranquero  <lekktu@gmail.com>

	* allout.el (allout-unload-function): New function.

2008-01-25  Juanma Barranquero  <lekktu@gmail.com>

	* allout.el (allout-prefix-data): Doc fix.
	(allout-show-current-subtree): Reflow docstring.
	(allout-use-mode-specific-leader, allout-use-hanging-indents)
	(produce-allout-mode-map, allout-overlay-interior-modification-handler)
	(allout-next-heading, allout-previous-heading, allout-rebullet-heading)
	(allout-rebullet-topic, allout-rebullet-topic-grunt, allout-kill-topic)
	(allout-copy-topic-as-kill, allout-listify-exposed)
	(allout-process-exposed, allout-encrypted-key-info)
	(allout-update-passphrase-mnemonic-aids)
	(allout-next-topic-pending-encryption)
	(allout-tests-globally-true): Fix typos in docstrings.

2008-01-23  Jason Rumney  <jasonr@gnu.org>

	* lpr.el (printer-name): Do not set on MS Windows.

2008-01-28  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-handle-shell-command): Use "/bin/sh -c" for
	the command.

2008-01-28  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* whitespace.el: Moved to obsolete dir.

	* blank-mode.el: New version 9.2.  Replace whitespace functions by
	aliases in blank-mode.
	(whitespace-buffer): New fun.
	(whitespace-region): Alias for whitespace-buffer, because there is no
	blank-region fun.
	(whitespace-cleanup): Alias for blank-cleanup.
	(whitespace-cleanup-region): Alias for blank-cleanup-region.

2008-01-27  Juanma Barranquero  <lekktu@gmail.com>

	* server.el (server-log-time-function): Doc fix.
	(server-buffer): Fix typo in docstring.

2008-01-27  Martin Rudalics  <rudalics@gmx.at>

	* view.el (view-buffer): Explain in doc-string why exit-action
	should not be set to kill-buffer.

	* arc-mode.el (archive-extract):
	* tar-mode.el (tar-extract): Use kill-buffer-if-not-modified as
	exit-action when viewing the buffer.

2008-01-27  Dan Nicolaescu  <dann@ics.uci.edu>

	* add-log.el (change-log-search-file-name): Work harder to find
	the correct file name.
	(change-log-find-file): Fix typo.
	(change-log-start-entry-re): Move definition earlier.

2008-01-27  Jan Nieuwenhuizen  <janneke@gnu.org>

	* add-log.el (change-log-search-file-name, change-log-find-file):
	New function.
	(change-log-font-lock-keywords): Move file name matching ...
	(change-log-file-names-re): ... here.  New defconst.
	(change-log-mode-map): New binding C-c C-f to change-log-find-file.

2008-01-27  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-awk.el, progmodes/cc-engine.el: Correct typos,
	enhance comments.

2008-01-27  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-compute-multi-hops): In case of su(do)?
	methods, the host name must be a local host.

2008-01-27  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el: Add TODO item about not defaulting to RCS.

	* server.el (server-process-filter): Check for non-nil before
	calling file-directory-p.

2008-01-27  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-vars.el (c-hanging-braces-alist): New element for
	arglist-cont-nonempty.

	* progmodes/cc-cmds.el (c-brace-newlines): Determine the newlines
	for a brace with syntax arglist-cont-nonempty.

	* progmodes/cc-styles.el (c-style-alist): Add elements for
	arglist-cont-nonempty into 5 styles (gnu, ellemtel, linux, python, awk).

2008-01-27  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* button.el (define-button-type): Clarify type of NAME in docstring.

2008-01-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* server.el (server-buffer): New const.
	(server-log): New var.
	(server-log): Use them.
	(server-process-filter): (Try to) run the continuation in the same cwd
	as the client's.

2008-01-26  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-defs.el (c-save-buffer-state):
	Bind buffer-file-name and buffer-file-truename to nil, to prevent
	primitives generating "buffer is read only" messages.

2008-01-20  Ulf Jasper  <ulf.jasper@web.de>

	* calendar/icalendar.el (icalendar-version): Increase to "0.17".
	(icalendar-import-format): Doc fix.  Allow function type.
	(icalendar--read-element): Doc fix.
	(icalendar--parse-summary-and-rest): Doc fix.  Handle function
	type icalendar-import-format.  Make regexps non-greedy.
	(icalendar--format-ical-event): Handle function type
	icalendar-import-format.
	(icalendar-import-format-sample): New function.

2008-01-26  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* vc.el (vc-exec-after): For mode-line-process highlighting, if
	`compile' is not available, fall back to font-lock-warning-face.

2008-01-26  Phil Sung  <psung@mit.edu>  (tiny change)

	* wdired.el (wdired-get-filename): Change `(1+ beg)' to `beg' so
	that the filename end is found even when the filename is empty.
	Fixes error and spurious newlines when marking files for deletion.

2008-01-26  Martin Rudalics  <rudalics@gmx.at>

	* subr.el (find-tag-default): Simplify using exclusively
	skip-syntax-backward/-forward.

2008-01-26  Michael Albinus  <michael.albinus@gmx.de>

	* vc.el (vc-directory, vc-update-change-log): Remove check for
	Tramp.  Both functions work for it, though pretty slow
	(`vc-directory').  Maybe the implementation can be optimized.

	* net/tramp.el (tramp-dissect-file-name): Raise an error when
	Tramp 2.0 syntax is used.
	Suggested by Trent W. Buck <trentbuck@gmail.com>.

2008-01-26  Eli Zaretskii  <eliz@gnu.org>

	* ls-lisp.el (ls-lisp-insert-directory): If -n switch is used,
	invoke directory-files-and-attributes with last argument `integer'
	instead of `string'.
	(insert-directory): Add -n to the list of supported switches
	mentioned in the doc string.

2008-01-26  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* blank-mode.el: New version 9.1.  Handle "long" line tail
	visualization.  Doc fix.
	(blank-line-length): Rename to blank-line-column.
	(blank-chars-value-list, blank-toggle-option-alist, blank-help-text):
	Initialization fix.
	(blank-replace-spaces-by-tabs): New fun.
	(blank-cleanup, blank-cleanup-region, blank-color-on): Code fix.

2008-01-25  Richard Stallman  <rms@gnu.org>

	* subr.el (add-hook): Implement `permanent-local-hook' property.

	* loadhist.el (file-provides, file-requires): Push the filename right.

2008-01-25  Martin Rudalics  <rudalics@gmx.at>

	* emacs-lisp/find-func.el (find-library): Wrap search for
	library name in condition-case to avoid reporting a scan-error.

2008-01-25  Juanma Barranquero  <lekktu@gmail.com>

	* server.el (server-process-filter): Don't force
	the authentication string to be followed by "\n".

2008-01-25  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* blank-mode.el: New version 9.0.  New commands to clean up some blank
	problems like trailing blanks.  New faces and regexp for visualizing
	the blank problems.  Doc fix.
	(blank-chars, blank-global-modes, blank-chars-value-list)
	(blank-toggle-option-alist, blank-help-text): Initialization fix.
	(blank-indentation, blank-empty, blank-space-after-tab): New faces.
	(blank-indentation, blank-empty, blank-space-after-tab)
	(blank-indentation-regexp, blank-empty-at-bob-regexp)
	(blank-empty-at-eob-regexp, blank-space-after-tab-regexp): New options.
	(blank-cleanup, blank-cleanup-region): New commands.
	(blank-color-on): Code fix.

2008-01-25  Dan Nicolaescu  <dann@ics.uci.edu>

	* ibuffer.el (ibuffer-default-sorting-mode): Add option to sort by
	file name.
	(ibuffer-mode-map): Add binding to sort by file name.
	(ibuffer-filename/process-header-map): New variable.
	(filename-and-process): Add a header that sorts by file name.
	(ibuffer-mode): Mention sorting by file name.

	* ibuf-ext.el (filename/process): New sorter.

2008-01-25  Sven Joachim  <svenjoac@gmx.de>

	* view.el (kill-buffer-if-not-modified): Don't pass t to
	buffer-modified-p.

2008-01-24  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-do-copy-or-rename-file): Flush the cache of
	the source file in case of `rename'.
	Reported by Pete Forman <pete.forman@westerngeco.com>.

2008-01-24  Ken Manheimer  <ken.manheimer@gmail.com>

	* allout.el (allout-keybindings-list): In initial setting, express
	meta-prefixed allout keys as vectors instead of strings, since the
	string form is interpreted in some cases as composed key
	modifiers, eg, accented keys.

	(allout-line-boundary-regexp): Clarify description.

	(set-allout-regexp): Repair the expressions so that the formfeed
	part is identified as one of the top-level groups, and is
	included in all the forms, not just the -line-boundary-regexp one.

	(allout-prefix-data): Incorporate information from the various
	allout regexp's formfeed alternative group, when present.

	(allout-write-file-hook-handler): Rectify mangling of the error
	handling.  It was broken in version 1.100, where an `error'
	condition-case handler was apparently reformatted as if it was a
	call to the error function.  An apparent repair attempt in version
	1.101 situated the original body of the error handling code as
	bogus condition-case handlers.  I've returned to just about the
	working code that was originally there, removing an unnecessary -
	but benign - enclosing 'progn'.  (Automated or cursory code fixes
	often aren't.)

	(allout-region-active-p): Fallback to value of mark-active if
	neither use-region-p nor region-active-p are present, for
	compatibility with current and recent Emacs major releases.

2008-01-24  Dan Nicolaescu  <dann@ics.uci.edu>

	* textmodes/reftex-toc.el (reftex-toc-next, reftex-toc-previous)
	(reftex-toc-restore-region):
	* textmodes/reftex-index.el (reftex-index-initialize-phrases-buffer)
	(reftex-index-phrases-apply-to-region):
	* textmodes/ispell.el (ispell-word):
	* progmodes/vhdl-mode.el (vhdl-keep-region-active):
	* progmodes/pascal.el (pascal-mark-defun):
	* progmodes/f90.el (f90-mark-subprogram, f90-indent-region)
	(f90-fill-region):
	* emulation/tpu-edt.el (tpu-set-mark):
	* emulation/crisp.el (crisp-region-active):
	* winner.el (winner-active-region):
	* ansi-color.el (ansi-color-set-extent-face): Use featurep instead
	of bound tests in order to resolve conditionals at compile time.

2008-01-24  Juanma Barranquero  <lekktu@gmail.com>

	* delsel.el (delsel-unload-function): Don't use `remprop'; it is
	not autoloaded, and we wouldn't want to load CL just to unload
	delsel.el anyway.  Suggested by Martin Rudalics <rudalics@gmx.at>.

2008-01-24  Martin Rudalics  <rudalics@gmx.at>

	* delsel.el (delete-selection-pre-hook): Avoid clearing out
	pre-command-hook when text is read-only.

2008-01-24  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* vc.el (vc-process-filter): Do nothing if buffer not live.
	(vc-diff-finish): Rename from vc-diff-sentinel.
	No longer take REV1-NAME and REV2-NAME.
	Instead, take BUFFER-NAME.  Do nothing if buffer not live.
	Don't do window resize if no window displays buffer.
	(vc-diff-internal): Use vc-diff-finish.

	* vc.el (vc-next-action): Fix two instances of "free-var file" bug:
	In both cases, convert single call to one wrapped in dolist.

2008-01-24  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el: Add a TODO item about missing files.
	(vc-exec-after): Add a tooltip to the new mode-line item.

2008-01-24  Glenn Morris  <rgm@gnu.org>

	* t-mouse.el (gpm-mouse-start): Declare as a function.

2008-01-23  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-remote-process-environment): Set "LC_ALL=C".
	(tramp-end-of-output): Add `tramp-rsh-end-of-line' into the regexp.
	(tramp-find-shell, tramp-open-connection-setup-interactive-shell):
	Don't send `tramp-rsh-end-of-line' additionally, when setting the
	prompt.
	(tramp-wait-for-output): Distinguish different prompt formats.
	(tramp-get-test-nt-command): Don't check for "\n" in the prompt.
	(tramp-local-host-p): Check whether temp directory is writable.

2008-01-23  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el: Add TODO items.

2008-01-23  Carsten Dominik  <dominik@science.uva.nl>

	* replace.el (occur-mode-find-occurrence-hook): New hook that can
	be used to reveal or highlight the location of a match.
	(occur-mode-goto-occurrence, occur-mode-goto-occurrence-other-window)
	(occur-mode-display-occurrence): Run `occur-mode-find-occurrence-hook'.

2008-01-23  Martin Rudalics  <rudalics@gmx.at>

	* progmodes/hideif.el (hide-ifdef-shadow): Add version number
	for defcustom.
	(hide-ifdef-shadow): Add version number for defface.

2008-01-23  Glenn Morris  <rgm@gnu.org>

	* textmodes/org.el (org-export-latex-cleaned-string): Fix declaration.

2008-01-23  Dan Nicolaescu  <dann@ics.uci.edu>

	* progmodes/sh-script.el (sh-basic-offset):
	* progmodes/cc-vars.el (c-syntactic-indentation)
	(c-syntactic-indentation-in-macros): Mark as safe.

2008-01-23  Richard Stallman  <rms@gnu.org>

	* icomplete.el (icomplete-get-keys):
	Look up KEYS using all maps in proper buffer.

2008-01-23  Juanma Barranquero  <lekktu@gmail.com>

	* frame.el (display-mm-height, display-mm-width):
	* whitespace.el (whitespace-check-leading-whitespace)
	(whitespace-check-trailing-whitespace)
	(whitespace-check-spacetab-whitespace)
	(whitespace-check-indent-whitespace)
	(whitespace-check-ateol-whitespace):
	* progmodes/ada-xref.el (ada-convert-file-name): Fix typo in docstring.

2008-01-23  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-arch.el (vc-arch-delete-rej-if-obsolete): Remove the
	after-save-hook so that it is not called multiple times.

	* vc-svn.el (vc-svn-resolve-when-done): Likewise.

2008-01-23  Eli Zaretskii  <eliz@gnu.org>

	* view.el (view-file-other-window, view-file-other-frame):
	Don't kill the buffer if it is modified.  Doc fixes.
	(kill-buffer-if-not-modified): New function.
	(view-file): Don't kill the buffer if it is modified.

	* progmodes/ebrowse.el (ebrowse-view-file-other-window): Delete.
	(ebrowse-view/find-file-and-search-pattern):
	Call view-file-other-window instead of ebrowse-view-file-other-window.
	(ebrowse-view-file-other-frame): Don't call
	current-window-configuration.  Fix second argument in the call to
	view-mode-enter.  Doc fix.

2008-01-23  Richard Stallman  <rms@gnu.org>

	* subr.el (atomic-change-group): Prevent undo list truncation.

2008-01-23  Dan Nicolaescu  <dann@ics.uci.edu>

	* files.el (safe-local-eval-forms):
	Mark (add-hook 'write-file-hooks 'time-stamp) as safe.

2008-01-23  Nick Roberts  <nickrob@snap.net.nz>

	* comint.el (comint-insert-input): Set point first.

	* progmodes/gdb-ui.el (gdb-dequeue-input): Make doubly sure
	session doesn't hang because gdb-pending-triggers is non-nil.
	(gdb-frame-handler): Use buffer-file-name instead of
	buffer-name in case of duplicate file names.

2008-01-23  Dan Nicolaescu  <dann@ics.uci.edu>

	* progmodes/verilog-mode.el (verilog-mode-map): Don't bind C-M-a,
	C-M-e and C-M-h for emacs, they work by default.
	(verilog-emacs-features): Remove.
	(verilog-setup-dual-comments, verilog-populate-syntax-table):
	Remove.  Move syntax table initialization ...
	(verilog-mode-syntax-table): ... here.
	(verilog-mode): Don't initialize the syntax table here.
	(verilog-mark-defun): Only do something useful for XEmacs, Emacs
	does not need it.

2008-01-23  Wilson Snyder  <wsnyder@wsnyder.org>

	* progmodes/verilog-mode.el (verilog-booleanp): New function for
	backward compatibility.  Replace all uses of booleanp with
	verilog-booleanp.

2008-01-23  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-hg.el (vc-hg-diff): Don't pass an empty string.

2008-01-23  Wilson Snyder  <wsnyder@wsnyder.org>

	* progmodes/verilog-mode.el (top-level): Fix spacing.
	(verilog-mode-version, verilog-mode-release-date):
	Update version number.
	(verilog-mode-release-emacs): New variable.
	(compile-command, reporter-prompt-for-summary-p):
	Define for byte compiler.
	(verilog-startup-message-lines, verilog-startup-message-displayed)
	(verilog-display-startup-message): Remove.
	(verilog-highlight-p1800-keywords): Improve docstring.
	(sigs-in, sigs-out, got-sig, got-rvalue, uses-delayed)
	(vector-skip-list): Only defvar at compile time.
	(verilog-highlight-translate-off, verilog-indent-level)
	(verilog-indent-level-module, verilog-indent-level-declaration)
	(verilog-indent-declaration-macros, verilog-indent-lists)
	(verilog-indent-level-behavioral, verilog-indent-level-directive)
	(verilog-cexp-indent, verilog-case-indent, verilog-auto-newline)
	(verilog-auto-indent-on-newline, verilog-tab-always-indent)
	(verilog-tab-to-comment, verilog-indent-begin-after-if)
	(verilog-align-ifelse, verilog-minimum-comment-distance)
	(verilog-auto-lineup, verilog-highlight-p1800-keywords)
	(verilog-auto-endcomments, verilog-auto-read-includes)
	(verilog-auto-star-expand, verilog-auto-star-save)
	(verilog-library-flags, verilog-library-directories)
	(verilog-library-files, verilog-library-extensions)
	(verilog-active-low-regexp, verilog-auto-sense-include-inputs)
	(verilog-auto-sense-defines-constant, verilog-auto-reset-widths)
	(verilog-assignment-delay, verilog-auto-inst-vector)
	(verilog-auto-inst-template-numbers, verilog-auto-input-ignore-regexp)
	(verilog-auto-inout-ignore-regexp, verilog-auto-output-ignore-regexp)
	(verilog-auto-unused-ignore-regexp, verilog-typedef-regexp):
	Add safe-local-variable properties.
	(verilog-statement-menu, verilog-company, verilog-re-search-forward)
	(verilog-re-search-backward, verilog-error-regexp-add)
	(verilog-end-block-re, verilog-emacs-features)
	(verilog-populate-syntax-table, verilog-setup-dual-comments)
	(verilog-type-font-keywords, verilog-inside-comment-p)
	(electric-verilog-backward-sexp, verilog-backward-sexp)
	(verilog-forward-sexp, verilog-font-lock-init, verilog-mode)
	(electric-verilog-terminate-line, electric-verilog-semi)
	(electric-verilog-tab, verilog-insert-1, verilog-insert-indices)
	(verilog-generate-numbers, verilog-comment-region, verilog-label-be)
	(verilog-beg-of-statement, verilog-in-case-region-p)
	(verilog-in-struct-region-p, verilog-in-generate-region-p)
	(verilog-in-fork-region-p, verilog-backward-case-item)
	(verilog-set-auto-endcomments, verilog-get-expr)
	(verilog-expand-vector-internal, verilog-surelint-off)
	(verilog-batch-execute-func, verilog-calculate-indent)
	(verilog-calc-1, verilog-calculate-indent-directive)
	(verilog-leap-to-head, verilog-continued-line)
	(verilog-backward-token, verilog-backward-syntactic-ws)
	(verilog-forward-syntactic-ws, verilog-backward-ws&directives)
	(verilog-forward-ws&directives, verilog-at-constraint-p)
	(verilog-skip-backward-comments, verilog-indent-line-relative)
	(verilog-do-indent, verilog-indent-comment, verilog-more-comment)
	(verilog-pretty-declarations, verilog-pretty-expr)
	(verilog-just-one-space, verilog-indent-declaration)
	(verilog-get-completion-decl, verilog-goto-defun, verilog-showscopes)
	(verilog-header, verilog-signals-combine-bus, verilog-read-decls)
	(verilog-read-always-signals-recurse, verilog-read-instants)
	(verilog-read-auto-template, verilog-set-define)
	(verilog-read-defines, verilog-read-signals, verilog-getopt)
	(verilog-is-number, verilog-expand-dirnames, verilog-modi-lookup)
	(verilog-modi-cache-results, verilog-insert-one-definition)
	(verilog-make-width-expression, verilog-delete-autos-lined)
	(verilog-auto-save-check, verilog-auto-arg, verilog-auto-inst-port)
	(verilog-auto-inst, verilog-auto-inst-param, verilog-auto-reg)
	(verilog-auto-reg-input, verilog-auto-wire, verilog-auto-output)
	(verilog-auto-output-every, verilog-auto-input, verilog-auto-inout)
	(verilog-auto-inout-module, verilog-auto-sense, verilog-auto-reset)
	(verilog-auto-tieoff, verilog-auto-unused, verilog-auto-ascii-enum)
	(verilog-auto, verilog-sk-define-signal, verilog-mode-mouse-map)
	(verilog-load-file-at-mouse, verilog-load-file-at-point)
	(verilog-library-files): Cleanup spacing of )'s they should not be
	on unique lines.  Fix checkdoc warnings.

2008-01-22  Glenn Morris  <rgm@gnu.org>

	* progmodes/hideif.el (hide-ifdef-initially, hide-ifdef-read-only)
	(hide-ifdef-lines, hide-ifdef-shadow): Remove autoload cookies
	from defcustoms.
	(hide-ifdef-shadow): Remove autoload cookie from defface.

	* vc.el (vc-diff-sentinel): Do not write a footer if there were
	differences.

2008-01-21  Reiner Steib  <Reiner.Steib@gmx.de>

	* pcvs-defs.el (cvs-menu): Improve cvs-mode-find-file,
	cvs-mode-find-file-other-window.  Add cvs-mode-diff-yesterday and
	manual entry.

2008-01-21  Michael Albinus  <michael.albinus@gmx.de>

	* net/dbus.el (dbus-ignore-errors): New macro.
	(dbus-unregister-object): New defun.  Moved from dbusbind.c.
	(dbus-handle-event, dbus-list-activatable-names, dbus-list-names)
	(dbus-list-queued-owners, dbus-get-name-owner, dbus-introspect)
	(dbus-get-signatures): Apply `dbus-ignore-errors'.

2008-01-21  Martin Rudalics  <rudalics@gmx.at>

	* outline.el (outline-up-heading): Fix check for top level to
	avoid infinite looping in hide-other.

2008-01-21  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* vc.el (vc-process-sentinel): After calling the previous
	sentinel, do nothing if the process' buffer is not live.

2008-01-21  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* blank-mode.el: Fix a problem of cleaning blank faces when turning off
	blank-mode in some buffers (like *info* buffers).  Reported by Juanma
	Barranquero <lekktu@gmail.com>.  Eliminate `-face' suffix of all
	blank-mode faces.  Doc fix.  New version 8.1.
	(blank-turn-on, blank-turn-off): Replace (and CONDITION BODY) by (when
	CONDITION BODY).
	(blank-space-face): Face/option name replaced by blank-space.
	(blank-hspace-face): Face/option name replaced by blank-hspace.
	(blank-tab-face): Face/option name replaced by blank-tab.
	(blank-newline-face): Face/option name replaced by blank-newline.
	(blank-trailing-face): Face/option name replaced by blank-trailing.
	(blank-line-face): Face/option name replaced by blank-line.
	(blank-space-before-tab-face): Face/option name replaced by
	blank-space-before-tab.
	(blank-color-on, blank-color-off, blank-display-char-on): Fix code.

2008-01-21  Juanma Barranquero  <lekktu@gmail.com>

	* blank-mode.el (blank-style, blank-chars, blank-hspace-regexp)
	(blank-space-regexp, blank-tab-regexp, blank-trailing-regexp)
	(blank-space-before-tab-regexp, blank-global-modes, blank-mode)
	(global-blank-mode): Doc fixes.
	(blank, blank-space-face, blank-hspace-face, blank-tab-face)
	(blank-newline-face, blank-trailing-face, blank-line-face)
	(blank-space-before-tab-face, blank-display-mappings)
	(blank-chars-value-list, blank-style-value-list, blank-toggle-options)
	(global-blank-toggle-options, blank-help-text, blank-interactive-char)
	(blank-turn-on, blank-turn-off, blank-color-on, blank-color-off):
	Fix typos in docstrings.

2008-01-21  Juanma Barranquero  <lekktu@gmail.com>

	* server.el (server-log-time-function): New variable.
	(server-log): Use it.

2008-01-21  Glenn Morris  <rgm@gnu.org>

	* progmodes/hideif.el: Move defcustoms and defface to start of file.

	* textmodes/org.el (org-entry-properties): Let-bind `clocksum'.

2008-01-21  Juanma Barranquero  <lekktu@gmail.com>

	* textmodes/org.el (org-unmodified, org-cycle-emulate-tab)
	(org-descriptive-links, org-link-file-path-type)
	(org-remember-use-refile-when-interactive)
	(org-agenda-skip-timestamp-if-done, org-agenda-scheduled-leaders)
	(org-export-ascii-bullets, org-agenda-deadline-faces)
	(turn-on-orgstruct++, orgtbl-to-texinfo, org-mhe-get-header)
	(org-batch-agenda, org-batch-agenda-csv, org-fix-agenda-info)
	(org-kill-note-or-show-branches): Fix typos in docstrings.

2008-01-20  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* vc.el (vc-process-sentinel): Set mode-line-process.
	(vc-exec-after): Likewise, for the `run' process status.

2008-01-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* ibuffer.el (ibuffer-mode): Fix last change.

2008-01-20  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-hg.el (vc-hg-registered):
	* vc-svn.el (vc-svn-registered): Make it work for non-existent files.

2008-01-20  Martin Rudalics  <rudalics@gmx.at>

	* repeat.el (repeat-undo-count): New variable.
	(repeat): For self-insertions make undo boundary only after 20
	repetitions.  Inhibit point recording unless repeat-repeat-char is nil.

2008-01-19  Reiner Steib  <Reiner.Steib@gmx.de>

	* net/imap.el (imap-ping-server): New variable.
	(imap-opened): On add extra ping if imap-ping-server is non-nil.
	(imap-ping-server): Minor doc string fixes.

2008-01-19  Knut Anders Hatlen  <kahatlen@gmail.com>  (tiny change)

	* net/imap.el (imap-ping-server): New function.
	(imap-opened): Call imap-ping-server.

2008-01-20  Glenn Morris  <rgm@gnu.org>

	* progmodes/python.el: Quote all calls to "auxiliary skeleton"s to
	prevent infloops.

2008-01-20  Martin Svenson  <phromo@gmail.com>  (tiny change)

	* progmodes/python.el (python-imports): Default to "None".

2008-01-19  Tom Tromey  <tromey@redhat.com>

	* vc-svn.el (vc-svn-after-dir-status): New function.
	(vc-svn-dir-status): Run svn asynchronously.

2008-01-19  Martin Rudalics  <rudalics@gmx.at>

	* progmodes/hideif.el (hide-ifdef-shadow): New option.
	(hide-ifdef-shadow): New face.
	(hide-ifdef-toggle-shadowing): New function to toggle between
	shadowing and making code invisible.
	(hide-ifdef-mode-submap): Add binding for hide-ifdef-toggle-shadowing.
	(hide-ifdef-mode-menu): Add entry for hide-ifdef-toggle-shadowing.
	(hide-ifdef-region-internal): Give new overlay hide-ifdef
	property.  Shadow text when hide-ifdef-shadow is non-nil.
	(hif-show-ifdef-region): Remove overlays with hide-ifdef property set.
	(hif-hide-line): Use when instead of if.
	(hide-ifdef-initially, hide-ifdef-read-only, hide-ifdef-lines):
	Remove unneeded * from doc-strings.

2008-01-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* doc-view.el (doc-view-goto-page): Don't move point any more, now that
	the hscroll behavior was fixed.
	(doc-view-mode): Disable auto-hscroll-mode.

2008-01-18  Tom Tromey  <tromey@redhat.com>

	* vc-svn.el (vc-svn-dir-status): New function.

2008-01-18  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el: Make vc-status asynchronous.
	(vc-update-vc-status-buffer): New function broken out of ...
	(vc-status-refresh): ... here.  Pass vc-update-vc-status-buffer to
	the dir-status backend function.

	* vc-hg.el (vc-hg-dir-status): Compute the status asynchronously.
	Move the output processing to ...
	(vc-hg-after-dir-status): ... here.  Call the function passed as
	an argument with the results.

2008-01-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* doc-view.el (doc-view-pdf/ps->png): Make sure we a have a valid cwd.
	(doc-view-insert-image): Do something if the image is missing.
	(doc-view-mode): Don't use file-remote-p.

2008-01-18  Bastien Guerry  <Bastien.Guerry@ens.fr>

	* textmodes/org-export-latex.el (org-export-latex-cleaned-string): Fix.
	(org-export-latex-special-chars): Convert "..." in \ldots
	and skip tables.
	(org-export-latex-fontify-headline): Change parameter name.
	(org-export-as-latex): Handle export of subtrees.
	(org-export-latex-make-header): New argument TITLE.
	(org-export-latex-content): New argument EXCLUDE-LIST.
	(org-list-parse-list): New name for org-export-latex-parse-list.
	(org-export-latex-make-header): New name for
	org-export-latex-make-preamble.
	(org-list-to-generic): New name of org-export-list-to-generic.
	(org-list-to-latex): New name of org-export-list-to-latex.
	(org-list-item-begin, org-list-end, org-list-insert-radio-list)
	(org-list-send-list, org-list-to-texinfo)
	(org-list-to-html): New functions.
	(org-export-latex-tables-column-borders)
	(org-export-latex-default-class, org-export-latex-classes)
	(org-export-latex-classes-sectioning)
	(org-list-radio-list-templates): New options.
	(org-export-latex-header): New variable.
	(org-latex-entities): New constant.
	(org-export-latex-default-sectioning, org-export-latex-preamble)
	(org-export-latex-prepare-text-option)
	(org-export-latex-get-sectioning): Remove.

2008-01-18  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org-publish.el (org-publish-current-project):
	Fix bug with forcing publication.

	* textmodes/org.el (org-export-with-special-strings): New option.
	(org-export-html-convert-special-strings): New function.
	(org-html-do-expand): `org-export-html-convert-special-strings'
	added to the list of conversion.
	(org-infile-export-plist, org-get-current-options): Add support
	for "-" in the #+OPTION line to let user switch on/off special
	strings conversion.
	(org-export-plist-vars): New :html-table-tag property.
	(org-export-as-html, org-format-org-table-html)
	(org-format-table-table-html) Use the :html-table-tag property
	instead of the `org-export-html-table-tag' global value.
	(org-additional-option-like-keywords): Add "TBLFM".
	(org-entry-properties): Include the CLOCKSUM special property.
	(org-columns-edit-value): Do not allow to edit the special
	CLOCKSUM property.
	(org-flag-drawer): Use the original value of `outline-regexp'.
	(org-remember-handler): Add invisible-ok flag to call to
	`org-end-of-subtree'.
	(org-agenda-highlight-todo): Respect
	`org-agenda-todo-keyword-format'.
	(org-agenda-todo-keyword-format): New option.
	(org-infile-export-plist): No restriction while searching for options.
	(org-remember-handler): Remove comments at the end of the buffer.
	(org-remember-use-refile-when-interactive): New option.
	(org-table-sort-lines): Make sure sorting works on link
	descriptions only, and ignores the link.
	(org-sort-entries-or-items): Make sure the end of the subtree is
	included.
	(org-refile-use-outline-path): New allowed values `file' and
	`full-file-path'.
	(org-get-refile-targets): Respect new values for
	`org-refile-use-outline-path'.
	(org-agenda-get-restriction-and-command): DEL goes back to initial list.
	(org-export-as-xoxo): Restore point when done.
	(org-open-file): Allow multiple %s in command.
	(org-clock-in-switch-to-state): New option.
	(org-first-list-item-p): New function.
	(org-last-remember-storage-locations): New variable.
	(org-get-refile-targets): Interpret the new maxlevel setting.
	(org-refile-targets): New option `:maxlevel'.
	(org-copy-subtree): Include empty lines before but not after subtree.
	(org-back-over-empty-lines, org-skip-whitespace): New functions.
	(org-move-item-down, org-move-item-up): Include empty lines before
	but not after item.
	(org-first-sibling-p): New function.
	(org-remember-apply-template): Defaults, completions and history
	for template prompts.  Also, interpret new `%!' escape.
	(org-context-choices): New constant.
	(org-bound-and-true-p): New macro.
	(org-imenu-depth): New option.
	(org-imenu-markers): New variable.
	(org-imenu-new-marker, org-imenu-get-tree)
	(org-speedbar-set-agenda-restriction): New functions.
	(org-agenda-set-restriction-lock)
	(org-agenda-remove-restriction-lock)
	(org-agenda-maybe-redo): New functions.
	(org-agenda-restriction-lock): New face.
	(org-agenda-restriction-lock-overlay)
	(org-speedbar-restriction-lock-overlay): New variables.
	(org-open-at-point): Remove obsolete way to do redirection in
	shell links.
	(org-imenu-and-speedbar): New customization group.
	(org-entry-properties): Return keyword-less time strings.
	(org-clock-heading-function): New option.
	(org-clock-in): Use `org-clock-heading-function'.
	(org-calendar-holiday): Try to use `calendar-check-holidays'
	instead of the obsolete `check-calendar-holidays'.
	(org-export-html-special-string-regexps): New constant.
	(org-massive-special-regexp): New variable.
	(org-compute-latex-and-specials-regexp)
	(org-do-latex-and-special-faces): New functions.
	(org-latex-and-export-specials): New face.
	(org-highlight-latex-fragments-and-specials): New option.
	(org-link-escape-chars): Use characters instead of strings.
	(org-link-escape-chars-browser, org-link-escape)
	(org-link-unescape): Use characters instead of strings.
	(org-export-html-convert-sub-super, org-html-do-expand): Check for
	protected text.
	(org-emphasis-alist): Additional `verbatim' flag.
	(org-set-emph-re): Handle the verbatim flag and compute
	`org-verbatim-re'.
	(org-cleaned-string-for-export): Protect verbatim elements.
	(org-verbatim-re): New variable.
	(org-hide-emphasis-markers): New option.
	(org-additional-option-like-keywords): Add new keywords.
	(org-get-entry): Rename from `org-get-cleaned-entry'.
	(org-icalendar-cleanup-string): New function for quoting icalendar text.
	(org-agenda-skip-scheduled-if-done): New option.
	(org-agenda-get-scheduled, org-agenda-get-blocks): Use
	`org-agenda-skip-scheduled-if-done'.
	(org-prepare-agenda-buffers): Allow buffers as arguments.
	(org-entry-properties): Add CATEGORY as a special property.
	(org-use-property-inheritance): Allow a list of properties as a value.
	(org-eval-in-calendar): No longer update the prompt.
	(org-read-date-popup-calendar): Rename from
	`org-popup-calendar-for-date-prompt'.
	(org-read-date-display-live): New variable.
	(org-read-date-display): New function.
	(org-read-date-analyze): New function.
	(org-remember-apply-template): Define `remember-finalize' if it is
	not yet defined.
	(org-remember-insinuate): New function.
	(org-read-date-prefer-future): New option.
	(org-read-date): Respect the setting of
	`org-read-date-prefer-future'.  Use `org-read-date-analyze'.
	(org-set-font-lock-defaults): Use `org-archive-tag' instead of a
	hardcoded string.
	(org-remember-apply-template): Use `remember-finalize' instead of
	`remember-buffer'.
	(org-columns-compute, org-column-number-to-string)
	(org-columns-uncompile-format, org-columns-compile-format)
	(org-columns-compile-format): Handle printf format specifier.
	(org-columns-new, org-column-number-to-string)
	(org-columns-uncompile-format, org-columns-compile-format):
	Support for new currency summary type.
	(org-tree-to-indirect-buffer): Do not kill old buffer when
	`org-indirect-buffer-display' is `new-frame'.
	(org-indirect-buffer-display): Document that `new-frame' leads to
	indirect buffer proliferation.
	(org-agenda-list): Use `org-extend-today-until'.
	(org-extend-today-until): New option.
	(org-format-org-table-html): Use lower-case for <col> tag.
	(org-agenda-execute): New command.
	(org-agenda-mode-map): Keybindings of "g" "G", "e" modified.
	(org-select-remember-template): New function.
	(org-remember-apply-template): Use `org-select-remember-template'.
	(org-go-to-remember-target): New function.

2008-01-18  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el: Add a TODO note about vc-state.
	(vc-next-action): Register 'unregistered and 'ignored files.
	Use when and unless instead of if where appropriate.
	(vc-start-entry): Fix typo.
	(vc-status): Autoload it.

2008-01-18  Glenn Morris  <rgm@gnu.org>

	* ffap.el (ffap-alist): Remove space from RFC regexp.

2008-01-18  Richard Stallman  <rms@gnu.org>

	* custom.el (custom-theme-recalc-face): Use face-spec-set rather
	than face-spec-recalc.

2008-01-18  Glenn Morris  <rgm@gnu.org>

	* ibuffer.el (ibuffer-mode): Fix typo in previous change.

2008-01-17  Vinicius Jose Latorre  <viniciusjl@ig.com.br>
            Miles Bader  <miles@gnu.org>

	* blank-mode.el: New file.  Minor mode to visualize (HARD) SPACE,
	TAB, NEWLINE.  Miles Bader <miles@gnu.org> wrote the original code
	for handling display table (via visws.el package), his code was
	modified, but the main idea was kept.

2008-01-17  Glenn Morris  <rgm@gnu.org>

	* ibuf-ext.el (ibuffer-auto-mode, ibuffer-save-filter-groups)
	(ibuffer-save-filters): Remove calls to deleted
	ibuffer-update-mode-name.

2008-01-16  Martin Rudalics  <rudalics@gmx.at>

	* longlines.el (longlines-mode, longlines-show-region)
	(longlines-unshow-hard-newlines): Bind buffer-file-name and
	buffer-file-truename to nil while modifying buffer.

	* cus-edit.el (custom-reset-standard-variables-list)
	(custom-reset-standard-faces-list): New variables.
	(custom-reset-standard-save-and-update): New function.
	(Custom-save): Apply custom-mark-to-save before and
	custom-state-set-and-redraw after saving options.
	(Custom-reset-standard): Apply custom-mark-to-reset-standard to
	options and call custom-reset-standard-save-and-update.
	(custom-variable, custom-face, custom-group): Provide new
	entries for custom-mark-to-save, custom-mark-to-reset-standard,
	and custom-state-set-and-redraw.
	(custom-variable-mark-to-save)
	(custom-variable-state-set-and-redraw)
	(custom-variable-mark-to-reset-standard)
	(custom-face-mark-to-save, custom-face-state-set-and-redraw)
	(custom-face-mark-to-reset-standard)
	(custom-group-mark-to-save, custom-group-state-set-and-redraw)
	(custom-group-mark-to-reset-standard): New functions.
	(custom-variable-save): Move save, state-set, and redraw
	functionality to custom-variable-mark-to-save.
	(custom-face-save): Move save, state-set, and redraw
	functionality to custom-face-mark-to-save.
	(custom-group-save): Move save, state-set, and redraw
	functionality to custom-group-mark-to-save.
	(custom-variable-reset-standard, custom-face-reset-standard)
	(custom-group-reset-standard): Move save, state-set, and redraw
	functionality to custom-reset-standard-save-and-update.

	(custom-buffer-create-internal): Fix text in verbose help.
	(custom-face-value-create): Indent doc-strings of faces like
	those of variables.

2008-01-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* server.el (server-process-filter): Replace lineno and columnno
	which defaulted to 1&0 with filepos which defaults to nil.
	(server-goto-line-column): Only receive the filepos.
	Only move if filepos is non-nil.
	(server-visit-files): Slight restructure to consolidate two calls to
	server-goto-line-column into just one.

	* nxml/nxml-mode.el (nxml-mode): Use mode-line-process to indicate
	the use of degraded mode.
	(nxml-degrade): Don't change mode-name.

	* nxml/rng-nxml.el (rng-nxml-mode-init):
	Don't overwrite mode-line-process.

	* ibuffer.el (mode): Pass the buffer to format-mode-line.
	(ibuffer-update-mode-name): Remove.
	(ibuffer-redisplay, ibuffer-update, ibuffer-mode): Don't call it.
	(ibuffer-mode): Use mode-line-process instead.

	* ibuf-ext.el (ibuffer-auto-update-changed, ibuffer-auto-mode):
	Use derived-mode-p.
	(ibuffer-mark-by-mode-regexp): Pass the buffer to format-mode-line.

	* help.el (describe-mode): Pass the right buffer to format-mode-line.

2008-01-16  Glenn Morris  <rgm@gnu.org>

	* comint.el (comint-regexp-arg): Fix no-input case.

2008-01-16  Dan Nicolaescu  <dann@ics.uci.edu>

	* smerge-mode.el (smerge-start-session): Rename from smerge-auto.
	* pcvs.el (cvs-revert-if-needed):
	* vc.el (vc-maybe-resolve-conflicts): Rename callers.

	* vc-svn.el (vc-svn-find-file-hook):
	* vc-arch.el (vc-arch-find-file-hook): Undo previous change.

2008-01-16  Ulf Jasper  <ulf.jasper@web.de>

	* calendar/icalendar.el (icalendar-version): Increase to 0.16.
	(icalendar-export-file, icalendar-import-file):
	Restore significant trailing whitespace in `interactive' prompts.

2008-01-16  Tom Tromey  <tromey@redhat.com>

	* calendar/icalendar.el (icalendar--convert-tz-offset)
	(icalendar--parse-vtimezone, icalendar--convert-all-timezones)
	(icalendar--find-time-zone): New functions.
	(icalendar--decode-isodatetime): Add `zone' argument, passed to
	`decode-time'.  Doc fix.
	(icalendar--convert-ical-to-diary): Compute zone-map.
	Pass timezone to icalendar--decode-isodatetime.

2008-01-16  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-vars.el (c-constant-symbol): Put this defun inside
	an eval-and-compile, so as to permit byte-compiling (e.g. in
	bootstrap).

2008-01-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/easymenu.el (easy-menu-avoid-duplicate-keys): New var.
	(easy-menu-create-menu, easy-menu-convert-item-1): Use it to avoid
	using the same key for different menu entries.

	* smerge-mode.el (smerge-refine): Also work on "same change conflicts".
	(smerge-makeup-conflict): New command.

2008-01-15  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* log-edit.el (log-edit): Doc fix.

2008-01-15  Glenn Morris  <rgm@gnu.org>

	* diff-mode.el (diff-end-of-hunk): Revert 2008-01-08 change.

2008-01-14  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-vars.el (c-constant-symbol): New function which
	supersedes c-const-symbol.  During a customize-.. call it enables
	an element of (e.g.) c-hanging-braces alist to have its name
	displayed, even when the default value of c-h-b etc. doesn't
	include the element.  Replace uses of the old function by the new.

	* progmodes/cc-vars.el (c-hanging-braces-alist): Remove the
	obscure non-working fragment ":value c-".

2008-01-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* abbrev.el (clear-abbrev-table): Can't pass a symbol to intern.

2008-01-14  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-local-host-p): Use `tramp-file-name-host'
	instead of `tramp-file-name-real-host'.

	* net/trampver.el: Update release number.

2008-01-14  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-engine.el (c-guess-basic-syntax): Prevent a macro
	call inside a struct being recognized as a K&R argument.

2008-01-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/compile.el (compilation-error-regexp-alist-alist):
	Accept "fatal error" from MSFT.
	Reported by Jared Finder <jfinder@crypticstudios.com>.

2008-01-14  Dan Nicolaescu  <dann@ics.uci.edu>

	* smerge-mode.el (smerge-auto): New function.
	* vc-svn.el (vc-svn-find-file-hook):
	* vc-arch.el (vc-arch-find-file-hook):
	* pcvs.el (cvs-revert-if-needed):
	* vc.el (vc-maybe-resolve-conflicts): Use it instead of vc-mode.
	(top-level): Add a Todo list.

2008-01-13  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el (vc-update): Resolve conflicts if necessary instead of
	just updating the buffer.

	* vc-cvs.el (vc-cvs-merge-news): Ignore the error status of the
	update command so that we can parse the output.

2008-01-13  Martin Rudalics  <rudalics@gmx.at>

	* mail/rmail.el (rmail-convert-to-babyl-format):
	Remove save-excursion to avoid infinite looping.
	Reported by dnz <dnz@bk.ru>.

2008-01-12  Glenn Morris  <rgm@gnu.org>

	* woman.el (woman-parse-numeric-arg): Change handling of `==':
	can be interned without a function definition.

2008-01-12  Jason Rumney  <jasonr@gnu.org>

	* nxml/nxml-mode.el (nxml-enable-unicode-char-name-sets)
	(rng-nxml-mode-init): Declare.

2008-01-11  Jason Rumney  <jasonr@gnu.org>

	* nxml/rng-nxml.el (rng-preferred-prefix-alist): Add some defaults.
	(rng-preferred-prefix-alist-default): Remove.

	* nxml/nxml-uchnm.el (nxml-internal-unicode-char-name-sets-enabled):
	Rename from nxml-enable-unicode-char-name-sets-flag.
	(nxml-enable-unicode-char-name-sets-1): Merge into
	nxml-enable-unicode-char-name-sets.
	(nxml-enable-unicode-char-name-sets): Don't unconditionally set
	nxml-char-name-ignore-case here.

	* nxml/nxml-mode.el (nxml-mode): Call rng-nxml-mode-init directly.
	Update doc string and commentary.
	(nxml-char-name-ignore-case): Change default value.
	(nxml-mode): Call nxml-enable-unicode-char-name-sets directly.

2008-01-11  Martin Rudalics  <rudalics@gmx.at>

	* cus-start.el (all): Add missing version entries.

2008-01-11  Glenn Morris  <rgm@gnu.org>

	* language/china-util.el (big5-to-flat-code, flat-code-to-big5)
	(euc-to-flat-code, flat-code-to-euc):
	* textmodes/org.el (elmo-msgdb-overview-get-entity)
	(wl-summary-buffer-msgdb): Declare as functions.

2008-01-10  Martin Rudalics  <rudalics@gmx.at>

	* progmodes/ada-mode.el (ada-set-syntax-table-properties):
	Bind buffer-file-name and buffer-file-truename.

	* fringe.el (fringe-mode-explicit): New variable.
	(set-fringe-mode): Don't alter default-frame-alist when just
	loading this file.

2008-01-10  Tassilo Horn  <tassilo@member.fsf.org>

	* doc-view.el (doc-view-buffer-file-name): New variable.
	(doc-view-convert-current-doc, doc-view-search)
	(doc-view-current-cache-dir, doc-view-initiate-display)
	(doc-view-mode): Use it.
	(doc-view-bookmark-make-cell): Use variable buffer-file-name
	instead of function.

2008-01-10  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-svn.el (vc-svn-registered): Return the correct value for
	ignored and unregistered files.

2008-01-10  Tassilo Horn  <tassilo@member.fsf.org>

	* doc-view.el (tramp): Require tramp because we use tramp-tramp-file-p.

2008-01-10  Tom Tromey  <tromey@redhat.com>

	* vc.el (vc-status-unmark-all-files): New function.
	(vc-status-unmark-all-files): Likewise.
	(vc-status-mode-map): Add bindings.

2008-01-10  Michael Kifer  <kifer@cs.stonybrook.edu>

	* ediff*.el: Uncomment declare-function.

	* emulation/viper*.el: Uncomment declare-function.

2008-01-09  Tassilo Horn  <tassilo@member.fsf.org>

	* doc-view.el (doc-view-mode): Support tramp, compressed files and
	files inside archives uniformly.

2008-01-09  Eric S. Raymond  <esr@snark.thyrsus.com>

	* textmodes/sgml-mode.el (sgml-tag-syntax-table): Initialize this
	constant with a computation on sgml-specials rather than a literal
	list.  Without this change the syntax table is generated
	incorrectly, and the mode will think it's in a comment following
	any instance of the string "--".

2008-01-09  Tassilo Horn  <tassilo@member.fsf.org>

	* doc-view.el (doc-view-mode-p): Add EPS as supported type.
	(doc-view-mode): Support document files inside archives.

2008-01-09  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el (vc-deduce-fileset): Return the currently selected file if
	no files are selected when using vc-status.

2008-01-09  Michael Kifer  <kifer@cs.stonybrook.edu>

	* ediff*.el: Comment out declare-function.  "make bootstrap"
	stops with an error and Emacs does not compile with those things in.
	Besides, declare-function is not defined in XEmacs.

	* ediff-util.el (ediff-quit): Autoraise minibuffer.

	* ediff-diff.el (ediff-convert-fine-diffs-to-overlays): Make it a defun.

	* emulation/viper*.el: Comment out declare-function -- not defined
	in XEmacs.

	* emulation/viper-ex.el (viper-info-on-file):
	Take care of indirect buffers.

	* emulation/viper.el (viper-set-hooks, set-cursor-color):
	Set viper-vi-state-cursor-color.

2008-01-09  Tom Tromey  <tromey@redhat.com>

	* vc.el (vc-status-headers): Rename from vc-status-insert-headers.
	Just return header.
	(vc-status-move-to-goal-column): New function.
	(vc-status-mode-map): Define more keys.
	(vc-status-mode): Use vc-status-refresh.  Now 'special.
	(vc-status-refresh): New function.
	(vc-status-next-line): Likewise.
	(vc-status-previous-line): Likewise.
	(vc-status-mark-file): Use vc-status-next-line.
	(vc-status-unmark-file): Use vc-status-previous-line.
	(vc-status-unmark-file-up): New function.
	(vc-status-register): Likewise.
	(vc-status-find-file): Likewise.
	(vc-status-find-file-other-window): Likewise.
	(vc-status-current-file): Likewise.
	(vc-ensure-vc-buffer): Understand vc-status mode.

	* vc-hg.el (vc-hg-dir-status): Don't pass -A to "hg status".

2008-01-09  Glenn Morris  <rgm@gnu.org>

	* ffap.el (ffap-string-at-point-mode-alist): Add `\' to file
	entry, for Windows.

2008-01-09  Tom Tromey  <tromey@redhat.com>

	* play/blackbox.el (blackbox-mode-map): Add `q' and [return] bindings.

2008-01-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* ffap.el (ffap-read-file-or-url): Don't use let-binding to temporarily
	add a file-name handler.

2008-01-08  Roland Winkler  <Roland.Winkler@physik.uni-erlangen.de>

	* textmodes/bibtex.el (bibtex-initialize): New autoloaded command.
	Rename from function bibtex-files-expand.  New optional arg select.
	(bibtex-flash-head): Allow blink-matching-delay being zero.
	(bibtex-clean-entry): Use atomic-change-group.
	(bibtex-format-entry): Check presence of required fields only
	after formatting of fields.  Use member-ignore-case.  Do not use
	bibtex-parse-entry.  Do not use booktitle field to set a missing title.
	(bibtex-autofill-entry): Do not call undo-boundary.
	(bibtex-lessp): Handle crossref keys that point to another bibtex file.
	(bibtex-sort-buffer, bibtex-prepare-new-entry, bibtex-validate):
	Parse keys if necessary.

2008-01-08  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-var-list-children-1): Put varnum in
	quotes in case of spaces, e.g. STL containers (not pretty).

2008-01-08  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gud-gdb-command-name):
	Explain "--annotate=3" option is necessary for the Graphical Interface.

2008-01-08  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/hideif.el (hide-ifdef-mode-menu): Put hide-ifdef commands
	on menu bar.

2008-01-08  Michael Albinus  <michael.albinus@gmx.de>

	* ffap.el (ffap-read-file-or-url): Let-bind
	`file-name-handler-alist' due to `rfn-eshadow-update-overlay'.

2008-01-08  Sven Joachim  <svenjoac@gmx.de>

	* vc-bzr.el: Fix typo in header.

2008-01-08  Eli Zaretskii  <eliz@gnu.org>

	* Makefile.in (custom-deps, finder-data): Depend on autoloads
	instead of loaddefs.el.

2008-01-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-cvs.el (vc-cvs-annotate-time): Don't move backward when text
	gets inserted out-of-order.

2008-01-08  Riccardo Murri  <riccardo.murri@gmail.com>

	* vc-bzr.el: Copyright and version headers update.
	Remove some outdated comments through the whole file.
	(vc-bzr-program-args): Remove because unused.
	(vc-bzr-log-switches): New customization option.
	(vc-bzr-command): Use LC_MESSAGES=C instead of LC_ALL=C.  No longer
	use `vc-bzr-program-args'.
	(vc-bzr-register): Fix for working with both 22.1 and CVS version of
	`vc-find-root' (patch by Andreas Hoenen).
	(vc-bzr-status): Update regex to match latest Bzr output.
	Remove redundant test.
	(vc-bzr-init-version): New function.
	(vc-bzr-unregister): Must not delete file.
	(vc-bzr-find-version): New function.
	(vc-bzr-checkout): Argument `rev' is explicit revision only if it's
	a non-empty string, otherwise take head revision.
	(vc-bzr-print-log): Pass `vc-bzr-log-switches' to "bzr log".
	(vc-bzr-diff): Simpler build of the revision spec string.
	(vc-annotate-convert-time, vc-bzr-annotate-difference):
	Remove: compatibility hacks for Emacs21, not needed in Emacs 22.
	(vc-bzr-dir-state): Add code comments.  Removed redundant statement.
	(vc-bzr-dired-state-info): Only provide custom strings for
	overloaded VC state 'edited; otherwise fallback to
	`vc-default-dired-state-info'.

2008-01-08  Richard Stallman  <rms@gnu.org>

	* delsel.el (delete-selection-mode): Doc fix.

2008-01-08  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gud.el (gud-def): Do nothing if gud-running is t.
	(gud-speedbar-menu-items): Add item for gdb-var-set-format below.

	* progmodes/gdb-ui.el (gdb-var-set-format): Set the output format
	of watch expressions (only works fully with GDB 6.7 or later).

2008-01-08  Dan Nicolaescu  <dann@ics.uci.edu>

	* time-stamp.el (time-stamp-time-zone):
	* whitespace.el (whitespace-check-buffer-leading)
	(whitespace-check-buffer-trailing, whitespace-check-buffer-indent)
	(whitespace-check-buffer-spacetab, whitespace-check-buffer-ateol):
	* progmodes/sh-script.el (sh-indentation):
	* textmodes/ispell.el (ispell-local-pdict):
	Add safe-local-variable properties.

2008-01-08  Michael Albinus  <michael.albinus@gmx.de>

	* vc-git.el (vc-git--call): Apply `process-file' instead of
	`call-process'.

	* net/tramp.el (tramp-remote-process-environment): Add "LC_CTYPE=C".
	Reported by Pete Forman <pete.forman@westerngeco.com>.
	(tramp-perl-encode, tramp-perl-decode): Update copyrights.
	(tramp-handle-process-file): Handle the case where DESTINATION is
	a consp with t as car.
	(tramp-wait-for-output): We shall remove exactly what has been
	find by the search.

2008-01-08  Kevin Ryde  <user42@zip.com.au>

	* progmodes/compile.el (compilation-error-regexp-alist-alist):
	For perl, allow "during global destruction" at end.  Add entry for
	two-arg form of the Test module ok() func.

2008-01-08  Glenn Morris  <rgm@gnu.org>

	* diff-mode.el (diff-end-of-hunk): Don't match empty lines in
	unified format.

	* mouse.el (mouse-major-mode-menu): Suppress duplicate menus.

2008-01-08  Ralf Angeli  <angeli@caeruleus.net>

	* textmodes/reftex-toc.el (reftex-make-separate-toc-frame):
	Simplify selection of frame focusing function.

2008-01-08  Michael Olson  <mwolson@gnu.org>

	* textmodes/remember.el (remember-region): Fix typo in docstring.

2008-01-08  Lennart Borgman  <lennart.borgman.073@student.lu.se>

	* textmodes/remember.el (remember): If there is a visible region
	[that is, the mark is active and transient mark mode is enabled]
	then use this region for the initial contents of the *Remember*
	buffer.  Use `region-beginning' and `region-end' instead of
	`point' and `mark'.

2008-01-07  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-hg.el (vc-hg-dir-state, vc-hg-dir-status): Pass the dir
	argument to vc-hg-command.
	(vc-hg-log-view-mode): Handle the user field better.

2008-01-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc.el (vc-ensure-vc-buffer): Check liveness of vc-parent-buffer.

2008-01-06  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el (vc-status-fileinfo): New defstruct.
	(vc-status): New defvar.
	(vc-status-insert-headers, vc-status-printer, vc-status)
	(vc-status-mode-map, vc-status-mode, vc-status-mark-file)
	(vc-status-unmark-file, vc-status-marked-files): New functions.

	* vc-hg.el (vc-hg-dir-status): New function.

2008-01-06  Martin Rudalics  <rudalics@gmx.at>

	* cus-edit.el (custom-tool-bar-map): Move initialization of this
	keymap from here ...
	(custom-mode): ... to here.  Reported by Reiner Steib.

2008-01-06  Dan Nicolaescu  <dann@ics.uci.edu>

	* obsolete/x-apollo.el: Remove file for unsupported system.

	* term/x-win.el (vendor-specific-keysyms): Remove reference to
	Apollo.

	* progmodes/gud.el (gud-dgux-p): Remove.
	(dbx): Remove reference to dgux.

	* progmodes/ps-mode.el (ps-mode-print-function):
	* ps-print.el (ps-lp-system):
	* paths.el (rmail-spool-directory):
	* ls-lisp.el (ls-lisp-emulation):
	* lpr.el (lpr-lp-system):
	* dired.el (dired-chown-program): Remove references to dgux.

2008-01-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc.el (vc-process-sentinel): Fix apparent typo.
	(vc-do-command): Forcefully kill any left over process.
	Use start-file-process.
	(vc-annotate-get-time-set-line-props): Check we don't move backward.

2008-01-04  Michael Albinus  <michael.albinus@gmx.de>

	* net/dbus.el (dbus-list-hash-table)
	(dbus-name-owner-changed-handler): Replace "signal" by "member".
	(dbus-check-event): Add serial number to event.
	(dbus-handle-event): Apply return message if needed.
	(dbus-event-serial-number): New defun.
	(dbus-event-service-name, dbus-event-path-name)
	(dbus-event-interface-name, dbus-event-member-name):
	Adapt implementation to serial number.

2008-01-04  Juanma Barranquero  <lekktu@gmail.com>

	* bs.el (bs--get-mode-name): Fix typo in previous change.

2008-01-04  Dan Nicolaescu  <dann@ics.uci.edu>

	* mouse.el (mouse-popup-menubar): Fix typo.

	* emacs-lisp/bytecomp.el (byte-compile-from-buffer): Move one more
	form inside with-current-buffer.

	* progmodes/antlr-mode.el (provide): Move to the end of file.
	(require): Don't require font-lock and compile.
	(outline-level, imenu-use-markers, imenu-create-index-function):
	Move declarations to top level.
	(cond-emacs-xemacs-macfn): Declare for compiler.

	* vc-bzr.el (vc-bzr-root):
	* vc-arch.el (vc-arch-root): Only set a property if the file is
	managed by this backend.

	* vc-hg.el (vc-hg-state): Support the new status code for up-to-date.

2008-01-04  Tassilo Horn  <tassilo@member.fsf.org>

	* doc-view.el (doc-view-scroll-up-or-next-page)
	(doc-view-scroll-down-or-previous-page): Don't scroll to the
	top/bottom again when on the first/last page.

	* doc-view.el (doc-view-scroll-up-or-next-page)
	(doc-view-scroll-down-or-previous-page): Use image-scroll-up and
	image-scroll-down instead of the non-image equivalents.
	Don't rely on a signaled condition but switch pages when scrolling
	doesn't change the vertical position anymore.
	(doc-view-mode-map): Remap scroll-{up,down} to
	image-scroll-{up,down}.

2008-01-04  Rob Riepel  <riepel@networking.Stanford.EDU>

	* emulation/tpu-edt.el (tpu-load-xkeys): Recommend to run the
	tpu-mapper command rather than load the tpu-mapper package.

	* emulation/tpu-mapper.el (tpu-mapper): New command.
	Contains all the code previously at top-level.

2008-01-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* bs.el (bs--sort-by-mode, bs--get-mode-name):
	* imenu.el (imenu-add-to-menubar):
	* makesum.el (make-command-summary):
	* mouse.el (mouse-major-mode-menu, mouse-popup-menubar)
	(mouse-buffer-menu):
	* msb.el (msb--mode-menu-cond):
	* calc/calc-embed.el (calc-do-embedded):
	* emacs-lisp/helper.el (Helper-describe-mode):
	* mail/emacsbug.el (report-emacs-bug):
	* progmodes/hideshow.el (hs-grok-mode-type):
	* textmodes/sgml-mode.el (sgml-mode-facemenu-add-face-function):
	* textmodes/table.el (*table--cell-describe-mode):
	Pass mode-name through format-mode-line.

2008-01-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/ada-xref.el (ada-prj-find-prj-file):
	* progmodes/ada-mode.el (comment-region):
	* calendar/todo-mode.el (todo-insert-item):
	* bookmark.el (bookmark-buffer-name):
	Test major-mode rather than mode-name.

2008-01-04  Richard Stallman  <rms@gnu.org>

	* emacs-lisp/bytecomp.el (byte-compile-from-buffer):
	Call byte-compile-warn-about-unresolved-functions outside
	the with-current-buffer.
	(byte-compile-insert-header): Use with-current-buffer.

2008-01-04  Glenn Morris  <rgm@gnu.org>

	* startup.el (fancy-about-screen): Remove reference to deleted
	`fancy-splash-help-echo' variable.

	* version.el (emacs-copyright): Update to 2008.

	* net/tramp-smb.el (tramp-smb-handle-insert-directory): Use mapc
	rather than mapcar.

	* progmodes/cc-vars.el (defcustom-c-stylevar): Revert previous
	change (merge mistake).

	* doc-view.el (doc-view-search-internal): Don't use `incf'.

	* doc-view.el (bookmark-make-cell-function, bookmark-get-filename)
	(bookmark-get-bookmark-record):
	* image-mode.el (bookmark-make-cell-function)
	(bookmark-get-filename, bookmark-get-bookmark-record)
	(bookmark-get-position):
	* log-view.el (vc-modify-change-comment):
	* progmodes/grep.el (find-name-arg): Declare for compiler.

2008-01-04  Juanma Barranquero  <lekktu@gmail.com>

	* savehist.el (savehist-coding-system): Default to a variant coding
	system with explicit unix end-of-line conversion, which is safer.

2008-01-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* ibuf-ext.el (mode-name sorter, ibuffer-mark-by-mode-regexp):
	* ibuffer.el (mode column): Use format-mode-line.

	* server.el (server-create-window-system-frame): Remove workaround for
	a bug that has been fixed.

2008-01-03  Magnus Henoch  <magnus@zemdatav>

	* net/dbus.el (dbus-name-owner-changed-handler):
	Use dbus-unregister-object instead of dbus-unregister-signal.

2008-01-03  Drew Adams  <drew.adams@oracle.com>

	* frame.el (frame-geom-value-cons, frame-geom-spec-cons): New fns.

2008-01-03  Richard Stallman  <rms@gnu.org>

	* replace.el (occur-context-lines): New subroutine,
	broken out of occur-engine.
	(occur-engine): Call it.

2008-01-03  Alexandre Julliard  <julliard@winehq.org>

	* vc-git.el (vc-git--ls-files-state): New function.
	(vc-git-dir-state): Use it instead of processing the status
	results here.

2008-01-02  Eric S. Raymond  <esr@snark.thyrsus.com>

	* progmodes/grep.el (grep-find-ignored-directories):
	Initialize from the value of vc-directory-exclusion-list.

	* vc-hooks.el (vc-directory-exclusion-list): Include "_darcs",
	even though we don't have a back end for darcs yet.

2008-01-02  Karl Fogel  <kfogel@red-bean.com>

	Change a return type, for greater extensibility.
	See http://lists.gnu.org/archive/html/emacs-devel/2007-12/msg01077.html
	and its thread for discussion leading to this change.

	* bookmark.el (bookmark-jump-noselect):
	Return an alist instead of a dotted pair.
	(bookmark-jump, bookmark-jump-other-window, bookmark-insert)
	(bookmark-bmenu-2-window, bookmark-bmenu-other-window)
	(bookmark-bmenu-switch-other-window): Adjust accordingly.
	(bookmark-make-cell-function): Adjust documentation accordingly.

	* image-mode.el (image-bookmark-jump):
	Adjust return type accordingly; document.

	* doc-view.el (doc-view-bookmark-jump):
	Adjust return type accordingly; document.

2008-01-02  Miles Bader  <miles@gnu.org>

	* net/rcirc.el (rcirc-log-filename-function): New variable.
	(rcirc-log): Use `rcirc-log-filename-function' to generate the
	log-file name.  Don't log anything if it returns nil.
	(rcirc-log-write): Use `expand-file-name' when merging the
	log-file name from the alist with rcirc-log-directory; this does
	the right thing if the name in the alist already an absolute
	filename.  Make the log-file directory if necessary.

2008-01-02  Richard Stallman  <rms@gnu.org>

	* font-lock.el (font-lock-prepend-text-property)
	(font-lock-append-text-property): Canonicalize the face and
	font-lock-face properties.

	* faces.el (facep): Doc fix.

	* startup.el (fancy-startup-tail, fancy-about-text)
	(fancy-startup-text): Regularize format of face property.

	* facemenu.el (list-colors-print): Use :background and :foreground
	instead of background-color and foreground-color.

2008-01-02  Drew Adams  <drew.adams@oracle.com>

	* cus-edit.el (custom-add-parent-links):
	Fill the "Parent documentation" text.

2008-01-02  Eli Zaretskii  <eliz@gnu.org>

	* textmodes/ispell.el (ispell-grep-command): Use "grep" on
	MS-Windows and MS-DOS.
	(ispell-grep-options): Use "-Ei" on MS-Windows and MS-DOS.

2008-01-02  Eric S. Raymond  <esr@snark.thyrsus.com>

	* vc-svn.el (vc-svn-modify-change comment): New function.

2008-01-01  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-git.el (vc-git-dir-state): Set the vc-backend property.
	Do not disable undo, with-temp-buffer does it by default.

2008-01-01  Eric S. Raymond  <esr@snark.thyrsus.com>

	* vc-svn.el (vc-svn-parse-status): Set the `unregistered' property
	correctly.

	* vc.el (vc-dired-hook): Speed tuning.  Replace a vc-backend call
	with vc-state.
	(vc-next-action): Fix vc-transfer-file call.

2007-12-31  Tom Tromey  <tromey@redhat.com>

	* emacs-lisp/elp.el (elp-results): Use header-line-format for header.
	Move point to the start of the buffer.

2007-12-31  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-cvs.el (vc-cvs-parse-entry): Set the vc-backend property.

	* vc.el: State that dir-state is required to set the vc-state and
	vc-backend properties.

2007-12-31  Martin Rudalics  <rudalics@gmx.at>

	* man.el (Man-default-man-entry): Make this a defun.
	Improve guessing mechanism and handling of section numbers.

2007-12-31  Richard Stallman  <rms@gnu.org>

	* faces.el (face-all-attributes): If FRAME is nil, return defaults.

2007-12-31  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-units.el (calc-convert-temperature): Ensure that units
	are on the result even when the result is zero.

2007-12-30  Michael Albinus  <michael.albinus@gmx.de>

	* net/dbus.el (dbus-name-owner-changed-handler): Make the function
	resistent towards wrong parameters.
	(dbus-handle-event): Propagate D-Bus errors only in the debug case.

2007-12-30  Richard Stallman  <rms@gnu.org>

	* faces.el (face-all-attributes): New function.

	* faces.el (face-differs-from-default-p): Compute list of attr names
	from face-attribute-name-alist.

	* cus-edit.el (custom-face-set): Call `face-spec-set' with FOR-DEFFACE.
	(custom-face-save): Likewise.
	(custom-face-reset-saved, custom-face-reset-standard): Likewise.

	* cus-face.el (custom-declare-face): Per frame, use `face-spec-set-2'.
	(custom-theme-set-faces): Clear `face-override-spec' property.
	Call `face-spec-set' with FOR-DEFFACE.

	* custom.el (custom-theme-recalc-face): Simply call `face-spec-recalc'.

	* faces.el (face-spec-set): Third arg is now FOR-DEFFACE.
	Use of frame as third arg is deprecated.
	Handle `face-override-spec' property.
	(face-spec-recalc): New function.
	(face-spec-set-2): New function.
	(frame-set-background-mode): Handle `face-override-spec' property.
	Use `face-spec-recalc'.
	(face-set-after-frame-default): Use `face-spec-recalc'.

2007-12-29  Nick Roberts  <nickrob@snap.net.nz>

	* thumbs.el (thumbs-conversion-program): Add comment for Windows XP.

2007-12-29  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-hg.el (vc-hg-dir-state): Set the vc-backend property.

2007-12-29  Eric S. Raymond  <esr@snark.thyrsus.com>

	* vc-svn.el (vc-svn-parse-status): Recognize 'unregistered,
	'added, 'removed.

	* vc.el (header comment): Better description of dir-state.
	(vc-compatible-state): New function.  Checks whether two states
	can be in the same changeset; used with 'edited it can test whether
	the next action for a state should be commit.
	(vc-default-dired-state-info): Display 'removed state.
	(vc-dired-hook): Turn off undo, this is a speed tweak.

	* vc-bzr.el (vc-bzr-dir-state): Recognize 'added.

	* vc-hg.el (vc-bzr-hg-state): Recognize 'added and 'removed.
	Cope with the possibility that the 'C' status flag might change
	in 0.9,6.

	* vc-git.el (vc-bzr-dir-state): Recognize 'removed.

2007-12-29  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* files.el (cd-absolute): Fix omission bug:
	Make `list-buffers-directory' buffer-local.

2007-12-29  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-hg.el (vc-hg-dir-state): Deal with the up-to-date state.

2007-12-29  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-aent.el (math-read-token): Fix misplaced parentheses.

	* calc/calc-lang.el (calc-yacas-language, calc-maxima-language)
	(calc-giac-language, math-yacas-parse-Sum, math-yacas-compose-sum)
	(math-yacas-compose-deriv, math-yacas-compose-taylor)
	(math-maxima-parse-subst, math-maxima-parse-taylor)
	(math-maxima-compose-taylor, math-maxima-compose-subst)
	(math-maxima-compose-if, math-lang-switch-args)
	(math-lang-compose-switch-args, math-read-giac-subscr):
	New functions.
	(calc-lang-allow-underscores, calc-lang-allow-percentsigns)
	(calc-lang-brackets-are-subscripts, calc-lang-c-type-hex):
	Add languages.
	(math-vector-brackets, math-complex-format, math-variable-table)
	(math-parse-table, math-oper-table, math-function-table)
	(math-special-function-table, math-compose-subscr):
	Add values for new languages.

	* calc/calccomp.el (math-compose-expr): Add new languages.

	* calc/calc.el (calc-language): Add languages to docstring.

	* calc/calc-ext.el (calc-init-extensions): Add keybindings
	for new languages.  Autoload commands to change languages.

	* calc/calc-help.el (calc-d-prefix-help): Add new languages.

	* calc/calc-menu.el (calc-modes-menu): Add new languages.
	(calc-arithmetic-menu, calc-scientific-function-menu)
	(calc-algebra-menu, calc-graphics-menu, calc-vectors-menu)
	(calc-units-menu, calc-variables-menu, calc-stack-menu):
	Add :active keywords.

2007-12-28  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-hg.el (vc-hg-registered): Return the false when vc-hg-state
	returns 'ignored or 'unregistered.
	(vc-hg-state): Pass "-A" to the status command and deal with the
	output.
	(vc-hg-dir-state): Pass "-A" to the status command.

2007-12-29  Richard Stallman  <rms@gnu.org>

	* progmodes/compile.el (compilation-start): Set initial visible
	point properly even when compilation buffer already current.

2007-12-29  Richard Stallman  <rms@gnu.org>

	* files.el (conf-mode-maybe): New function.
	(auto-mode-alist): Use conf-mode-maybe for .conf etc.

2007-12-29  Martin Rudalics  <rudalics@gmx.at>

	* textmodes/fill.el (fill-find-break-point): Fix doc-string typo.

2007-12-29  Dan Nicolaescu  <dann@ics.uci.edu>

	* progmodes/asm-mode.el (asm-mode-map): Add a major mode menu.

2007-12-29  Richard Stallman  <rms@gnu.org>

	* comint.el (comint-mode-map): Explicitly bind `delete' and `kp-delete'
	so they never do EOF.

2007-12-29  Richard Stallman  <rms@gnu.org>

	* faces.el (copy-face): Create the new face explicitly if it
	does not exist already.

2007-12-29  Eli Zaretskii  <eliz@gnu.org>

	* simple.el (minibuffer-history, shell-command-history)
	(set-variable-value-history):
	* replace.el (regexp-history):
	* international/mule-cmds.el (input-method-history):
	* files.el (file-name-history): Add reference to history-length in
	the doc string.

2007-12-29  Richard Stallman  <rms@gnu.org>

	* comint.el (comint-password-prompt-regexp): Match `Enter Password'.

2007-12-29  Jason Rumney  <jasonr@gnu.org>

	* find-dired.el (find-name-arg): New custom variable.
	(find-name-dired): Use it.
	(find-dired-find-program): Remove.
	(find-dired): Use find-program.
	(find-grep-dired): Use grep-program.

	* progmodes/grep.el (rgrep): Use find-name-arg.

2007-12-29  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* progmodes/cc-vars.el (defcustom-c-stylevar):
	Revert to pre-2007-12-12 version.

2007-12-29  Richard Stallman  <rms@gnu.org>

	* emacs-lisp/find-func.el (find-function-after-hook): Add :type.

	* info.el (Info-clone-buffer): Rename from Info-clone-buffer-hook.
	Use changed.

	* startup.el (fancy-splash-help-echo): Var deleted.
	(fancy-splash-insert): Get help-echo from (startup-echo-area-message).
	(fancy-about-screen): Don't display fancy-splash-help-echo.

	* menu-bar.el (menu-bar-describe-menu): Remove dots from menu text.

2007-12-28  Eric S. Raymond  <esr@snark.thyrsus.com>

	* vc-hooks.el, vc.el: Move vc-directory-exclusion-list from vc.el
	to vc-hooks.el so it will be available to other modes, such as
	speedbar.el.  Also, teach it to recognize monotone state directories.

	* speedbar.el: Remove this mode's fragile assumptions about
	version-control systems.  Instead, make it use logic from
	vc-hooks.el so it will become smarter whenever VC mode does.

	* vc-hooks.el: 'added is a real state, not a future hypothetical one.
	Fix the documentation.

	* vc-bzr.el, vc-cvs.el, vc-git.el, vc-hg.el, vc-mcvs.el, vc-svn.el:
	Modify all instances of the dir-state back-end method to suppress
	keeping undo lists on the buffers holding status output, which
	can get extremely large.

	* vc-cvs.el, vc-svn.el: Simplify backend dired-state-info functions
	so they don't do work that the default one can do instead.

	* vc-hooks.el (vc-state): Document new 'ignored and 'unregistered
	states, and the new return-value convention.  These are not
	actually used yet, just set.

	* vc-svn.el (vc-svn-parse-status): Set 'ignored and 'unregistered
	states when appropriate.

	* vc-hg.el (vc-hg-state, vc-hg-dir-state): Set 'ignored and
	'unregistered when appropriate.

	* vc-git.el: Document that we don't set the new states yet.

	* vc.el (vc-dired-state-info): Display 'added, 'unregistered and
	'ignored states.

	* vc-cvs.el (vc-cvs-parse-status): Set the 'ignored state when
	appropriate.

	* vc-bzr.el (vc-bzr-dir-state): Set 'ignored and 'unregistered
	when appropriate.

2007-12-28  Nick Roberts  <nickrob@snap.net.nz>

	* thumbs.el (thumbs-call-convert): Use call-process directly
	with thumbs-conversion-program instead of through shell-file-name
	for better error reporting.

2007-12-27  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-aent.el (math-remove-percentsigns):
	* calc/calccomp.el (math-to-percentsigns): Change placeholder
	for percent signs.

2007-12-27  Eric S. Raymond  <esr@snark.thyrsus.com>

	* vc.el (vc-dired-ignorable-p, vc-dired-hook): Speed optimization;
	use completion-ignored-extensions to detect files that should be
	ignorted in VC-Dired listings, heading off lots of expensive calls
	to (vc-state).

	* vc.el (vc-dired-hook): Show unregistered file status as "?" in
	non-terse mode.
	(vc-dired-ignorable-p): Ignore Makefile when it has a peer named
	Makefile.in or Makefile.am.

2007-12-27  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el (ps-mark-active-p): Fun returned back.
	(ps-print-preprint-region): Use `ps-mark-active-p' instead of
	`region-active-p' for error checking.

2007-12-27  Eric S. Raymond  <esr@snark.thyrsus.com>

	* vc.el, vc-sccs.el, vc-rcs.el, vc-cvs.el, vc-mcvs.el:
	Put new machinery in place to support editing of change comments
	with 'e' in a log-view buffer.  Not documented yet as this
	only works for SCCS, RCS, and maybe CVS if you have admin
	privileges.  When we have backend support for Subversion and
	more modern systems it will be time to write this up.

2007-12-27  Kenichi Handa  <handa@ni.aist.go.jp>

	* international/mule-cmds.el (select-safe-coding-system):
	When a buffer is modified, cancel the writing.

2007-12-26  Eric S. Raymond  <esr@snark.thyrsus.com>

	* log-view.el: Add Subversion and Mercurial log format samples.

	* vc.el (vc-dired-hook): Significantly speed up by arranging for
	it to call the backend dir-state hook (if it exists)
	exactly *once*, rather than once per each subdirectory (with
	dired-state-info calls on all toplevel files slowing it down even
	further).  For this to work, backend dir-state methods have to
	recurse to subdirectories.  Most of them already did anyway; a few
	needed *non*-recursion switches removed.  This change mostly
	removed code that was perversely bad and should have been shot
	through the head years ago.

	* vc-bzr.el (vc-bzr-dir-state):
	* vc-cvs.el (vc-cvs-dir-state):
	* vc-mcvs.el (vc-mcvs-dir-state):
	* vc-svn.el (vc-svn-dir-state): Recurse in subdirectories.

	* vc-svn.el (vc-svn-print-log): svn log doesn't actually accept
	multiple arguments, so generate logs sequentially when we get them.
	* vc-hg.el (vc-hg-print-log): Gives this CVS-like "Working file:"
	headers so the various log bindings can do the right thing.
	* vc-cvs.el (vc-cvs-print-log): Fix a misleading comment.

2007-12-26  Andreas Schwab  <schwab@suse.de>

	* font-lock.el (save-buffer-state): Make sure the state of the
	buffer is always restored.

2007-12-26  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc.el (calc-lang-allow-percentsigns): New variable.

	* calc/calc-lang.el (calc-lang-allow-percentsigns): Declare as
	a variable.

	* calc/calccomp.el (math-to-percentsigns): New function.
	(math-compose-var): Handle variables with percent signs.
	(math-compose-expr): Handle function names with percent signs.

	* calc/calc-aent.el (math-to-percentsigns): Declare as function.
	(math-read-exprs): Handle percent signs in languages that
	allow them.
	(math-restore-underscores): Remove function.
	(math-remove-percentsigns, math-restore-placeholders):
	New functions.

2007-12-26  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el (ps-print-preprint-region): Use `region-active-p' instead
	of `mark' for error checking.

2007-12-26  Tassilo Horn  <tassilo@member.fsf.org>

	* image-mode.el (image-bookmark-make-cell, image-bookmark-jump):
	New functions.
	(image-mode): Set bookmark-make-cell-function appropriately.

	* doc-view.el (doc-view-bookmark-jump): Correct misspelled arg name.

	* bookmark.el (bookmark-make-cell-function): New variable.
	(bookmark-make): Call bookmark-make-cell-function's function
	instead of bookmark-make-cell.
	(bookmark-get-handler, bookmark-jump-internal): New functions.
	(bookmark-jump, bookmark-jump-other-window, bookmark-insert)
	(bookmark-bmenu-2-window, bookmark-bmenu-other-window):
	Use bookmark-jump-internal.
	(bookmark-make-cell-for-text-file): Rename from bookmark-make-cell.

	* doc-view.el (doc-view-bookmark-make-cell)
	(doc-view-bookmark-jump): New functions.
	(doc-view-mode): Set bookmark-make-cell-function buffer-locally.

2007-12-25  Miles Bader  <miles@gnu.org>

	* indent.el (indent-for-tab-command): Rigidly indent the following
	sexp along with the current line when a prefix arg is given in the
	non-active-region case.  Specify raw prefix in interactive spec.
	Simplify main indentation logic to get rid of the conditional call
	to `indent-according-to-mode' (it just ended up calling
	`indent-line-function' in all cases anyway, which can be done more
	simply here).  Remove unnecessary test of ARG in active region case.

2007-12-25  Richard Stallman  <rms@gnu.org>

	* allout.el (allout-region-active-p): Rename from my-region-active-p.
	Use `use-region-p'.
	(allout-write-file-hook-handler): Simplify code.

	* ps-print.el (ps-mark-active-p): Function deleted.
	(ps-print-preprint-region): Use (mark) for the error check.

	* tooltip.el (tooltip-region-active-p): Use `use-region-p'.

	* winner.el (winner-active-region): Use `mark-active' if it's defined.

	* progmodes/ada-mode.el (ada-region-selected): Use `use-region-p'.

	* textmodes/org.el (org-region-active-p): Use `use-region-p'.

	* progmodes/idlwave.el (idlwave-region-active-p): Use `use-region-p'.

	* textmodes/reftex.el (reftex-region-active-p): Use `use-region-p'.

	* progmodes/cc-defs.el (c-region-is-active-p):
	Use `mark-active' if it's defined.

	* progmodes/cc-cmds.el (c-indent-line-or-region):
	Pass prefix arg to `c-indent-command'.  Use `use-region-p'.

	* simple.el (select-active-regions): New option.
	(set-mark): Obey it.
	(yank-pop-change-selection): New option.
	(current-kill): Obey it.

	* simple.el (use-region-p): Rename from `region-active-p'.
	(region-active-p): New function.

2007-12-25  David Golden  <david.delaharpe.golden@gmail.com>  (tiny change)

	* term/x-win.el (x-select-enable-primary): New option.
	(x-select-text, x-cut-buffer-or-selection-value): Obey it.

	* mouse.el (mouse-yank-primary): New function (almost same
	as mouse-yank-secondary).

2007-12-25  Dan Nicolaescu  <dann@ics.uci.edu>

	* calculator.el:
	* dframe.el:
	* iswitchb.el:
	* whitespace.el:
	* winner.el:
	* emacs-lisp/checkdoc.el:
	* mail/feedmail.el:
	* net/quickurl.el:
	* obsolete/fast-lock.el:
	* play/5x5.el:
	* progmodes/delphi.el:
	* progmodes/idlw-shell.el:
	* progmodes/idlwave.el:
	* textmodes/artist.el:
	* textmodes/ispell.el:
	* textmodes/texinfmt.el:
	* textmodes/texinfo.el: Remove obsolete definitions of backward
	compatibility macros for defcustom, defgroup, defface, when,
	unless, with-current-buffer and with-temp-message.

2007-12-24  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/verilog-mode.el: Reformat parts to 80 columns.

2007-12-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* server.el (server-save-buffers-kill-terminal): Check the `proc' is
	indeed a process.

2007-12-23  Richard Stallman  <rms@gnu.org>

	* simple.el (region-active-p): New function.
	(use-empty-active-region): New variable.

	* dired-aux.el (dired): Load dired.el at run time too.

2007-12-23  Juri Linkov  <juri@jurta.org>

	* man.el (Man-follow-manual-reference): Fill the minibuffer's
	default list with a full list of references.

	* files.el (auto-mode-alist): Add \\' to doc-view files regexp.

2007-12-23  Andreas Schwab  <schwab@suse.de>

	* files.el (switch-to-buffer-other-frame): Return the buffer
	switched to.

2007-12-23  Michael Albinus  <michael.albinus@gmx.de>

	Sync with Tramp 2.1.12.

	* net/tramp.el: New todo item.

	* net/tramp-smb.el (tramp-smb-handle-insert-directory): Handle "-F"
	switch.  Reported by Mark T. Kennedy <mkennedy@diamondbackcap.com>.

	* net/trampver.el: Update release number.

2007-12-22  Richard Stallman  <rms@gnu.org>

	* newcomment.el (comment-region-default): Don't triple the
	comment starter if the first region line isn't indented enough.

2007-12-21  Teodor Zlatanov  <tzz@lifelogs.com>

	* net/imap.el (imap-authenticate): Use current-buffer instead of
	buffer, for the cases where imap-authenticate is called with a nil
	buffer parameter.

2007-12-21  Martin Rudalics  <rudalics@gmx.at>

	* autoinsert.el (auto-insert-alist): Remove nonsensical precision
	specifier from format-string.  Reported by Ye Wenbin.

2007-12-20  Jason Rumney  <jasonr@gnu.org>

	* nxml/nxml-mode.el (nxml-faces): Rename from nxml-highlighting-faces.
	Parent group is font-lock-faces.
	(nxml-light-blue-color, nxml-dark-blue-color, nxml-green-color)
	(nxml-sky-blue-color, nxml-dark-green-color, nxml-light-green-color):
	(nxml-version): Remove.
	(nxml-delimited-data, nxml-name, nxml-ref, nxml-delimiter)
	(nxml-text, nxml-comment-content, nxml-comment-delimiter)
	(nxml-processing-instruction-delimiter)
	(nxml-processing-instruction-target)
	(nxml-processing-instruction-content, nxml-cdata-section-delimiter)
	(nxml-cdata-section-CDATA, nxml-cdata-section-content)
	(nxml-char-ref-number, nxml-char-ref-delimiter, nxml-entity-ref-name)
	(nxml-entity-ref-delimiter, nxml-tag-delimiter, nxml-tag-slash)
	(nxml-element-prefix, nxml-element-colon, nxml-element-local-name)
	(nxml-attribute-prefix, nxml-attribute-colon)
	(nxml-attribute-local-name, nxml-namespace-attribute-xmlns)
	(nxml-namespace-attribute-colon, nxml-namespace-attribute-prefix)
	(nxml-attribute-value, nxml-attribute-value-delimiter)
	(nxml-namespace-attribute-value)
	(nxml-namespace-attribute-value-delimiter)
	(nxml-prolog-literal-delimiter, nxml-prolog-literal-content)
	(nxml-prolog-keyword, nxml-markup-declaration-delimiter, nxml-hash)
	(nxml-glyph): Rename, removing -face suffix.
	Inherit from existing font-lock faces.
	(nxml-apply-fontify-rule, nxml-char-ref-display-extra):
	Use new face names.

	* nxml/nxml-outln.el (nxml-heading, nxml-outline-indicator)
	(nxml-outline-active-indicator, nxml-outline-ellipsis):
	Rename, removing -face suffix.
	(nxml-highlighted-less-than, nxml-highlighted-greater-than)
	(nxml-highlighted-colon, nxml-highlighted-slash)
	(nxml-highlighted-ellipsis, nxml-highlighted-inactive-minus)
	(nxml-highlighted-active-minus, nxml-highlighted-active-plus)
	(nxml-highlighted-qname, nxml-outline-display-heading):
	Use new face names.

	* nxml/rng-valid.el (rng-error): Rename from rng-error-face.

	* nxml/rng-nxml.el (rng-nxml-easy-menu): Remove nxml-version.

2007-12-19  Martin Rudalics  <rudalics@gmx.at>

	* cus-start.el (all): Use correct group name for members of
	mode-line group.

	* man.el (Man-default-man-entry): When looking for default man
	entry title search text preceding point.  Use when instead of if.

	* indent.el (indent-for-tab-command): Fix doc-string typo.

	* vc.el (vc-ensure-vc-buffer): Avoid infinite looping when
	vc-parent-buffer is the current buffer.

	* info-look.el (info-lookup, info-lookup-setup-mode)
	(info-lookup-make-completions): Avoid clobbering Info-history and
	Info-history-list.

2007-12-19  Glenn Morris  <rgm@gnu.org>

	* progmodes/verilog-mode.el (top-level): Don't require compile.
	(compilation-error-regexp-alist, compilation-last-buffer):
	Define for compiler.
	(verilog-insert-1): New function.
	(verilog-insert-indices, verilog-generate-numbers): Doc fixes.
	Use verilog-insert-1.
	(verilog-surelint-off): Use next-error-last-buffer if bound.
	Check compile buffer is live.

2007-12-19  John J Foerch  <jjfoerch@earthlink.net>  (tiny change)

	* progmodes/compile.el (compilation-start): Don't pass a FRAME
	argument to display-buffer.

2007-12-19  Jason Rumney  <jasonr@gnu.org>

	* nxml/rng-maint.el (rng-format-manual): Do not autoload.
	(rng-autoload-modules, rng-update-autoloads, rng-compile-modules)
	(rng-byte-compile-load, rng-write-version): Remove.

	* nxml/rng-loc.el (rng-schema-locating-files-default)
	(rng-schema-locating-file-schema-file): Use files in etc/schemas.
	(rng-schema-loader-alist): Use rng-c-load-schema to load rnc files.

2007-12-18  Michael Albinus  <michael.albinus@gmx.de>

	* files.el (cd-absolute): Set `list-buffers-directory' in order to
	show correct path in buffer list.

	* net/tramp.el (tramp-open-connection-setup-interactive-shell)
	(tramp-find-shell): Send only single prompt setting commands, in
	order to avoid double-prompt.

	* net/tramp-compat.el (top): Require cl only when compiling.
	Reported by Glenn Morris <rgm@gnu.org>.

2007-12-18  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* progmodes/cc-vars.el (defcustom-c-stylevar): Eval VAL.
	(c-comment-continuation-stars): No longer declare with
	cc-bytecomp-obsolete-var and cc-bytecomp-defvar.
	(c-block-comment-prefix): Use symbol-value to
	access c-comment-continuation-stars.
	* progmodes/cc-mode.el (c-initialize-cc-mode):
	Use symbol-value to access c-comment-continuation-stars.

2007-12-18  Mark A. Hershberger  <mah@everybody.org>

	* xml.el (xml-escape-string): New function.  Escape string using
	xml-entity-alist.
	(xml-debug-print-internal): Use xml-escape-string to escape
	characters in attributes and in text children of elements.

2007-12-18  Glenn Morris  <rgm@gnu.org>

	* progmodes/cc-subword.el (c-subword-mode): Drop support for
	systems without define-minor-mode.

	* progmodes/cc-vars.el (defcustom-c-stylevar): Remove debugging message.

	* progmodes/verilog-mode.el: Replace all instances of
	string-to-int with string-to-number, insert-string with insert,
	and read-input with read-string.
	(top-level): No need to require imenu, reporter, dinotrace, vc,
	font-lock when compiling.  Always require compile.  Relegate remaining
	compatibility cruft to XEmacs.  Don't require font-lock.
	(verilog-version): Remove superfluous concat.
	(dinotrace-unannotate-all, zmacs-activate-region, customize-apropos):
	No need to define.
	(verilog-regexp-opt): On Emacs, just make it an alias for regexp-opt.
	(verilog-font-lock-keywords, verilog-font-lock-keywords-1)
	(verilog-font-lock-keywords-2, verilog-font-lock-keywords-3)
	(verilog-startup-message-displayed): These are variables, not constants.
	(verilog-batch-execute-func, verilog-auto-inst)
	(verilog-auto-inst-param): Use mapc rather than mapcar.
	(sigs-in, sigs-inout, sigs-out): Define for compiler rather than
	actually defining.
	(verilog-modi-get-decls, verilog-modi-get-sub-decls)
	(verilog-modi-get-outputs, verilog-modi-get-inouts)
	(verilog-modi-get-inputs, verilog-modi-get-wires)
	(verilog-modi-get-regs, verilog-modi-get-assigns)
	(verilog-modi-get-consts, verilog-modi-get-gparams)
	(verilog-modi-get-sub-outputs, verilog-modi-get-sub-inouts)
	(verilog-modi-get-sub-inputs): Move inline functions earlier in
	the file.
	(sigs-in, sigs-out): Don't declare multiple times.
	(got-sig, got-rvalue, uses-delayed): Define for compiler with just
	`defvar'.
	(verilog-auto): Call dinotrace-unannotate-all only if bound.
	(verilog-module-inside-filename-p): No need to wrap fboundp test
	in condition-case.
	(reporter-submit-bug-report): Autoload it.
	(verilog-mark-defun): Call zmacs-activate-region only if bound.
	(verilog-font-customize): Call customize-apropos only if bound.
	(verilog-getopt-flags, verilog-auto-reeval-locals):
	Use make-local-variable rather than make-variable-buffer-local.
	(verilog-company, verilog-project, verilog-modi-cache-list):
	Move make-variable-buffer-local calls to top-level.
	(font-lock-defaults-alist): Don't define it.
	(verilog-need-fld): Remove.
	(verilog-font-lock-init): Don't set font-lock-defaults-alist.
	(verilog-mode): Only call make-local-hook on XEmacs.
	Set font-lock-defaults rather than using verilog-font-lock-init.

2007-12-17  Andreas Schwab  <schwab@suse.de>

	* progmodes/sh-script.el (sh-font-lock-syntactic-keywords):
	Fix comment typo.

2007-12-16  Michael Albinus  <michael.albinus@gmx.de>

	* net/dbus.el (dbus-name-owner-changed-handler):
	Use `dbus-unregister-signal' for removing old rules.
	Obey new structure of `dbus-registered-functions-table'.

2007-12-12  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* progmodes/cc-vars.el (defcustom-c-stylevar): Rewrite.

2007-12-11  Dan Nicolaescu  <dann@ics.uci.edu>

	* progmodes/verilog-mode.el (set-buffer-menubar): Remove unused
	function.
	(add-submenu): Only define for XEmacs.
	(verilog-regexp-words): Revert previous change, keep the other
	definition.

2007-12-09  Dan Nicolaescu  <dann@ics.uci.edu>

	* progmodes/perl-mode.el (perl-continued-statement-offset)
	(perl-continued-brace-offset, perl-brace-offset)
	(perl-brace-imaginary-offset, perl-label-offset):
	* progmodes/cperl-mode.el (cperl-brace-offset)
	(cperl-continued-brace-offset, cperl-label-offset)
	(cperl-continued-statement-offset)
	(cperl-extra-newline-before-brace, cperl-merge-trailing-else):
	Add safe-local-variable properties.

2007-12-08  Dan Nicolaescu  <dann@ics.uci.edu>

	* progmodes/verilog-mode.el (verilog-mode-map)
	(verilog-template-map, verilog-mode-mouse-map): Fix typos.
	(verilog-colorize-include-files): Use only overlay functions so
	that it can work on both emacs and XEmacs.
	(set-extent-keymap): Remove unused defun.
	(verilog-kill-existing-comment, verilog-insert-date)
	(verilog-insert-year): Rename in order not to pollute the global
	namespace from kill-existing-comment, insert-date and
	insert-year, respectively.
	(verilog-set-auto-endcomments, verilog-header): Update callers.

	* files.el (auto-mode-alist): Recognize verilog files.

	* progmodes/verilog-mode.el (verilog-string-replace-matches)
	(verilog-string-remove-spaces, verilog-re-search-forward)
	(verilog-re-search-backward, verilog-re-search-forward-quick)
	(verilog-re-search-backward-quick, verilog-get-beg-of-line)
	(verilog-get-end-of-line, verilog-within-string): Move definitions
	before first use.  No code changes.

2007-12-08  Dan Nicolaescu  <dann@ics.uci.edu>

	* progmodes/verilog-mode.el (verilog-mode-version)
	(verilog-mode-release-date): Don't use expanding keywords.
	(provide): Move to the end of file.
	(fboundp): Don't check if eval-when-compile is bound, it is used
	later in the file without checking.
	(when, unless): Copy definitions from subr.el.
	(char-before, defcustom, defface, customize-group)
	(verilog-batch-error-wrapper): Don't use old style backquotes.
	(verilog-regexp-opt): Avoid using the cl function case.
	(verilog-regexp-words): Remove duplicated definition.
	(verilog-mode-abbrev-table): Remove, duplicate.
	(verilog-mode-map, verilog-template-map, verilog-mode-mouse-map):
	Declare and initialize in one step.
	(verilog-declaration-prefix-re, verilog-declaration-re)
	(verilog-end-of-statement, verilog-indent-declaration)
	(verilog-get-lineup-indent): Remove trailing whitespace.
	(verilog-mode): Fix autoload cookie.
	Set beginning-of-defun-function and end-of-defun-function.  Use when
	instead of if.
	(verilog-emacs-features, verilog-auto-ascii-enum)
	(verilog-insert-indices): Escape braces in doc strings.

2007-12-08  Michael McNamara  <mac@verilog.com>
            Wilson Snyder  <wsnyder@wsnyder.org>

	* progmodes/verilog-mode.el: New file.

2007-12-08  Eli Zaretskii  <eliz@fencepost.gnu.org>

	* international/latexenc.el (latexenc-find-file-coding-system):
	If both coding-system-for-write and buffer-file-coding-system of
	latex-main-file are nil, use `undecided'.

2007-12-06  Jason Rumney  <jasonr@gnu.org>

	* mouse.el (mouse-buffer-menu-alist): Keep buffer names left aligned.

2007-12-12  Yoni Rabkin Katzenell  <yoni-r@actcom.com>  (tiny change)

	* files.el (revert-buffer): Docstring fix.

2007-12-11  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/check-declare.el (check-declare-verify): Handle deffoo.

2007-12-11  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-aent.el (math-restore-underscores)
	(math-string-restore-underscores): New functions.
	(math-read-factor): Properly check variable names with underscores
	for entries in `math-expr-variable-mapping'.

	* calc/calc-lang.el (math-lang-name): New property name.

	* calc/calc.el (calc-set-mode-line): Use `math-lang-name'
	to set language name.

2007-12-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* pgg.el (pgg-run-at-time, pgg-cancel-timer): Use eval-and-compile.

2007-12-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* server.el (server-select-display): Fix important typo.
	(server-process-filter): Turn a "" display into nil.

2007-12-09  Juri Linkov  <juri@jurta.org>

	* replace.el (keep-lines, flush-lines, how-many): Doc fix.
	Check search-upper-case before calling isearch-no-upper-case-p
	to set case-fold-search.
	(occur): Doc fix.
	(occur-1, perform-replace): Check search-upper-case before calling
	isearch-no-upper-case-p to set case-fold-search.

	* isearch.el (search-upper-case): Doc fix.
	(isearch-mode-map): Bind `M-s o' to isearch-occur.
	(isearch-query-replace): Doc fix.  Let-bind search-upper-case to nil.
	(isearch-query-replace-regexp): Doc fix.
	(isearch-occur): New function.

2007-12-09  Reiner Steib  <Reiner.Steib@gmx.de>

	* pgg.el, pgg-parse.el (declare-function): Add new no-op macro for
	backward compatibility.

	* net/imap.el (imap-string-to-integer): New function.

2007-12-09  David Kastrup  <dak@gnu.org>

	* emacs-lisp/lisp-mnt.el (lm-verify): Make it work with
	directories.  Not sure anybody uses this anymore, though.

2007-12-09  Glenn Morris  <rgm@gnu.org>

	* emulation/viper-init.el (top-level): Use dolist rather than mapc
	in make-variable-frame-local call.

2007-12-08  Dan Nicolaescu  <dann@ics.uci.edu>

	* mail/hashcash.el (declare-function):
	* net/imap.el (declare-function): New no-op macro for backward
	compatibility.

2007-12-08  Eli Zaretskii  <eliz@gnu.org>

	Sync makefile.w32-in with Makefile.in.

	* makefile.w32-in (check-declare): New target.
	(BYTE_COMPILE_EXTRA_FLAGS): New variable.
	(.el.elc, compile-CMD, compile-SH, compile-always-CMD)
	(compile-always-SH, compile-calc-CMD, compile-calc-SH)
	($(lisp)/progmodes/cc-mode.elc): Use it.
	($(lisp)/progmodes/cc-mode.elc): New rule.

2007-12-08  Reiner Steib  <Reiner.Steib@gmx.de>

	* indent.el (tab-stop-list): Mark as safe-local-variable.

	* generic-x.el (etc-sudoers-generic-mode): New mode.
	(generic-unix-modes): Add it.

2007-12-08  Michael Albinus  <michael.albinus@gmx.de>

	* net/dbus.el (dbus-hash-table=): Remove function.  We cannot
	apply wildcards in a hash table key; there is no usable hash code then.
	(dbus-registered-functions-table): Use `equal' as test function.
	(dbus-name-owner-changed-handler): Rewrite due to new hash table
	structure.

2007-12-08  Martin Rudalics  <rudalics@gmx.at>

	* progmodes/cc-cmds.el (c-mask-paragraph): Avoid invalid search
	bound error in block comment branch.

2007-12-08  David Kastrup  <dak@gnu.org>

	* textmodes/reftex.el (reftex-select-with-char):
	* textmodes/reftex-toc.el (reftex-toc-do-promote)
	(reftex-toc-visit-location, reftex-toc-find-section):
	* textmodes/reftex-index.el (reftex-index-show-entry):
	* textmodes/org.el (org-cycle-hide-archived-subtrees)
	(org-table-rotate-recalc-marks, org-mark-ring-push)
	(org-follow-info-link, org-mhe-get-message-folder-from-index)
	(org-auto-repeat-maybe, org-store-log-note, org-delete-property)
	(org-evaluate-time-range, org-edit-agenda-file-list):
	* textmodes/artist.el (artist-select-next-op-in-list)
	(artist-select-prev-op-in-list):
	* term/mac-win.el (mac-service-insert-text):
	* startup.el (fancy-about-screen):
	* progmodes/vhdl-mode.el (vhdl-decision-query):
	* progmodes/idlwave.el (idlwave-template)
	(idlwave-scroll-completions, idlwave-display-completion-list):
	* progmodes/ebrowse.el (ebrowse-show-progress):
	* progmodes/cperl-mode.el (cperl-find-pods-heres):
	* progmodes/antlr-mode.el (antlr-insert-option-do):
	* play/mpuz.el (mpuz-close-game):
	* net/rcirc.el (rcirc-next-active-buffer):
	* mail/reporter.el (reporter-update-status):
	* kmacro.el (kmacro-display):
	* international/ja-dic-cnv.el (skkdic-set-okuri-nasi):
	* emulation/viper-util.el (viper-save-setting):
	* emacs-lisp/lisp-mnt.el (lm-verify):
	* emacs-lisp/edebug.el (edebug-set-mode):
	* emacs-lisp/checkdoc.el (checkdoc-rogue-spaces, checkdoc-defun):
	* calendar/calendar.el (calendar-print-day-of-year):
	* calc/calcalg3.el (calc-curve-fit):
	* calc/calcalg2.el (math-integral):
	* calc/calc.el (calc-read-key-sequence, calc-version):
	* calc/calc-mode.el (calc-set-simplify-mode):
	* calc/calc-ext.el (calc-fancy-prefix): Fix buggy call to `message'.

2007-12-07  Deepak Goel  <deego3@gmail.com>

	* progmodes/idlw-shell.el (idlwave-shell-display-line)
	* progmodes/ada-xref.el (ada-find-file, ada-get-all-references)
	(ada-xref-find-in-modified-ali, ada-find-in-src-path)
	* mail/uce.el (uce-reply-to-uce)
	* progmodes/vhdl-mode.el (vhdl-template-modify)
	* mail/feedmail.el (feedmail-dump-message-to-queue): Improve calls
	to `error' (as suggested by RMS.)

2007-12-07  Glenn Morris  <rgm@gnu.org>

	* allout.el (allout-write-file-hook-handler):
	* textmodes/reftex.el (reftex-TeX-master-file):
	* textmodes/reftex-parse.el (reftex-short-context):
	Revert previous change.

2007-12-07  Michael Albinus  <michael.albinus@gmx.de>

	* net/dbus.el (dbus-hash-table=): Fix for new hash table key structure.
	(dbus-list-hash-table, dbus-name-owner-changed-handler): New defuns.
	(dbus-check-event, dbus-handle-event, dbus-event-bus-name)
	(dbus-event-service-name, dbus-event-path-name)
	(dbus-event-interface-name, dbus-event-member-name): Fix for new
	event structure.
	(dbus-list-activatable-names, dbus-list-names)
	(dbus-list-queued-owners, dbus-get-name-owner, dbus-introspect):
	Reorder `dbus-call-method' arguments.

2007-12-06  Deepak Goel  <deego3@gmail.com>

	* allout.el (allout-write-file-hook-handler):
	* textmodes/reftex.el (reftex-TeX-master-file):
	* textmodes/org.el (org-paste-subtree):
	* progmodes/vhdl-mode.el (vhdl-template-modify):
	* progmodes/idlw-shell.el (idlwave-shell-send-command)
	(idlwave-shell-display-line):
	* progmodes/ada-xref.el (ada-find-file, ada-get-all-references)
	(ada-xref-find-in-modified-ali, ada-find-in-src-path):
	* net/trampver.el (x):
	* mail/uce.el (uce-reply-to-uce):
	* mail/rmailout.el (rmail-output):
	* mail/feedmail.el (feedmail-dump-message-to-queue):
	* whitespace.el (whitespace-write-file-hook):
	* wdired.el (wdired-check-kill-buffer):
	* vc.el (vc-update):
	* vc-mcvs.el (vc-mcvs-checkin):
	* vc-cvs.el (vc-cvs-checkin):
	* man.el (Man-bgproc-sentinel, Man-goto-see-also-section):
	* ibuffer.el (ibuffer-current-buffer):
	* dired.el (dired-move-to-end-of-filename):
	* bindings.el (complete-symbol):
	* textmodes/org-publish.el (org-publish-file):
	(org-publish-current-project):
	* textmodes/reftex-parse.el (reftex-short-context):
	* textmodes/texinfmt.el: Fix buggy calls to `error'.

2007-12-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* doc-view.el (doc-view-dvi->pdf-sentinel)
	(doc-view-pdf/ps->png-sentinel, doc-view-pdf->txt-sentinel)
	(doc-view-ps->pdf-sentinel, doc-view-display): Don't change buffer
	within a sentinel or timer.
	(doc-view-display): Don't try to display before the requested page
	is available, unless told to do so explicitly.
	(doc-view-pdf/ps->png-sentinel, doc-view-initiate-display):
	Force display even if the requested page is not available.

2007-12-06  Richard Stallman  <rms@gnu.org>

	* help-fns.el (describe-function-1): Call ad-get-advice-info
	only on symbols.

2007-12-06  Glenn Morris  <rgm@gnu.org>

	* progmodes/antlr-mode.el (antlr-keyword, antlr-syntax)
	(antlr-ruledef, antlr-tokendef, antlr-ruleref-face)
	(antlr-tokenref, antlr-literal): Inherit from standard font-lock
	faces in non-light-background case.

	* add-log.el, dired-aux.el, font-lock.el, help-fns.el, ido.el:
	* informat.el, emacs-lisp/bytecomp.el, emacs-lisp/gulp.el:
	* emacs-lisp/tcover-ses.el, emacs-lisp/timer.el, emulation/edt.el:
	* emulation/vi.el, emulation/viper-cmd.el:
	* international/titdic-cnv.el, mail/emacsbug.el, progmodes/dcl-mode.el:
	* progmodes/prolog.el, progmodes/ps-mode.el, progmodes/python.el:
	* textmodes/fill.el: Remove directory part from filenames in
	function declarations.

	* dired-aux.el (mailcap-mime-info): Update declaration.

2007-12-05  Richard Stallman  <rms@gnu.org>

	* wid-edit.el (widget-type): Doc fix.

2007-12-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/perl-mode.el (perl-font-lock-syntactic-keywords):
	Don't match "sub { (...) ... }".

2007-12-05  Richard Stallman  <rms@gnu.org>

	* international/mule-cmds.el (toggle-input-method-active): New var.
	(toggle-input-method): Bind toggle-input-method-active to t.
	Error if it was already non-nil.

2007-12-05  Reiner Steib  <Reiner.Steib@gmx.de>

	* net/tls.el (tls-hostmismatch, open-tls-stream): Checkdoc cleanup.

2007-12-05  Elias Oltmanns  <eo@nebensachen.de>

	* net/tls.el (open-tls-stream): Actually consult tls-checktrust to
	see if certs should be verified and what is to be done in the
	event of a verification failure.

2007-12-05  Reiner Steib  <Reiner.Steib@gmx.de>

	* net/tls.el (tls-program): Provide more custom choices from
	`tls-checktrust'.  Refer to `tls-checktrust' in doc string.
	(tls-process-connection-type, tls-success): Remove "*" in doc string.
	(tls-checktrust, tls-hostmismatch, tls-untrusted): Add custom
	version.  Minor improvement to doc strings.
	(tls-program): Add comment.

2007-12-05  Elias Oltmanns  <eo@nebensachen.de>

	* net/tls.el (tls-certtool-program, tls-hostmismatch): New variables.
	(tls-checktrust): New variable.  Check if GNU TLS complained about a
	mismatch between the hostname provided in the certificate and the name
	of the host connecting to.
	(open-tls-stream): Use them.  Check certificates against trusted root
	certificates.

2007-12-05  Nathan J. Williams  <nathanw@MIT.EDU>  (tiny change)

	* net/imap.el (imap-mailbox-status-asynch): Upcase STATUS items.
	(imap-parse-status): Upcase status-att for broken servers that sends
	them lower-case (e.g., MS Exchange 2007).

2007-12-05  Deepak Goel  <deego3@gmail.com>

	* simple.el (undo):
	* image-dired.el (image-dired-display-thumb-properties):
	(image-dired-modify-mark-on-thumb-original-file):
	(image-dired-dired-display-properties):
	* help.el (help-window-display-message):
	* files.el (hack-local-variables-confirm):
	* ediff.el (ediff-version):
	* complete.el (pc-chunk-after, PC-temp-minibuffer-message):
	`message' and `error': Ensure that first arg is a format string.

	* emacs-lisp/find-func.el (find-library-name): Prefer files with
	".el" suffix over "".

2007-12-05  Michael Albinus  <michael.albinus@gmx.de>

	* net/dbus.el (dbus-hash-table=): Allow nil as wildcard in the
	interface and member fields.

2007-12-05  Glenn Morris  <rgm@gnu.org>

	* eshell/em-alias.el (pcomplete-stub): Define for compiler.
	(pcomplete-here): Autoload it.

	* eshell/em-basic.el (print-func): No need to define for compiler.

	* eshell/esh-cmd.el (eshell-debug-command):
	* eshell/esh-io.el (eshell-print): Move definitions before use.

	* eshell/esh-module.el (eshell-load-defgroups): Eval and compile.

	* eshell/esh-util.el (top-level): Don't require pp.
	Use condition-case rather than ignore-errors.

	* eshell/eshell.el (eshell-buffer-name): Define for compiler.

	* eshell/em-alias.el, eshell/em-banner.el, eshell/em-basic.el
	* eshell/em-cmpl.el, eshell/em-dirs.el, eshell/em-glob.el
	* eshell/em-hist.el, eshell/em-ls.el, eshell/em-pred.el
	* eshell/em-prompt.el, eshell/em-rebind.el, eshell/em-script.el
	* eshell/em-smart.el, eshell/em-term.el, eshell/em-unix.el
	* eshell/em-xtra.el, eshell/esh-cmd.el, eshell/esh-test.el
	* eshell/esh-util.el, eshell/eshell.el: Require individual files
	if needed when compiling, rather than esh-maint.  Collect any
	require statements.  Move provide statement to end.  Move any
	commentary to start.

	* eshell/esh-arg.el, eshell/esh-ext.el, eshell/esh-io.el:
	* eshell/esh-mode.el, eshell/esh-module.el, eshell/esh-opt.el:
	* eshell/esh-proc.el, eshell/esh-var.el:
	Require individual files if needed when compiling, rather than
	esh-maint.  Collect any require statements.  Leave provide at start.
	Move any commentary to start.

	* emacs-lisp/bytecomp.el (byte-compile-declare-function):
	Remove declared function from byte-compile-noruntime-functions.

	* ediff-util.el (ediff-version):
	* progmodes/python.el (compilation-shell-minor-mode):
	* textmodes/org.el (Info-goto-node, calendar-astro-date-string)
	(calendar-bahai-date-string, calendar-check-holidays)
	(calendar-chinese-date-string, calendar-coptic-date-string)
	(calendar-ethiopic-date-string, calendar-forward-day)
	(calendar-french-date-string, calendar-goto-date)
	(calendar-goto-today, calendar-hebrew-date-string)
	(calendar-islamic-date-string, calendar-iso-date-string)
	(calendar-julian-date-string, calendar-mayan-date-string)
	(calendar-persian-date-string, gnus-summary-last-subject)
	(parse-time-string, rmail-show-message): Declare as functions.

2007-12-05  Michael Olson  <mwolson@gnu.org>

	* textmodes/remember.el: Merge contents of remember-diary.el here,
	updating header.  Add autoload cookie so that byte-compilation
	works without warning.
	(remember-diary-file): Default to nil, since diary might not yet
	be loaded at this point, which would deny us access to diary-file.
	(remember-diary-extract-entries): If remember-diary-file is nil,
	then use diary-file instead.

	* textmodes/remember-diary.el: Remove, due to the issue of needing
	the first 8 characters of a filename to be unique.

2007-12-04  Michael Albinus  <michael.albinus@gmx.de>

	* net/dbus.el (dbus-hash-table=): New defun.
	(dbus-hash-table-test): New hash table test function, used in
	`dbus-registered-functions-table'.
	(dbus-check-event, dbus-handle-event, dbus-event-bus-name)
	(dbus-event-service-name, dbus-event-path-name)
	(dbus-event-interface-name, dbus-event-member-name):
	Rewrite, due to new structure of `dbus-event'.

2007-12-04  Juanma Barranquero  <lekktu@gmail.com>

	* ido.el (ido-save-history): Set the `coding' local
	variable in the first line of the file.

2007-12-04  Glenn Morris  <rgm@gnu.org>

	* password-cache.el: Move here from gnus/password.el.
	(top-level): Don't require cl when compiling.
	(password-read-and-add): Doc fix.  Make obsolete.

	* net/tramp.el: Require password-cache or password.

	* emulation/cua-base.el (top-level): Move (provide 'cua-base) to end.
	No longer provide 'cua.  Don't require cua-rect, cua-gmrk when
	compiling.
	(cua-set-rectangle-mark): Add doc string to autoload.
	(cua--rectangle, cua--last-killed-rectangle)
	(cua--global-mark-active): Always define for compiler.
	(cua-copy-rectangle, cua-cut-rectangle, cua--rectangle-left)
	(cua--delete-rectangle, cua--insert-rectangle)
	(cua--rectangle-corner, cua--rectangle-assert)
	(cua--insert-at-global-mark, cua--global-mark-post-command):
	Declare as functions.

	* emulation/cua-gmrk.el (top-level): Move provide to end.

	* emulation/cua-rect.el (top-level): Move provide to end.
	Don't require cua-gmrk when compiling.
	(cua--cut-rectangle-to-global-mark)
	(cua--copy-rectangle-to-global-mark): Declare as functions.

	* emulation/viper-init.el (viper-replace-overlay-cursor-color)
	(viper-insert-state-cursor-color, viper-emacs-state-cursor-color)
	(viper-vi-state-cursor-color):
	Consolidate make-variable-frame-local calls.

	* net/eudcb-bbdb.el (bbdb-address-streets): Declare as a function.
	(eudc-bbdb-extract-addresses): Use bbdb-address-streets rather
	than bbdb-address-street1,2,3.

	* textmodes/reftex-toc.el (reftex-make-separate-toc-frame):
	Try x-focus-frame before focus-frame.  Only try focus-frame on XEmacs.

2007-12-03  Karl Fogel  <kfogel@red-bean.com>

	* saveplace.el (save-place-quiet): Remove, reverting 1.39.
	(save-place-alist-to-file, load-save-place-alist-from-file):
	Don't print non-error messages at all, there's really no need.
	Do print if there's a problem, and clarify message in that case.

2007-12-03  Dan Nicolaescu  <dann@ics.uci.edu>

	* ediff-diff.el (ediff-prepare-error-list):
	* ediff-util.el (ediff-setup): Disable undo for ediff-error-buffer.

2007-12-03  Tassilo Horn  <tassilo@member.fsf.org>

	* doc-view.el (doc-view-initiate-display): Use `doc-view-mode-p'.
	(doc-view-current-overlay, doc-view-pending-cache-flush):
	Add doc string.

2007-12-03  Richard Stallman  <rms@gnu.org>

	* subr.el (declare-function): Move from byte-run.el.

	* emacs-lisp/byte-run.el (declare-function): Move to subr.el.

	* window.el (recenter-top-bottom): Don't use `ecase'.

2007-12-02  Karl Fogel  <kfogel@red-bean.com>

	* saveplace.el (save-place-alist-to-file):
	Set coding-system-for-write once and refer to it throughout.
	Suggested by David Reitter <dreitter{_AT_}inf.ed.ac.uk>.

2007-12-02  Karl Fogel  <kfogel@red-bean.com>

	* saveplace.el (save-place-alist-to-file): Use `utf-8' coding
	system when writing, and set it in the first-line file variables.
	Suggested by David Reitter <dreitter{_AT_}inf.ed.ac.uk> and
	Juanma Barranquero.

2007-12-02  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/bytecomp.el (byte-compile-declare-function):
	Reverse branches of if statement.

	* emulation/viper-cmd.el (top-level): Don't require advice.
	Don't load viper-util, viper-keym, viper-mous, viper-macs,
	viper-ex when compiling.

	* emulation/viper-ex.el (top-level): Don't load viper-util,
	viper-keym when compiling.

	* emulation/viper-init.el (top-level): Move provide statement to end.

	* emulation/viper-keym.el (top-level): Don't load viper-util when
	compiling.  Move provide statement to end.

	* emulation/viper-macs.el (top-level): Don't load viper-util,
	viper-keym, viper-mous when compiling.

	* emulation/viper-mous.el (top-level): Don't load viper-util when
	compiling.

	* emulation/viper-util.el (top-level): Don't load viper-init when
	compiling.

	* emulation/viper.el (top-level): Don't require ring.
	Don't load viper-init, viper-cmd when compiling.

	* net/sasl-cram.el, net/sasl-digest.el, net/sasl-ntlm.el, net/sasl.el:
	Move here from gnus/.

2007-12-02  Karl Fogel  <kfogel@red-bean.com>

	Offer option for saveplace to be quiet about loading and saving.
	Suggested by David Reitter <dreitter{_AT_}inf.ed.ac.uk>.

	* saveplace.el (save-place-quiet): New customizable boolean.
	(save-place-alist-to-file, load-save-place-alist-from-file): Use it
	to determine whether to print loading/saving messages.

2007-12-02  Glenn Morris  <rgm@gnu.org>

	* mail/binhex.el: Move here from gnus/.
	(binhex): New custom group.
	(binhex-decoder-program, binhex-decoder-switches)
	(binhex-use-external): Move to the binhex custom group.

	* mail/uudecode.el: Move here from gnus/.
	(uudecode): New custom group.
	(uudecode-decoder-program, uudecode-decoder-switches)
	(uudecode-use-external): Move to the uudecode custom group.

	* net/netrc.el (top-level): Don't load `encrypt' features.
	(netrc-parse): Don't use encrypt.
	(netrc-find-service-name, netrc-find-service-number): Don't use caddr.

	* progmodes/python.el (top-level): Don't require cl when compiling.

2007-12-02  Agustín Martín  <agustin.martin@hispalinux.es>

	* textmodes/flyspell.el (flyspell-large-region): Explicitly set
	encoding for aspell process and for communication with it.
	Only add "-d" option if not already present.
	Use ispell-current-dictionary and ispell-current-personal-dictionary.
	General reorganization.

	* textmodes/ispell.el (ispell-aspell-find-dictionary): Do not set
	encoding here.
	(ispell-start-process): Explicitly set encoding here if using aspell.

2007-12-02  Dan Nicolaescu  <dann@ics.uci.edu>

	* pcvs.el (cvs-mode-commit, cvs-mode-edit-log): Also pass a diff
	function to log-edit.

2007-12-02  Michael Albinus  <michael.albinus@gmx.de>

	* net/dbus.el: New file.

2007-12-02  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc.el (calc-lang-slash-idiv, calc-lang-allow-underscores)
	(calc-lang-c-type-hex, calc-lang-brackets-are-subscripts)
	(calc-lang-parens-are-subscripts): New variables.
	(math-expr-special-function-mapping): Remove variable.
	(math-eqn-ignore-words, math-tex-ignore-words)
	(math-latex-ignore-words): Move to calc-lang.el.

	* calc/calc-lang.el (math-compose-vector, math-compose-var)
	(math-tex-expr-is-flat): Declare as functions.
	(calc-lang-slash-idiv, calc-lang-allow-underscores)
	(math-comp-left-bracket, math-comp-right-bracket)
	(math-comp-comma, math-comp-vector-prec): Declare as variables.
	(math-var-formatter, math-matrix-formatter)
	(math-lang-adjust-words, math-lang-read-symbol, math-land-read)
	(math-punc-table, math-compose-subscr, math-dots)
	(math-func-formatter): New property names to store language
	specific information.
	(math-compose-tex-var, math-compose-tex-intv)
	(math-compose-maple-intv, math-compose-eqn-intv)
	(math-compose-tex-sum, math-compose-tex-func)
	(math-compose-tex-intv): New functions.
	(math-eqn-ignore-words, math-tex-ignore-words)
	(math-latex-ignore-words): Move from calc.el.
	(math-special-function-table): Add entries for tex.
	(calc-lang-slash-idiv, calc-lang-allows-underscores):
	New variables.
	(math-compose-latex-frac): Rename from `math-latex-print-frac'.
	(math-compose-tex-matrix, math-compose-eqn-matrix)
	(math-eqn-special-functions): Move from calccomp.el.

	* calc/calccomp.el (math-compose-var): New function.
	(math-compose-expr): Allow more special functions to be used.
	Change test for formatting fractions.  Use variables and property
	names to help with language specific formatting.
	(math-compose-tex-matrix, math-compose-eqn-matrix)
	(math-eqn-special-functions): Move to calc-lang.el.
	(math-compose-rows): Use property names to help with language
	specific formatting.

	* calc/calc-aent.el (math-read-factor): Turn multiple subscripts
	into nested subscripts.
	(math-read-token): Use variables and property names to help with
	language specific parsing.
	(math-read-expression-level): Use variables to help with language
	specific parsing.

2007-12-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* arc-mode.el (archive-find-type): Add recognition of rar-exe format.
	(archive-rar-summarize): Allow the file name to be passed as argument.
	Remove unused vars `header' and `footer'.
	(archive-rar-exe-summarize, archive-rar-exe-extract): New functions.

2007-12-01  Dan Nicolaescu  <dann@ics.uci.edu>

	* log-edit.el (log-edit-show-diff): New function.
	(log-edit-mode-map, log-edit-menu): Bind it.
	(log-edit-diff-function): New variable.
	(log-edit): Change the 3rd param to be an alist and accept a
	function that computes a diff for the files involved.

	* vc.el (vc-log-edit): Add a diff function parameter to log-edit.

2007-12-01  Martin Rudalics  <rudalics@gmx.at>

	* play/blackbox.el (bb-up, bb-down): Revert 2007-10-21 change and
	wrap next-/previous-line in with-no-warnings.

2007-12-01  Glenn Morris  <rgm@gnu.org>

	* format-spec.el, hex-util.el, sha1.el: Move here from gnus/.

	* net/dig.el: Move here from gnus/.
	(dig-mode): Replace gnus-run-mode-hooks with equivalent expansion.

	* net/dns.el: Move here from gnus/.
	(top-level): Don't require mm-util, or cl when compiling.
	(dns-write-name, dns-read, dns-read-type, query-dns):
	Replace mm-with-unibyte-buffer with its expansion.
	(query-dns): Replace decf and ignore-errors with non-cl equivalents.

	* progmodes/gdb-ui.el (gud-remove, gud-break):
	* progmodes/gud.el (gdb-create-define-alist)
	(gdb-restore-windows, gdb-reset, global-hl-line-highlight)
	(hl-line-highlight, gdb-display-source-buffer)
	(gdb-display-buffer, c-langelem-sym, c-langelem-pos)
	(syntax-symbol, syntax-point, gdb-enqueue-input): Declare as functions.

2007-11-30  Dan Nicolaescu  <dann@ics.uci.edu>

	* textmodes/org-export-latex.el (org-export-latex-cleaned-string):
	Move args on defun line.

	* textmodes/org.el (org-calendar-holiday):
	Use calendar-check-holidays instead of the obsolete
	check-calendar-holidays.
	(add-to-diary-list, table--at-cell-p, Info-find-node, bbdb)
	(bbdb-company, bbdb-current-record, bbdb-name)
	(bbdb-record-getprop, bbdb-record-name)
	(bibtex-beginning-of-entry, bibtex-generate-autokey)
	(bibtex-parse-entry, bibtex-url, cdlatex-tab)
	(dired-get-filename, gnus-article-show-summary, mh-display-msg)
	(mh-find-path, mh-get-header-field, mh-get-msg-num)
	(mh-header-display, mh-index-previous-folder)
	(mh-normalize-folder-name, mh-search, mh-search-choose, mh-show)
	(mh-show-buffer-message-number, mh-show-header-display)
	(mh-show-msg, mh-show-show, mh-visit-folder)
	(org-export-latex-cleaned-string, remember)
	(remember-buffer-desc, rmail-narrow-to-non-pruned-header)
	(rmail-what-message, elmo-folder-exists-p)
	(elmo-message-entity-field, elmo-message-field)
	(vm-beginning-of-message, vm-follow-summary-cursor)
	(vm-get-header-contents, vm-isearch-narrow, vm-isearch-update)
	(vm-select-folder-buffer, vm-su-message-id, vm-su-subject)
	(vm-summarize, wl-folder-get-elmo-folder)
	(wl-summary-goto-folder-subr)
	(wl-summary-jump-to-msg-by-message-id, wl-summary-line-from)
	(wl-summary-line-subject, wl-summary-message-number)
	(wl-summary-redisplay): Declare as functions.

2007-11-30  Martin Rudalics  <rudalics@gmx.at>

	* longlines.el (longlines-show-hard-newlines): Remove handling of
	buffer-undo-list and buffer-modified status.
	(longlines-show-region, longlines-unshow-hard-newlines):
	Handle buffer-undo-list, buffer-modified status, inhibit-read-only, and
	inhibit-modification-hooks here to avoid that a buffer appears
	modified when toggling visibility of hard newlines.

2007-11-30  Glenn Morris  <rgm@gnu.org>

	* nxml/rng-maint.el (rng-do-some-validation): Fix declaration.

	* progmodes/idlw-complete-structtag.el
	(idlwave-sintern-structtag):
	* progmodes/idlw-help.el (idlwave-sintern-sysvar)
	(idlwave-sintern-sysvartag):
	* progmodes/idlwave.el (idlwave-sintern-class-tag)
	(idlwave-sintern-sysvar, idlwave-sintern-sysvartag): Declare as
	functions.

2007-11-30  Dan Nicolaescu  <dann@ics.uci.edu>

	* textmodes/reftex-index.el (texmathp):
	* textmodes/reftex-auc.el (TeX-argument-insert)
	(TeX-argument-prompt, multi-prompt, LaTeX-add-index-entries)
	(LaTeX-add-labels, LaTeX-bibitem-list, LaTeX-index-entry-list)
	(LaTeX-label-list):
	* nxml/rng-maint.el (rng-clear-cached-state, rng-clear-overlays)
	(rng-clear-conditional-region, rng-do-some-validation): Declare as
	functions.
	(rng-error-count, rng-validate-up-to-date-end): Pacify byte compiler.

2007-11-30  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/byte-run.el (declare-function): Add optional fourth
	argument and document it.

	* emacs-lisp/bytecomp.el (byte-compile-declare-function):
	Third argument to declare-function must be a list to specify arglist.

	* emacs-lisp/check-declare.el (check-declare-scan): Doc fix.
	Handle declare-function third argument `t' and fourth argument.
	(check-declare-verify): Doc fix.  Handle `fileonly' case.
	Use progn rather than prog1.

	* desktop.el (uniquify-item-base):
	* term/mac-win.el (url-type): Declare as functions.

	* net/eudcb-bbdb.el (bbdb-phone-location, bbdb-record-phones)
	(bbdb-address-city, bbdb-address-state, bbdb-address-zip)
	(bbdb-address-location, bbdb-record-addresses): Pass non-nil
	fourth arg to declare-function.

	* play/dunnet.el: Don't require cl when compiling.
	(byte-compile-warnings): Set via file local variables.
	(dun-parse): Let-bind `beg' and `line'.

2007-11-29  Alexandre Julliard  <julliard@winehq.org>

	* vc-git.el (vc-git-dir-state): Fix the git command arguments.

2007-11-29  Ari Roponen  <ari.roponen@gmail.com>  (tiny change)

	* calendar/time-date.el (encode-time-value): Doc fix.

2007-11-29  Glenn Morris  <rgm@gnu.org>

	* calendar/time-date.el (with-decoded-time-value): Doc fix.

	* textmodes/css-mode.el (prog-mode): Remove.
	(css-mode): Derive from fundamental-mode rather than prog-mode.

	* emacs-lisp/byte-run.el (declare-function): Doc fix.

	* emacs-lisp/check-declare.el (check-declare-locate)
	(check-declare-verify): Handle `external' files.
	(check-declare-errmsg): New function.
	(check-declare-verify, check-declare-file, check-declare-directory):
	Use check-declare-errmsg to report the number of problems.

	* ffap.el (w3-view-this-url)
	* mail/mspools.el (vm-visit-folder)
	* net/browse-url.el (w3-fetch-other-window, w3-fetch)
	* net/eudcb-bbdb.el (bbdb-phone-location, bbdb-phone-string)
	(bbdb-record-phones, bbdb-address-city, bbdb-address-state)
	(bbdb-address-zip, bbdb-address-location, bbdb-record-addresses)
	(bbdb-records)
	* net/eudc-export.el (bbdb-parse-phone-number, bbdb-string-trim)
	* net/imap.el (sasl-find-mechanism, sasl-mechanism-name)
	(sasl-make-client, sasl-next-step, sasl-step-data)
	(sasl-step-set-data)
	* net/newsticker.el (w3m-toggle-inline-image, htmlr-reset)
	(htmlr-step): Declare as functions.

	* net/eudcb-bbdb.el (eudc-bbdb-extract-addresses):
	Use bbdb-address-zip rather than bbdb-address-zip-string.

2007-11-28  Richard Stallman  <rms@gnu.org>

	* md4.el, net/hmac-def.el, net/hmac-md5.el, net/ntlm.el:
	Move here from gnus/.

2007-11-28  Martin Rudalics  <rudalics@gmx.at>

	* newcomment.el (comment-region-internal): Fix newline insertion
	in `block' case.

2007-11-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcvs-parse.el (cvs-parse-table): Adjust regexp for resurrections.

2007-11-28  Glenn Morris  <rgm@gnu.org>

	* Makefile.in (maintainer-clean): Depend on bootstrap-clean to
	delete .elc files.

	* nxml/char-name/unicode: Move to etc/nxml/.
	* nxml/nxml-uchnm.el (top-level): Adapt for moved Unicode files.

	* nxml/nxml-enc.el (xmltok-get-declared-encoding-position):
	Declare as a function.

	* nxml/nxml-maint.el (nxml-create-unicode-char-name-sets):
	* nxml/nxml-mode.el (nxml-get-char-name, nxml-insert-named-char):
	* nxml/xsd-regexp.el (xsdre-gen-categories): Change mapcar -> mapc.

	* nxml/nxml-outln.el (nxml-token-start-tag-p)
	(nxml-token-end-tag-p): Move definitions before use.

	* nxml/nxml-rap.el (nxml-prolog-regions): Declare for compiler.

	* nxml/nxml-uchnm.el (top-level)
	(nxml-enable-unicode-char-name-sets-1): Use mapc rather than mapcar.
	(nxml-enabled-unicode-blocks): Add custom group.

	* nxml/xmltok.el (xmltok-scan-char-ref, xmltok-char-number):
	Use string-to-number rather than string-to-int.

	* dired-x.el (dired-omit-old-add-entry): Declare as function.
	Move definition before use.
	(dired-old-find-buffer-nocreate): Declare as function.

	* emacs-lisp/check-declare.el (check-declare-locate): Reflow doc.
	(check-declare-verify): Handle fset.

	* emulation/edt.el (edt-user-emulation-setup):
	Test edt-setup-user-bindings is bound before calling.

	* emulation/tpu-edt.el: Don't require cl when compiling.
	(tpu-emacs-search, tpu-emacs-rev-search): Declare as functions.
	(tpu-edt-off): Use condition-case rather than ignore-errors.
	Use with-no-warnings.

	* eshell/esh-util.el (top-level): Use require rather than load for
	ange-ftp.

	* mail/supercite.el (sc-version): Redefine as an alias for
	emacs-version.
	(sc-help-address): Remove.
	(sc-version): Use emacs-version rather than sc-version.
	(sc-submit-bug-report): Redefine as an alias for report-emacs-bug.

	* net/socks.el (socks-original-open-network-stream): Declare as
	function.  Move definition before use.

2007-11-28  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-ext.el (math-sqrt-raw, math-map-vec)
	(math-make-frac): Declare as functions.

2007-11-27  Dan Nicolaescu  <dann@ics.uci.edu>

	* progmodes/cperl-mode.el (compilation-error-regexp-alist):
	Pacify byte compiler.
	(cperl-mode): Use with-no-warnings for setting vc-header-alist.

	* progmodes/idlwave.el (idlwave-shell-get-path-info)
	(idlwave-shell-temp-file, idlwave-shell-is-running)
	(widget-value, comint-dynamic-complete-filename, Info-goto-node):
	* progmodes/idlw-help.el (idlwave-prepare-structure-tag-completion)
	(idlwave-all-method-classes, idlwave-all-method-keyword-classes)
	(idlwave-beginning-of-statement, idlwave-best-rinfo-assoc)
	(idlwave-class-found-in, idlwave-class-or-superclass-with-tag)
	(idlwave-completing-read, idlwave-current-routine)
	(idlwave-downcase-safe, idlwave-entry-find-keyword)
	(idlwave-expand-keyword, idlwave-find-class-definition)
	(idlwave-find-inherited-class, idlwave-find-struct-tag)
	(idlwave-get-buffer-visiting, idlwave-in-quote)
	(idlwave-make-full-name, idlwave-members-only)
	(idlwave-popup-select, idlwave-routine-source-file)
	(idlwave-routines, idlwave-sintern-class)
	(idlwave-sintern-keyword, idlwave-sintern-method)
	(idlwave-sintern-routine-or-method)
	(idlwave-substitute-link-target, idlwave-sys-dir)
	(idlwave-this-word, idlwave-what-module-find-class)
	(idlwave-where):
	* progmodes/idlw-complete-structtag.el (idlwave-shell-buffer):
	* mail/uce.el (rmail-msg-is-pruned)
	(rmail-maybe-set-message-counters, rmail-msgbeg, rmail-msgend)
	(rmail-toggle-header):
	* mail/sendmail.el (dired-view-file, dired-get-filename):
	* mail/rmailkwd.el (rmail-maybe-set-message-counters)
	(rmail-display-labels, rmail-msgbeg)
	(rmail-set-message-deleted-p, rmail-message-labels-p)
	(rmail-show-message, mail-comma-list-regexp)
	(mail-parse-comma-list):
	* mail/rmail.el (rmail-spam-filter, rmail-summary-goto-msg)
	(rmail-summary-mark-undeleted, rmail-summary-mark-deleted)
	(rfc822-addresses, mail-abbrev-make-syntax-table)
	(mail-sendmail-delimit-header, mail-header-end):
	* mail/hashcash.el (message-narrow-to-headers-or-head)
	(message-fetch-field, message-goto-eoh)
	(message-narrow-to-headers):
	* vc.el (view-mode-exit): Declare as functions.

	* mail/vms-pmail.el:
	* vmsproc.el:
	* vms-patch.el: Don't byte compile these files, they don't work.

2007-11-27  Glenn Morris  <rgm@gnu.org>

	* calc/calc-ext.el (math-read-big-rec):
	* calc/calc-nlfit.el (math-map-binop):
	* calc/calc.el (math-normalize-nonstandard): Fix declarations.

	* eshell/eshell.el (eshell-report-bug): Add version number of
	obsolescence.

	* emulation/viper.el, emulation/viper-util.el,
	emulation/viper-macs.el, emulation/viper-keym.el,
	emulation/viper-ex.el, emulation/viper-cmd.el:
	Load viper-*.el files silently.

	* ediff-diff.el, ediff-help.el, ediff-merg.el, ediff-mult.el,
	ediff-ptch.el, ediff-util.el, ediff-vers.el, ediff-wind.el, ediff.el:
	Load ediff-*.el files silently.

	* ediff.el: Load dired silently.  Don't load info, pcl-cvs when
	compiling.
	(Info-goto-node): Declare as a function.

	* ediff-init.el: Don't load ange-ftp when compiling.
	* ediff-util.el: Don't load reporter when compiling.

	* ediff-wind.el (ediff-display-pixel-width)
	(ediff-display-pixel-height):
	* generic-x.el (ini-generic-mode):
	* ps-print.el (ps-mule-encode-header-string, ps-mule-begin-page)
	(ps-mule-prepare-ascii-font, ps-mule-set-ascii-font)
	(ps-mule-initialize, ps-mule-begin-job):
	* calendar/cal-bahai.el (add-to-diary-list, diary-name-pattern)
	(mark-calendar-days-named):
	* calendar/cal-hebrew.el (holiday-filter-visible-calendar)
	(add-to-diary-list, diary-name-pattern)
	(mark-calendar-days-named):
	* calendar/cal-islam.el (add-to-diary-list, diary-name-pattern)
	(mark-calendar-days-named):
	* calendar/cal-x.el (make-fancy-diary-buffer):
	* calendar/holidays.el (calendar-absolute-from-julian):
	* calendar/todo-mode.el (calendar-current-date):
	* calendar/cal-menu.el (calendar-increment-month)
	(calendar-month-name, extract-calendar-year)
	(calendar-cursor-to-date, holiday-list, calendar-sunrise-sunset)
	(calendar-current-date, calendar-cursor-holidays)
	(calendar-date-string, insert-diary-entry, calendar-set-mark)
	(cal-tex-cursor-day, cal-tex-cursor-week, cal-tex-cursor-week2)
	(cal-tex-cursor-week-iso, cal-tex-cursor-week-monday)
	(cal-tex-cursor-filofax-daily, cal-tex-cursor-filofax-2week)
	(cal-tex-cursor-filofax-week, cal-tex-cursor-month)
	(cal-tex-cursor-month-landscape, cal-tex-cursor-year)
	(cal-tex-cursor-filofax-year, cal-tex-cursor-year-landscape)
	(calendar-day-of-year-string, calendar-iso-date-string)
	(calendar-julian-date-string, calendar-astro-date-string)
	(calendar-absolute-from-gregorian, calendar-hebrew-date-string)
	(calendar-persian-date-string, calendar-bahai-date-string)
	(calendar-islamic-date-string, calendar-chinese-date-string)
	(calendar-coptic-date-string, calendar-ethiopic-date-string)
	(calendar-french-date-string, calendar-mayan-date-string)
	(calendar-print-chinese-date, calendar-goto-date):
	Declare as functions.

	* calendar/calendar.el (nongregorian-diary-listing-hook): Doc fix.
	(Info-find-emacs-command-nodes, Info-find-node): Declare as functions.

	* ffap.el (ffap-bug, ffap-submit-bug): Redefine as obsolete
	aliases for report-emacs-bug.
	(gnus-summary-select-article, gnus-configure-windows): Declare as
	functions.

	* pgg-parse.el (pgg-parse-24, pgg-parse-crc24-string): Declare for
	compiler.

	* pgg.el (pgg-clear-string): Declare as a function.
	(pgg-run-at-time-1): Wrap whole definition in (featurep 'xemacs) test.
	(pgg-run-at-time, pgg-cancel-timer): Move definitions before use.

	* emacs-lisp/check-declare.el (check-declare-locate):
	Handle compressed files.
	(check-declare-verify): Handle define-generic-mode,
	define-global(ized)-minor-mode, define-obsolete-function-alias.

2007-11-27  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-menu.el (calc-modes-menu): Add normal and incomplete
	algebraic modes.

	* calc/calc-aent.el (calc-refresh-evaltos, calc-execute-kbd-macro)
	(math-is-true, calc-explain-why, calc-alg-edit)
	(math-composite-inequalities, math-flatten-lands)
	(math-multi-subst, calcFunc-vmatches, math-simplify)
	(math-known-matrixp, math-parse-fortran-subscr, math-to-radians-2)
	(math-read-string, math-read-brackets, math-read-angle-brackets):
	Declare as functions.

	* calc/calcalg3.el (calc-fit-s-shaped-logistic-curve)
	(calc-fit-bell-shaped-logistic-curve)
	(calc-fit-hubbert-linear-curve, calc-graph-add-curve)
	(calc-graph-lookup, calc-graph-set-styles, math-min-list)
	(math-max-list): Declare as functions.
	(math-map-binop): New function.
	(calc-curve-fit): Replace `mapcar*' by `math-map-binop'.

	* calc/calc.el (calc-set-language, calc-edit-finish)
	(calc-edit-cancel, calc-do-quick-calc, calc-do-calc-eval)
	(calc-do-keypad, calcFunc-unixtime, math-parse-date)
	(math-lessp, calc-embedded-finish-command)
	(calc-embedded-select-buffer, calc-embedded-mode-line-change)
	(calc-push-list-in-macro, calc-replace-selections)
	(calc-record-list, calc-normalize-fancy, calc-do-handle-whys)
	(calc-top-selected, calc-sel-error, calc-pop-stack-in-macro)
	(calc-embedded-stack-change, calc-refresh-evaltos)
	(calc-do-refresh, calc-binary-op-fancy, calc-unary-op-fancy)
	(calc-delete-selection, calc-alg-digit-entry, calc-alg-entry)
	(calc-dots, calc-temp-minibuffer-message, math-read-radix-digit)
	(calc-digit-dots, math-normalize-fancy, math-normalize-nonstandard)
	(math-recompile-eval-rules, math-apply-rewrites, calc-record-why)
	(math-dimension-error, calc-incomplete-error, math-float-fancy)
	(math-neg-fancy, math-zerop, calc-add-fractions)
	(math-add-objects-fancy, math-add-symb-fancy, math-mul-zero)
	(calc-mul-fractions, math-mul-objects-fancy, math-mul-symb-fancy)
	(math-reject-arg, math-div-by-zero, math-div-zero, math-make-frac)
	(calc-div-fractions, math-div-objects-fancy, math-div-symb-fancy)
	(math-compose-expr, math-comp-width, math-composition-to-string)
	(math-stack-value-offset-fancy, math-format-flat-expr-fancy)
	(math-adjust-fraction, math-format-binary, math-format-radix)
	(math-group-float, math-mod, math-format-number-fancy)
	(math-format-bignum-fancy, math-read-number-fancy)
	(calc-do-grab-region, calc-do-grab-rectangle, calc-do-embedded)
	(calc-do-embedded-activate, math-do-defmath)
	(calc-load-everything): Declare as functions.

	* calc/calc-ext.el (math-clip, math-round, math-simplify)
	(math-simplify-extended, math-simplify-units, calc-set-language)
	(calc-flush-caches, calc-save-modes, calc-embedded-modes-change)
	(calc-embedded-var-change, math-mul-float, math-arctan-raw)
	(math-sqrt-float, math-exp-minus-1-raw, math-normalize-polar)
	(math-normalize-hms, math-normalize-mod, math-make-sdev)
	(math-make-intv, math-normalize-logical-op, math-possible-signs)
	(math-infinite-dir, math-calcFunc-to-var)
	(calc-embedded-evaluate-expr, math-known-nonzerop)
	(math-read-expr-level, math-read-big-rec, math-read-big-balance)
	(math-format-date, math-vector-is-string, math-vector-to-string)
	(math-format-radix-float, math-compose-expr, math-abs)
	(math-format-bignum-binary, math-format-bignum-octal)
	(math-format-bignum-hex, math-format-bignum-radix)
	(math-compute-max-digits): Declare as functions.
	(math-provably-realp): Fix typo.

	* calc/calc-forms.el (calendar-current-time-zone)
	(calendar-absolute-from-gregorian, dst-in-effect): Declare as
	functions.

	* calc/calc-help.el (Info-goto-node, Info-last): Declare as functions.

	* calc/calc-lang.el (math-read-factor, math-read-expr-level):
	Declare as functions.

	* calc/calc-macs.el (math-zerop, math-negp, math-looks-negp)
	(math-posp, math-compare, math-bignum, math-compare-bignum):
	Declare as functions.

	* calc/calc-misc.el (calc-do-keypad, calc-inv-hyp-prefix-help)
	(calc-inverse-prefix-help, calc-hyperbolic-prefix-help)
	(calc-explain-why, calc-clear-command-flag)
	(calc-roll-down-with-selections, calc-roll-up-with-selections)
	(calc-last-args, calc-is-inverse, calc-do-prefix-help)
	(math-objvecp, math-known-scalarp, math-vectorp, math-matrixp)
	(math-trunc-special, math-trunc-fancy, math-floor-special)
	(math-floor-fancy, math-square-matrixp, math-matrix-inv-raw)
	(math-known-matrixp, math-mod-fancy, math-pow-of-zero)
	(math-pow-zero, math-pow-fancy): Declare as functions.

	* calc/calc-mode.el (calc-embedded-save-original-modes):
	Declare as a function.

	* calc/calc-nlfit.el (calc-get-fit-variables, math-map-binop):
	Declare as functions.
	(math-nlfit-make-matrix, math-nlfit-find-qmax, math-nlfit-fit)
	(math-nlfit-fit-curve, calc-fit-hubbert-linear-curve):
	Replace `mapcar*' by `math-map-binop'.
	(math-nlfit-make-matrix): Replace `copy-list' with `copy-sequence'.

	* calc/calc-prog.el (edmacro-format-keys, edmacro-parse-keys)
	(math-read-expr-level): Declare as functions.

	* calc/calc-vec.el (math-read-expr-level): Declare as a function.

2007-11-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/lisp.el (end-of-defun): Restructure so that
	end-of-defun-function is called consistently, even for negative
	arguments.
	(end-of-defun-function): Default to forward-sexp.

2007-11-26  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/bytecomp.el (batch-byte-recompile-directory): Doc fix.

2007-11-26  Glenn Morris  <rgm@gnu.org>

	* calendar/cal-menu.el (cal-menu-holidays-menu): Use :label rather
	than :suffix.

	* emacs-lisp/easymenu.el (easy-menu-define): Doc fix.

2007-11-26  Simon Josefsson  <simon@josefsson.org>

	* net/imap.el: Move from ../gnus.

2007-11-25  Reiner Steib  <Reiner.Steib@gmx.de>

	* doc-view.el (doc-view-mode-p): New function.

2007-11-25  Dan Nicolaescu  <dann@ics.uci.edu>

	* mail/mspools.el (rmail-get-new-mail):
	* mail/reporter.el (mail-position-on-field, mail-text):
	* mail/rmail.el (mail-position-on-field, mail-text-start)
	(rmail-update-summary):
	* mail/rmailedit.el (rmail-summary-disable, rmail-summary-enable):
	* mail/rmailmsc.el (rmail-parse-file-inboxes, rmail-show-message):
	* mail/rmailout.el (rmail-update-summary):
	* mail/rmailsort.el (rmail-update-summary):
	* mail/sendmail.el (dired-move-to-filename, dired-get-filename)
	(dired-view-file):
	* mail/uce.el (mail-strip-quoted-names):
	* mail/undigest.el (rmail-update-summary):
	* mail/unrmail.el (mail-strip-quoted-names):
	* ediff.el (diff-latest-backup-file): Declare as functions.

	* obsolete/mlsupport.el (ml-previous-page): Fix typo.
	(kill-to-end-of-line):
	* obsolete/rnews.el (news-set-minor-modes):
	Remove non working functions.

2007-11-25  Glenn Morris  <rgm@gnu.org>

	* eshell/esh-maint.el (top-level): Use require with NOERROR for
	pcomplete.  Don't mess with load-path.

	* eshell/eshell.el (eshell-report-bug-address): Remove.
	(eshell-report-bug): Redefine as an alias for report-emacs-bug.

2007-11-24  Glenn Morris  <rgm@gnu.org>

	* calendar/appt.el: Remove leading `*' from defcustom doc-strings.
	(appt-disp-window): Don't require electric.
	Simplify minibuffer-avoidance code.
	(appt-select-lowest-window): Avoid minibuffer.

	* eshell/eshell.el: Remove leading `*' from defcustom doc-strings.
	(esh-mode): Require it.
	(esh-util): Use require rather than featurep and load.
	(eshell): No need to test if eshell-mode is bound; remove obsolete
	reference to eshell-auto.
	(eshell-command, eshell-command-result): Don't require esh-mode
	now that the file does.
	(top-level): Move provide statement to the end of the file.
	Re-order and update commentary.

2007-11-24  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* vc.el (vc-annotate-mode): Frob buffer invisibility spec.
	(vc-annotate-toggle-annotation-visibility): New command.
	(vc-annotate-mode-map): Bind "V" to it.
	(vc-annotate-mode-menu): Add entry for it.
	(vc-annotate-get-time-set-line-props): New func.
	(vc-annotate-display-autoscale)
	(vc-annotate-display-difference): Use it.

	* vc-git.el (vc-git-annotate-time): Handle optional field FILENAME.
	Also, match one space at end of annotation text, after last paren.

2007-11-24  Michael Albinus  <michael.albinus@gmx.de>

	* ido.el (ido-file-name-all-completions-1): Check for fboundp of
	`tramp-completion-mode-p' as it is in Tramp 2.1.  Let-bind
	`tramp-completion-mode'.

2007-11-24  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* vc-git.el (vc-git-show-log-entry): New func.

	* vc-git.el (vc-git--call, vc-git--out-ok): New funcs.
	(vc-git-state): Use vc-git--call.
	(vc-git-registered, vc-git-working-revision)
	(vc-git-previous-revision, vc-git-next-revision)
	(vc-git--run-command-string, vc-git-symbolic-commit):
	Use vc-git--out-ok.

2007-11-24  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/byte-run.el (declare-function): Doc fix.

2007-11-24  Kenichi Handa  <handa@m17n.org>

	* international/ucs-tables.el (ucs-8859-7-alist): Update the table.

2007-11-23  David Kastrup  <dak@gnu.org>

	* server.el (server-process-filter): Use `command-line-args-left'.

2007-11-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* nxml/subdirs.el, nxml/char-data/subdirs.el, nxml/rng-auto.el: Remove.

2007-11-23  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el (vc-deduce-fileset): Also look for a fileset in the parent
	buffer if the parent buffer is in vc-dired-mode.

2007-11-23  Mark A. Hershberger  <mah@everybody.org>
	    James Clark  <none@example.com>

	* nxml/: Initial merge of nxml.  Kept nxml/char-name subdir for now.

2007-11-23  Juri Linkov  <juri@jurta.org>

	* dired.el (dired-read-dir-and-switches): For C-x d, set the
	value for M-n to the visited file name of the current buffer.
	Use minibuffer-with-setup-hook to set minibuffer-default to
	buffer-file-name inside read-file-name.

	* man.el (Man-getpage-in-background): Don't disregard user option
	`Man-width' on non-window systems.  Remove test for `window-system'
	around setting envvar "COLUMNS" depending on the value of `Man-width'.

	* progmodes/grep.el (grep-process-setup): Set envvar "TERM" to
	"emacs-grep".  Set envvar "GREP_OPTIONS" to "--color=auto" instead
	of "--color=always".

2007-11-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/lisp.el (beginning-of-defun-raw): Pass `arg' down to
	beginning-of-defun-function.

2007-11-22  Reiner Steib  <Reiner.Steib@gmx.de>

	* mail/hashcash.el: Move from ../gnus.  Add hashcash payments to email.

2007-11-22  Glenn Morris  <rgm@gnu.org>

	* emulation/cua-base.el (x-clipboard-yank): Fix declaration.

	* emacs-lisp/check-declare.el (check-declare-locate): New function.
	(check-declare-scan): Use check-declare-locate.
	(check-declare-verify): No longer adjust fnfile, now
	check-declare-locate does it.

	* emacs-lisp/byte-run.el (declare-function): Doc fix.

2007-11-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (posn-col-row): Make the `default-value' use explicit.

	* window.el (balance-windows): Remove unused var `counter'.
	(bw-balance-sub): Remove unused var `lastchild'.
	(split-window-vertically): Remove unused var `switch'.
	(recenter-top-bottom): Remove unused vars `bottom', `current', `total'.

	* emacs-lisp/bytecomp.el
	(byte-compile-file-form-custom-declare-variable): Simplify.

2007-11-22  Juanma Barranquero  <lekktu@gmail.com>

	* cus-edit.el (custom-mode): Define with `define-derived-mode'.
	Set `show-trailing-whitespace' to nil.

	* dired.el (make-symbolic-link):
	* dired-aux.el (mailcap-parse-mailcaps, mailcap-parse-mimetypes)
	(mailcap-extension-to-mime, mailcap-mime-info, make-symbolic-link):
	* dired-x.el (make-symbolic-link):
	* frame.el (x-initialize-window-system):
	* menu-bar.el (x-menu-bar-open):
	* select.el (x-get-cut-buffer-internal, x-rotate-cut-buffers-internal)
	(x-store-cut-buffer-internal):
	* wdired.el (make-symbolic-link):
	* x-dnd.el (x-register-dnd-atom, x-get-atom-name)
	(x-send-client-message):
	* emulation/cua-base.el (x-clipboard-yank): Declare as functions.

2007-11-22  Jan Djärv  <jan.h.d@swipnet.se>

	* term/x-win.el (x-gtk-map-stock): Check if FILE is a string.

2007-11-22  Glenn Morris  <rgm@gnu.org>

	* dos-fns.el (int86):
	* term/mac-win.el (mac-font-panel-mode): Fix declarations.

	* calendar/cal-menu.el (cal-menu-holidays-menu): Fix holiday-list call.

	* calendar/holidays.el (holiday-list): Add autoload cookie.

	* emacs-lisp/check-declare.el (check-declare-scan): Expand .c
	files relative to src/ directory.
	(check-declare-verify): Handle .c files.  Warn if could not find
	an arglist to check.

	* emacs-lisp/byte-run.el (declare-function): Doc fix.

2007-11-22  Dan Nicolaescu  <dann@ics.uci.edu>

	* replace.el (occur-mode-map): Add a major mode menu with entries
	for all occur operations.

	* international/titdic-cnv.el (dos-8+3-filename):
	* obsolete/fast-lock.el (msdos-long-file-names):
	* frame.el (msdos-mouse-p):
	* files.el (msdos-long-file-names, w32-long-file-name):
	* term/mac-win.el (mac-code-convert-string, mac-coerce-ae-data)
	(mac-resume-apple-event, mac-font-panel-mode)
	(mac-atsu-font-face-attributes, mac-ae-set-reply-parameter)
	(mac-clear-font-name-table):
	* term/pc-win.el (msdos-remember-default-colors)
	(w16-set-clipboard-data, w16-get-clipboard-data):
	* term/w32-win.el (w32-send-sys-command, w32-select-font)
	(set-message-beep):
	* net/browse-url.el (w32-shell-execute):
	* w32-fns.el (set-message-beep, w32-get-clipboard-data)
	(w32-get-locale-info, w32-get-valid-locale-ids)
	(w32-set-clipboard-data):
	* dos-fns.el (int86, msdos-long-file-names):
	* dos-w32.el (default-printer-name): Declare as functions.

2007-11-21  Jason Rumney  <jasonr@gnu.org>

	* emacs-lisp/byte-run.el (declare-function): Return nil.

2007-11-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/sh-script.el (sh-mode): Set defun-prompt-regexp.

2007-11-21  Juanma Barranquero  <lekktu@gmail.com>

	* w32-fns.el: Undo 2007-11-21 change by Dan Nicolaescu.

2007-11-21  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/check-declare.el (check-declare-verify): Skip C files
	for now.  Handle define-minor-mode, and defalias (with no argument
	checking).

2007-11-21  Dan Nicolaescu  <dann@ics.uci.edu>

	* frame.el (msdos-mouse-p):
	* files.el (msdos-long-file-names, w32-long-file-name):
	* term/mac-win.el (mac-code-convert-string, mac-coerce-ae-data)
	(mac-resume-apple-event, mac-font-panel-mode)
	(mac-atsu-font-face-attributes, mac-ae-set-reply-parameter)
	(mac-clear-font-name-table):
	* term/pc-win.el (msdos-remember-default-colors)
	(w16-set-clipboard-data, w16-get-clipboard-data):
	* term/w32-win.el (w32-send-sys-command, w32-select-font)
	(set-message-beep):
	* net/browse-url.el (w32-shell-execute):
	* dos-fns.el (int86, msdos-long-file-names):
	* dos-w32.el (default-printer-name): Undo previous change.

2007-11-21  Eli Zaretskii  <eliz@gnu.org>

	* international/mule-cmds.el (set-locale-environment):
	Set default-file-name-coding-system _after_ keyboard and terminal
	coding systems.  This fixes last change.

	* mail/rmail.el (rmail-current-subject-regexp): Allow more than
	one space after "Subject:".

2007-11-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcvs-parse.el (cvs-parse-table): Ignore errors when looking up files
	in order to determine if there's a conflict.

2007-11-21  Richard Stallman  <rms@gnu.org>

	* bindings.el (esc-map): Bind C-M-l here; moved from reposition.el.

	* reposition.el (reposition-window):
	Binding C-M-l moved to bindings.el.

	* bindings.el (ctl-x-4-map): Bind C-x 4 a here; moved from add-log.el.

	* add-log.el (add-change-log-entry-other-window):
	Key binding C-x 4 a moved to bindings.el.

	* bindings.el (minibuffer-local-map): Bind C-tab here; moved
	from filecache.el.

	* filecache.el: Minibuffer map bindings moved to bindings.el.

2007-11-21  Jason Rumney  <jasonr@gnu.org>

	* international/mule-cmds.el (set-locale-environment):
	Set default-file-name-coding-system from system defaults on Windows.

2007-11-21  Jason Rumney  <jasonr@gnu.org>

	* term/w32console.el: New term init file for w32 console.

	* w32-fns.el (x-alternatives-map): Copy from term/x-win.el.
	(x-setup-function-keys): Likewise, replacing top-level key definitions.
	(w32-tty-standard-colors): Move to term/w32console.el.

	* term/w32-win.el (x-setup-function-keys): Remove.

	* term/tty-colors.el (tty-register-default-colors): Remove special
	case for w32.

2007-11-21  Dan Nicolaescu  <dann@ics.uci.edu>

	* frame.el (msdos-mouse-p):
	* generic-x.el (w32-shell-name):
	* files.el (msdos-long-file-names, w32-long-file-name)
	(dired-get-filename, dired-unmark, dired-do-flagged-delete)
	(dos-8+3-filename, vms-read-directory, view-mode-disable):
	* term/mac-win.el (mac-code-convert-string, mac-coerce-ae-data)
	(mac-resume-apple-event, mac-font-panel-mode)
	(mac-atsu-font-face-attributes, mac-ae-set-reply-parameter)
	(mac-clear-font-name-table):
	* term/pc-win.el (msdos-remember-default-colors)
	(w16-set-clipboard-data, w16-get-clipboard-data):
	* term/w32-win.el (w32-send-sys-command, w32-select-font)
	(set-message-beep):
	* w32-fns.el (set-message-beep, w32-get-clipboard-data)
	(w32-get-locale-info, w32-get-valid-locale-ids)
	(w32-set-clipboard-data):
	* help-fns.el (ad-get-advice-info):
	* font-lock.el (fast-lock-after-fontify-buffer)
	(fast-lock-after-unfontify-buffer, fast-lock-mode)
	(lazy-lock-after-fontify-buffer)
	(lazy-lock-after-unfontify-buffer, lazy-lock-mode):
	* net/browse-url.el (w32-shell-execute):
	* dos-fns.el (int86, msdos-long-file-names):
	* dos-w32.el (default-printer-name): Declare as functions.

2007-11-21  Juanma Barranquero  <lekktu@gmail.com>

	* textmodes/paragraphs.el (forward-sentence): Doc fix.
	Reported by Drew Adams <drew.adams@oracle.com>.

2007-11-20  Jason Rumney  <jasonr@gnu.org>

	* term/w32-win.el (x-setup-function-keys): Protect against
	multiple calls on the same terminal.

2007-11-20  Dan Nicolaescu  <dann@ics.uci.edu>

	* term/mac-win.el (x-setup-function-keys): Only setup
	local-function-key-map if it has not been setup already for the
	current frame.  Move the suspend-emacs processing here.

2007-11-20  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/grep.el (xargs-program): New variable.
	(grep-compute-defaults): Use it.
	(grep-default-command): Doc fix.
	(grep, lgrep, rgrep): Reflow docstrings.

2007-11-20  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el (vc-find-revision): Set the parent buffer.
	Use when instead of if.

	* progmodes/python.el (info-lookup-maybe-add-help):
	* progmodes/ps-mode.el (doc-view-minor-mode):
	* mail/emacsbug.el (Info-menu, Info-goto-node):
	* emulation/viper-keym.el (viper-ex)
	(viper-normalize-minor-mode-map-alist, viper-set-mode-vars-for):
	* emulation/viper-cmd.el (widget-type, widget-button-press)
	(viper-set-hooks):
	* emacs-lisp/tcover-unsafep.el (unsafep-function):
	* emacs-lisp/tcover-ses.el (ses-set-curcell, ses-update-cells)
	(ses-load, ses-vector-delete, ses-create-header-string)
	(ses-read-cell, ses-read-symbol, ses-command-hook, ses-jump):
	* emacs-lisp/gulp.el (mail-subject, mail-send): Declare as functions.

2007-11-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcvs.el (cvs-revert-if-needed): Fix copy&paste typo.

2007-11-20  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/check-declare.el (check-declare-verify): Tweak regexp
	for end of function-name.  Handle define-derived-mode.

2007-11-20  Dan Nicolaescu  <dann@ics.uci.edu>

	* progmodes/idlw-help.el: Require browse-url unconditionally, it
	is available by default.
	(idlwave-help-browse-url-available): Change default to t.

	* emulation/edt.el (defgroup, defcustom): Remove definition.
	(eval-when-compile): Remove.
	(c-mark-function):
	* textmodes/reftex-dcr.el (bibtex-beginning-of-entry):
	* textmodes/fill.el (comment-search-forward)
	(comment-string-strip):
	* progmodes/prolog.el (comint-mode, comint-send-string)
	(comint-send-region, comint-send-eof):
	* progmodes/dcl-mode.el (imenu-default-create-index-function):
	* emulation/viper-util.el (viper-forward-Word):
	* emulation/vi.el (c-mark-function):
	* emulation/edt-vt100.el (vt100-wide-mode):
	* emacs-lisp/timer.el (diary-entry-time): Declare as functions.

2007-11-19  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-open-connection-setup-interactive-shell):
	Still some tuning in case of an echoing shell.
	(tramp-send-command): Connection property "remote-echo" is not
	persistent; cache key is the process therefore.

2007-11-19  Juanma Barranquero  <lekktu@gmail.com>

	* replace.el (map-query-replace-regexp): Doc fix (revert part of
	revision 1.104, made on 2000-05-21 with no ChangeLog entry).

2007-11-19  Dan Nicolaescu  <dann@ics.uci.edu>

	* progmodes/octave-mod.el (inferior-octave-send-list-and-digest):
	* play/yow.el (doctor-ret-or-read):
	* vc-hooks.el (vc-dired-resynch-file):
	* vc-hg.el (log-view-get-marked):
	* smerge-mode.el (ediff-cleanup-mess):
	* pcvs.el (vc-editable-p, vc-checkout):
	* pcomplete.el (comint-bol):
	* informat.el (texinfo-format-refill):
	* ido.el (tramp-tramp-file-p):
	* ibuffer.el (ibuffer-mark-on-buffer, ibuffer-format-qualifier)
	(ibuffer-generate-filter-groups, ibuffer-format-filter-group-data):
	* add-log.el (c-beginning-of-defun, c-end-of-defun): Declare as
	functions.

	* textmodes/ispell.el (ispell-int-char): Make it a defalias
	instead of fset.
	(ispell-message): Use with-no-warnings for sc-cite-regexp call.

	* ido.el (ido-file-internal): Move with-no-warnings to include the
	ffap-string-at-point call.

	* pcomplete.el (pcomplete-executables): Move defsubst before first use.

	* vc-hg.el (vc-hg-revision-table): Fix last change.

2007-11-19  Martin Rudalics  <rudalics@gmx.at>

	* menu-bar.el (top-level): Deactivate clipboard-kill-region and
	clipboard-yank when the buffer is read-only.

	* cus-edit.el (custom-field-keymap): Move to other Custom mode
	keymaps such that it's before the definition of Custom-mode-menu.
	(Custom-mode-menu): Show it for custom-field-keymap too.

2007-11-19  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el: Update commentary.

2007-11-18  Dan Nicolaescu  <dann@ics.uci.edu>

	* net/tramp.el (tramp-terminal-type): Remove duplicated definition.

2007-11-19  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/check-declare.el (check-declare-verify): If fnfile
	does not exist, try adding `.el' extension.  Also search for defsubsts.

	* cus-edit.el (recentf-expand-file-name):
	* dired.el (dired-relist-entry):
	* subr.el (w32-shell-dos-semantics):
	* emacs-lisp/bytecomp.el (compilation-forget-errors):
	Declare as functions.

2007-11-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* abbrev.el (kill-all-abbrevs, insert-abbrevs)
	(prepare-abbrev-list-buffer): Use dolist.
	(clear-abbrev-table): Preserve properties.

2007-11-18  Shigeru Fukaya  <shigeru.fukaya@gmail.com>  (tiny change)

	* textmodes/texinfmt.el (texinfo-format-printindex):
	Collect combined indexes using texinfo-short-index-format-cmds-alist.
	Reported on <bug-texinfo@gnu.org>.

2007-11-18  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-completion-reread-directory-timeout):
	New defcustom.
	(tramp-handle-file-name-all-completions): Flush directory contents
	from cache regularly.
	(tramp-set-auto-save-file-modes): Check also for `buffer-modified-p'.
	(tramp-open-connection-setup-interactive-shell):
	Call `tramp-cleanup-connection' via funcall.

	* net/tramp-ftp.el (tramp-ftp-file-name-handler): Temp file is already
	created when copying.

2007-11-17  Dan Nicolaescu  <dann@ics.uci.edu>

	* eshell/esh-util.el (eshell-under-xemacs-p): Remove.
	* eshell/esh-mode.el (eshell-mode-syntax-table, command-running-p):
	* eshell/esh-ext.el (eshell-external-command):
	* eshell/esh-cmd.el (require):
	* eshell/em-unix.el (eshell-plain-locate-behavior):
	* eshell/em-cmpl.el (eshell-cmpl-initialize):
	Replace eshell-under-xemacs-p with (featurep 'xemacs).
	* eshell/esh-mode.el (characterp, char-int): Remove unused
	conditional defaliases.

	* pcomplete.el (pcomplete-event-matches-key-specifier-p):
	Rename from event-matches-key-specifier-p, define unconditionally.
	(event-basic-type): Remove unused defalias.
	(pcomplete-show-completions):
	Use pcomplete-event-matches-key-specifier-p.

2007-11-17  Eli Zaretskii  <eliz@gnu.org>

	* eshell/esh-module.el (eshell-load-defgroups): Don't make backups
	when saving esh-groups.el.

2007-11-17  Martin Rudalics  <rudalics@gmx.at>

	* wid-edit.el (widget-default-complete):
	* progmodes/flymake.el (flymake-goto-file-and-line):
	Fix typo in (doc-)string.

2007-11-17  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/byte-run.el (declare-function): New macro.
	* emacs-lisp/bytecomp.el (byte-compile-declare-function):
	New function, byte-hunk-handler for declare-function.
	(byte-compile-callargs-warn): Handle declared functions.

	* emacs-lisp/check-declare.el: New file.
	* Makefile.in (check-declare): New target.

	* progmodes/fortran.el (gud-find-c-expr): Declare as a function.

	* subr.el (process-lines): Move here from ../admin/admin.el.
	* emacs-lisp/authors.el (authors-process-lines): Remove.
	(authors): Use process-lines rather than authors-process-lines.

	* progmodes/compilation-perl.el, progmodes/compilation-weblint.el:
	Remove these files.

2007-11-17  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/backquote.el (backquote):
	Improve argument/docstring consistency.

	* emacs-lisp/ring.el (ring-size, ring-p, ring-insert)
	(ring-length, ring-empty-p): Use c[ad]dr.
	(ring-plus1): Use `1+'.
	(ring-minus1): Use `zerop'.
	(ring-remove): Use c[ad]dr.  Use `when'.
	(ring-copy): Use c[ad]dr.  Use `let', not `let*'.
	(ring-ref): Use `let', not `let*'.
	(ring-insert-at-beginning): Use c[ad]dr.  Doc fix.
	(ring-insert+extend): Use c[ad]dr.  Fix typo in docstring.
	(ring-member): Simplify.  Doc fix.
	(ring-convert-sequence-to-ring): Simplify.

2007-11-17  Juri Linkov  <juri@jurta.org>

	* dired-aux.el (dired-create-directory): Allow creating
	a directory of an arbitrary depth.  Add a loop to find the topmost
	nonexistent parent dir `new', and call `dired-add-file' on it.
	Set the `PARENTS' arg of `make-directory' to t.

2007-11-16  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-aent.el (calc-last-user-lang-parse-table): New variable.
	(math-build-parse-table): Get parse information from math-parse-table.

2007-11-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* window.el (recenter-last-op): New var.
	(recenter-top-bottom): New command.
	(global-map): Bind it to C-l.

	* abbrev.el (abbrev--write): Fix error in transcription from C.

	* emulation/pc-select.el (pc-select-shifted-mark): Remove.
	(pc-select-ensure-mark): Set mark-active to a special value instead.
	Rename from ensure-mark.  Update call callers.
	(pc-select-maybe-deactivate-mark): Rename from maybe-deactivate-mark.
	Rewrite.  Update all callers.
	(pc-selection-mode): Remove redundant var declaration.

2007-11-16  Tassilo Horn  <tassilo@member.fsf.org>

	* doc-view.el (doc-view-search-backward, doc-view-search):
	Fix assignment to free variable bug.

2007-11-16  Martin Pohlack  <mp26@os.inf.tu-dresden.de>

	* emulation/pc-select.el (pc-select-shifted-mark): New var.
	(ensure-mark): Set it.
	(maybe-deactivate-mark): New fun.
	Use it everywhere instead of (setq mark-active nil).

2007-11-16  Dan Nicolaescu  <dann@ics.uci.edu>

	* textmodes/reftex-dcr.el (reftex-start-itimer-once):
	Add check for XEmacs.

	* calc/calc-menu.el (calc-mode-map): Pacify byte compiler.

	* doc-view.el (doc-view-resolution): Add missing :group.

2007-11-16  Juanma Barranquero  <lekktu@gmail.com>

	* subr.el (make-variable-frame-local):
	Fix typo in obsolescence declaration.

2007-11-16  Werner Lemberg  <wl@gnu.org>

	* files.el (set-auto-mode-1): Check second line for -*- if file
	starts with '\" (which is used by man pages to identify needed
	troff preprocessors).

2007-11-16  Glenn Morris  <rgm@gnu.org>

	* mail/mail-extr.el (mail-extr-all-top-level-domains): Update domains.

2007-11-16  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-lang.el (math-oper-table): Fix typo.
	Reduce precedence of "/" for TeX.

	* calc/calc-menu.el (calc-modes-menu): Add Languages submenu.

2007-11-16  Juri Linkov  <juri@jurta.org>

	* dired-aux.el (dired-read-shell-command-default): New function.
	(dired-read-shell-command): Use its return value for DEFAULT arg.

	* replace.el (keep-lines-read-args, occur-read-primary-args):
	Use a list of default values for DEFAULT arg of read-from-minibuffer.

	* man.el (Man-heading-regexp): Add 0-9.
	(Man-first-heading-regexp): Remove leading space [ \t]* before NAME.

2007-11-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* doc-view.el (doc-view-ghostscript-options): Remove resolution arg.
	(doc-view-resolution): New custom var.
	(doc-view-pdf/ps->png): Use it.
	(doc-view-shrink-factor): New var.
	(doc-view-enlarge, doc-view-shrink): New commands.
	(doc-view-mode-map): Use them.

2007-11-15  Juanma Barranquero  <lekktu@gmail.com>

	* ediff-wind.el (ediff-window-setup-function):
	* simple.el (normal-erase-is-backspace):
	* eshell/em-unix.el (eshell/info):
	* progmodes/cc-engine.el (c-crosses-statement-barrier-p):
	Fix typos in docstrings.

	* emulation/cua-base.el (cua--keymaps-initialized):
	Rename from `cua--keymaps-initalized'.  Callers changed.
	(cua-highlight-region-shift-only): Doc fix.
	(cua-paste-pop): Fix typo in docstring.

2007-11-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emulation/cua-base.el (cua--pre-command-handler-1):
	Use input-decode-map instead of function-key-map.
	Use event-modifiers now that it works reliably.

	* vc.el (vc-diff-internal): Pop-to-buffer later.

	* subr.el (event-modifiers): Use internal-event-symbol-parse-modifiers.

	* pcvs.el (cvs-revert-if-needed): Ignore `unknown' files, since CVS
	did not touch them.

2007-11-15  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-menu.el: New file.
	* calc/calc.el (calc-mode): Require calc-menu.

2007-11-14  Juanma Barranquero  <lekktu@gmail.com>

	* isearch-multi.el (isearch-buffers-next-buffer-function): Doc fix.

2007-11-14  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-parent-bptno-enabled): New variable.
	(gdb-breakpoint-regexp, gdb-mouse-toggle-breakpoint-margin)
	(gdb-mouse-toggle-breakpoint-fringe, gdb-delete-breakpoint)
	(gdb-goto-breakpoint): Generalize for breakpoints with multiple
	locations.
	(gdb-info-breakpoints-custom, gdb-assembler-custom)
	(gdb-toggle-breakpoint): Update for new gdb-breakpoint-regexp.
	(gdb-put-breakpoint-icon): Only display icon for parent breakpoint.

2007-11-13  Noah Friedman  <friedman@splode.com>

	* calc/calc.el: Add `backward-delete-char-untabify' to the list of
	bindings to remap when `calc-scan-for-dels' is non-nil.

2007-11-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/byte-opt.el (byte-compile-trueconstp): Handle more
	constant forms.
	(byte-compile-nilconstp): New function.
	(byte-optimize-cond): Kill subsequent branches when a branch is
	know to be taken or not taken.
	(byte-optimize-if): Use byte-compile-nilconstp instead of hand coding.

2007-11-13  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el (vc-register): Allow registering a file passed as a
	parameter instead of just the current buffer.

2007-11-12  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-open-connection-setup-interactive-shell):
	Check whether the output of "uname -sr" has been changed.

2007-11-12  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* progmodes/compile.el (compilation-error-regexp-alist-alist): Insert
	patterns from compilation-perl.el and compilation-weblint.el files.

2007-11-12  Dan Nicolaescu  <dann@ics.uci.edu>

	* progmodes/compilation-perl.el:
	* progmodes/compilation-weblint.el: Disable autoloads, they cause
	a bootstrap failure.

	* vc-cvs.el (vc-cvs-diff): If backup files exist, diff them
	instead of doing "cvs diff" in order to avoid accessing the repository.

2007-11-12  Kevin Ryde  <user42@zip.com.au>

	* progmodes/compilation-perl.el:
	* progmodes/compilation-weblint.el: New files.

2007-11-11  Juanma Barranquero  <lekktu@gmail.com>

	* international/iso-cvt.el (iso-translate-conventions): Doc fix.
	(iso-aggressive-german-trans-tab, iso-conservative-german-trans-tab)
	(iso-tex2iso-trans-tab, iso-gtex2iso-trans-tab): Reflow docstring.
	(iso-spanish, iso-german, iso-iso2tex, iso-tex2iso, iso-gtex2iso)
	(iso-iso2gtex, iso-iso2duden, iso-iso2sgml, iso-sgml2iso):
	Rewrite in active voice.

2007-11-11  Tassilo Horn  <tassilo@member.fsf.org>

	* doc-view.el: Add comments about isearch support.

2007-11-11  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el (vc-start-entry): Fix setting the in the case the function
	is called from vc-dired.  Use when instead of if where appropriate.

2007-11-11  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el (ps-do-despool): Do not force ps-lpr-switches
	to be a list.
	(ps-begin-job): Error if ps-lpr-switches is not a list.

2007-11-11  YAMAMOTO Mitsuharu  <mituharu@math.s.chiba-u.ac.jp>

	* faces.el (face-normalize-spec): Remove function.
	(frame-set-background-mode): Undo last change.

2007-11-10  Jason Rumney  <jasonr@gnu.org>

	* w32-fns.el: Sync charset names with setup-default-fontset.
	Append "-1" where second part missing.

2007-11-10  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-mode-end-hook, isearch-mode-end-hook-quit):
	Fix docstring.  Reported by Leo <sdl.web@gmail.com>.

	* custom.el (custom-note-var-changed): Remove the `interactive'
	spec from this new non-interactive function.

2007-11-10  Tassilo Horn  <tassilo@member.fsf.org>

	* doc-view.el (doc-view-mode-map, doc-view-menu)
	(doc-view-pdf->txt-sentinel): Adapt to new search UI.
	(doc-view-search-backward): New function.
	(doc-view-search): Query new regexp if prefix arg is given, else
	jump to next/previous match.
	(doc-view-mode): Handle compressed files.
	(jka-compr): Required for compressed files.

2007-11-10  Paul Pogonyshev  <pogonyshev@gmx.net>

	* replace.el (query-replace-show-replacement): New defcustom.
	(perform-replace): Use `match-substitute-replacement' if
	`query-replace-show-replacement' is non-nil.

2007-11-10  David Kastrup  <dak@gnu.org>

	* subr.el (match-substitute-replacement): New function.

2007-11-10  Carsten Dominik  <dominik@science.uva.nl>

	* files.el (auto-mode-alist): Select org-mode for files with the
	extension ".org".

2007-11-10  Martin Rudalics  <rudalics@gmx.at>

	* help.el (help-window, help-window-point-marker): New variables.
	(help-window-select): New option.
	(with-help-window): New macro for displaying help windows.
	(help-window-display-message, help-window-setup-finish)
	(help-window-setup): New functions used for setting up help windows.
	(print-help-return-message): Reset help-window to nil.
	(view-lossage): Use with-help-window instead of
	with-output-to-temp-buffer and move help-window-point-marker after
	inserted text.
	(describe-bindings, describe-key, describe-mode): Use
	with-help-window instead of with-output-to-temp-buffer.

	* help-mode.el (help-mode): Set view-exit-action to bury the
	buffer instead of fiddling with windows.  Simplify code.
	(help-mode-finish): When help-window equals t set it to the selected
	window and have with-help-window set up view-return-to-alist.
	(help-buffer): Add autoload cookie.

	* view.el (view-remove-frame-by-deleting): Change default value to t.
	Add autoload cookie.
	(view-exit-action, view-file, view-file-other-window)
	(view-file-other-frame, view-buffer, view-buffer-other-window)
	(view-buffer-other-frame): Rewrite doc strings.
	(view-return-to-alist-update): New function to remove stale entries
	from view-return-to-alist.
	(view-mode-enter): Rewrite doc string and simplify code.
	(view-mode-exit): Handle new case 'keep-frame.  Don't reset
	view-exit-action to nil.  Simplify code and rewrite doc string.

	* apropos.el (apropos-describe-plist):
	* descr-text.el (describe-char):
	* disp-table.el (describe-display-table):
	* faces.el (list-faces-display, describe-face):
	* facemenu.el (list-colors-display):
	* help-fns.el (describe-function, describe-variable)
	(describe-syntax, describe-categories):
	Use with-help-window instead of with-output-to-temp-buffer.

2007-11-10  Dan Nicolaescu  <dann@ics.uci.edu>

	* emacs-lisp/byte-opt.el (byte-optimize-featurep):
	Optimize (featurep 'emacs) to t.

	* emacs-lisp/bytecomp.el (byte-compile-find-bound-condition):
	New function.
	(byte-compile-maybe-guarded): Use it to also look for bound
	symbols inside `and' forms.  Comment out non-working code that was
	trying to avoid warnings for XEmacs code.

	* vc.el (vc-diff-internal): Make the *vc-diff* buffer read only.

	* vc-svn.el (vc-svn-print-log, vc-svn-diff):
	* vc-mcvs.el (vc-mcvs-print-log, vc-mcvs-annotate-command):
	* vc-cvs.el (vc-cvs-print-log, vc-cvs-diff)
	(vc-cvs-annotate-command):
	* vc-arch.el (vc-arch-diff): Remove test to check if start-process
	is bound, it always is.

2007-11-10  Jason Rumney  <jasonr@gnu.org>

	* term/w32-win.el (w32-initialize-window-system): Move SJIS font
	setup here from global scope.

2007-11-10  Juanma Barranquero  <lekktu@gmail.com>

	* ido.el (ido-save-history): Save the history file in UTF-8, not
	the current filename coding system.

2007-11-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (interprogram-cut-function, interprogram-paste-function):
	Don't make them frame-local any more.

	* faces.el (x-create-frame-with-faces, tty-create-frame-with-faces):
	Don't set interprogram-(cut|paste)-function on each frame.

	* term/x-win.el (x-select-text, x-cut-buffer-or-selection-value):
	Make them work in tty frames.
	(interprogram-cut-function, interprogram-paste-function):
	Set them globally.

2007-11-09  Juanma Barranquero  <lekktu@gmail.com>

	* international/iso-cvt.el (iso-spanish, iso-german, iso-iso2tex)
	(iso-tex2iso, iso-gtex2iso, iso-iso2gtex, iso-iso2duden): Doc fixes.
	(iso-iso2duden-trans-tab): Add docstring.

2007-11-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* abbrev.el (define-abbrev-table): Record the variable definition.

	* emacs-lisp/bytecomp.el (byte-compile-file-form-define-abbrev-table):
	New function.

2007-11-09  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el: Clean the code for checking suitable Emacs version.
	(ps-do-despool): If ps-lpr-switches is not a list, force it to be one.
	(ps-print-version): New version 6.8.1.

2007-11-09  Juanma Barranquero  <lekktu@gmail.com>

	* files.el (enable-local-variables): Doc fix.

2007-11-09  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gud.el (gud-gdb): Remove vestigial gdba doc and code.

2007-11-09  Sven Joachim  <svenjoac@gmx.de>

	* dired-aux.el (dired-copy-file-recursive):
	Preserve directory permissions.

2007-11-09  Juanma Barranquero  <lekktu@gmail.com>

	* whitespace.el (whitespace-write-file-hook): Remove interactive spec.
	(whitespace-unload-function): New-style unload function.  When run,
	unintern `whitespace-unload-hook' and call `unload-feature' recursively
	to stop the old hook from messing with the unloading.

2007-11-09  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/elp.el (elp-report-limit, elp-restore-all)
	(elp-unset-master, elp-results): Fix typos.
	(elp-sort-by-function, elp-use-standard-output, elp-recycle-buffers-p):
	Doc fixes.

	* msb.el (msb--many-menus): Remove variable.
	(msb-max-menu-items, msb--add-to-menu): Doc fixes.
	(msb-menu-cond, msb-item-handling-function, msb--create-function-info)
	(msb--toggle-menu-type): Fix typos in docstrings.

	* shadowfile.el (shadow-inhibit-overload, shadow-remove-from-todo)
	(shadow-insert-var): Doc fixes.
	(shadow-file-match, shadow-define-cluster, shadow-define-regexp-group):
	Reflow docstrings.
	(shadow-parse-fullname, shadow-read-files): Fix typos in docstrings.

2007-11-09  Juanma Barranquero  <lekktu@gmail.com>

	* ediff-hook.el (ediff, ediff-files, ediff-buffers, ebuffers, ediff3)
	(ediff-files3, ediff-buffers3, ebuffers3, erevision, ediff-revision):
	Fix typos in autoload docstrings.

2007-11-09  Richard Stallman  <rms@gnu.org>

	* savehist.el (savehist-save): Obey savehist-ignored-variables.

2007-11-09  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-delete-out-of-scope): New option.
	(gdb-var-update-handler-1): Use it.

2007-11-09  Juanma Barranquero  <lekktu@gmail.com>

	* loadhist.el (unload-feature): Remove erroneous check for the
	FEATURE-unload-function variable; check the existence of the
	function (that's what the docstring says, and it makes more sense).

	* follow.el (follow-unload-function): Add docstring.
	(follow-unload-function): Remove variable.

	* server.el (server-unload-function): Remove variable.
	(server-unload-function): Unbind `server-edit' from `C-x #'.

	* ses.el (ses-unload-function): New function.

2007-11-09  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/unsafep.el (unsafep, unsafep-function)
	(unsafep-progn, unsafep-let): Fix typos in docstrings.

	* uniquify.el (uniquify-maybe-rerationalize-w/o-cb): Define it
	before use to avoid a warning in packages that require uniquify.
	(uniquify-unload-function): New function and var.

2007-11-09  Dan Nicolaescu  <dann@ics.uci.edu>

	* ediff-init.el (ediff-xemacs-p, ediff-emacs-p): Remove.
	(ediff-has-face-support-p, ediff-BAD-INFO, ediff-check-version)
	(ediff-current-diff-A, ediff-current-diff-B)
	(ediff-current-diff-C, ediff-fine-diff-C, ediff-fine-diff-A)
	(ediff-fine-diff-B, ediff-fine-diff-Ancestor, ediff-even-diff-A)
	(ediff-even-diff-B, ediff-even-diff-C, ediff-even-diff-Ancestor)
	(ediff-odd-diff-A, ediff-odd-diff-B, ediff-odd-diff-C)
	(ediff-odd-diff-Ancestor, ediff-reset-mouse):
	* ediff-wind.el (ediff-narrow-control-frame-leftward-shift)
	(ediff-setup-windows-plain-merge)
	(ediff-setup-windows-plain-compare, ediff-setup-control-frame)
	(ediff-refresh-control-frame, ediff-get-visible-buffer-window):
	* ediff-util.el (ediff-setup-keymap)
	(ediff-toggle-wide-display, ediff-toggle-multiframe)
	(ediff-toggle-use-toolbar, ediff-really-quit)
	(ediff-good-frame-under-mouse)
	(ediff-highlight-diff-in-one-buffer)
	(ediff-remove-flags-from-buffer, ediff-place-flags-in-buffer1)
	(ediff-make-bullet-proof-overlay):
	* ediff-mult.el (ediff-setup-meta-map, ediff-emacs-p)
	(ediff-set-meta-overlay):
	* ediff-help.el (ediff-help-region-map, ediff-set-help-overlays):
	* ediff.el (ediff-documentation): Replace ediff-xemacs-p and
	ediff-emacs-p with their former definitions.

	* emulation/viper-init.el (viper-xemacs-p, viper-emacs-p): Remove.
	(viper-has-face-support-p, viper-inactivate-input-method)
	(viper-activate-input-method)
	(viper-use-replace-region-delimiters, viper-restore-cursor-type):
	* emulation/viper-mous.el (viper-multiclick-timeout)
	(viper-surrounding-word, viper-mouse-click-insert-word)
	(viper-mouse-click-search-word, viper-parse-mouse-key):
	* emulation/viper-macs.el (viper-char-array-to-macro):
	* emulation/viper.el (viper-go-away, viper-set-hooks)
	(viper-non-hook-settings):
	* emulation/viper-util.el (viper-get-saved-cursor-color-in-replace-mode)
	(viper-get-saved-cursor-color-in-insert-mode)
	(viper-get-saved-cursor-color-in-emacs-mode)
	(viper-check-version, viper-get-visible-buffer-window)
	(viper-file-checked-in-p, viper-set-replace-overlay)
	(viper-set-replace-overlay-glyphs, viper-set-minibuffer-overlay)
	(viper-check-minibuffer-overlay, viper-read-key-sequence)
	(viper-key-to-emacs-key): Replace viper-xemacs-p and viper-emacs-p
	with their former definitions.
	(viper-eventify-list-xemacs): Only do work for XEmacs.
	(viper-set-unread-command-events): Only do work for Emacs.
	(viper-overlay-p, viper-make-overlay, viper-overlay-live-p)
	(viper-move-overlay, viper-overlay-start, viper-overlay-end)
	(viper-overlay-get, viper-overlay-put, viper-read-event)
	(viper-characterp, viper-int-to-char, viper-get-face)
	(viper-color-defined-p, viper-iconify): New defaliases replacing
	the old fsets.

	* progmodes/fortran.el (comment-region-function)
	(uncomment-region-function): Pacify byte compiler.

	* vc.el (vc-diff-internal): Remove code for an old version of gnus.

2007-11-08  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-maybe-open-connection): Use a local copy of
	`process-environment'.

2007-11-08  David Hansen  <david.hansen@gmx.net>  (tiny change)

	* eshell/em-dirs.el (eshell-expand-multiple-dots): Change regexp to
	match dir like "a...b".

2007-11-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* smerge-mode.el (smerge-refine-subst): Pass "-d" to diff.

2007-11-07  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-handle-substitute-in-file-name):
	Don't expand the remote connection identification.
	(tramp-find-shell, tramp-open-connection-setup-interactive-shell):
	Set also $PS2 and $PS3 when setting $PS1.  Check for shell echoing
	before calling stty.

	* net/tramp-cache.el (tramp-cache-print)
	(tramp-dump-connection-properties): Fix docstring.
	(tramp-list-connections): Rename from `tramp-cache-list-connections'.

	* net/tramp-cmds.el (tramp-cleanup-connection): Apply it.

	* net/tramp-ftp.el (tramp-ftp-file-name-handler): Don't expand the
	remote connection identification when setting connection property.

	* net/tramp-smb.el (tramp-smb-handle-substitute-in-file-name):
	"//" substitutes only in the local filename part.

2007-11-07  David Hansen  <david.hansen@gmx.net>

	* eshell/em-glob.el (eshell-extended-glob): Sort matches.

2007-11-07  Glenn Morris  <rgm@gnu.org>

	* emulation/tpu-mapper.el (tpu-map-key): Use unless rather than cond.
	Remove superfluous concats.  Move final set-buffer to
	non-emacs-specific code.

2007-11-07  Rob Riepel  <riepel@networking.stanford.edu>

	* emulation/tpu-mapper.el (tpu-map-key): Remove un-needed cond branch.

2007-11-07  Johan Bockgård  <bojohan@gnu.org>

	* eshell/esh-mode.el (eshell-output-filter):
	* eshell/esh-proc.el (eshell-insertion-filter, eshell-sentinel):
	Use `with-current-buffer'.

2007-11-07  Andreas Schwab  <schwab@suse.de>

	* server.el (server-start): Only register cleanup after server was
	started.

2007-11-06  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (top): Don't autoload `tramp-cache-print'.

	* net/tramp-cache.el (tramp-cache-print): Move down.
	(tramp-cache-list-connections): New defun.

	* net/tramp-cmds.el (tramp-cleanup-connection): Use it.

2007-11-06  Juanma Barranquero  <lekktu@gmail.com>

	* ido.el (ido-save-history): Write the history file in the current
	filename coding system, and add `coding' file-local variable.

2007-11-06  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el (org-table-formula-substitute-names):
	Remove forgotten temporary debugging code.

2007-11-05  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-wait-for-output): Ignore escape sequences in
	the prompt.

2007-10-05  Chris Moore  <christopher.ian.moore@gmail.com>

	* wdired.el (wdired-use-dired-vertical-movement): Doc fix.

2007-11-05  Simon Josefsson  <simon@josefsson.org>

	* net/tls.el (tls-end-of-info): Doc fix.

2007-11-05  Kenichi Handa  <handa@ni.aist.go.jp>

	* international/utf-7.el (utf-7-imap): New coding system.
	(utf-7-imap-post-read-conversion): New function.
	(utf-7-imap-pre-write-conversion): New function.

2007-11-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	* abbrev.el (abbrev--write): Fix up typo.

2007-11-04  Juanma Barranquero  <lekktu@gmail.com>

	* abbrev.el (define-abbrev-table): Doc fix.

2007-11-04  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* info.el (Info-revert-buffer-function): New func.
	(Info-mode): Arrange to use it for reverting.
	(Info-copy-current-node-name): Add space between filename and nodename.

2007-11-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* abbrev.el (expand-abbrev): Move point back to expansion's end.

2007-11-04  Glenn Morris  <rgm@gnu.org>

	* net/tls.el: Don't require rx when compiling.
	(tls-end-of-info): Rewrite without using rx.
	(open-tls-stream): Use with-current-buffer.

2007-11-04  Riccardo Murri  <riccardo.murri@gmail.com>

	* net/tls.el: Require rx when compiling.
	(tls-end-of-info): New variable.
	(open-tls-stream): Keep reading input until `tls-end-of-info' is
	matched.

2007-11-03  Sean O'Rourke  <seano@cs.ucla.edu>

	* register.el (append-to-register, prepend-to-register):
	Don't signal error on empty register; use the text, instead.

2007-11-03  Michael Olson  <mwolson@gnu.org>

	* textmodes/remember.el (remember-buffer):
	Use define-obsolete-function-alias rather than defalias.

2007-11-03  Ulrich Mueller  <ulm@gentoo.org>  (tiny change)

	* simple.el (bad-packages-alist): Anchor semantic regexp.

2007-11-03  Glenn Morris  <rgm@gnu.org>

	* newcomment.el (comment-dwim): Call comment-insert-comment-function,
	if defined, for blank lines.  Doc fix.

	* progmodes/fortran.el (fortran-mode-map): Don't bind M-;.
	(fortran-mode): Set values for comment-region-function,
	uncomment-region-function and comment-insert-comment-function.
	(fortran-uncomment-region): New function.

	* textmodes/nroff-mode.el (nroff-mode):
	Set comment-insert-comment-function rather than indent-line-function.
	(nroff-indent-line-function): Remove.
	(nroff-insert-comment-function): New function.

2007-11-02  Michael Kifer  <kifer@cs.stonybrook.edu>

	* ediff-vers.el (ediff-vc-working-revision): Add a quote.

2007-11-02  Michael Kifer  <kifer@cs.stonybrook.edu>

	* emulation/viper-ex.el (viper-ex): Do not ignore the region.

	* emulation/viper-cmd.el (viper-prev-destructive-command)
	(viper-insert-prev-from-insertion-ring): Use ring-copy instead of
	copy-sequence.

	* ediff-util.el (ediff-make-current-diff-overlay): Do not use face-name.
	Got rid of ediff-copy-list.

	* ediff-diff.el (ediff-set-fine-diff-properties-in-one-buffer): Do not
	use face-name.
	(ediff-test-utility, ediff-diff-mandatory-option)
	(ediff-reset-diff-options): Remove to simplify the mandatory option
	handling on Windows.
	(ediff-set-diff-options): Add.
	(ediff-diff-options): Set "--binary" option as default in some cases.

	* ediff-vers.el (ediff-vc-internal): Use ediff-vc-revision-other-window.
	(ediff-vc-merge-internal): Use ediff-vc-revision-other-window and
	ediff-vc-working-revision.  Require vc-hooks.

2007-11-02  Drake Wilson  <drake@begriffli.ch>  (tiny change)

	* files.el (hack-local-variables): Fix membership tests to avoid
	treating all variables as safe if `enable-local-variables' is
	set to :safe (CVE-2007-5795).

2007-11-02  Glenn Morris  <rgm@gnu.org>

	* newcomment.el (comment-indent): Let comment-insert-comment-function,
	if defined, do all the work of inserting a new comment.

	* progmodes/etags.el (tags-table-mode): Disable undo.

	* simple.el (bad-packages-alist): Revert previous change.

2007-11-02  Dan Nicolaescu  <dann@ics.uci.edu>

	* emacs-lisp/lselect.el: Move to obsolete/lselect.el.

	* obsolete/lselect.el: Do not warn about unknown functions.

2007-11-02  Michael Olson  <mwolson@gnu.org>

	* textmodes/remember.el (remember-buffer): Make this an alias of
	remember-finalize, because Org uses it.

2007-11-01  Michael Olson  <mwolson@gnu.org>

	* textmodes/remember.el: Improve documentation in heading.
	(remember-before-remember-hook): Turn into a customizable option.
	(remember): Document INITIAL argument.
	(remember-region): Remove autoload cookie.  Improve docstring to
	mention that it is called from the *Remember* buffer, and does not
	have any functional overlap with the `remember' function.
	(remember-finalize): Remove autoload cookie.  Rename from
	remember-buffer to emphasize that this does not have any
	functional overlap with the `remember' function.
	(remember-destroy): Remove autoload cookie.
	(remember-mode-map): Define and initialize in one step.
	(remember-mode): Improve docstring.
	(remember-annotation-functions): Default to just '(buffer-file-name),
	and don't try to take the default value from Planner.

2007-11-01  Glenn Morris  <rgm@gnu.org>

	* doc-view.el (doc-view-cache-directory): Remove superfluous concat.

	* simple.el (bad-packages-alist): Add an entry for standalone vc-svn.

	* emacs-lisp/authors.el (authors-scan-change-log)
	(authors-scan-el): Don't enable local eval; enable only safe local
	variables, without querying.

	* mail/footnote.el (footnote-numeric-regexp)
	(footnote-english-upper-regexp, footnote-english-lower-regexp)
	(footnote-roman-lower-regexp, footnote-roman-upper-regexp):
	Match multi-character footnotes.

	* textmodes/nroff-mode.el (nroff-mode): Set indent-line-function.
	(nroff-indent-line-function): New function.
	(nroff-count-text-lines): Use nroff-forward-text-line rather than
	obsolete alias.

2007-11-01  Ryan Yeske  <rcyeske@gmail.com>

	* net/rcirc.el (rcirc-last-quit-line, rcirc-last-line)
	(rcirc-elapsed-lines): New argument PROCESS.  Update callers.
	(rcirc-print): Only update the line count when not marking the
	line as omittable.
	(rcirc-log-write): Specify coding system when writing logfile.
	(rcirc-markup-fill): Make sure ellipsis does not cause line to wrap.

2007-11-01  Dan Nicolaescu  <dann@ics.uci.edu>

	* printing.el (printing): Fix :version, printing.el was included
	for in emacs-22.1.
	(pr-path-style, pr-path-alist, pr-txt-name)
	(pr-txt-printer-alist, pr-ps-name, pr-ps-printer-alist)
	(pr-temp-dir, pr-ps-temp-file, pr-file-modes, pr-gv-command)
	(pr-gs-command, pr-gs-switches, pr-gs-device, pr-gs-resolution)
	(pr-print-using-ghostscript, pr-file-tumble, pr-auto-region)
	(pr-auto-mode, pr-mode-alist, pr-ps-utility)
	(pr-ps-utility-alist, pr-menu-char-height, pr-menu-char-width)
	(pr-setting-database, pr-visible-entry-list)
	(pr-delete-temp-file, pr-list-directory, pr-buffer-name)
	(pr-buffer-name-ignore, pr-buffer-verbose): Remove incorrect :version.

	* ediff-util.el (ediff-nuke-selective-display): Move definition to
	top level, make it dependent on the emacs flavor.

	* play/gamegrid.el (gamegrid-kill-timer, gamegrid-start-timer):
	Test for XEmacs not for itimer.

	* term/sun-mouse.el:
	* obsolete/sun-fns.el:
	* obsolete/sun-curs.el: Remove files.

	* term/sun.el (select-previous-complex-command): Remove obsolete code.

2007-10-31  Tassilo Horn  <tassilo@member.fsf.org>

	* doc-view.el (doc-view-cache-directory): Fix bug where an integer
	was given to concat.

2007-10-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	* doc-view.el (doc-view-mode-map): Bind doc-view-goto-page to the keys
	used normally for goto-line.  Change `g' to revert the buffer.
	Add redundant `r' binding for buffer-revert.

	* mail/mailabbrev.el (mail-abbrevs-mode): Use define-minor-mode.
	(mail-abbrevs-setup): Use abbrev-expand-functions.
	(build-mail-abbrevs): Use with-temp-buffer.
	(define-mail-abbrev): Simplify.
	(mail-abbrev-expand-wrapper): Rename sendmail-pre-abbrev-expand-hook.
	Change it for use on abbrev-expand-functions.
	(mail-abbrev-complete-alias): Use with-syntax-table.

2007-10-31  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-handle-shell-command): Call `start-file-process'
	directly.  Fix bug in deleting temp file.

2007-10-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/python.el (python-mode-abbrev-table): Use :regexp.
	Merge defvar and define-abbrev-table.
	(def-python-skeleton): Use :case-fixed and :enable-function.
	(python-abbrev-pc-hook, python-abbrev-syntax-table, python-pea-hook):
	Remove.
	(python-mode): Don't modify pre-abbrev-expand-hook.

2007-10-31  Dan Nicolaescu  <dann@ics.uci.edu>

	* ediff-util.el (ediff-file-checked-out-p)
	(ediff-file-checked-in-p): Only call vc-locking-user for XEmacs.

2007-10-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	* abbrev.el (abbrev-symbol): Correct let->let*.
	(abbrev--before-point): Only use abbrev-start-location if before point.

2007-10-31  Juanma Barranquero  <lekktu@gmail.com>

	* strokes.el (strokes-alphabetic-lessp): Simplify.  Doc fix.
	(strokes-unload-hook): Remove function and variable.
	(strokes-unload-function): New-style unload function, adapted
	from `strokes-unload-hook'.

	* emacs-lisp/cl.el (cl-cannot-unload): Remove function.
	(cl-unload-hook): Remove variable.
	(cl-unload-function): New-style unload function, adapted
	from `cl-cannot-unload'.

	* emacs-lisp/elp.el (elp-unload-hook): Remove function and variable.
	(elp-unload-function): New-style unload function, adapted
	from `elp-unload-hook'.

2007-10-31  Sean O'Rourke  <sorourke@cs.ucsd.edu>

	* emacs-lisp/find-func.el (find-library): Use library at
	point as default interactive argument.

2007-10-31  Juanma Barranquero  <lekktu@gmail.com>

	* shadowfile.el (shadow-join): Remove.
	(shadow-shadows): Use `mapconcat' instead of `shadow-join'.
	(shadow-initialize): Use `write-file-functions', not `write-file-hooks'.
	(shadowfile-unload-hook): Remove function and variable.
	(shadowfile-unload-function): New-style unload function, adapted
	from `shadowfile-unload-hook'.

2007-10-31  Dan Nicolaescu  <dann@ics.uci.edu>

	* progmodes/mixal-mode.el (mixal-run, mixal-debug): Call mixvm
	only if it is bound.

	* textmodes/reftex.el: Move autoloads for before all uses.
	(reftex-make-overlay, reftex-overlay-put, reftex-move-overlay)
	(reftex-delete-overlay): Move to the top level with the condition
	in the body.

	* progmodes/simula.el: Use when instead of if.

	* iimage.el (iimage-locate-file): Define unconditionally.

	* mail/mailabbrev.el (mail-abbrev-next-line):
	* emulation/vip.el (vip-enlarge-region, vip-line)
	(vip-next-line-at-bol, vip-previous-line)
	(vip-previous-line-at-bol, vip-find-char, vip-put-back, ex-read):
	Wrap with-no-warnings around uses of next-line and previous-line.

	* ediff.el (run-ediff-from-cvs-buffer):
	* ediff-vers.el (cvs-run-ediff-on-file-descriptor):
	Remove function not used by pcl-cvs anymore.
	(noninteractive, generic-sc-get-latest-rev)
	(ediff-generic-sc-internal, ediff-generic-sc-merge-internal):
	Delete support for long obsolete generic-sc.el.

2007-10-31  Glenn Morris  <rgm@gnu.org>

	* cvs-status.el: No longer require pcvs when compiling.

	* doc-view.el (doc-view-conversion-refresh-interval)
	(doc-view-dvi->pdf, doc-view-pdf/ps->png, doc-view-pdf->txt)
	(doc-view-reset-slice): Doc fixes.
	(doc-view-menu): Remove deleted function doc-view-edit-doc.

2007-10-31  Juanma Barranquero  <lekktu@gmail.com>

	* help-at-pt.el (help-at-pt-unload-hook): Remove.
	Timers are automatically canceled by `unload-feature'.

	* delsel.el (delsel-unload-hook): Remove function and variable.
	(delsel-unload-function): New-style unload function, adapted
	from `delsel-unload-hook'.

	* msb.el (msb-unload-hook): Remove function and variable.
	(msb-unload-function): New-style unload function, adapted from
	`msb-unload-hook'.

2007-10-30  Juanma Barranquero  <lekktu@gmail.com>

	* desktop.el (uniquify-managed): Pacify byte compiler.
	(desktop-buffer-info): If the buffer name is managed by uniquify,
	save the base name, not the uniquified one.
	(desktop-create-buffer): Allow `rename-buffer' to generate a new
	name in case of conflict.

2007-10-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* doc-view.el: Use expand-file-name rather than concat.
	(doc-view-cache-directory): Add the UID so multiple users won't clash.
	(doc-view-current-overlay, doc-view-pending-cache-flush): New vars.
	(doc-view-goto-page, doc-view-insert-image, doc-view-buffer-message)
	(doc-view-toggle-display): Use an overlay over the whole buffer so as
	not to have to touch the buffer's content.
	(doc-view-initiate-display): New function, extracted from doc-view-mode.
	(doc-view-mode): Use it.  Don't mark as a special mode.
	Put the page numbers in the modeline.
	Set up the overlay.  Hide the cursor.  Run the mode hook.
	Use after-revert-hook rather than revert-buffer-function.
	(doc-view-search-internal): Fix typo.
	(doc-view-convert-current-doc, doc-view-insert-image): Delay the
	image-cache flush.
	(doc-view-reconvert-doc): Don't reset the whole mode.
	(doc-view-make-safe-dir): New function.
	(doc-view-current-cache-dir): Use it.

2007-10-30  Jason Rumney  <jasonr@gnu.org>

	* time.el (display-time-world-list): Test for zoneinfo support.

2007-10-30  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-maybe-open-connection): Set $LC_ALL to "C".

	* net/tramp-cache.el (tramp-flush-file-function): Check also
	`default-directory' if `buffer-file-name' does not return a
	string.  Added to `eshell-pre-command-hook'.

2007-10-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* doc-view.el (doc-view-current-doc): Remove.
	Replace all uses by buffer-file-name.
	(doc-view-menu): New menu.
	(doc-view-reconvert-doc): Don't bind inhibit-read-only and remove
	unused var `doc'.
	(doc-view-sort): Simplify.
	(doc-view-buffer-message): Don't change buffer-modified-p.
	(doc-view-mode): Change it here instead.
	Tighten scoping of prev-major-mode.  Don't re-insert the file's content.
	Don't modify the global value of revert-buffer-function.

	* image-mode.el (image-forward-hscroll, image-next-line, image-eol)
	(image-eob, image-mode, image-minor-mode, image-toggle-display-text)
	(image-toggle-display): Take overlays into account and don't assume
	point-min==1.

2007-10-30  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* vc.el (vc-annotate): Fix omission bug:
	Specify value for vc-sentinel-movepoint.

2007-10-30  Michael Olson  <mwolson@gnu.org>

	* textmodes/remember.el (remember-mode-hook)
	(remember-handler-functions, remember-annotation-functions):
	Add additional items as options, including some Org functions.

2007-10-30  Tassilo Horn  <tassilo@member.fsf.org>

	* doc-view.el: Remove cl-dependency.
	(doc-view-buffer-message): Mention new binding K.
	(doc-view-convert-current-doc): Use function d-v-current-cache-dir
	instead of variable.
	(doc-view-current-cache-dir): Better cache dir naming.
	(doc-view-current-display): Remove variable.
	(doc-view-edit-doc, doc-view-display-maybe): Remove functions.
	(doc-view-kill-proc): Set converter process to nil.
	(doc-view-minor-mode): New minor mode.
	(doc-view-minor-mode-map): New keymap.
	(doc-view-mode): Remove text/image switching code.  Use plain defun.
	(doc-view-mode-map): New binding K kills converter process.
	Remove C-c C-e binding.
	(doc-view-mode-text-map): Remove keymap.
	(doc-view-pdf/ps->png): Timer calls d-v-display instead of
	d-v-display-maybe.
	(doc-view-previous-major-mode): New variable.
	(doc-view-ps->pdf): Resort args to make ps2pdf happy.
	(doc-view-remove-if): New function.
	(doc-view-search-next-match, doc-view-search-previous-match): Use it.
	(doc-view-toggle-display): Toggle modes instead of display styles.
	(doc-view-reconvert-doc): Adapt to new way of doing things.

	* progmodes/ps-mode.el (ps-mode-map): Enable doc-view-minor-mode.

2007-10-30  Glenn Morris  <rgm@gnu.org>

	* dirtrack.el (dirtrack-mode): Doc fix.

	* shell.el (shell-dirtrack-verbose, shell-mode)
	(shell-directory-tracker, shell-dirtrack-mode): Doc fix.

	* emacs-lisp/bytecomp.el (byte-compile-disable-warning)
	(byte-compile-enable-warning): Doc fix.

	* emulation/tpu-mapper.el (tpu-map-key): Use with-no-warnings to
	suppress byte-opt warning.

2007-10-30  Dan Nicolaescu  <dann@ics.uci.edu>

	* emulation/edt.el (edt-emacs19-p, edt-x-emacs19-p)
	(edt-gnu-emacs19-p): Remove.
	(edt-emacs-variant, edt-window-system): Use feature 'emacs.
	(edt-xserver, edt-page-backward, edt-beginning-of-line)
	(edt-end-of-line-forward, edt-end-of-line-backward)
	(edt-one-word-forward, edt-one-word-backward, edt-character)
	(edt-line-forward, edt-next-line, edt-previous-line, edt-top)
	(edt-find-forward, edt-find-backward, edt-find-next-forward)
	(edt-find-next-backward, edt-reset, edt-advance, edt-backup)
	(edt-define-key, edt-bottom-check, edt-sentence-forward)
	(edt-sentence-backward, edt-paragraph-forward)
	(edt-paragraph-backward, edt-restore-key, edt-window-top)
	(edt-window-bottom, edt-scroll-window-forward-line)
	(edt-scroll-window-backward-line, edt-line-to-bottom-of-window)
	(edt-line-to-top-of-window, edt-paragraph-backward)
	(edt-restore-key, edt-window-top, edt-window-bottom)
	(edt-scroll-window-forward-line)
	(edt-scroll-window-backward-line, edt-line-to-bottom-of-window)
	(edt-line-to-middle-of-window, edt-goto-percentage)
	(edt-display-the-time, edt-remember, edt-split-window)
	(edt-emulation-on, edt-emulation-off)
	(edt-default-emulation-setup, edt-user-emulation-setup)
	(edt-select-default-global-map, edt-select-user-global-map):
	Replace uses of edt-x-emacs19-p and edt-gnu-emacs19-p with feature
	tests.

	* textmodes/reftex-index.el (reftex-index-selection-or-word):
	Use feature test instead of boundp test so it can be resolved at
	compile time.

	* net/newsticker.el (replace-regexp-in-string): Only define for XEmacs.

2007-10-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* abbrev.el: Rename `count' and `system-flag' to :count and :system.
	Update all users.
	(abbrev-get, abbrev-put): Simplify.
	(define-abbrev): Don't store the `force' value in the :system property.
	(abbrev--before-point): Obey the :enable-function of the abbrev as well.

2007-10-30  Michael Olson  <mwolson@gnu.org>

	* desktop.el (desktop-minor-mode-table): Add line for ERC.

	* textmodes/remember.el: New file that implements a mode for
	quickly jotting down things to remember.

	* textmodes/remember-diary.el: A backend for remember.el that
	implements saving notes to a Diary file.

2007-10-29  Ken Manheimer  <ken.manheimer@gmail.com>

	* allout.el (allout-command-prefix, allout-inhibit-auto-fill):
	Relocate in file.
	(allout-doublecheck-at-and-shallower): Increase to include
	slightly greater depths, since yank interaction is now ok.
	Also, elaborate the docstring to explain the situation.
	(produce-allout-mode-map, allout-hotspot-key-handler): Use vconcat
	instead of concat, so we accommodate key sequences expressed as
	vectors as well as strings and lists.
	(allout-flag-region, allout-hide-by-annotation): Make the
	hidden-text overlays 'front-advance.
	(allout-overlay-insert-in-front-handler): Correct docstring's grammar.
	(allout-aberrant-container-p, allout-on-current-heading-p)
	(allout-e-o-prefix-p, allout-next-heading)
	(allout-previous-heading, allout-goto-prefix)
	(allout-end-of-prefix, allout-next-sibling-leap)
	(allout-next-visible-heading, allout-auto-fill)
	(allout-rebullet-heading, allout-kill-line, allout-kill-topic)
	(allout-yank-processing, allout-resolve-xref)
	(allout-current-topic-collapsed-p, allout-hide-region-body)
	(allout-latex-verbatim-quote-curr-line, allout-encrypt-string)
	(allout-encrypted-topic-p, allout-next-topic-pending-encryption)
	(count-trailing-whitespace-region): Preserve match data, so allout
	outline navigation doesn't disrupt other Emacs operations.
	(allout-beginning-of-line): Retreat to the beginning of the hidden
	text, so fields are respected (for submodes that care).
	(allout-end-of-line): Preserve mark activation status when jumping.
	(allout-open-topic): Account for opening after a child that
	contains a hidden trailing newline.  Preserve match data.
	Run allout-structure-added-hook.
	(allout-encrypt-decrypted): Preserve match data.
	(allout-toggle-current-subtree-exposure): Add new interactive
	function for toggle subtree exposure - suggested by tassilo.
	(move-beginning-of-line, move-end-of-line): Don't use
	line-move-invisible-p, it's obsolete - substitute the code, instead.

2007-10-29  Dan Nicolaescu  <dann@ics.uci.edu>

	* textmodes/flyspell.el (message-signature-separator):
	* longlines.el (message-indent-citation-function): Pacify byte
	compiler.

	* emacs-lisp/cl-loaddefs.el:
	* ldefs-boot.el: Regenerate.

	* Makefile.in (BYTE_COMPILE_EXTRA_FLAGS): New variable.
	(.el.elc, compile, compile-always, compile-calc)
	($(lisp)/progmodes/cc-mode.elc): Use it.

	* ps-print.el (ps-xemacs-color-name, ps-xemacs-face-kind-p):
	Only do work for XEmacs.
	(ps-xemacs-mapper): Rename from ps-mapper, only work on XEmacs.
	(ps-xemacs-extent-sorter): Rename from ps-extent-sorter, only work
	on XEmacs.
	(ps-x-color-instance-p, ps-x-color-instance-rgb-components)
	(ps-x-color-name, ps-x-color-specifier-p)
	(ps-x-copy-coding-system, ps-x-device-class)
	(ps-x-extent-end-position, ps-x-extent-face)
	(ps-x-extent-priority, ps-x-extent-start-position)
	(ps-x-face-font-instance, ps-x-find-coding-system)
	(ps-x-font-instance-properties, ps-x-make-color-instance)
	(ps-x-map-extents, ps-e-face-bold-p, ps-e-face-italic-p)
	(ps-e-next-overlay-change, ps-e-overlays-at, ps-e-overlay-get)
	(ps-e-overlay-end, ps-e-x-color-values, ps-e-color-values):
	(ps-generate-postscript-with-faces): Delete defaliases.
	(ps-face-foreground-name, ps-face-background-name)
	(ps-color-values, ps-face-bold-p, ps-face-italic-p):
	Move definitions to top level, make the body conditional on the Emacs
	flavor.  Replace uses of deleted aliases and renamed functions.
	(ps-generate-postscript-with-faces, ps-color-device): Replace uses
	of deleted aliases and renamed functions.

	* calc/calc.el (calc-emacs-type-lucid): Remove.
	(calc-digit-map, calcDigit-start, calc-read-key)
	(calc-clear-unread-commands):
	* calc/calc-ext.el (calc-user-key-map): Replace uses of
	calc-emacs-type-lucid with (featurep 'xemacs)

	* emulation/tpu-mapper.el: Replace tpu-lucid-emacs19-p with
	(featurep 'xemacs).
	(tpu-lucid-emacs19-p): Remove.
	(tpu-map-key): Make it a function instead of using fset.  Inline
	tpu-emacs-map-key and tpu-lucid-map-key.  Use featurep 'xemacs.
	(tpu-emacs-map-key, tpu-lucid-map-key): Remove.

	* ielm.el: Use featurep 'xemacs.

	* progmodes/cperl-mode.el (cperl-xemacs-p): Remove.
	(condition-case, cperl-can-font-lock, cperl-singly-quote-face)
	(cperl-define-key, cperl-mode-map, cperl-mode, cperl-init-faces)
	(cperl-write-tags, cperl-tags-hier-init, cperl-perldoc): Replace
	cperl-xemacs-p with (featurep 'xemacs).
	(font-lock-cache-position): Pacify byte compiler.

2007-10-29  Drew Adams  <drew.adams@oracle.com>

	* faces.el (read-color): New function.
	(face-at-point, foreground-color-at-point)
	(background-color-at-point): New functions.

2007-10-28  Richard Stallman  <rms@gnu.org>

	* net/browse-url.el (browse-url-text-xterm): Rename from
	browse-url-lynx-xterm and made generic.
	(browse-url-text-emacs): Likewise.
	(browse-url-text-browser): New variable.
	(browse-url-text-emacs-args): Rename from browse-url-lynx-emacs-args.
	(browse-url-text-input-field, browse-url-text-input-attempts)
	(browse-url-kde-program): Likewise.

2007-10-29  Glenn Morris  <rgm@gnu.org>

	* textmodes/org-publish.el (org-publish-get-plist-from-filename):
	Use mapc rather than mapcar (reinstall change deleted without log
	entry 2007-10-22).

2007-10-29  Martin Rudalics  <rudalics@gmx.at>

	* wdired.el (wdired-next-line, wdired-previous-line):
	Use next-line and previous-line wrapped in with-no-warnings.

2007-10-29  Ryan Yeske  <rcyeske@gmail.com>

	* net/rcirc.el (rcirc-server-alist): Use keywords for parameter names.
	(rcirc-recent-quit-alist): New function.
	(rcirc): Print a better message when there is only one connected server.
	(rcirc-complete-nick): Do not update the nick table here.
	(rcirc-mode-map): Add M-o.
	(rcirc-current-line): Add variable.
	(rcirc-mode): Setup variables for line based omit.
	(rcirc-edit-multiline): Strip text properties.
	(rcirc-omit-responses): Add NICK.
	(rcirc-omit-threshold): Add variable.
	(rcirc-last-quit-line, rcirc-last-line, rcirc-elapsed-lines):
	Add functions.
	(rcirc-print): Keep track of current line.  Do not fill text if
	`rcirc-fill-flag' is null.  Only omit text if the last activity
	from the sender is more than `rcirc-omit-threshold' lines ago.
	(rcirc-put-nick-channel, rcirc-handler-PRIVMSG): Track line
	numbers instead of time.
	(rcirc-channel-nicks): Sort by line numbers instead of time.
	(rcirc-omit-mode): Add `...' when omitting text and recenter.
	(rcirc-handler-JOIN): Restore the joiners linestamp.
	(rcirc-maybe-remember-nick-quit): Add function.
	(rcirc-handler-QUIT): Record sender in table of recently quit nicks.

2007-10-29  Juanma Barranquero  <lekktu@gmail.com>

	* loadhist.el (unload-feature-special-hooks):
	Add `delete-frame-functions' and `suspend-tty-functions'.

	* server.el (server-unload-function): Rename from `server-unload-hook'
	and adapt to new `unload-feature' functionality.  Remove hook from
	`kill-buffer-hook' buffer-locally.
	(server-unload-hook): Remove.
	(server-unload-function): New var; replaces `server-unload-hook'.

2007-10-29  Glenn Morris  <rgm@gnu.org>

	* dirtrack.el (dirtrack-debug): Doc fix.
	(dirtrack-mode, dirtrack-debug-mode): New names for
	dirtrack-toggle and dirtrack-debug-toggle.  Use define-minor-mode.
	(dirtrack-toggle, dirtrack-debug-toggle, dirtrackp, dirtrack-debug):
	Make obsolete.
	(dirtrack-debug-message): Only print message if
	dirtrack-debug-mode is non-nil.  Use with-current-buffer.
	(dirtrack): Doc fix.  Use dirtrack-mode rather than dirtrackp.
	Remove dirtrack-debug checks now that dirtrack-debug-message does this.

2007-10-28  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/bytecomp.el (byte-compile-warnings): Document `not'.
	(byte-compile-warnings-safe-p): Handle `not'.
	(byte-compile-warning-enabled-p, byte-compile-disable-warning)
	(byte-compile-enable-warning): New functions.
	(byte-compile-eval-before-compile)
	(byte-compile-file-form-require): Use byte-compile-disable-warning.
	(byte-compile-close-variables): Locally bind byte-compile-warnings,
	but do not modify it.
	(byte-compile-eval, byte-compile-obsolete)
	(byte-compile-warn-about-unresolved-functions)
	(byte-compile-file-form-defvar)
	(byte-compile-file-form-custom-declare-variable)
	(byte-compile-file-form-require)
	(byte-compile-file-form-defmumble, byte-compile-lambda)
	(byte-compile-form, byte-compile-normal-call)
	(byte-compile-variable-ref, byte-compile-defvar)
	(byte-compile-make-variable-buffer-local):
	Use byte-compile-warning-enabled-p.
	* emacs-lisp/advice.el (ad-compile-function):
	Use byte-compile-disable-warning.
	* emacs-lisp/cl.el: Move local variables to end of file, and set
	byte-compile-warnings to `(not cl-functions)'.
	* emacs-lisp/cl-compat.el: Add a local variables section, and set
	byte-compile-warnings to `(not cl-functions)'.
	* emacs-lisp/cl-macs.el: Unify local variable section, and set
	byte-compile-warnings to `(not cl-functions)'.
	(cl-do-proclaim): Use byte-compile-disable-warning and
	byte-compile-enable-warning.
	* emacs-lisp/cl-seq.el: Unify local variable section, and set
	byte-compile-warnings to `(not cl-functions)'.
	* progmodes/cc-bytecomp.el (cc-bytecomp-ignore-obsolete):
	Use byte-compile-disable-warning.

2007-10-28  Dan Nicolaescu  <dann@ics.uci.edu>

	* cus-edit.el (custom-browse-insert-prefix):
	* emulation/edt.el (edt-x-emacs19-p): Use featurep 'xemacs.

2007-10-28  Juanma Barranquero  <lekktu@gmail.com>

	* server.el (server-process-filter): Fix typo in docstring.
	(server-log): Reflow docstrings.
	(server-delete-client, server-kill-emacs-query-function): Doc fixes.
	(server-goto-line-column): Use `when'.

2007-10-28  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-other-meta-char): Call `isearch-edit-string'
	when mouse is clicked on the isearch message.
	(isearch-resume): Call `isearch-update' at the end.
	Rename argument `search' to `string' to conform to the
	isearch terminology.

2007-10-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	Rewrite abbrev.c in Elisp.
	* abbrev.el (abbrev-mode): Move custom group from cus-edit.el.
	(abbrev-table-get, abbrev-table-put, abbrev-get)
	(abbrev-put, make-abbrev-table, abbrev-table-p, clear-abbrev-table)
	(define-abbrev, abbrev--check-chars, define-global-abbrev)
	(define-mode-abbrev, abbrev--active-tables, abbrev-symbol)
	(abbrev-expansion, abbrev--before-point, expand-abbrev)
	(unexpand-abbrev, abbrev--write, abbrev--describe)
	(insert-abbrev-table-description, define-abbrev-table):
	New funs, largely transcribed from abbrev.c.
	(abbrev-with-wrapper-hook): New macro.
	(abbrev-table-name-list, global-abbrev-table)
	(abbrev-minor-mode-table-alist, fundamental-mode-abbrev-table)
	(abbrevs-changed, abbrev-all-caps, abbrev-start-location)
	(abbrev-start-location-buffer, last-abbrev, last-abbrev-text)
	(last-abbrev-location, pre-abbrev-expand-hook, abbrev-expand-function):
	New vars, largely transcribed from abbrev.c.
	* cus-edit.el (abbrev-mode): Remove.  Move to abbrev.el.
	* cus-start.el: Remove abbrev-all-caps and pre-abbrev-expand-hook.
	* loadup.el: Load "abbrev.el" before "lisp-mode.el".

2007-10-27  Glenn Morris  <rgm@gnu.org>

	* shell.el (shell-dirtrack-verbose, shell-directory-tracker): Doc fix.
	(shell-dirtrack-toggle): Mark as obsolete.
	(dirtrack-toggle, dirtrack-mode): No longer alias to
	shell-dirtrack-mode.

2007-10-27  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc.el (math-standard-opers): Lower the precedence
	of negation.
	* calc/calc-lang.el (math-oper-table): Lower precedence of
	negation for C, TeX, and eqn.

2007-10-27  Dan Nicolaescu  <dann@ics.uci.edu>

	* progmodes/cc-defs.el: Reorder conditions to avoid warnings.

2007-10-27  Juanma Barranquero  <lekktu@gmail.com>

	* desktop.el (desktop-load-locked-desktop, desktop-base-lock-name)
	(desktop-not-loaded-hook): Fix :version tags.

2007-10-27  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-wrong-passwd-regexp): Tune regexp.
	(tramp-get-remote-tmpdir): New defun.
	(tramp-make-tramp-temp-file): Use it.
	(tramp-local-call-process): New defun.  Replace all calls of
	`call-process' by this when appropriate.
	(tramp-handle-write-region): Replace calls of `file-attributes' by
	`tramp-compat-file-attributes'.
	(tramp-find-shell, tramp-open-connection-setup-interactive-shell):
	Make the first command a `tramp-send-command' call, with let-bind
	of `tramp-end-of-output'.
	(tramp-version, tramp-bug, tramp-reporter-dump-variable)
	(tramp-load-report-modules, tramp-append-tramp-buffers):
	Move to tramp-cmds.el.

	* net/tramp-fish.el (tramp-fish-handle-copy-file)
	(tramp-fish-do-copy-or-rename-file)
	(tramp-fish-do-copy-or-rename-file-directly):
	* net/tramp-smb.el (tramp-smb-handle-copy-file):
	Add parameter PRESERVE-UID-GID.

2007-10-27  Eli Zaretskii  <eliz@gnu.org>

	* time.el (zoneinfo-style-world-list, legacy-style-world-list):
	New defcustoms.
	(display-time-world-list): Use them as appropriate for the current
	value of `system-type'.

2007-10-26  Dan Nicolaescu  <dann@ics.uci.edu>

	* emulation/pc-select.el (next-line-mark, next-line-nomark)
	(previous-line-mark, previous-line-nomark): Wrap with-no-warnings
	around uses of previous-line and next-line.

	* diff.el (diff-old-file, diff-new-file, diff-extra-args):
	New defvars.

	* textmodes/css-mode.el (comment-continue):
	* net/browse-url.el (url-handler-regexp):
	* progmodes/idlw-help.el (idlwave-system-routines):
	Pacify byte-compiler.

	* textmodes/fill.el (fill-nobreak-p): Replace obsolete alias
	line-move-invisible-p with its former definition: invisible-p.
	line-move-invisible-p was removed on 2007-08-29.

2007-10-26  Juanma Barranquero  <lekktu@gmail.com>

	* files.el (kill-emacs-query-functions): Doc fix;
	`save-buffers-kill-emacs' is no longer bound to a key.

2007-10-26  Richard Stallman  <rms@gnu.org>

	* isearch-multi.el (isearch-buffers-multi): New option.
	(isearch-buffers-search-fun): Test it.

	* progmodes/ps-mode.el (ps-mode-map): Delete C-c v binding.
	Put ps-run-clear on C-c C-l.

	* newcomment.el (comment-styles): New style indent-or-triple.
	(comment-style): Make that the default.
	(comment-add defvar): Doc fix.
	(comment-add): Delete arg EXTRA.
	(comment-region-default): Open code call to comment-add.
	Handle indent-or-triple style which uses `multi-char' for INDENT.

2007-10-26  Juanma Barranquero  <lekktu@gmail.com>

	* eshell/em-unix.el (nil-blank-string): Doc fix.

2007-10-26  John Wiegley  <johnw@newartisans.com>

	* eshell/em-unix.el (eshell/diff): Before calling the `diff'
	function, ensure that the third argument is turned into a nil if
	the string is otherwise completely empty (either no characters, or
	all tabs/spaces).  This fixes a bug from a user who found himself
	unable to customize `diff-switches' and still use Eshell's diff
	command.

2007-10-26  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/bytecomp.el (byte-compile-warnings): Autoload the
	safe-local-variable property.

2007-10-26  Gwern Branwen  <gwern0@gmail.com>  (tiny change)

	* net/browse-url.el (browse-url-browser-function): Delete grail.
	(browse-url-grail): Function and variable deleted.
	(browse-url-browser-function): Delete IXI Mosaic.
	(browse-url-default-browser): Don't try IXI Mosaic.
	(browse-url-iximosaic): Function deleted.
	(browse-url-browser-function): Delete MMM.
	(browse-url-default-browser): Don't try MMM.
	(browse-url-mmm): Function deleted.

2007-10-26  Drew Adams  <drew.adams@oracle.com>

	* custom.el (custom-note-var-changed): New function.

2007-10-25  Dan Nicolaescu  <dann@ics.uci.edu>

	* emulation/edt-mapper.el (edt-emacs-variant): Replace the only
	use with the definition.  Remove.

	* add-log.el (change-log-start-entry-re): New defconst.
	(change-log-sortable-date-at): Use it.
	(change-log-beginning-of-defun, change-log-end-of-defun):
	New functions.
	(change-log-mode): Use them for beginning-of-defun-function and
	end-of-defun-function.

2007-10-25  Jonathan Yavner  <jyavner@member.fsf.org>

	* ses.el: Make `ses--symbolic-formulas' a safe local variable.
	(ses-mode-print-map): Add `c' and `t' (suggested by Gareth Rees).
	(ses-recalculate-cell): Deal with point being just beyond end of
	data area (why does this happen?)
	(ses-set-curcell): Ditto.
	(ses-column-letter): Handle columns beyond 702.  Code written by
	Gareth Rees.

2007-10-25  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el (org-agenda-get-restriction-and-command):
	Use `mapc' instead of `mapcar'.
	(org-agenda-list): Numeric prefix argument can specify the number
	of days.
	(remember-register, remember-buffer): Prevent byte compiler from
	complaining.
	(org-todo): Save and restore match data.
	(org-no-warnings): New macro.
	(org-columns-eval): Use `org-no-warnings'.

2007-10-25  Chris Moore  <christopher.ian.moore@gmail.com>

	* comint.el (comint-password-prompt-regexp):
	Handle `[sudo] password'-style prompt.

2007-10-25  Glenn Morris  <rgm@gnu.org>

	* custom.el (custom-declare-variable): Add :risky and :safe keywords.
	(defcustom): Doc fix.

	* progmodes/f90.el (f90-keywords-re, f90-keywords-level-3-re):
	Add `non_intrinsic'.
	(f90-constants-re): Add ieee modules.
	(f90-typedef-matcher, f90-typedec-matcher)
	(f90-imenu-type-matcher): New functions.
	(f90-font-lock-keywords-1): Give module procedures function-name face.
	Use `f90-typedef-matcher' for derived types.  Fix `abstract interface'.
	Add `use, intrinsic'.
	(f90-font-lock-keywords-2): Use `f90-typedec-matcher' for derived types.
	Move start of `enum' blocks to separate entry.
	(f90-start-block-re): Fix `type', `abstract interface'.
	(f90-imenu-generic-expression): Use `f90-imenu-type-matcher' for
	derived types.
	(f90-mode-abbrev-table): Add `abstract interface', `asynchronous',
	`elemental', change `enumerator'.
	(f90-no-block-limit): Fix `abstract interface'.

	* progmodes/f90.el (f90-indented-comment-re)
	(f90-directive-comment-re, f90-break-delimiters):
	* progmodes/fortran.el (fortran-comment-line-start-skip)
	(fortran-directive-re):
	* textmodes/conf-mode.el (conf-space-keywords): Mark these regexps
	as safe if they are strings.

2007-10-25  Stefan Monnier  <monnier@iro.umontreal.ca>

	* startup.el (window-system): Remove.  Don't make it frame-local.

2007-10-24  Richard Stallman  <rms@gnu.org>

	* savehist.el (savehist-save): Omit unreadable elements.

	* loadhist.el (unload-function-defs-list): Rename from
	unload-function-features-list.
	(unload-feature-special-hooks, unload-feature): Doc fixes.

	* indent.el (indent-to-left-margin): If point's in the indentation,
	move to the end of the indentation.

	* cus-edit.el (customize-changed-options): Make arg optional.

2007-10-24  Juanma Barranquero  <lekktu@gmail.com>

	* bs.el (bs-select, bs-select-other-window): Fix typos in docstrings.

2007-10-24  Dan Nicolaescu  <dann@ics.uci.edu>

	* textmodes/org-publish.el (org-publish-attachment): Re-install
	accidentally deleted change.

2007-10-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* term/iris-ansi.el (iris-function-map): Move init into declaration.

2007-10-24  Juanma Barranquero  <lekktu@gmail.com>

	* buff-menu.el (Buffer-menu-sort-column): Doc fix.
	(Buffer-menu-mode-map): Initialize in the declaration.
	(Buffer-menu-mode): Define with `define-derived-mode'.

2007-10-24  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el (org-version): Change to 5.13e.
	(org-agenda-file-regexp): Fix typo in docstring.
	(org-add-planning-info): Fix bug in parenthesis settings.
	(org-scan-tags): Catch the case of indirect buffers with no filename.
	(org-fast-tag-selection, org-export-as-ascii, org-export-as-html):
	Re-install switch to mapc, had been removed by accident.
	(org-columns-map): New binding `C-c C-o'.
	(org-columns-menu): Change menu text and added new entry.
	(org-columns-eval): Document the use of `next-line'.
	(org-columns-open-link): New function.
	(org-columns-follow-link): Remove function.
	(org-open-link-from-string): New function.
	(org-read-date-get-relative): Fix typo in docstring.
	(org-read-date-get-relative): Leading +/- is not optional.
	(org-agenda-get-restriction-and-command): Always resize window on
	first loop cycle.
	(org-agenda-open-link): Make sure the link abbreviations are
	present in the agenda buffer.
	(org-agenda-copy-local-variable): New function.

2007-10-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc.el (vc-update-changelog-rcs2log): Remove incorrect `backend' arg.

2007-10-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (reindent-then-newline-and-indent): Use a `move after
	insert' kind of marker in the save-excursion.

2007-10-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/css-mode.el: Require CL.
	(comment-continue): Declare.

	* subr.el (make-variable-frame-localizable): Remove.
	(make-variable-frame-local): Mark obsolete.

2007-10-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/tex-mode.el (tex-uptodate-p): Don't signal an error if one
	of the subdirs is unreadable.

2007-10-23  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-set-file-uid-gid): Protect `call-process'
	when we are local.

2007-10-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/python.el (python-current-defun): Remove left-over
	assignment to `start'.

2007-10-23  Juanma Barranquero  <lekktu@gmail.com>

	* ibuf-ext.el (ibuffer-auto-update-changed): Use `dolist' rather
	than `mapcar'; return value is not used.

2007-10-23  Dan Nicolaescu  <dann@ics.uci.edu>

	* progmodes/gud.el (gdb-source-window, gud-tooltip-mode)
	(hl-line-mode, hl-line-sticky-flag): Pacify byte compiler.

2007-10-23  Juanma Barranquero  <lekktu@gmail.com>

	* ibuf-ext.el (ibuffer-switch-to-saved-filters)
	(ibuffer-switch-to-saved-filter-groups): Doc fixes.

2007-10-23  Dan Nicolaescu  <dann@ics.uci.edu>

	* term/xterm.el (terminal-init-xterm): Experiment with a longer timeout.

2007-10-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* emacs-lisp/advice.el (ad-make-advised-docstring):
	Add ad-advice-info text property to doc string.

2007-10-23  Glenn Morris  <rgm@gnu.org>

	* progmodes/f90.el (f90-do-indent, f90-if-indent)
	(f90-type-indent, f90-program-indent, f90-associate-indent)
	(f90-continuation-indent, f90-comment-region)
	(f90-beginning-ampersand, f90-smart-end)
	(f90-break-before-delimiters, f90-auto-keyword-case)
	(f90-leave-line-no, f90-mode-hook):
	Give an appropriate safe-local-variable property.

	* progmodes/fortran.el (fortran-tab-mode-default)
	(fortran-tab-mode-string, fortran-do-indent, fortran-if-indent)
	(fortran-structure-indent, fortran-continuation-indent)
	(fortran-comment-indent, fortran-comment-line-extra-indent)
	(fortran-comment-line-start)
	(fortran-minimum-statement-indent-fixed)
	(fortran-minimum-statement-indent-tab)
	(fortran-comment-indent-char, fortran-line-number-indent)
	(fortran-check-all-num-for-matching-do)
	(fortran-blink-matching-if, fortran-continuation-string)
	(fortran-comment-region, fortran-electric-line-number)
	(fortran-column-ruler-fixed, fortran-column-ruler-tab)
	(fortran-analyze-depth, fortran-break-before-delimiters):
	Give an appropriate safe-local-variable property.

2007-10-23  Dan Nicolaescu  <dann@ics.uci.edu>

	* printing.el: Move variable definitions before use.
	(pr-menu-char-width, pr-menu-char-height): Pacify byte compiler.

2007-10-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emulation/tpu-edt.el (tpu-edt-old-global-values): New var.
	(tpu-edt-off): Use it.
	(tpu-edt-on): Set it.  Make sure the tpu-global-map is not already on
	the global-map before adding it to global-map.

	* menu-bar.el (global-buffers-menu-map): New var.
	(global-map, menu-bar-update-buffers): Use it.
	* msb.el (msb-menu-bar-update-buffers): Use it.
	(msb-sort-by-directory, msb--choose-menu, msb--mode-menu-cond)
	(msb--most-recently-used-menu, msb--create-buffer-menu-2):
	Use with-current-buffer.

2007-10-22  Juri Linkov  <juri@jurta.org>

	* isearch-multi.el: New file.

	* isearch.el (isearch-search-string): After finding the next
	occurrence switch to buffer isearch-buffers-current-buffer when
	isearch-buffers-next-buffer-function is non-nil and
	isearch-buffers-current-buffer is live.

	* add-log.el (change-log-mode): Make and set buffer-local variable
	isearch-buffers-next-buffer-function to change-log-next-buffer.
	Call isearch-buffers-minor-mode.
	(change-log-next-buffer): New function.

2007-10-22  Bastien Guerry  <Bastien.Guerry@ens.fr>

	* textmodes/org-export-latex.el (org-export-latex-protect-string):
	Renaming of `org-latex-protect'.
	(org-export-latex-emphasis-alist): By default, don't protect
	any emphasis formatter from further conversion.
	(org-export-latex-tables): Honor column grouping for tables.
	(org-export-latex-title-command): New option.
	(org-export-latex-treat-backslash-char): Use \textbackslash{} to
	export backslash character.

2007-10-22  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el (org-read-date-get-relative): New function.
	(org-agenda-file-regexp): New variable.
	(org-agenda-files): Allow directories in the variable.
	(org-agenda-get-restriction-and-command): New function.
	(org-agenda): Use `org-agenda-get-restriction-and-command'.
	(org-todo-blocker-hook, org-todo-trigger-hook): New hooks.
	(org-entry-is-todo-p, org-entry-is-done-p, org-get-todo-state):
	New functions.
	(org-entry-add-to-multivalued-property)
	(org-entry-remove-from-multivalued-property)
	(org-entry-member-in-multivalued-property): New functions.
	(org-remember-apply-template): Catch C-g and make sure window
	configuration is restored.
	(org-agenda-open-link): Make it work with several links in the line.
	(org-drawers, org-set-regexps-and-options)
	(org-get-current-options): Add support for a DRAWERS in-buffer option.
	(org-agenda-window-frame-fractions): New option.
	(org-fit-agenda-window): Use `org-agenda-window-frame-fractions'.
	(org-columns-cleanup-item, org-find-entry-with-id)
	(org-insert-columns-dblock, org-listtable-to-string)
	(org-dblock-write:columnview, org-columns-capture-view)
	(org-edit-headline): New functions.
	(org-agenda-to-appt): Require calendar.
	(org-entry-get-with-inheritance): Widen for search.
	(org-columns-display-here): Don't mark buffer as modified when
	adding space characters to accommodate column overlays.
	(org-export-as-html): Better formatting of tags in the toc.
	(org-columns-display-here): Make the ITEM column as compact as possible.
	(org-remember-templates): Customization interface improved.
	(org-export-with-property-drawer): Variable removed.
	(org-export-with-drawers): New option.
	(org-complex-heading-regexp): New variable.
	(org-sort-entries): Rewrite using `sort-subr'.
	(org-set-property): More appropriate completion during interactive use.
	(org-sort-entries): Allow sorting by property.
	(org-additional-option-like-keywords): Add more values.
	(org-sort-entries-or-items): Rename from `org-sort-entries'.

2007-10-22  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el (org-get-date-from-calendar): New function.
	(org-at-timestamp-p, org-timestamp-change)
	(org-remember-templates): First element of each entry is now a
	name for the template.
	(org-store-log-note): Check for `org-note-abort'.
	(org-kill-note-or-show-branches): New command.
	(org-fontify-priorities): New option.
	(org-fontify-priorities): New function.
	(org-cut-subtree, org-copy-subtree): New argument N to
	act on N sequential subtrees.
	(org-paste-subtree): Fix the level at which a tree is pasted.
	(org-fit-agenda-window): Limitations on window size removed.
	(org-agenda-find-same-or-today-or-agenda): Rename from
	`org-agenda-find-today-or-agenda'.
	(org-scheduled-past-days): New option.
	(org-agenda-scheduled-leaders)
	(org-agenda-deadline-leaders): New options.
	(org-agenda-get-deadlines): Use `org-agenda-deadline-leaders'.
	(org-agenda-get-scheduled): Use `org-agenda-scheduled-leaders'.
	(org-export-with-tags, org-export-plist-vars)
	(org-infile-export-plist): New "tags" option.
	(org-use-property-inheritance): New option.
	(org-cached-entry-get): Use `org-use-property-inheritance'.
	(org-remember-apply-template): Fix typo.

2007-10-22  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-find-shell)
	(tramp-open-connection-setup-interactive-shell): Improve sending
	initial commands.
	(tramp-action-terminal): Send debug message.
	(tramp-wait-for-shell-prompt, tramp-send-command-internal): Remove.
	(tramp-barf-if-no-shell-prompt): Insert code of
	`tramp-wait-for-shell-prompt'.

2007-10-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* term/AT386.el (terminal-init-AT386): Use input-decode-map.

	* term/vt200.el (terminal-init-vt200):
	* term/vt201.el (terminal-init-vt201):
	* term/vt220.el (terminal-init-vt220):
	* term/vt240.el (terminal-init-vt240):
	* term/vt300.el (terminal-init-vt300):
	* term/vt320.el (terminal-init-vt320):
	* term/vt400.el (terminal-init-vt400):
	* term/vt420.el (terminal-init-vt420): Use input-decode-map.

	* term/wyse50.el (wyse50-terminal-map): New var.
	(terminal-init-wyse50): Use it and input-decode-map.
	(enable-arrow-keys): Emasculate.

	* term/tvi970.el (tvi970-terminal-map): New var.
	(terminal-init-tvi970): Use it and input-decode-map.
	(tvi970-keypad-numeric): Remove.
	(tvi970-set-keypad-mode): Use a terminal-parameter rather than var.

	* term/sun.el (sun-raw-prefix): Fill as part of declaration.
	(terminal-init-sun): Use it and input-decode-map.

	* term/news.el (terminal-init-news):
	* term/lk201.el (terminal-init-lk201):
	* term/iris-ansi.el (terminal-init-iris-ansi): Use input-decode-map.

2007-10-22  Sean O'Rourke  <sorourke@cs.ucsd.edu>

	* complete.el (PC-expand-many-files): Remove.
	(PC-do-completion): Call file-expand-wildcards instead of
	PC-expand-many-files.

	* net/tramp.el (tramp-handle-expand-many-files): Remove.
	(PC-expand-many-files): Remove advice.

2007-10-22  Glenn Morris  <rgm@gnu.org>

	* progmodes/f90.el: Remove leading "*" from defcustom doc-strings.
	Add some support for Fortran 2003 syntax:
	(f90-type-indent): Now also applies to `enum'.
	(f90-associate-indent): New user option.
	(f90-keywords-re, f90-keywords-level-3-re, f90-procedures-re):
	Add some F2003 keywords.
	(f90-constants-re): New constant.
	(f90-font-lock-keywords-1): Add `associate' blocks, and `abstract
	Interface'.
	(f90-font-lock-keywords-2): Add `enumerator', `generic', `procedure',
	`class'.  Arguments for `type'/`class' may have spaces.  Add a new
	element for functions with specified types.  Add `end enum' and
	`select type'.  Add `implicit enumerator' and `procedure'.
	Add `class default' and `type is', `class is'.  Fix `go to' regexp.
	(f90-font-lock-keywords-3): Add `asynchronous' attribute.
	(f90-font-lock-keywords-4): Add `f90-constants-re'.
	(f90-blocks-re): Add `enum' and `associate'.
	(f90-else-like-re): Add `class is', `type is', and `class default'.
	(f90-end-type-re): Add `enum'.
	(f90-end-associate-re, f90-typeis-re): New constants.
	(f90-end-block-re): Add `enum' and `associate'.  Change from
	optional whitespace to end-of-word, to avoid `enumerator'.
	(f90-start-block-re): Add `select type', `abstract interface', and
	`enum'.  Avoid `type is', and `type (sometype)'.
	(f90-mode-abbrev-table): Add `enumerator', `protected', and `volatile'.
	(f90-mode): Doc fix.
	(f90-looking-at-select-case): Doc fix.  Add `select type'.
	(f90-looking-at-associate): New function.
	(f90-looking-at-type-like): Avoid `type is' and `type (sometype)'.
	Add `enum' and `abstract interface'.
	(f90-no-block-limit): Add `select type' and `abstract interface'.
	(f90-get-correct-indent, f90-calculate-indent)
	(f90-end-of-block, f90-beginning-of-block, f90-next-block)
	(f90-indent-region, f90-match-end): Handle `associate' blocks.

2007-10-22  Martin Rudalics  <rudalics@gmx.at>

	* progmodes/fortran.el (fortran-mode-map, fortran-window-create):
	Use window-full-width-p.

2007-10-22  Dan Nicolaescu  <dann@ics.uci.edu>

	* mail/vms-pmail.el (insert-signature): Don't use end-of-buffer.

	* tooltip.el: Use featurep 'xemacs.

	* printing.el: Move variable definitions before use, no code change.

2007-10-22  Juri Linkov  <juri@jurta.org>

	* simple.el (goto-history-element): Allow minibuffer-default to be
	a list of default values accessible by typing M-n in the minibuffer.

	* dired-x.el (dired-guess-shell-command): Put all guesses to the
	minibuffer default value list instead of pushing them temporarily
	to the history list.

2007-10-21  Dan Nicolaescu  <dann@ics.uci.edu>

	* hexl.el (hexl-menu): New major mode menu.

2007-10-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/byte-opt.el (byte-optimize-featurep): Fix paren typo.

2007-10-21  Dan Nicolaescu  <dann@ics.uci.edu>

	* w32-fns.el (w32-quote-process-args):
	* dos-w32.el (print-region-function, lpr-headers-switches)
	(ps-print-region-function): Pacify byte-compiler.

	* emulation/edt-mapper.el (function-key-map):
	(edt-map-key): Make it a function instead of using fset.
	Inline edt-gnu-map-key and edt-lucid-map-key.  Use featurep 'xemacs.
	(edt-gnu-map-key, edt-lucid-map-key): Remove.
	(edt-x-emacs-p): Remove.
	(edt-emacs-variant, edt-window-system, edt-xserver):
	Use featurep 'xemacs.

	* net/eudc.el: Use (featurep 'xemacs) instead of the string test.
	Replace eudc-xemacs-p with its definition.
	(eudc-xemacs-p, eudc-emacs-p, eudc-xemacs-mule-p)
	(eudc-emacs-mule-p): Remove.
	(eudc-install-menu, eudc-mode): Replace eudc-emacs-p and
	eudc-xemacs-p with feature tests.

	* net/eudc-bob.el (eudc-bob-generic-menu, eudc-bob-mail-keymap)
	(eudc-bob-url-keymap, eudc-bob-sound-keymap)
	(eudc-bob-generic-keymap, eudc-bob-popup-menu)
	(eudc-bob-toggle-inline-display):
	* net/eudc-hotlist.el (eudc-hotlist-emacs-menu):
	Replace eudc-emacs-p and eudc-xemacs-p with feature tests.

	* net/eudcb-ph.el (eudc-ph-open-session):
	Replace eudc-xemacs-mule-p with its former definition.

	* progmodes/octave-mod.el (octave-xemacs-p): Remove.
	(octave-abbrev-start): Replace octave-xemacs-p with (featurep 'xemacs).

	* progmodes/vera-mode.el (vera-xemacs): Remove.
	(vera-mode-syntax-table): Replace vera-xemacs with (featurep 'xemacs).

	* progmodes/vhdl-mode.el (vhdl-xemacs): Remove.
	(vhdl-doc-mode, vhdl-doc-variable, vhdl-compile-init)
	(vhdl-speedbar-initialize, vhdl-ps-print-init)
	(vhdl-forward-comment, vhdl-mode-map-init, vhdl-show-messages)
	(vhdl-emacs-22, vhdl-emacs-21): Replace vhdl-xemacs
	with (featurep 'xemacs).

	* progmodes/antlr-mode.el (cond-emacs-xemacs-macfn, defunx)
	(save-buffer-state-x):
	* obsolete/fast-lock.el (fast-lock-verbose):
	* emulation/viper-init.el (viper-xemacs-p)
	(viper-cond-compile-for-xemacs-or-emacs):
	* emacs-lisp/checkdoc.el (checkdoc-minor-mode-map):
	* ps-print.el (case-fold-search):
	* ediff-hook.el (ediff-cond-compile-for-xemacs-or-emacs):
	* calculator.el (calculator-help): Use featurep 'xemacs.

	* progmodes/prolog.el: Undo previous change.
	(comint-prompt-regexp, comint-process-echoes): Pacify byte-compiler.

	* progmodes/dcl-mode.el:
	* play/yow.el:
	* calendar/todo-mode.el:
	* calendar/cal-hebrew.el:
	* vc-hg.el: Undo previous change.

	* vms-patch.el: Likewise.
	(print-region-function): Pacify byte-compiler.

2007-10-21  Michael Albinus  <michael.albinus@gmx.de>

	* files.el (backup-buffer-copy): Call `copy-file' with non-nil
	preserve-uid-gid.

	* net/ange-ftp.el (ange-ftp-copy-file): Add PRESERVE-UID-GID for
	compatibility.  It is not used, though.

	* net/tramp.el (top): Put load of all tramp-* files into a dolist.
	Require tramp-cmds.el.
	(tramp-make-tramp-temp-file): We can get rid of DONT-CREATE.
	(tramp-handle-file-name-all-completions): Expand DIRECTORY.
	(tramp-do-copy-or-rename-file-directly): Make more rigid checks.
	(tramp-do-copy-or-rename-file-out-of-band)
	(tramp-maybe-open-connection): Use `make-temp-name'.  This is
	possible, because we don't need to create the temporary file, but
	we need a prefix for ssh, which has its own temporary file handling.
	(tramp-handle-delete-directory): Add "-f" to rmdir.
	(tramp-handle-dired-recursive-delete-directory): Call "rm -rf".
	(tramp-handle-insert-file-contents): Don't raise a tramp-error but
	a signal, in order to give the callee a chance to suppress.
	(tramp-handle-write-region): Set owner also in case of short
	track.  Don't use compatibility calls for `write-region' anymore.
	(tramp-clear-passwd): Add parameter VEC.  Adapt all callees.
	(tramp-append-tramp-buffers): Apply `tramp-list-tramp-buffers'.

	* net/tramp-cmds.el: New file.

	* net/tramp-gw.el (tramp-gw-basic-authentication): Apply VEC to
	`tramp-clear-passwd'.

	* net/trampver.el: Update release number.

2007-10-21  Dan Nicolaescu  <dann@ics.uci.edu>

	* progmodes/gud.el (gud-target-name): Move definition before use.

	* progmodes/dcl-mode.el: Require imenu at compile time.

	* progmodes/cc-engine.el (c-maybe-stale-found-type):
	Pacify byte-compiler.

	* obsolete/fast-lock.el: Use featurep test instead of string-match.

	* eshell/esh-mode.el (eshell-handle-ansi-color):
	Require ansi-color at compile time too.

	* eshell/em-unix.el (eshell/info): Require info at compile time too.

	* w32-fns.el: Require w32-vars.

	* diff-mode.el (diff-refine-hunk): Require smerge-mode at compile
	time too.

2007-10-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* double.el ([ignore]): Use `ignore'.
	(double-setup): Inline into double-mode.
	(double-mode): Use define-minor-mode.

2007-10-21  Dan Nicolaescu  <dann@ics.uci.edu>

	* textmodes/reftex.el: Move require easymenu before first use.
	(reftex-info): Require info at compile too.

	* textmodes/org-publish.el (org-publish-org-to-html)
	(org-publish-org-to): Require org at compile time too.
	(org-publish-attachment): Require at compile time too.

	* term/tty-colors.el (w32-tty-standard-colors):
	Pacify byte-compiler.

	* term/pc-win.el (frame-creation-function-alist): Add to this
	instead of setting frame-creation-function.

	* play/blackbox.el (bb-up, bb-down): Use forward-line.

	* net/rcirc.el (rcirc-markup-text-functions): Move definition earlier.

	* calendar/todo-mode.el: Require calendar at compile time.

	* calendar/cal-hebrew.el: Require holidays at compile time.

	* w32-vars.el: Provide w32-vars.

	* term/w32-win.el: Require w32-vars.
	(w32-color-map): Pacify byte-compiler.

	* loadup.el: Load w32-vars before term/w32-win.

2007-10-20  Juri Linkov  <juri@jurta.org>

	* textmodes/fill.el (fill-paragraph): When the region is active,
	don't try other `or' branches regardless of the value returned by
	fill-region; just return t.

2007-10-20  Eric S. Raymond  <esr@snark.thyrsus.com>

	* vc.el (vc-do-command): Condition out a misleading message when
	running asynchronously.
	(vc-deduce-fileset): New argument enables using an unregistered
	visited file as a singleton fileset if nothing else is available.
	(vc-next-action): Restore file-registering behavior.

2007-10-20  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/README: Add recent news.

2007-10-20  Dan Nicolaescu  <dann@ics.uci.edu>

	* term/x-win.el (x-gtk-stock-map, icon-map-list)
	(x-gtk-map-stock): Delete duplicated definitions from merge.

	* progmodes/compile.el (compilation-skip-to-next-location)
	(compilation-skip-threshold, compilation-skip-visited):
	Move definitions earlier.

	* play/decipher.el (decipher-keypress):
	* play/zone.el (zone-fall-through-ws):
	* play/landmark.el (lm-move-down, lm-move-up):
	* play/handwrite.el (handwrite):
	* mail/mspools.el (mspools-visit-spool):
	* wdired.el (wdired-next-line, wdired-previous-line):
	* tar-mode.el (tar-subfile-save-buffer):
	* scroll-lock.el (scroll-lock-next-line)
	(scroll-lock-previous-line):
	* image-dired.el (image-dired-next-line)
	(image-dired-previous-line):
	* ediff-help.el (ediff-help-message-line-length):
	Use forward-line.

	* smerge-mode.el (smerge-auto-refine):
	* diff-mode.el (diff-auto-refine): Add :group.

	* play/yow.el: Require doctor at compile time.

	* vmsproc.el: Provide vmsproc.
	(command-send-input): Use forward-line.

	* vms-patch.el: Require ps-print and vmsproc at compile time.

	* vc-mtn.el (log-view-message-re, log-view-file-re)
	(log-view-font-lock-keywords): Pacify byte-compiler.

	* vc-hg.el: Require log-view at compile time.

2007-10-20  Eric S. Raymond  <esr@snark.thyrsus.com>

	* log-view.el (log-view-diff): Adapt log-view-diff for new VC API.

2007-10-20  Glenn Morris  <rgm@gnu.org>

	* progmodes/f90.el (f90-font-lock-keywords-2)
	(f90-looking-at-type-like): Fix regexp typos.

2007-10-19  Juanma Barranquero  <lekktu@gmail.com>

	* bs.el (bs--track-window-changes): Don't refresh the whole list.
	(bs-mode): Set mode-class property to special.

2007-10-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* diff-mode.el (diff-auto-refine): New var.
	(diff-hunk): Use it.
	(diff-ignore-whitespace-hunk): Rename diff-refine-ignore-spaces-hunk.
	(diff-refine-change): Rename from diff-fine-change.  Change it.
	(diff-refine-preproc): Rename from diff-fine-highlight-preproc.
	(diff-refine-hunk): Rename from diff-fine-highlight.

2007-10-20  John Paul Wallington  <jpw@pobox.com>

	* help-fns.el (describe-variable-custom-version-info): New function
	to return variable's version or package version note.
	(describe-variable): Use it, display result.

2007-10-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* smerge-mode.el (smerge-auto-refine): New var.
	(smerge-next, smerge-prev): Use it.
	(smerge-batch-resolve): Ad-hoc trick for Arch's .rej files.

	* emacs-lisp/easy-mmode.el (easy-mmode-define-navigation):
	Add `body' arg.  Cleanup the check-narrow-maybe/re-narrow-maybe mess.

	* vc-bzr.el (vc-bzr-diff-tree):
	* vc-git.el (vc-git-diff-tree):
	* vc-hg.el (vc-hg-diff-tree):
	* vc-mcvs.el (vc-mcvs-diff-tree):
	* vc-mtn.el (vc-mtn-diff-tree):
	* vc-svn.el (vc-svn-diff-tree): Remove.

	* vc-mtn.el (vc-mtn-revision-completion-table):
	* vc-cvs.el (vc-cvs-revision-completion-table):
	* vc-arch.el (vc-arch-revision-completion-table):
	* vc-hg.el (vc-hg-revision-completion-table, vc-hg-revision-table):
	* vc-git.el (vc-git-revision-completion-table, vc-git-revision-table):
	Make it work when the arg is a list of files.

2007-10-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc.el: Remove `diff-tree' operation, now subsumed by `diff'.
	Also `revision-completion-table' now takes a list of files.
	(vc-deduce-fileset): Remove unused var `regexp'.
	Only obey allow-directory-wildcard in dired buffers.
	(vc-default-diff-tree): Remove.
	(vc-diff-added-files): New var.
	(vc-diff-internal): Use it.  Remove arg `backend'.  Update callers.
	(vc-version-diff): Revert from `vc-history-diff' to the original name.
	Remove the `backend' arg.
	(vc-contains-version-controlled-file): Remove.
	(vc-diff): Bring it closer to the version in Emacs-22.
	(vc-revert): Fix typo in let-binding.
	(vc-default-unregister): Remove.
	(vc-dired-buffers-for-dir): Remove N^2 behavior.

2007-10-19  Dan Nicolaescu  <dann@ics.uci.edu>

	* textmodes/two-column.el (2C-split, 2C-merge):
	* textmodes/bib-mode.el (bib-find-key, mark-bib):
	* progmodes/idlw-shell.el (idlwave-shell-move-or-history):
	* progmodes/etags.el (find-tag-in-order, etags-tags-apropos)
	* progmodes/ada-xref.el (ada-get-all-references):
	* obsolete/mlsupport.el (ml-next-line, ml-previous-line):
	* emulation/vi.el (vi-previous-line-first-nonwhite)
	(vi-effective-range, vi-put-before):
	* emulation/edt.el (edt-next-line, edt-previous-line)
	(edt-paragraph-forward): Use forward-line.

	* progmodes/etags.el (tags-apropos): Require apropos at compile
	time too.

	* progmodes/prolog.el: Require comint when compiling.
	(inferior-prolog-flavor): Move defvar before use.

2007-10-19  Richard Stallman  <rms@gnu.org>

	* font-core.el (turn-on-font-lock-if-desired):
	Rename from `turn-on-font-lock-if-enabled'.
	Fully obey `font-lock-global-modes'.

2007-10-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* diff-mode.el (diff-fine-highlight-preproc): Stick to minimal changes
	which will not affect the behavior of things like forward-word.
	(diff-fine-highlight): Preserve point.

	* doc-view.el (doc-view-mode-map): Use remapping.
	Don't rebind C-v, M-v to their default value.
	Don't bind mouse-4 and mouse-5: it's mwheel.el's job.

	* smerge-mode.el: Add word-granularity refinement.
	(smerge-refine-forward-function, smerge-refine-ignore-whitespace)
	(smerge-refine-weight-hack): New vars.
	(smerge-refine-forward): New fun.
	(smerge-refine-chopup-region, smerge-refine-highlight-change): Use them.
	(smerge-refine-subst): Use them as well.  Preserve point.

2007-10-19  Juanma Barranquero  <lekktu@gmail.com>

	* follow.el (follow-unload-function): New function.

	* loadhist.el (unload-function-features-list):
	Rename from `unload-hook-features-list'.
	(unload-hook-features-list): Add as obsolete alias.
	(unload-feature): Use `unload-function-features-list'
	and new FEATURE-unload-function.

2007-10-19  Glenn Morris  <rgm@gnu.org>

	* bindings.el (mouse-minor-mode-menu)
	(minor-mode-menu-from-indicator): Move to mouse.el.
	* mouse.el (mouse-minor-mode-menu, minor-mode-menu-from-indicator):
	Move here from bindings.el.

2007-10-19  Richard Stallman  <rms@gnu.org>

	* help-fns.el (describe-function-1): Don't use the advice origname
	if it has no function definition.

2007-10-18  Johan Bockgård  <bojohan@gnu.org>

	* net/tramp.el (tramp-rfn-eshadow-update-overlay): Save excursion.
	Use `save-restriction' rather than `widen'.

2007-10-18  Richard Stallman  <rms@gnu.org>

	* time.el (display-time-world-time-format): Display day # not month #.

2007-10-18  Reiner Steib  <Reiner.Steib@gmx.de>

	* files.el (auto-mode-alist): Don't use doc-view for PS and EPS.

	* doc-view.el: Remove version keyword.
	(doc-view-ghostscript-program, doc-view-dvipdfm-program)
	(doc-view-ps2pdf-program): Use executable-find.  Simplify custom type.
	(doc-view-ghostscript-options): Improve custom type.
	(doc-view-cache-directory, doc-view-conversion-buffer)
	(doc-view-conversion-refresh-interval): Simplify custom type.

2007-10-18  Tassilo Horn  <tassilo@member.fsf.org>

	* doc-view.el (doc-view-dvi->pdf-sentinel, doc-view-dvi->pdf)
	(doc-view-pdf/ps->png-sentinel, doc-view-pdf/ps->png)
	(doc-view-pdf->txt-sentinel, doc-view-pdf->txt)
	(doc-view-ps->pdf-sentinel, doc-view-ps->pdf):
	Remove superfluous messages.
	(doc-view-mode-map): Use the image-mode scrolling commands.
	Don't rebind C-x k.

2007-10-18  Reiner Steib  <Reiner.Steib@gmx.de>

	* doc-view.el (doc-view-ghostscript-options, doc-view-ps->pdf):
	Add comment about "-dSAFER".

2007-10-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* term/xterm.el: Don't require xt-mouse.
	(terminal-init-xterm): Run terminal-init-xterm-hook rather than
	calling turn-on-xterm-mouse-tracking-on-terminal directly.

	* xt-mouse.el: Don't change the global function-key-map any more.
	(xterm-mouse-mode): Use terminal-init-xterm-hook.
	Don't use after-make-frame-functions now that term/xterm.el calls
	us directly.
	(turn-on-xterm-mouse-tracking, turn-off-xterm-mouse-tracking):
	Use turn-*-xterm-mouse-tracking-on-terminal.  Only once per terminal.
	(turn-on-xterm-mouse-tracking-on-terminal): Make param optional.
	Setup input-decode-map and remember that xterm-mouse-mode was
	enabled in this terminal.
	(turn-off-xterm-mouse-tracking-on-terminal): Only disable on those
	terminals where it has been enabled.

	* faces.el (tty-create-frame-with-faces): Make sure not only
	tty-run-terminal-initialization but also set-locale-environment
	are run only once per terminal.
	(tty-run-terminal-initialization): Don't check if the terminal was
	already initted.

	* international/encoded-kb.el (encoded-kbd-setup-display): Be careful
	not to remove keymaps that just happen to inherit from one of ours.
	When setting up our keymap, make sure it won't be accidentally
	modified by someone else.

2007-10-18  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* textmodes/artist.el (artist-previous-line, artist-next-line):
	* dired.el (dired-next-line, dired-previous-line):
	* progmodes/delphi.el (delphi-newline):
	* textmodes/org.el (org-columns-eval):
	Use forward-line.

	* emerge.el (emerge-setup): Use insert-buffer-substring.
	(emerge-prepare-error-list, emerge-setup-with-ancestor): Likewise.

2007-10-18  Juanma Barranquero  <lekktu@gmail.com>

	* textmodes/fill.el (fill-individual-paragraphs): Doc fix.
	(adaptive-fill-function): Doc fix.  Remove * from docstring.

2007-10-18  Tom Horsley  <tom.horsley@att.net>

	* simple.el (interprogram-paste-function): Doc fix.
	(current-kill): Accept list of strings as well
	as single string from `interprogram-paste-function'.

2007-10-18  Glenn Morris  <rgm@gnu.org>

	* ibuf-ext.el (ibuffer-saved-filter-groups): Doc fix.

2007-10-18  Drew Adams  <drew.adams@oracle.com>

	* bindings.el (mode-line-minor-mode-keymap):
	Add mouse-minor-mode-menu on mouse-1.
	(mode-line-modes): Add mouse-1 to help-echo text.
	(mouse-minor-mode-menu, minor-mode-menu-from-indicator):
	New functions.
	(mode-line-minor-mode-help): Doc fix.

2007-10-17  Juri Linkov  <juri@jurta.org>

	* textmodes/fill.el (fill-paragraph-or-region): Remove function
	at the request of RMS.
	(fill-paragraph): Change `arg' to optional `justify'.  Add interactive
	arg `region'.  Fix docstring.  At the first `or' branch add call to
	`fill-region' if it the region is active in transient-mark-mode.

	* bindings.el (esc-map): Bind M-q to fill-paragraph
	instead of fill-paragraph-or-region.

	* tutorial.el (tutorial--default-keys): Replace fill-paragraph-or-region
	with fill-paragraph.

	* textmodes/ispell.el (ispell-word): Add interactive arg `region'.
	Fix docstring.

	* indent.el (indent-for-tab-command): Change interactive spec from
	"P" to "p".  Add check for interactive arg before indenting the
	active region.

	* files.el (auto-mode-alist): Add \\. before PDF/PS/DVI extensions.
	Regroup.

2007-10-17  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/find-func.el: Don't require loadhist.

	* loadhist.el (feature-symbols, file-provides, file-requires)
	(file-set-intersect, file-dependents): Simplify.
	(unload-feature-special-hooks): Update list of special hooks.

2007-10-17  Tassilo Horn  <tassilo@member.fsf.org>

	* bindings.el (completion-ignored-extensions): Remove pdf and dvi
	extensions since they can be viewed with doc-view.

	* files.el (auto-mode-alist): Make doc-view-mode the default mode
	for pdf, ps and dvi files.

	* doc-view.el: Make doc-view-mode the standard mode for viewing
	pdf, [e]ps and dvi files and add binding C-c C-c to toggle between
	text and image display.  Add binding C-c C-e to switch to an
	editing mode.
	(doc-view-ghostscript-options, doc-view-ps->pdf): Add "-dSAFER" to
	avoid security problems when rendering files from untrusted sources.

2007-10-17  Aaron S. Hawley  <aaronh@garden.org>

	* tutorial.el (tutorial--save-tutorial): Display message when tutorial
	position is not saved.

2007-10-17  Reiner Steib  <Reiner.Steib@gmx.de>

	* doc-view.el: Mention xpdf.  Fix spelling of Ghostscript.
	(doc-view-ghostscript-options): Fix typo in doc string.

2007-10-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/compile.el (compilation-next-error-function): Fix timestamp
	handling, so compilation-fake-loc works again.

	* server.el (server-select-display): Nop if we do not support m-f-o-d.
	(server-process-filter): Revert last change.

	* vc.el (vc-diff-sentinel, vc-diff-internal): Revert some change in the
	behavior unrelated to filesets.

2007-10-17  Chong Yidong  <cyd@stupidchicken.com>

	* longlines.el (longlines-wrap-follows-window-size): Integer value
	specifies wrapping margin.
	(longlines-mode, longlines-window-change-function):
	Set window-specific wrapping margin based on the above.

2007-10-17  John Wiegley  <johnw@newartisans.com>

	* eshell/esh-cmd.el (eshell-complex-commands): Add "ls".

2007-10-17  Dan Nicolaescu  <dann@ics.uci.edu>

	* server.el (server-process-filter): Only set display if X11 is
	supported.

2007-10-17  Glenn Morris  <rgm@gnu.org>

	* progmodes/cc-menus.el (cc-imenu-c++-generic-expression):
	Tweak regexp to avoid stack overflow.

2007-10-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (reindent-then-newline-and-indent): Don't assume that
	indent-according-to-mode preserves point.

2007-10-16  Juanma Barranquero  <lekktu@gmail.com>

	* bs.el (bs--make-header-match-string, bs-show-in-buffer)
	(bs--nth-wrapper): Simplify.
	(bs-select, bs--insert-one-entry): Simplify.  Use `when'.
	(bs-buffer-list): Simplify.  Use `when'.  Use `string-match-p'.
	(bs-sort-buffer-interns-are-last): Use `string-match-p'.
	(bs-attributes-list, bs-max-window-height, bs-must-always-show-regexp)
	(bs-maximal-buffer-name-column, bs-minimal-buffer-name-column)
	(bs-configurations, bs-default-configuration)
	(bs-alternative-configuration, bs-cycle-configuration-name)
	(bs-string-show-always, bs-string-show-never, bs-string-current)
	(bs-string-current-marked, bs-string-marked, bs-string-show-normally)
	(bs-sort-functions, bs-default-sort-name): Remove * in docstrings.
	(bs--redisplay, bs--goto-current-buffer, bs--current-buffer, bs-delete)
	(bs-apply-sort-faces, bs-next-config-aux): Use `when'.
	(bs--window-config-coming-from): Revert 2006-11-09 change.
	(bs--restore-window-config): Keep the selected frame.
	(bs--track-window-changes, bs--remove-hooks): New functions.
	(bs-mode): Use `define-derived-mode'.  Set hook to track window changes.
	(bs--create-header): Remove.
	(bs--create-header-line): New function, based on `bs--create-header'.
	(bs--show-header): Use `bs--create-header-line'.
	(bs--show-with-configuration): Revert 2006-11-09 change.
	Don't reuse window unless it is visible on the selected frame.
	Restore window configuration (possibly in a different frame)
	before creating any window.

2007-10-16  Glenn Morris  <rgm@gnu.org>

	* simple.el (blink-matching-open): Don't report false errors with
	the `$' syntax class.

2007-10-16  Richard Stallman  <rms@gnu.org>

	* emacs-lisp/advice.el (ad-get-advice-info): Change to a function.
	(ad-get-advice-info-macro): New macro, like old ad-get-advice-info.
	(ad-is-advised, ad-get-advice-info-field)
	(ad-set-advice-info-field): Use ad-get-advice-info-macro.

2007-10-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-hooks.el (vc-workfile-version): Compatibility alias.
	(vc-default-working-revision): Compatibility for backends.

2007-10-15  Juanma Barranquero  <lekktu@gmail.com>

	* filesets.el (filesets-alist-get): Use `let' rather than `let*'.
	(filesets-ormap, filesets-sort-case-sensitive-flag)
	(filesets-remake-shortcut, filesets-ingroup-collect-files):
	Fix typos in docstrings.
	(filesets-conditional-sort, filesets-find-or-display-file)
	(filesets-data-get-name, filesets-data-get-data)
	(filesets-data-set, filesets-cmd-query-replace-getargs)
	(filesets-ingroup-collect): Doc fixes.

2007-10-15  Sam Steingold  <sds@gnu.org>

	* mail/sendmail.el (sendmail-error-reporting-interactive)
	(sendmail-error-reporting-non-interactive): New variables for
	sendmail error reporting options to simplify support for imperfect
	sendmail emulators.
	(sendmail-send-it): Use them instead of list literals.

2007-10-15  Juanma Barranquero  <lekktu@gmail.com>

	* help-fns.el: Revert previous change; it creates a
	dependency loop between advice.el and help-fns.el.

2007-10-15  Juanma Barranquero  <lekktu@gmail.com>

	* help-fns.el: Require advice when compiling.

2007-10-14  Drew Adams  <drew.adams@oracle.com>

	* emacs-lisp/ring.el (ring-convert-sequence-to-ring)
	(ring-insert+extend, ring-remove+insert+extend, ring-member)
	(ring-next, ring-previous): New functions.

2007-10-14  Richard Stallman  <rms@gnu.org>

	* emacs-lisp/advice.el (documentation): Advice deleted.
	Doc for advised functions is now handled at C level.
	(ad-stop-advice, ad-start-advice): Don't enable or disable
	advice for `documentation'.
	(ad-advised-definition-docstring-regexp): Var deleted.
	(ad-make-advised-definition-docstring): Store orig name
	as text property of string.
	(ad-advised-definition-p): Check for text property of docstring.

	* help-fns.el (describe-function-1): Find source of advised functions.

2007-10-14  Juri Linkov  <juri@jurta.org>

	* faces.el (describe-face): Allow handling a string as the face name.

	* textmodes/ispell.el (ispell-word): Call `ispell-region' on the
	active region in transient-mark-mode.
	(ispell-region): Change messages displayed at the start and end of
	the spell-checking to be the same.

	* startup.el (fancy-startup-tail): Say exactly what does the button
	dismiss ("Dismiss this startup screen").  Use text "Never show
	it again" for the checkbox after this button.
	(fancy-startup-screen, fancy-about-screen): Put point before the
	first link, so the user can quickly select links with the keyboard.
	(normal-mouse-startup-screen): Add more useful text describing how
	to follow a link.

2007-10-14  Glenn Morris  <rgm@gnu.org>

	* progmodes/etags.el (select-tags-table): Disable undo in the
	`*Tags Table List*' buffer.

2007-10-13  Eli Zaretskii  <eliz@gnu.org>

	* dired.el (dired-warn-writable): New face.
	(dired-warn-writable-face): New variable.
	(dired-font-lock-keywords): Use dired-warn-writable-face, instead
	of dired-warning-face, for group- and world-writable files.

2007-10-13  Richard Stallman  <rms@gnu.org>

	* files.el (directory-abbrev-alist): Doc fix.

2007-10-13  Jari Aalto  <jari.aalto@cante.net>

	* comint.el (comint-password-prompt-regexp): Add 'LDAP'.

2007-10-12  Martin Rudalics  <rudalics@gmx.at>

	* frame.el (set-frame-configuration): Assign name parameter only
	if it has been set explicitly before.

2007-10-11  Tom Tromey  <tromey@redhat.com>

	* progmodes/gdb-ui.el (gdb-info-stack-custom): Ensure current
	frame is visible.

2007-10-10  Richard Stallman  <rms@gnu.org>

	* emacs-lisp/debug.el (debugger-setup-buffer): Disable undo
	in *Backtrace*.

	* faces.el (face-font-selection-order): Doc fix.

	* loadhist.el (unload-feature): Doc fix.

2007-10-13  Glenn Morris  <rgm@gnu.org>

	* progmodes/octave-mod.el (octave-looking-at-kw): Add doc string.
	(octave-re-search-forward-kw, octave-re-search-backward-kw):
	Add doc string, and an explicit COUNT argument.
	(octave-scan-blocks, octave-beginning-of-defun): Explicitly pass
	`inc' to search functions.

	* faces.el (face-spec-set): When FRAME is nil, set the default for
	new frames (restores pre-2007-09-17 behavior).  Doc fix.

2007-10-13  John W. Eaton  <jwe@octave.org>

	* progmodes/octave-mod.el (octave-looking-at-kw)
	(octave-re-search-forward-kw, octave-re-search-backward-kw):
	New functions.
	(octave-in-defun-p, calculate-octave-indent)
	(octave-blink-matching-block-open, octave-beginning-of-defun)
	(octave-auto-fill): Use octave-looking-at-kw instead of looking-at,
	to search for regexps that contain case-sensitive keywords.
	(octave-beginning-of-defun): Likewise, for octave-re-search-backward-kw.
	(octave-scan-blocks): Likewise, for octave-re-search-forward-kw.

2007-10-13  Dan Nicolaescu  <dann@ics.uci.edu>

	* frame.el (select-frame-set-input-focus): Fix typo "max" -> "mac".
	Do not use a single clause cond.

	* cus-start.el (all): Use test that does not match the X11 version
	for mac.

2007-10-13  Markus Gritsch  <m.gritsch@gmail.com>  (tiny change)

	* progmodes/ebrowse.el (ebrowse-tree-mode): Disable undo in the
	BROWSE buffer.

2007-10-13  Dan Nicolaescu  <dann@ics.uci.edu>

	* cus-start.el (all): Undo previous change.

2007-10-13  Glenn Morris  <rgm@gnu.org>

	* woman.el (woman0-rename): Fix paren typo.

	* mail/feedmail.el (feedmail-run-the-queue)
	(feedmail-look-at-queue-directory):
	* mail/reporter.el (reporter-dump-state):
	* net/eudc-hotlist.el (eudc-edit-hotlist):
	* net/eudc.el (eudc-display-records)
	(eudc-filter-duplicate-attributes)
	(eudc-distribute-field-on-records, eudc-query-form, eudc-process-form):
	* net/eudcb-bbdb.el (eudc-bbdb-filter-non-matching-record)
	(eudc-bbdb-query-internal):
	* net/eudcb-ldap.el (eudc-ldap-simple-query-internal):
	* net/socks.el (socks-build-auth-list):
	* progmodes/cc-cmds.el (top level):
	* progmodes/cc-styles.el (c-make-styles-buffer-local, c-set-style):
	* progmodes/cperl-mode.el (top level, cperl-imenu-addback)
	(cperl-write-tags, cperl-tags-treeify):
	* progmodes/ebnf-yac.el (ebnf-yac-token-table):
	* progmodes/ebnf2ps.el (ebnf-map-name, ebnf-dimensions):
	* progmodes/idlw-shell.el (idlwave-shell-filter-bp, top level):
	* progmodes/idlw-toolbar.el (idlwave-toolbar-add-everywhere)
	(idlwave-toolbar-remove-everywhere):
	* progmodes/idlwave.el (idlwave-indent-line)
	(idlwave-sintern-keyword-list, idlwave-scan-user-lib-files)
	(idlwave-write-paths, idlwave-all-method-classes)
	(idlwave-all-method-keyword-classes, idlwave-entry-keywords)
	(idlwave-fix-keywords, idlwave-display-calling-sequence)
	(idlwave-complete-in-buffer):
	* textmodes/org.el (org-export-as-html, org-export-as-ascii)
	(org-fast-tag-selection):
	* textmodes/reftex-sel.el (reftex-select-item): Use mapc rather
	than mapcar.

2007-10-13  Dan Nicolaescu  <dann@ics.uci.edu>

	* diff-mode.el (diff-fine-change): Add :group.

2007-10-12  Dan Nicolaescu  <dann@ics.uci.edu>

	* cus-start.el (all): Use the same test as the 22.2 branch.

2007-10-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* diff-mode.el (diff-current-defun): Force recomputation of
	change-log-default-name.

2007-10-12  Chong Yidong  <cyd@stupidchicken.com>

	* startup.el (fancy-startup-screen): Remove an unnecessary newline
	and some leftover logic regarding dedicated frames.  If showing
	concise startup screen, fit window to buffer.
	(command-line-1): If we will be using the splash screen, use
	find-file instead of find-file-other-window to find additional files.
	Comment out unused code for coping with the old sit-for behavior.

2007-10-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* term/xterm.el (xterm-function-map, xterm-alternatives-map): Use the
	`meta' modifier consistently, rather than using sometimes meta
	sometimes alt.

2007-10-12  Martin Rudalics  <rudalics@gmx.at>

	* window.el (handle-select-window): Revert part of 2007-10-08
	change setting the input focus.

2007-10-12  Glenn Morris  <rgm@gnu.org>

	* startup.el (command-line): Do not read abbrev file in batch mode.

	* emacs-lisp/byte-opt.el (top level):
	* mail/rmail.el (rmail-list-to-menu):
	* obsolete/hilit19.el (hilit-mode):
	* progmodes/cc-mode.el (c-postprocess-file-styles)
	(c-submit-bug-report):
	* textmodes/org-publish.el (org-publish-get-plist-from-filename):
	* textmodes/reftex.el (reftex-erase-all-selection-and-index-buffers)
	(reftex-access-parse-file):
	* textmodes/reftex-cite.el (reftex-do-citation)
	(reftex-insert-bib-matches):
	* textmodes/reftex-ref.el (reftex-offer-label-menu):
	* textmodes/reftex-sel.el (reftex-select-unmark):
	* textmodes/reftex-toc.el (reftex-toc-do-promote):
	* vc-mcvs.el (vc-mcvs-checkin): Use mapc rather than mapcar.

	* cus-edit.el (custom-variable-menu, custom-face-menu)
	(custom-group-menu): Check init-file-user rather than
	user-init-file, in case cus-edit is loaded by site-run-file.

2007-10-11  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el (vc-deduce-fileset): Delete unused code.
	(vc-next-action): Fix typos.

2007-10-11  Juanma Barranquero  <lekktu@gmail.com>

	* bs.el (bs--mark-unmark): New function.
	(bs-mark-current, bs-unmark-current): Use it.

2007-10-11  Eric S. Raymond  <esr@snark.thyrsus.com>

	* vc.el (vc-diff):
	(vc-diff-internal): Merge a patch by Juanma Barranquero.  Also,
	temporarily disable the check for his edge case of
	vc-diff (stopping it from grinding when called from $HOME), as
	it's calling some brittle code in vc-hooks.el.
	(with-vc-properties): Fix evaluation time of a macro argument.
	* ediff-vers.el (ediff-vc-internal):
	* vc-hooks.el:
	* loaddefs.el: Follow up on VC terminology change.

2007-10-11  Juanma Barranquero  <lekktu@gmail.com>

	* follow.el (follow-stop-intercept-process-output):
	Use `follow-call-process-filter' rather than `process-filter'.
	Simplify.

2007-10-11  Eric S. Raymond  <esr@snark.thyrsus.com>

	* vc-hooks.el (vc-registered): Robustify this function a bit
	against filenames with no directory component.

2007-10-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* international/characters.el: Undo unwanted and unexplained change.

2007-10-10  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el: Fix the usage of :foreground and :background face
	attributes.  Reported by Nikolaj Schumacher <n_schumacher@web.de>.
	(ps-print-version): New version 6.7.6.
	(ps-face-attributes, ps-face-attribute-list, ps-face-background):
	Fix code.
	(ps-face-foreground-color-p, ps-face-background-color-p)
	(ps-face-color-p): New inline funs.

2007-10-10  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el (org-additional-option-like-keywords): New constant.
	(org-complete): Use `org-additional-option-like-keywords'.
	(org-parse-local-options): New function.

2007-10-10  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el (org-in-clocktable-p): New function.
	(org-clock-report): Only update the table at point, or insert a new one.
	(org-clock-goto): New function.
	(org-open-file): Use `start-process-shell-command' instead of
	`shell-command' with an ampersand.
	(org-deadline, org-schedule): New argument REMOVE to remove the
	date from the entry.
	(org-agenda-schedule, org-agenda-deadline): Pass the prefix
	argument to `org-schedule' and `org-deadline'.
	(org-trim): Use the correct expressions for beginning and end of
	the string.
	(org-get-cleaned-entry): Trim the string before returning it.
	(org-clock-find-position): New function.
	(org-clock-into-drawer): New option.
	(org-agenda-tags-column): Rename from
	`org-agenda-align-tags-to-column'.
	(org-agenda-align-tags): Allow negative values for
	`org-agenda-tags-column'.
	(org-insert-labeled-timestamps-before-properties-drawer): Remove var.
	(org-agenda-to-appt): New optional argument FILTER.
	(org-completion-fallback-command): New variable.
	(org-complete): Use `org-completion-fallback-command'.
	(org-find-base-buffer-visiting): Catch the case that there is no
	buffer visiting the file.
	(org-property-or-variable-value): New function.
	(org-todo): Use `org-property-or-variable-value'.
	(org-agenda-compact-blocks): New option.
	(org-prepare-agenda, org-agenda-list): Use `org-agenda-compact-blocks'.
	(org-agenda-schedule, org-agenda-deadline):
	Call `org-agenda-show-new-time'.
	(org-agenda-show-new-time): New argument PREFIX.
	(org-colgroup-info-to-vline-list): Fix but that cause a
	shift in the vertical lines.
	(org-buffer-property-keys): New argument INCLUDE-DEFAULTS.
	(org-maybe-renumber-ordered-list, org-cycle-list-bullet)
	(org-indent-item): No arg in call to `org-fix-bullet-type'.
	(org-fix-bullet-type): Remove argument.
	(org-read-date): Check for am/pm twice, to catch the end time.
	(org-goto-map): Use `suppress-keymap'.
	(org-remember-apply-template): Respect the dynamically scoped
	selection character.

2007-10-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* frame.el (frame-inherited-parameters): Remove unused `environment'
	parameter, and let server.el add `client' when needed.

	* server.el (server-create-tty-frame)
	(server-create-window-system-frame): Set frame-inherited-parameters.

	* frame.el (frame-inherited-parameters): New var.
	(make-frame): Use it.

	* font-lock.el (lisp-font-lock-keywords-2): Remove let-environment.

	* env.el (let-environment): Remove.  Unused.
	(read-envvar-name): Simplify.
	(setenv): Remove unused arg `frame'.

	* help-fns.el (describe-variable): Add missing "  " for multiline
	obsolescence info and missing EOL after global value.

2007-10-10  Eric S. Raymond  <esr@snark.thyrsus.com>

	* add-log.el:
	* ediff-vers.el:
	* log-view.el:
	* pcvs.el:
	* vc-arch.el:
	* vc-bzr.el:
	* vc-cvs.el:
	* vc.el:
	* vc-git.el:
	* vc-hg.el:
	* vc-hooks.el:
	* vc-mcvs.el:
	* vc-mtn.el:
	* vc-rcs.el:
	* vc-sccs.el:
	* vc-svn.el: Terminology cleanup: workfile-version -> working-revision,
	{find,init,next,previous,annotate-*,log}-version ->
	{find,init,next,previous,annotate-*,log}-revision,
	annotate-focus-version -> annotate-working-revision, The term
	'focus' is gone.  The term 'revision' is now used consistently
	everywhere that reference to a revision ID is intended, replacing
	older use of 'version'.

2007-10-10  Juanma Barranquero  <lekktu@gmail.com>

	* follow.el: Change all instances of "Follow Mode" to "Follow
	mode" in docstrings and messages.
	(follow-menu-filter): Fix arg passed to `bound-and-true-p'.

2007-10-10  Eric S. Raymond  <esr@snark.thyrsus.com>

	* vc.el (vc-next-action): Rewrite completely; this principal
	entry point now operates on a current fileset selected either
	explicitly via VC-Dired or implicitly by visiting a file buffer,
	rather than always operating on the file of the current buffer as
	in older versions.  Rewrite the rest of the mode to match.
	(with-vc-properties): Rewrite to operate on a file list.
	(with-vc-file): vc-checkin takes a file list argument now.
	(vc-post-command-functions): This hook now receives a file list.
	(vc-do-command): Take a either a file or a file list as argument.
	(vc-deduce-fileset): New function for deducing a file list to
	operate on.
	(vc-next-action-on-file, vc-next-action-dired): Remove.
	Merge into vc-next-action.
	(vc-register): Adapt to the fact that vc-start-entry now takes a
	file list.
	(vc-register-with): New function.
	(vc-start-entry): Take a file list argument rather than a
	file argument.
	(vc-checkout): Cope with vc-start-entry taking a file list.
	(vc-steal-lock): Cope with with-vc-properties taking a
	file list.
	(vc-checkin): Take a file list argument rather than a file argument.
	(vc-finish-logentry): Use the filelist passed by vc-start-entry.
	(vc-diff-internal): Rewrite for filesets.
	(vc-diff-sentinel): New function, tests whether changes were
	written into a diff buffer.
	(vc-diff): Rewrite for filesets.
	(vc-version-diff): Rewrite for filesets.
	(vc-print-log): Take a fileset argument.
	(vc-revert): Revert the entire selected fileset, not just the
	current buffer.
	(vc-rollback): Roll back the entire selected fileset, if
	possible.  No longer accepts a prefix argument.
	(vc-update): Merge new changes for the entire selected
	fileset, not just the current buffer.
	(vc-revert-file): Cope with with-vc-properties taking a file list.
	(vc-default-dired-state-info): Add + status suffix if the file is
	modified.
	(vc-annotate-warp-version): Use the new diff machinery.
	(vc-log-edit): Take a file list argument rather than a file argument.

2007-10-10  Michael Albinus  <michael.albinus@gmx.de>

	Sync with Tramp 2.1.11.

	* net/tramp.el (tramp-open-connection-setup-interactive-shell):
	Pacify byte compiler.

	* net/trampver.el: Update release number.

2007-10-09  Richard Stallman  <rms@gnu.org>

	* play/gamegrid.el (gamegrid-setup-default-font): Use face-spec-set.

2007-10-09  Juanma Barranquero  <lekktu@gmail.com>

	* follow.el: Require easymenu.
	(follow-mode-hook, follow-mode): Doc fixes.
	(follow-mode-off-hook): Mark as obsolete.

2007-10-08  Martin Rudalics  <rudalics@gmx.at>

	* window.el (mouse-autoselect-window-cancel): Don't cancel for
	select-window or select-frame events.
	(handle-select-window): When autoselecting window set input
	focus.  Restructure.

	* frame.el (focus-follows-mouse): Move to frame.c.
	* cus-start.el (all): Add focus-follows-mouse.

2007-10-08  Juanma Barranquero  <lekktu@gmail.com>

	* bs.el (bs-mode): Make sure global-font-lock-mode doesn't
	activate font-locking in the *buffer-selection* buffer.
	(bs-show-sorted): Doc fix.

	* bs.el (bs--get-marked-string, bs--get-modified-string)
	(bs--get-readonly-string, bs--get-size-string, bs--get-name)
	(bs--get-mode-name, bs-mode): Fix typos in docstrings.
	(bs--format-aux): Doc fix.

2007-10-08  Michaël Cadilhac  <michael@cadilhac.name>

	* progmodes/gud.el (gud-gud-gdb-command-name): Fix typo in docstring.

2007-10-08  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gud.el (gud-gud-gdb-command-name): New option.
	(gud-gdb): New function for old M-x gdb (text command mode).
	(gud-gdb-command-name, gdb): Move to...

	* progmodes/gdb-ui.el: ...here and adapt doc string.
	(gud-gdba-command-name, gdba): Delete.

2007-10-08  Juanma Barranquero  <lekktu@gmail.com>

	* bs.el: Don't defvar `font-lock-verbose'.
	(bs-config-clear, bs-kill, bs-string-show-normally, bs-sort-functions)
	(bs--get-file-name): Fix typos in docstrings.
	(bs--show-header): Use `dolist' instead of `mapcar'.
	(bs-mode): Set `show-trailing-whitespace' to nil.
	(bs-buffer-sort-function, bs-mouse-select-other-frame)
	(bs-visits-non-file, bs-sort-buffer-interns-are-last, bs-show):
	Doc fixes.

2007-10-08  Adam Hupp  <adam@hupp.org>  (tiny change)

	* progmodes/gud.el (pdb): Specify file for gud-break.

2007-10-08  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gud.el (gdb): Make graphical mode the default and
	switch to text command mode if appropriate, i.e., reverse previous
	arrangement.
	(gud-gdb-marker-filter): Adapt for above change.

	* progmodes/gdb-ui.el (gdb-init-1): Don't set the values
	gud-minor-mode and gud-marker-filter.
	(gdb-fullname-regexp): New variable.
	(gud-gdba-marker-filter): Use it to switch to text command
	mode if appropriate.

2007-10-08  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gud.el (gud-display-line): Find source buffer even when
	GUD buffer has its own frame.

2007-10-08  Jan Djärv  <jan.h.d@swipnet.se>

	* term/x-win.el (icon-map-list): Set to nil for 22.1 compatibility.

2007-10-08  Jan Djärv  <jan.h.d@swipnet.se>

	* term/x-win.el (x-gtk-stock-map): Version is 22.2.

2007-10-08  Martin Rudalics  <rudalics@gmx.at>

	* allout.el (allout-before-change-handler): Replace got-char by
	goto-char.

2007-10-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-svn.el (vc-svn-resolve-when-done, vc-svn-find-file-hook): New funs.
	Used to try and automatically enabled smerge-mode in the presence of
	conflicts and to call `svn resolved' when the conflicts are gone.
	(vc-svn-parse-status): Remember the svn-specific status.

2007-10-08  Eli Zaretskii  <eliz@gnu.org>

	* menu-bar.el (menu-bar-search-documentation-menu): Rename from
	menu-bar-apropos-menu.  All users changed.
	(menu-bar-help-menu): Change menu symbols to better match the text
	displayed by the menu.

2007-10-08  Dan Nicolaescu  <dann@ics.uci.edu>

	* files.el (file-name-sans-versions): Use [:alnum:] and also allow
	#, @, : and ^.

2007-10-08  Dan Nicolaescu  <dann@ics.uci.edu>

	* pcvs-defs.el (cvs-mode-map): Bind TAB and backtab.

	* log-view.el (log-view-mode-map): Likewise.

	* diff-mode.el (diff-mode-shared-map): Likewise.

2007-10-08  Dan Nicolaescu  <dann@ics.uci.edu>

	* files.el (file-name-sans-versions): Also allow `A-Z'.

	* vc.el: Mention all supported VC backends.

2007-10-08  Richard Stallman  <rms@gnu.org>

	* wid-edit.el (widget-specify-button): Don't merge mouse-face with
	neighboring buttons.

2007-10-08  Andreas Schwab  <schwab@suse.de>

	* files.el (file-name-sans-versions): Also allow `_'.

2007-10-08  Dan Nicolaescu  <dann@ics.uci.edu>

	* files.el (file-name-sans-versions): Allow - and a-z in version names.

	* log-view.el (log-view-mode-map, log-view-mode-menu):
	Bind log-view-annotate-version.
	(log-view-beginning-of-defun, log-view-end-of-defun)
	(log-view-annotate-version): New functions.
	(log-view-mode): Use log-view-beginning-of-defun and
	log-view-end-of-defun.

2007-10-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/easy-mmode.el (define-minor-mode): Fix staging.

2007-10-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* wid-edit.el (widget-image-insert): Don't merge mouse-face with
	neighboring buttons.

	* progmodes/compile.el (compilation-error-regexp-alist-alist):
	Recognize gcc's use of "note" for informational messages.

2007-10-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/css-mode.el (css-electric-keys): electrick->electric.
	(css-mode): Update correspondingly.

2007-10-08  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-git.el (vc-git-log-view-mode): Add font-lock patterns for
	Signed-off-by, Acked-by and Merge.

2007-10-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* ediff-init.el (ediff-verbose-p): This var is not a constant.

2007-10-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-mtn.el: New file.

	* vc-hooks.el (vc-handled-backends): Add Mtn.

2007-10-08  Eli Zaretskii  <eliz@gnu.org>

	* files.el (find-file, find-file-other-window)
	(find-file-other-frame, find-file-existing, find-file-read-only)
	(find-file-read-only-other-window)
	(find-file-read-only-other-frame)
	(find-alternate-file-other-window, find-alternate-file): Doc fixes.

2007-10-08  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gud.el (gdb-ready): New variable.
	(gdb): Set it to nil.  Set gud-running to nil here...
	(gud-common-init): ...instead of here.

	* progmodes/gdb-ui.el (gdba, gdb-send, gdb-source-info):
	Use gdb-ready.  Discard input until GDB is ready to accept it.

2007-10-08  Martin Rudalics  <rudalics@gmx.at>

	* dired.el (dired-warning): Inherit from font-lock-warning-face to
	make it show up with eight colors.

2007-10-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* diff-mode.el (diff-sanity-check-hunk): Fix up the case when unified
	diffs are concatenated with no intervening line.

2007-10-08  Dave Love  <fx@gnu.org>

	* progmodes/python.el: Merge changes from Dave Love's v2007-Sep-10.
	(python-font-lock-keywords): Update to the 2.5 version of the language.
	(python-quote-syntax): Let-bind font-lock-syntactic-keywords to nil.
	(python-backspace): Only behave funny in code.
	(python-compilation-regexp-alist): Add PDB stack trace regexp.
	(inferior-python-mode): Add PDB prompt regexp.
	(python-fill-paragraph): Refine the fenced-string regexp.
	(python-find-imports): Handle imports spanning several lines.
	(python-mode): Add `class' to hideshow support.

2007-10-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcvs.el (cvs-mode-add-change-log-entry-other-window):
	Use add-log-buffer-file-name-function rather than binding
	buffer-file-name, so we don't end up calling change-log-mode in *cvs*
	when `fi' is the ChangeLog file itself.

	* outline.el (outline-flag-region): Use front-advance.

2007-10-08  Ilya Zakharevich  <ilyaz@cpan.org>

	* progmodes/cperl-mode.el: Merge upstream 5.23.
	(cperl-where-am-i): Remove function.
	(cperl-backward-to-noncomment): Don't go too far when skipping POD/HEREs.
	(cperl-sniff-for-indent): De-invert [string] and [comment].
	When looking for label, skip s:m:y:tr.
	(cperl-indent-line): Likewise.
	(cperl-mode): Don't assume `font-lock-multiline' is auto-local.
	(cperl-windowed-init): Wrong `ps-print' handling.
	Both thanks to Chong Yidong.
	(cperl-look-at-leading-count): Could fail with unfinished RExen.
	(cperl-find-pods-heres): If the second part of s()[] is missing,
	don't try to highlight delimiters...

2007-10-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/compile.el (compilation-get-file-structure): Complete last
	change by also using spec-directory in the puthash.

2007-10-08  Riccardo Murri  <riccardo.murri@gmail.com>

	* vc-bzr.el (vc-bzr-file-name-relative): Use 'when' instead of 'and'.
	(vc-bzr-status): Fix shadowing of variable 'status'.
	(vc-bzr-workfile-version): Use correct path to 'last-revision' file.
	Use `expand-file-name' instead of `concat'.
	(vc-bzr-annotate-command): Use option name '--long' instead of '-l'.
	Update annotation line regexp.  Fixes launchpad.net [Bug 137435].

2007-10-08  Jason Rumney  <jasonr@gnu.org>

	* frame.el (focus-follows-mouse): Doc-fix.  Change default on w32.

2007-10-08  Richard Stallman  <rms@gnu.org>

	* emacs-lisp/lisp-mode.el (lisp-indent-offset): Make defcustom.
	Add `safe-local-variable' property.
	(lisp-body-indent): Likewise.

2007-10-08  Richard Stallman  <rms@gnu.org>

	* files.el (hack-local-variables-confirm): Rename arg VARS to ALL-VARS.
	Add doc string.

2007-10-08  Martin Rudalics  <rudalics@gmx.at>

	* files.el (backup-buffer-copy): Try to overwrite old backup first.

2007-10-08  Martin Rudalics  <rudalics@gmx.at>

	* repeat.el (repeat): Use last-repeatable-command instead of
	real-last-command.  Run pre- and post-command hooks for
	self-insertion.  Update doc-string.

2007-10-08  Alexandre Julliard  <julliard@winehq.org>

	* vc-git.el (vc-git-state): Call git-add --refresh to update the
	state of the file.
	(vc-git-workfile-unchanged-p): Delegate implementation to vc-git-state.
	(vc-git-create-repo): Fix invalid command.

2007-10-08  Richard Stallman  <rms@gnu.org>

	* textmodes/flyspell.el (flyspell-mode):
	Catch errors in flyspell-mode-on.

2007-10-09  Juanma Barranquero  <lekktu@gmail.com>

	* term/x-win.el (x-alternatives-map): Remove spurious parenthesis.

2007-10-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* international/encoded-kb.el (encoded-kbd-setup-display):
	Use input-decode-map rather than local-key-translation-map.

	* term/rxvt.el (rxvt-alternatives-map): New map.
	(terminal-init-rxvt): Use it.
	Bind rxvt-function-map in input-decode-map.

	* term/xterm.el (xterm-alternatives-map): New map.
	(terminal-init-xterm): Use it.
	Bind xterm-function-map in input-decode-map.

	* term/x-win.el (x-alternatives-map): New var.
	(x-setup-function-keys): Use it.

	* help-fns.el (describe-variable): Slightly change the layout of
	meta-info to separate it better from the docstring.
	Standardize insertion of extra empty lines in various circumstances.

	* diff-mode.el (diff-hunk-style): New fun.
	(diff-end-of-hunk): Use it.
	(diff-context->unified): Use the new `apply' undo element,
	if applicable, so as to save undo-log space.
	(diff-fine-change): New face.
	(diff-fine-highlight-preproc): New function.
	(diff-fine-highlight): New command.
	(diff-mode-map, diff-mode-menu): Add diff-fine-highlight.

	* smerge-mode.el (smerge-refine-chopup-region): Add `preproc' argument.
	(smerge-refine-highlight-change): Add `props' argument.
	(smerge-refine-subst): New function holding most of smerge-refine.
	(smerge-refine): Use it.

2007-10-08  Eric S. Raymond  <esr@snark.thyrsus.com>

	* vc.el (vc-default-wash-log): Remove unused code, the
	log washers all live in the backends now.
	(vc-default-comment-history): Correct for the fact
	that wash-log is argumentless in the new API.

2007-10-08  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-find-foreign-file-name-handler): Check also host.
	(tramp-maybe-send-script): Apply `member' but `memq'.
	(tramp-advice-file-expand-wildcards): Simplify implementation.

2007-10-08  Juanma Barranquero  <lekktu@gmail.com>

	* follow.el (follow-mode): Don't run hooks twice.  Use `when'.

	* mb-depth.el (minibuf-depth-indicator-function): New variable.
	(minibuf-depth-setup-minibuffer): Use it.

2007-10-07  Glenn Morris  <rgm@gnu.org>

	* simple.el (bad-packages-alist): Clarify Semantic and CEDET
	version numbers.

2007-10-06  Juri Linkov  <juri@jurta.org>

	* textmodes/fill.el (fill-paragraph-or-region): New function.

	* bindings.el (esc-map): Bind M-q to fill-paragraph-or-region
	instead of fill-paragraph.

	* tutorial.el (tutorial--default-keys): Replace fill-paragraph
	with fill-paragraph-or-region.  Suspend command is now the same
	`suspend-frame' on window systems and on tty.

	* image.el (image-type): Check if image-types is bound to not fail
	on tty.

	* delsel.el (delete-selection-pre-hook):
	* emulation/cua-base.el (cua-paste): Check if mouse-region-match
	is fbound to not fail on mouseless tty.

2007-10-06  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (top): Move loading of tramp-util.el and
	tramp-vc.el to tramp-compat.el.
	(tramp-make-tramp-temp-file): Complete rewrite.  Create remote
	temporary file if possible, in order to avoid a security hole.
	(tramp-do-copy-or-rename-file-out-of-band)
	(tramp-maybe-open-connection): Call `tramp-make-tramp-temp-file'
	with DONT-CREATE, because the connection is not setup yet.
	(tramp-handle-process-file): Rewrite temporary file handling.
	(tramp-completion-mode): New defvar.
	(tramp-completion-mode-p): Use it.

	* net/tramp-compat.el (top): Load tramp-util.el and tramp-vc.el.

	* net/tramp-fish.el (tramp-fish-handle-process-file):
	Rewrite temporary file handling.

2007-10-06  Eric S. Raymond  <esr@snark.thyrsus.com>

	* vc.el: Workfile version -> focus version change.  Port various
	comments from new VC to reduce the noise in the diff.
	Patch in the new vc-create-repo function to go with the
	header comment about it already present.
	There are no changes to existing logic in this patch.
	(vc-revert-buffer1): Rename to vc-revert-buffer-internal.

2007-10-06  Aaron S. Hawley  <aaronh@garden.org>

	* autoinsert.el (auto-insert-alist): Add a Texinfo entry.

2007-10-05  Chris Moore  <dooglus@gmail.com>

	* server.el (server-kill-new-buffers): Doc fix.

2007-10-05  John W. Eaton  <jwe@octave.org>

	* progmodes/octave-mod.el (octave-abbrev-table): Add "until".
	(octave-begin-keywords): Add "do".
	(octave-end-keywords): Remove "end".
	(octave-reserved-words): Add "end".  Remove "all_va_args",
	"gplot", and 'gsplot".
	(octave-text-functions): Remove "gset", "gshow", "set", and "show".
	(octave-variables): Remove "IMAGEPATH", "INFO_FILE",
	"INFO_PROGRAM", "LOADPATH", "__error_text__", "automatic_replot",
	"default_return_value", "define_all_return_values",
	"do_fortran_indexing", "empty_list_elements_ok",
	"gnuplot_has_multiplot", "implicit_str_to_num_ok",
	"ok_to_lose_imaginary_part", "prefer_column_vectors",
	"prefer_zero_one_indexing", "propagate_empty_matrices",
	"resize_on_range_error", "treat_neg_dim_as_zero",
	"warn_assign_as_truth_value", "warn_comma_in_global_decl",
	"warn_divide_by_zero", "warn_function_name_clash",
	"warn_missing_semicolon", "whitespace_in_literal_matrix".
	Add "DEFAULT_EXEC_PATH", "DEFAULT_LOADPATH", "IMAGE_PATH",
	"crash_dumps_octave_core", "sighup_dumps_octave_core",
	"sigterm_dumps_octave_core".
	(octave-block-match-alist): Remove "end" from block-end keywords.
	(octave-mode): Update ftp site address.

2007-10-05  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el: Reorder functions, no code changes.

2007-10-04  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-make-temp-file): Move to tramp-compat.el.
	(tramp-do-copy-or-rename-file-directly): Handle tmpfile only in
	the cond clauses where needed.
	(tramp-handle-write-region): Rearrange code for proper handling of
	tmpfile.

	* net/tramp-compat.el (tramp-compat-make-temp-file): New defsubst.

	* net/tramp.el:
	* net/tramp-fish.el:
	* net/tramp-ftp.el:
	* net/tramp-smb.el: Rename `tramp-make-temp-file' to
	`tramp-compat-make-temp-file'.

2007-10-04  Juanma Barranquero  <lekktu@gmail.com>

	* image-dired.el (image-dired-image-at-point-p): Fix typo in docstring.

2007-10-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/copyright.el (copyright-update): Don't update if the file
	already uses a more recent copyright version than the "current" one.

2007-10-03  Michaël Cadilhac  <michael@cadilhac.name>

	* doc-view.el (doc-view-dvi->pdf-sentinel, doc-view-reset-slice)
	(doc-view-insert-image): Minor aesthetical docstring changes.

2007-10-03  Tassilo Horn  <tassilo@member.fsf.org>

	* doc-view.el (doc-view): Don't ignore pdf and dvi files when
	completing filename.
	(doc-view-search-internal): Docstring change.

2007-10-03  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (top): Add tramp-compat to `tramp-unload-hook'.
	(tramp-file-name-handler-alist):
	Add `tramp-handle-insert-file-contents-literally'.  Needed for XEmacs.
	(tramp-make-temp-file): Use `make-temp-name'.  `make-temp-file',
	used before, creates the file already, which is not desired.
	(tramp-do-copy-or-rename-file-directly): Simplify handling of
	temporary file.
	(tramp-handle-insert-file-contents): Assign the result in the
	short track case.
	(tramp-handle-insert-file-contents-literally): New defun.
	(tramp-completion-mode-p): Revert change from 2007-09-24.
	Checking for `return' etc as last character is not sufficient, for
	example in dired-mode when entering <g> (revert-buffer) or
	<s> (dired-sort).

	* net/tramp-compat.el (top): Add also compatibility code for loading
	appropriate timer package.
	(tramp-compat-copy-tree): Check for `subrp' and `symbol-file' in
	order to avoid autoloading problems.

	* net/tramp-fish.el:
	* net/tramp-smb.el: Move further compatibility code to tramp-compat.el.

	* net/tramp-ftp.el (tramp-ftp-file-name-handler): Handle the case
	where the second parameter of `copy-file' or `rename-file' is a
	remote file but not via ftp.

2007-10-02  Richard Stallman  <rms@gnu.org>

	* frame.el (cursor-in-non-selected-windows): Doc fix.

2007-10-01  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* play/zone.el (zone): Let-bind show-trailing-whitespace to nil.
	Suggested by Chris Moore <christopher.ian.moore@gmail.com>.

2007-10-01  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-math.el (math-largest-emacs-expt): Handle the cases
	when `expt' doesn't give range errors.

2007-10-01  Markus Triska  <markus.triska@gmx.at>

	* calc/calc-math.el (math-smallest-emacs-expt):
	Make the computation more robust.

2007-09-30  David Kastrup  <dak@gnu.org>

	* startup.el (argv): Alias for `command-line-args-left' to use as
	`(pop argv)' inside of --eval command sequences.  Allows for
	passing shell commands into Emacs verbatim without need for Lisp
	quoting.

	* autorevert.el (auto-revert-handler): In `auto-revert-tail-mode',
	check only for changed size.
	(auto-revert-tail-handler): Get size from caller.  If the file has
	shrunk, tail the whole file again (the file presumably has been
	rewritten).

	* woman.el (woman-topic-all-completions, woman-mini-help):
	Fix fallout from 2007-09-07 introduction of `dolist' when the list
	actually was being manipulated in the loop.
	(woman-Cyg-to-Win, woman-pre-process-region)
	(woman-horizontal-escapes, woman-if-body, woman-unescape)
	(woman-strings, woman-special-characters, woman1-hc)
	(woman-change-fonts, woman-find-next-control-line):
	Use `match-beginning' rather than `match-string' when the result is
	just used as a flag.

2007-09-30  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp-compat.el: New file.

	* net/tramp.el:
	* net/tramp-fish.el:
	* net/tramp-smb.el:
	* net/tramp-uu.el:
	* net/trampver.el: Move compatibility code to tramp-compat.el.
	Apply `mapc' instead of `mapcar' when the code needs side effects
	only.  Move utf-8 coding cookie to the second line.

2007-09-30  Reiner Steib  <Reiner.Steib@gmx.de>

	* term/x-win.el (x-gtk-stock-map): Add Gnus and MH-E icons.
	Improve custom type.
	(icon-map-list): Make it customizable.  Document how to disable
	stock icons.

2007-09-30  Richard Stallman  <rms@gnu.org>

	* play/zone.el (zone-hiding-modeline): Use mode-line-format.

2007-09-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* t-mouse.el (gpm-mouse-mode): Rename from t-mouse-mode.  Rewrite.
	(t-mouse-mode): New compatibility alias.

2007-09-28  Dan Nicolaescu  <dann@ics.uci.edu>

	* server.el (server-delete-client): Only delete the terminal if it
	is non-nil.

2007-09-28  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (with-file-property, with-connection-property):
	Highlight as keyword.
	(tramp-rfn-eshadow-setup-minibuffer)
	(tramp-rfn-eshadow-update-overlay, tramp-handle-set-file-times)
	(tramp-set-file-uid-gid, tramp-do-copy-or-rename-file-via-buffer)
	(tramp-do-copy-or-rename-file-directly)
	(tramp-do-copy-or-rename-file-out-of-band)
	(tramp-handle-shell-command, tramp-get-debug-buffer)
	(tramp-send-command-and-read, tramp-equal-remote)
	(tramp-get-local-gid): Pacify byte-compiler.
	(tramp-handle-file-name-directory): Result shall not be expanded.
	(tramp-find-foreign-file-name-handler): Rewrite.
	(tramp-dissect-file-name): Add optional parameter NODEFAULT.

	* net/tramp-cache.el (tramp-cache-print): Pacify byte-compiler.

	* net/tramp-fish.el (tramp-fish-handle-expand-file-name):
	Apply `tramp-completion-mode-p'.
	(tramp-fish-handle-set-file-times)
	(tramp-fish-handle-executable-find)
	(tramp-fish-handle-process-file, tramp-fish-get-file-entries)
	(tramp-fish-retrieve-data): Pacify byte-compiler.

	* net/tramp-gw.el (tramp-gw-basic-authentication):
	Call `tramp-read-passwd' with first parameter `nil'.

2007-09-28  Glenn Morris  <rgm@gnu.org>

	* mail/supercite.el (sc-attribs-filter-namelist): Use mapc rather
	than mapcar.

	* textmodes/tex-mode.el (tex-suscript-height-ratio)
	(tex-suscript-height-minimum): New customizable variables.
	(tex-suscript-height): New function.
	(superscript, subscript): Set height using tex-suscript-height
	rather than fixing at 0.8.
	(tex-fontify-script, tex-font-script-display): Add :version tag.

2007-09-27  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/python.el (python-eldoc-function): Doc fix.

2007-09-27  Glenn Morris  <rgm@gnu.org>

	* image.el (image-type-auto-detected-p): Doc fix.  Don't detect an
	image if it is not in image-type-auto-detectable, or is there with
	a nil value.

2007-09-27  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-maybe-open-connection): Make test for alive
	connection more robust.

2007-09-26  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/eldoc.el (eldoc-function-argstring-format):
	Deal with the case that special &keywords are at the beginning or
	end of the argument list.  Also add some (incomplete) support for
	non-standard arglists.

2007-09-26  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/eldoc.el (eldoc-message-commands-table-size)
	(eldoc-message-commands, eldoc-current-idle-delay)
	(eldoc-function-argstring-format): Fix typos in docstrings.

2007-09-26  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-units.el (calc-convert-units)
	(calc-convert-temperature): Remove unnecessary colons.

2007-09-26  Bastien Guerry  <bzg@altern.org>

	* textmodes/org-export-latex.el (org-export-latex-tables-verbatim):
	New function.
	(org-export-latex-remove-from-headlines): Name changed because of typo.
	(org-export-latex-quotation-marks-convention): Option removed.
	(org-export-latex-make-preamble): Handle the DATE option.
	(org-export-latex-cleaned-string): Now the only cleaning function,
	synched up with org.el.
	(org-export-latex-lists, org-export-latex-parse-list)
	(org-export-list-to-latex): New functions.

2007-09-26  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el (org-kill-is-subtree-p): Use `org-outline-regexp'.
	(org-outline-regexp): New constant.
	(org-remember-handler): Throw error when the target file is not in
	org-mode.
	(org-cleaned-string-for-export): No longer call
	`org-export-latex-cleaned-string' with an argument.
	(org-get-tags): Returns now a list, not a string.
	(org-get-tags-string): New function.
	(org-archive-subtree): No need to split return of `org-get-tags'.
	(org-set-tags, org-entry-properties): Call `org-get-tags-string'
	instead of `org-get-tags'.
	(org-agenda-format-date): Rename from `org-agenda-date-format'.
	(org-time-from-absolute, org-agenda-format-date-aligned): New funs.
	(org-compatible-face): New argument INHERITS.  Inherit from this
	face if possible.
	(org-level-1, org-level-2, org-level-3, org-level-4)
	(org-level-5, org-level-6, org-level-7, org-level-8)
	(org-special-keyword, org-drawer, org-column, org-warning)
	(org-archived, org-todo, org-done, org-headline-done, org-table)
	(org-formula, org-code, org-agenda-structure)
	(org-scheduled-today, org-scheduled-previously)
	(org-upcoming-deadline, org-time-grid): Call `org-compatible-face'
	in the new way.
	(org-get-heading): New argument NO-TAGS.
	(org-fast-tag-selection-include-todo): Made defvar instead of
	defcustom, feature is not deprecated.
	(org-remember-store-without-prompt): New default value t.
	(org-todo-log-states): New variable.
	(org-set-regexps-and-options): #+TODO is an alias for SEQ_TODO.
	Compute the log states.
	(org-goto-map): More commands copied from global map.  Also bind
	`org-occur'.
	(org-goto): Made into a general lookup command.
	(org-get-location): Complete rewrite.
	(org-goto-exit-command): New variable.
	(org-goto-selected-point): New variable.
	(org-goto-ret, org-goto-left, org-goto-right, org-goto-quit):
	Set the new variables.
	(org-paste-subtree): Whitespace insertion strategy revised.
	(org-remember-apply-template): Protect v-A from the possibility
	that v-a might be nil.
	(org-remember-handler): Insertion rules revised.
	(org-todo): Respect org-todo-log-states.
	(org-up-heading-safe): New function.
	(org-entry-get-with-inheritance): Use `org-up-heading-safe'.

2007-09-26  Dan Nicolaescu  <dann@ics.uci.edu>

	* progmodes/cc-cmds.el (c-indent-line-or-region): Only indent the
	region if in transient-mark-mode.

2007-09-26  Juanma Barranquero  <lekktu@gmail.com>

	* calc/calc-ext.el (calc-init-extensions, calc-reset):
	* calc/calc-help.el (calc-full-help):
	* calc/calc-misc.el (another-calc):
	* calc/calc-store.el (calc-var-name-map):
	* calc/calc-stuff.el (calc-flush-caches):
	* calc/calc-units.el (math-build-units-table):
	* calc/calc.el (calc-digit-map, calc-dispatch-map, calc-mode)
	(calc-quit):
	* calendar/icalendar.el (icalendar--format-ical-event)
	(icalendar--convert-ical-to-diary):
	* emacs-lisp/authors.el (authors):
	* emacs-lisp/cust-print.el (custom-print-install)
	(custom-print-uninstall):
	* emacs-lisp/disass.el (disassemble-1):
	* emacs-lisp/easy-mmode.el (easy-mmode-define-syntax):
	* emacs-lisp/edebug.el (byte-compile-resolve-functions):
	* emacs-lisp/elint.el (elint-current-buffer, elint-check-defun-form)
	(elint-check-let-form, elint-check-condition-case-form)
	(elint-initialize):
	* emacs-lisp/elp.el (elp-results):
	* emacs-lisp/generic.el (generic-mode-internal):
	* emacs-lisp/re-builder.el (reb-delete-overlays):
	* emacs-lisp/regi.el (regi-interpret):
	* emacs-lisp/sregex.el (sregex--char-aux):
	* emulation/cua-rect.el (cua--deactivate-rectangle)
	(cua--highlight-rectangle, cua--rectangle-post-command):
	* emulation/viper-keym.el (viper-toggle-key, viper-ESC-key):
	* emulation/viper-macs.el (viper-describe-kbd-macros)
	(viper-describe-one-macro):
	* emulation/viper-util.el (viper-setup-master-buffer):
	* emulation/viper.el (set-viper-state-in-major-mode):
	* international/mule-diag.el (describe-current-coding-system):
	* language/ethio-util.el (ethio-fidel-to-sera-buffer):
	* mail/emacsbug.el (report-emacs-bug):
	* net/ange-ftp.el (ange-ftp-call-chmod, ange-ftp-parse-bs2000-listing):
	* obsolete/hilit19.el (hilit-unhighlight-region)
	(hilit-set-mode-patterns):
	* play/solitaire.el (solitaire-check, solitaire-solve):
	* play/zone.el (zone-pgm-rotate):
	* progmodes/ada-mode.el (ada-save-exceptions-to-file):
	* progmodes/ada-prj.el (ada-prj-display-page):
	* progmodes/delphi.el (delphi-search-directory, delphi-find-unit-file)
	(delphi-debug-mode-map, delphi-mode-map, delphi-mode):
	* progmodes/ebrowse.el (ebrowse-tree-mode, ebrowse-view-exit-fn)
	(ebrowse-member-mode, ebrowse-save-tree-as, ebrowse-save-class):
	* progmodes/sh-script.el (sh-make-vars-local)
	(sh-reset-indent-vars-to-global-values):
	* progmodes/sql.el (top):
	* progmodes/vhdl-mode.el (vhdl-set-style, vhdl-regress-line):
	* progmodes/xscheme.el (top):
	* textmodes/artist.el (artist-mt-get-symbol-from-keyword-sub)
	(artist-go-retrieve-from-symbol-sub, artist-go-get-symbol-shift-sub)
	(artist-fc-retrieve-from-symbol-sub, artist-vaporize-line)
	(artist-vaporize-lines, artist-ellipse-compute-fill-info)
	(artist-submit-bug-report):
	* textmodes/flyspell.el (flyspell-delay-commands)
	(flyspell-deplacement-commands):
	* textmodes/table.el (table--generate-source-epilogue, table-insert)
	(table--generate-source-cells-in-a-row, table--make-cell-map)
	(*table--cell-describe-bindings): Use `mapc' rather than `mapcar'.

2007-09-25  Juanma Barranquero  <lekktu@gmail.com>

	* allout.el (produce-allout-mode-map, allout-process-exposed):
	* ansi-color.el (ansi-color-make-color-map):
	* autoinsert.el (auto-insert):
	* bookmark.el (bookmark-bmenu-list, bookmark-show-all-annotations):
	* dired-aux.el (dired-create-files):
	* dired.el (dired-restore-desktop-buffer):
	* ediff-diff.el (ediff-setup-fine-diff-regions):
	* ediff-mult.el (ediff-intersect-directories)
	(ediff-redraw-directory-group-buffer, ediff-dir-diff-copy-file)
	(ediff-redraw-registry-buffer):
	* ediff-ptch.el (ediff-fixup-patch-map):
	* ediff-util.el (ediff-toggle-multiframe, ediff-toggle-use-toolbar)
	(ediff-really-quit, ediff-clear-diff-vector):
	* emerge.el (emerge-really-quit):
	* ffap.el (ffap-replace-file-component):
	* filecache.el (file-cache-add-directory)
	(file-cache-add-directory-recursively)
	(file-cache-add-from-file-cache-buffer, file-cache-delete-file-regexp)
	(file-cache-delete-directory, file-cache-files-matching-internal)
	(file-cache-display):
	* files.el (cd):
	* find-lisp.el (find-lisp-insert-directory):
	* finder.el (finder-compile-keywords):
	* help.el (view-emacs-news):
	* hi-lock.el (hi-lock-write-interactive-patterns):
	* ido.el (ido-to-end, ido-set-matches-1):
	* image-dired.el (image-dired-display-thumbs, image-dired-remove-tag)
	(image-dired-mark-tagged-files):
	* jka-cmpr-hook.el (jka-compr-get-compression-info):
	* printing.el (pr-eval-local-alist, pr-eval-setting-alist):
	* ps-print.el (ps-background, ps-begin-file)
	(ps-build-reference-face-lists):
	* simple.el (clone-buffer):
	* startup.el (command-line):
	* tempo.el (tempo-insert-template, tempo-is-user-element)
	(tempo-forward-mark, tempo-backward-mark):
	* woman.el (woman-dired-define-keys): Use `mapc' rather than `mapcar'.

2007-09-25  Glenn Morris  <rgm@gnu.org>

	* textmodes/tex-mode.el (tex-font-script-display): Doc fix.

	* view.el (view-search-no-match-lines): Add a doc string.
	Rewrite to simplify and work better.

2007-09-24  Dan Nicolaescu  <dann@ics.uci.edu>

	* progmodes/cc-mode.el (c-mode-base-map):
	Use c-indent-line-or-region instead of c-indent-line.

	* indent.el (indent-for-tab-command): First check if the region is
	active.

2007-09-24  Michaël Cadilhac  <michael@cadilhac.name>

	* whitespace.el (whitespace-tickle-timer): Don't install the timer if
	whitespace-rescan-timer-time is 0.

2007-09-24  Karl Berry  <karl@gnu.org>

	* international/mule.el (coding-system-base): Fix doc string grammar.

2007-09-24  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-completion-mode-p): Rename from
	`tramp-completion-mode'.  Revert logic, check `return', `newline'
	and such alike.  Packages like Icicles tend to use other completion
	characters but `tab' and `space' only.

2007-09-24  Adam Hupp  <adam@hupp.org>

	* progmodes/python.el (run-python): Import emacs module without
	waiting; prevents lockup on error.

2007-09-23  Richard Stallman  <rms@gnu.org>

	* mail/sendmail.el (mail-bury): Delete the frame
	if this frame looks like it was made for this message.

	* completion.el (completion-separator-self-insert-command)
	(completion-separator-self-insert-autofilling):
	If `self-insert-command' has been remapped, use the substitute.

	* simple.el (copy-region-as-kill): Doc fix.

	* textmodes/org.el (org-confirm-shell-link-function)
	(org-confirm-elisp-link-function): Doc fixes.

2007-09-23  Glenn Morris  <rgm@gnu.org>

	* ses.el (ses-calculate-cell): Don't evaluate unsafe formulas.

2007-09-23  Dan Nicolaescu  <dann@ics.uci.edu>

	* term/w32-win.el (w32-drag-n-drop): Use mapc instead of mapcar.

	* term/tvi970.el (terminal-init-tvi970): Likewise.

	* term/sun-mouse.el (print-mouse-format): Likewise.

	* term/sun.el (scroll-down-in-place, scroll-up-in-place):
	Use forward-line instead of previous-line and next-line.

2007-09-22  Juri Linkov  <juri@jurta.org>

	* textmodes/org.el (org-confirm-shell-link-function): Doc fix.

	* tutorial.el (tutorial--default-keys): Update standard bindings:
	rename `iconify-or-deiconify-frame' to `suspend-frame',
	and `save-buffers-kill-emacs' to `save-buffers-kill-terminal'.

2007-09-22  Juri Linkov  <juri@jurta.org>

	* startup.el (fancy-startup-text, fancy-about-text, fancy-startup-tail):
	Add help-echo to external links and to links without description.
	(fancy-splash-insert): Use help-echo from the 3rd element of the
	link specification list, or "Follow this link" if it's nil.  Doc fix.

2007-09-22  Juri Linkov  <juri@jurta.org>

	* startup.el (command-line): Rename `inhibit-startup-message' to
	`inhibit-startup-screen'.
	(fancy-about-text): Use shorter label for "Ordering Manuals".
	(fancy-startup-tail): Add optional arg `concise'.  When `concise'
	is nil, display a line with "To start..." and 3 links to useful
	tasks.  Display the "Dismiss" button and "Don't show this message
	again" only when concise is non-nil.
	(fancy-startup-screen): Call `fancy-startup-tail' with optional
	arg `concise'.  If CONCISE is non-nil, display a concise version
	of the splash screen in another window.  Otherwise, switch to the
	startup buffer in the same window.
	(startup-echo-area-message): Change displayed binding from
	C-h C-p (describe-project) to C-h C-a (about-emacs), and change
	text "about the GNU system and GNU/Linux" to "about GNU Emacs and
	the GNU system".
	(display-startup-screen): Fix buffer name from "*About GNU Emacs*"
	to "*GNU Emacs*".
	(display-about-screen): Don't check the existence of the buffer
	"*About GNU Emacs*".
	(display-splash-screen): Make alias to `display-startup-screen'.
	(command-line-1): Rename `inhibit-startup-message' to
	`inhibit-startup-screen'.  Inhibit startup screen when Emacs is
	started with command line options "-f", "-funcall", "-e", "-eval",
	"-execute", "-insert", "-find-file", "-file", "-visit".
	Inhibit startup screen when Emacs is started with a file name only
	on tty (i.e. don't inhibit it when started with a file name like
	"emacs FILE..." on a window system).
	(command-line-1): Simplify logic of displaying the startup screen:
	if file-count > 0, then display the concise version in another
	window, otherwise display full version in the same window.

	* help.el (help-map): Bind C-h C-a to about-emacs.
	(help-for-help-internal): Add C-a description to C-h help text.

2007-09-22  Dan Nicolaescu  <dann@ics.uci.edu>

	* emacs-lisp/checkdoc.el (checkdoc-force-docstrings-flag)
	(checkdoc-permit-comma-termination-flag): Autoload the
	safe-local-variable setting.

	* bookmark.el (bookmark-xemacsp): Remove.
	(bookmark-make): Don't use bookmark-xemacsp,
	use (featurep 'xemacs) instead.

	* speedbar.el (speedbar-frame-mode)
	(speedbar-frame-reposition-smartly)
	(speedbar-set-mode-line-format, speedbar-reconfigure-keymaps)
	(speedbar-check-vc): Remove use of non-existent variable
	dframe-xemacsp, use (featurep 'xemacs) instead.

	* indent.el (indent-for-tab-command): Indent the region if
	transient-mark-mode and the region is active.

2007-09-21  Francesco Potortì  <pot@gnu.org>

	* progmodes/octave-inf.el (inferior-octave-mode): Use add-hook to
	add inferior-octave-directory-tracker to the buffer-local value
	of comint-input-filter-functions.

2007-09-21  Dan Nicolaescu  <dann@ics.uci.edu>

	* xt-mouse.el (xterm-mouse-mode): Re-enable suspend-tty-functions.

2007-09-21  Juanma Barranquero  <lekktu@gmail.com>

	* frame.el (suspend-frame): Call `iconify-or-deiconify-frame' also
	on w32 frames.

2007-09-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* startup.el (normal-top-level): Remove DISPLAY from
	process-environment to let it be computed dynamically in callproc.c.

	* frame.el (frame-initialize, make-frame):
	* faces.el (tty-set-up-initial-frame-faces):
	* env.el (setenv): Don't set display-environment-variable.

	* server.el (server-getenv-from): Remove.  Use getenv-internal instead.
	(server-create-tty-frame): Don't set unused `tty' property.
	Set `display' instead of display-environment-variable.
	(server-create-window-system-frame): No display-environment-variable.

2007-09-21  Michael Albinus  <michael.albinus@gmx.de>

	* rfn-eshadow.el (rfn-eshadow-setup-minibuffer-hook)
	(rfn-eshadow-update-overlay-hook): New defvars.
	(rfn-eshadow-setup-minibuffer, rfn-eshadow-update-overlay):
	Run the hooks.

	* net/tramp.el (tramp-rfn-eshadow-overlay): New defvar.
	(tramp-rfn-eshadow-setup-minibuffer)
	(tramp-rfn-eshadow-update-overlay): New defuns.  Hook into
	rfn-eshadow.el.

	* net/tramp-smb.el (tramp-smb-errors): Add error message for call
	timeout.

2007-09-21  Glenn Morris  <rgm@gnu.org>

	* obsolete/sun-fns.el (emacs-quit-menu): Remove emacstool-related code.
	* term/sun-mouse.el (suspend-emacstool): Remove.
	* term/sun.el: Remove emacstool-related code.

	* emacs-lisp/bytecomp.el (byte-compile-warnings)
	(byte-compile-warnings-safe-p): Add `mapcar'.
	(byte-compile-warning-types): Add mapcar and make-local.
	(byte-compile-normal-call): Add option to suppress mapcar warning.
	(top-level): Use mapc rather than mapcar in eval-when-compile.

	* textmodes/tex-mode.el (tex-validate-region): Handle escaped parens.
	(tex-next-unmatched-eparen, tex-last-unended-eparen): New functions.
	(latex-forward-sexp-1, latex-backward-sexp-1): Doc fix.
	Handle escaped parens.
	(latex-forward-sexp): Doc fix.

	* eshell/esh-mode.el (eshell-output-filter-functions):
	Add eshell-postoutput-scroll-to-bottom.

	* loadup.el: Remove termdev.

	* progmodes/fortran.el (fortran-mode-abbrev-table, fortran-line-length):
	* progmodes/f90.el (f90-mode-abbrev-table): Use mapc rather than mapcar.

2007-09-21  Markus Triska  <markus.triska@gmx.at>

	* emacs-lisp/bytecomp.el (byte-compile-normal-call): Warn when
	`mapcar' is called for effect.

2007-09-21  Kevin Ryde  <user42@zip.com.au>

	* international/mule.el (sgml-html-meta-auto-coding-function):
	Bind `case-fold-search' to t.

2007-09-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* termdev.el: Remove.

	* frame.el (get-device-terminal): New function.  Moved from termdev.el.
	(frames-on-display-list): Use it.

	* bindings.el: Bind C-z to suspend-frame instead of suspend-emacs.

	* termdev.el (terminal-id): Ask terminal-live-p before giving up.

2007-09-20  Richard Stallman  <rms@gnu.org>

	* newcomment.el (comment-add): If EXTRA, double `comment-add' value.

2007-09-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* add-log.el (add-log-current-defun): Fix thinko w.r.t derived-mode-p.

2007-09-20  Glenn Morris  <rgm@gnu.org>

	* textmodes/tex-mode.el (tex-validate-buffer): Use paragraph
	motion functions, rather than hard-coding "\n\n".
	(tex-validate-region): Check for eobp, to speed up.
	(tex-next-unmatched-end): Doc fix.

2007-09-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* files.el (auto-mode-alist): Use archive-mode for .rar files.

	* international/mule.el (auto-coding-alist): Rar archives are binary.

	* arc-mode.el: Add basic support for Rar.
	(archive-find-type): Recognize Rar's signature.
	(archive-desummarize): New fun.
	(archive-summarize): Use it to restore the buffer's data in case
	someone wants to switch to some other major mode.
	(archive-resummarize): Use it as well.
	(archive-rar-summarize, archive-rar-extract): New functions.

	* filesets.el: Remove spurious * in docstrings.
	(filesets-running-xemacs): Remove.  Use (featurep 'xemacs) instead.
	(filesets-conditional-sort): Remove unused arg `simply-do-it'.
	(filesets-ingroup-collect): Remove unused arg `depth'.
	(filesets-update): Remove unused arg `version'.

	* finder.el (finder-compile-keywords): Fix up comment style.
	(finder-mouse-face-on-line): previous-line -> forward-line.

	* recentf.el: Remove spurious * in docstrings.
	(recentf-save-list): Fix up comment style.

	* progmodes/octave-mod.el: Remove spurious * in docstrings.
	(octave-mode-map): Move init into declaration and remove \t binding.
	(octave-mode-startup-message): Remove unused var.
	(octave-scan-blocks): Remove unused arg `from'.
	(octave-forward-block, octave-down-block, octave-up-block):
	Update callers.

	* progmodes/meta-mode.el (meta-mode-syntax-table): Move init into decl.
	(meta-mode-map): Likewise and remove \t binding.

	* net/snmp-mode.el: Remove spurious * in docstrings.
	(snmp-rfc1155-types, snmp-rfc1213-types, snmp-rfc1902-types)
	(snmp-rfc1903-types, snmp-rfc1155-access, snmp-rfc1902-access)
	(snmp-rfc1212-status, snmp-rfc1902-status): Remove list wrappers now
	that completion accepts lists of strings.
	(snmp-mode-syntax-table): Move initialization into declaration.
	(snmp-mode-map): Likewise and remove \t binding.
	(snmp-common-mode): Set tab-always-indent according to snmp-t-a-i.
	(snmp-indent-line, snmp-mode-imenu-create-index): Remove unused var.
	(snmp-indent-command): Remove.

	* emacs-lisp/lisp-mode.el (lisp-mode-shared-map): Use the default TAB
	binding, so tab-always-indent works right.

2007-09-19  Johannes Weiner  <hannes@saeurebad.de>

	* net/browse-url.el (browse-url-elinks-new-window): New function.
	(browse-url-elinks): Use browse-url-elinks-new-window.
	Accept optional second argument `new-window'.  Fix typo in doc-string.
	(browse-url-elinks-sentinel): Use browse-url-elinks-new-window.
	Improve error message.

2007-09-19  Michaël Cadilhac  <michael@cadilhac.name>

	* net/browse-url.el (browse-url-url-encode-chars): Use the right
	parameter name in the function body.
	Reported by Johannes Weiner.

2007-09-19  Glenn Morris  <rgm@gnu.org>

	* net/socks.el (socks-open-network-stream): Signal an explicit
	error if the port associated with a service string can't be found.

	* textmodes/tex-mode.el (tex-terminate-paragraph):
	Use backward-paragraph.

2007-09-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* server.el (server-running-p): New function.

2007-09-18  Jason Rumney  <jasonr@gnu.org>

	* term/w32-win.el (w32-focus-frame): Make obsolete alias for
	x-focus-frame.

	* frame.el (select-frame-set-input-focus, select-frame-by-name):
	Use x-focus-frame for w32.

2007-09-17  David Kastrup  <dak@gnu.org>

	* textmodes/tex-mode.el (tex-verbatim-environments):
	Eliminate CL dependency.

2007-09-17  Richard Stallman  <rms@gnu.org>

	* newcomment.el (comment-add): New arg EXTRA.
	(comment-region-default): Pass EXTRA if not indenting lines.

2007-09-17  Michaël Cadilhac  <michael@cadilhac.name>

	* net/browse-url.el (browse-url-url-encode-chars): New function.
	URL-encode some chars in a string.
	(browse-url-encode-url): Rewrite using the previous function.
	(browse-url-file-url): Use `browse-url-url-encode-chars'.
	(browse-url-elinks-sentinel): Fix typo.
	(browse-url-new-window-flag): Doc change.

2007-09-17  Glenn Morris  <rgm@gnu.org>

	* textmodes/tex-mode.el (tex-compilation-parse-errors): Prefer the
	filename from `--file-line-error', if it is available.

2007-09-17  Joe Wells  <jbw@macs.hw.ac.uk>  (tiny change)

	* textmodes/tex-mode.el (tex-compilation-parse-errors): Also match
	TeX `--file-line-error' format.

2007-09-17  Dan Nicolaescu  <dann@ics.uci.edu>

	* xt-mouse.el: Delete add-hook calls that were moved to
	xterm-mouse-mode.
	(xterm-mouse-mode): Disable resume-tty-functions, explain why it
	does not work.

2007-09-17  Richard Stallman  <rms@gnu.org>

	* cus-face.el (custom-theme-set-faces): Undo previous change.

	* faces.el (face-spec-set): When FRAME nil, look up each frame in SPEC.

2007-09-17  Glenn Morris  <rgm@gnu.org>

	* textmodes/tex-mode.el (tex-region): Simplify previous change,
	handling the case where the region is not in `tex-main-file'.
	(tex-region-1): Delete.
	(tex-region-header): New function, doing the header part of the
	old tex-region-1.

2007-09-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (newline): Simplify use of prefix-numeric-value.
	(line-move-partial): Remove unused var `ppos'.
	(line-move-1): Replace 9999 with most-positive-fixnum.
	(move-end-of-line): Use more efficient single-property search.
	(move-beginning-of-line): Remove unused var `start'.
	(blink-matching-open): Restructure in a more functional style.

2007-09-16  Michaël Cadilhac  <michael@cadilhac.name>

	* calendar/holidays.el (list-holidays): Remove the cyclic alias.

2007-09-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* server.el (server-clients): Only keep procs, no properties any more.
	(server-client): Remove.
	(server-client-get, server-client-set): Remove, replace all callers by
	process-get and process-put resp.
	(server-clients-with, server-add-client, server-delete-client)
	(server-create-tty-frame, server-create-window-system-frame)
	(server-process-filter, server-execute, server-visit-files)
	(server-buffer-done, server-kill-buffer-query-function)
	(server-kill-emacs-query-function, server-switch-buffer)
	(server-save-buffers-kill-terminal): Update accordingly.

	* server.el (server-with-environment): Simplify.
	(server-select-display, server-unselect-display): Re-add functions that
	seem to have been lost in the multi-tty merge.
	(server-eval-and-print, server-create-tty-frame)
	(server-create-window-system-frame, server-goto-toplevel)
	(server-execute, server-return-error): New functions extracted from
	server-process-filter.
	(server-execute-continuation): New functions.
	(server-process-filter): Restructure so that all arguments are analyzed
	first and then acted upon in a subsequent stage.  This way
	server-goto-toplevel can be executed later, when we know if
	it's necessary.
	Remove the "-version" and "-version-good" support.

2007-09-16  Drew Adams  <drew.adams@oracle.com>

	* cus-edit.el (custom-face-edit-activate): Doc fix.

2007-09-16  Glenn Morris  <rgm@gnu.org>

	* calendar/cal-menu.el, calendar/calendar.el, calendar/diary-lib.el:
	Following cal-bahai renaming, update all instances of
	list-bahai-diary-entries to diary-bahai-list-entries,
	mark-bahai-diary-entries to diary-bahai-mark-entries,
	calendar-goto-bahai-date to calendar-bahai-goto-date,
	insert-bahai-diary-entry to diary-bahai-insert-entry,
	insert-monthly-bahai-diary-entry to diary-bahai-insert-monthly-entry,
	insert-yearly-bahai-diary-entry to diary-bahai-insert-yearly-entry, and
	calendar-print-bahai-date to calendar-bahai-print-date.

	* textmodes/tex-mode.el (tex-region): Handle the case where the
	region is not in `tex-main-file'.  Move the old code that applies
	to both cases...
	(tex-region-1): ...to this new function.

2007-09-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc.el (vc-process-sentinel): New function.
	(vc-exec-after): Use it instead of using ugly hackish analysis and
	construction of Elisp code.
	(vc-sentinel-movepoint): New dynamically scoped var.
	(vc-print-log, vc-annotate): Set it to move the user's point.

	* vc-cvs.el (vc-cvs-annotate-time): Use inhibit-read-only and
	inhibit-modification-hooks.

	* calendar/cal-bahai.el (mark-bahai-diary-entries): Fix up typo.
	(calendar-bahai-print-date, calendar-bahai-goto-date)
	(diary-bahai-list-entries, diary-bahai-insert-entry):
	New names to clean up the namespace a bit more.
	(calendar-goto-bahai-date, calendar-print-bahai-date): Compat aliases.

2007-09-15  Glenn Morris  <rgm@gnu.org>

	* calendar/holidays.el (holiday-list): Rename it back to
	`list-holidays', but leave `holiday-list' as an alias.

	* textmodes/bibtex-style.el (bibtex-style-indent-basic): Specify a
	custom group.

	* textmodes/css-mode.el (css): New custom group.
	(css-electrick-keys, css-selector, css-property)
	(css-indent-offset): Specify custom group.

2007-09-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcvs.el (cvs-tags-list, cvs-retrieve-revision, cvs-find-modif)
	(cvs-execute-single-file): Use process-file.
	(cvs-run-process): Use start-file-process.

2007-09-15  Dan Nicolaescu  <dann@ics.uci.edu>

	* xt-mouse.el (xterm-mouse-mode): Add hooks here not at the top
	level.  Remove the hooks when turning off the mode.

	* term/xterm.el: Require xt-mouse at compile time.
	(terminal-init-xterm): Turn on xterm mouse tracking for this
	terminal if xterm-mouse-mode is enabled.

2007-09-14  Dan Nicolaescu  <dann@ics.uci.edu>

	* term/xterm.el (xterm-function-map): Replace bindings that were
	deleted by the merge.

2007-09-14  Ulf Jasper  <ulf.jasper@web.de>

	* play/bubbles.el (bubbles-version): Bump value to "0.5".
	(bubbles-mode-map): Move define-key statements here.
	(bubbles-game-theme-menu): Ditto.
	(bubbles-graphics-theme-menu): Ditto.
	(bubbles-menu): Ditto.
	(bubbles-mode): Initialize buffer-undo-list, redisplay.
	(bubbles--initialize): Reset buffer-undo-list, redisplay.
	(bubbles-plop): Set buffer-undo-list, redisplay.
	(bubbles-undo): Reset buffer-undo-list, redisplay.
	(bubbles--show-images): Take care of missing text properties.

2007-09-14  Glenn Morris  <rgm@gnu.org>

	* startup.el (fancy-startup-text, fancy-about-text): Fix face
	quoting.

	* calendar/cal-hebrew.el, calendar/cal-menu.el
	* calendar/calendar.el, calendar/diary-lib.el
	* calendar/holidays.el: Rename all instances of
	list-calendar-holidays callers to calendar-list-holidays,
	list-holidays to holiday-list, check-calendar-holidays to
	calendar-check-holidays, mark-calendar-holidays to
	calendar-mark-holidays, and filter-visible-calendar-holidays to
	holiday-filter-visible-calendar.

2007-09-14  Dan Nicolaescu  <dann@ics.uci.edu>

	* term/xterm.el (xterm-function-map): Add C-M- bindings.

2007-09-13  Sascha Wilde  <wilde@sha-bang.de>  (tiny change)

	* play/bubbles.el (bubbles--initialize-images): Fix bug:
	Use transparent background for empty cells in graphics mode.

2007-09-13  Jari Aalto  <jari.aalto@cante.net>

	* man.el (Man-default-man-entry): At end of line, continue looking
	to the next line for possible end of hyphenated command.

2007-09-13  Chris Moore  <dooglus@gmail.com>

	* shell.el (shell-resync-dirs): Don't move the cursor relative to
	the command being edited.

2007-09-12  Jim Meyering  <jim@meyering.net>  (tiny change)

	* emacs-lisp/copyright.el (copyright-names-regexp): Doc fix: typo.

2007-09-12  Dan Nicolaescu  <dann@ics.uci.edu>

	* term/xterm.el (xterm-function-map): Add bindings for M-S- and
	C-M-S- keys.

	* term/rxvt.el (rxvt-function-map): Initialize in the declaration.

2007-09-12  Michaël Cadilhac  <michael@cadilhac.name>

	* net/browse-url.el (browse-url-encode-url): Fix an infinite loop.
	New argument `filename-p' to use one set of confusing chars or another.
	(browse-url-file-url): Use the argument.
	Suggested by Johannes Weiner.

2007-09-12  Romain Francoise  <romain@orebokech.com>

	* cus-start.el (all): Revert 2007-09-08 change.

2007-09-12  Aaron S. Hawley  <aaronh@garden.org>

	* jka-cmpr-hook.el (jka-compr-compression-info-list): Use gzip to
	extract .Z files, since it is more common than uncompress.

2007-09-12  Glenn Morris  <rgm@gnu.org>

	* textmodes/org-publish.el (org-publish-org-to-html): Remove
	duplicate function definition.

2007-09-10  Chris Moore  <dooglus@gmail.com>

	* diff-mode.el (diff-sanity-check-hunk):
	Also accept single-line hunks.

2007-09-10  Chong Yidong  <cyd@stupidchicken.com>

	* startup.el (startup-screen-inhibit-startup-screen)
	(pure-space-overflow-message): New vars.
	(fancy-splash-insert): Allow functions for face and link specs.
	(fancy-splash-head): Remove unused arg.  Move splash text...
	(fancy-startup-text, fancy-about-text): ...here.
	(fancy-startup-tail): Rename from fancy-splash-tail.
	(fancy-startup-screen, fancy-about-screen): Split off from
	fancy-splash-screens.
	(display-startup-screen): New function.
	(display-about-screen): Rename from display-splash-screen.
	(command-line-1): Use concise startup screen if necessary.

2007-09-10  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* net/browse-url.el (browse-url-encode-url): Use copy-sequence.
	Reported by Jan Djärv <jan.h.d@swipnet.se>.

2007-09-10  Dave Love  <fx@gnu.org>

	* outline.el (outline-4, outline-5, outline-7):
	Move font-lock-builtin-face down from 4 to 7 to better keep the
	progression of color brightness, and to better match Org-mode's faces.

2007-09-10  Michaël Cadilhac  <michael@cadilhac.name>

	* progmodes/meta-mode.el (meta-font-lock-keywords)
	(font-lock-match-meta-declaration-item-and-skip-to-next)
	(meta-comment-indent, meta-indent-previous-line)
	(meta-indent-unfinished-line, meta-beginning-of-defun)
	(meta-end-of-defun, meta-common-initialization): Handle \f.
	(meta-indent-unfinished-line): Do not handle a `%' in a string as
	a comment-start.

	* files.el (file-modes-char-to-who, file-modes-char-to-right)
	(file-modes-rights-to-number): Auxiliary functions for symbolic to
	numeric notation of file modes.
	(file-modes-symbolic-to-number): New.  Convert symbolic modes to its
	numeric value.
	(read-file-modes): New.  Read either an octal value of a file mode or a
	symbolic value, and return its numeric value.

	* dired-aux.el (dired-do-chmod): Change to use the built-in
	`set-file-modes' and the previous symbolic mode parsing functions.

2007-09-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/texinfo.el: Remove spurious * in docstrings.
	(texinfo-mode-syntax-table, texinfo-mode-map):
	Initialize in the declaration.

	* tmm.el: Remove spurious * in docstrings.
	(tmm-prompt): Use with-current-buffer.

	* vcursor.el: Remove spurious * in docstrings.
	(vcursor-map): Initialize in the declaration.
	(vcursor-use-vcursor-map): Use define-minor-mode.
	(vcursor-toggle-vcursor-map): Keep as an obsolete alias.

	* wid-browse.el (widget-browse-mode-map, widget-minor-mode-map):
	Initialize in the declaration.
	(widget-minor-mode): Use define-minor-mode.

	* woman.el (woman-mode-map, woman-syntax-table):
	Initialize in the declaration.

2007-09-09  Tassilo Horn  <tassilo@member.fsf.org>

	* doc-view.el: New file.

2007-09-09  Juri Linkov  <juri@jurta.org>

	* Makefile.in (update-authors): Add etc/ to AUTHORS.

	* makefile.w32-in (update-authors): Add etc/ to AUTHORS.

	* startup.el (initial-buffer-choice): Rename choice "Splash screen"
	to "Startup screen".  Fix docstring.
	(inhibit-startup-screen): Rename from `inhibit-splash-screen'.
	(inhibit-splash-screen): Make alias to `inhibit-startup-screen'.
	(inhibit-startup-message): Change alias to `inhibit-startup-screen'.
	(initial-scratch-message): Fix docstring.
	(fancy-startup-text): Move link to Emacs Manual below Emacs Guided
	Tour (which is a kind of tutorial and will be next to Emacs Tutorial).
	Add link to "Customize Startup" and set interval between links to
	5 spaces.
	(fancy-about-text): Add links "Authors" and "Contributing".
	(fancy-splash-head): Add text "Welcome to " on the startup screen,
	and "This is " on the about screen.  Add link to
	"http://www.gnu.org/software/emacs/" for "GNU Emacs".
	For the about screen move emacs version to the header from
	`fancy-splash-tail' (as it's done already for normal about screen).
	(fancy-splash-tail): Insert emacs version only for startup screen.
	(normal-splash-screen): Remove duplicate empty lines.
	(normal-about-screen): Add links "Authors" and "Contributing".

	* menu-bar.el (menu-bar-help-menu):
	Move "About Emacs" and "About GNU" to the end of the Help menu.
	Move "Emacs Psychotherapist" after "Send Bug Report...".
	Move "External Packages" after "Find Emacs Packages".

2007-09-09  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (top): Remove declarations of `tramp-gw-*' symbols,
	they are useless with the byte compiler.
	(tramp-make-temp-file, tramp-make-tramp-temp-file): Move up.
	(tramp-do-copy-or-rename-file-directly): Rearrange let-bindings.
	(tramp-compute-multi-hops): Mask `tramp-gw-*' symbols.
	(tramp-file-name-real-host, tramp-file-name-port)
	(tramp-find-method, tramp-find-user, tramp-find-host): Make them
	defuns.

	* net/tramp-cache.el (top): Improve error message when
	`tramp-persistency-file-name' is corrupted.

2007-09-09  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el (org-re): Also replace the :alpha: class.
	(org-todo-tag-alist): Variable removed.
	(org-todo-key-alist, org-todo-key-trigger): New variables.
	(org-use-fast-todo-selection): New option.
	(org-log-done): Docstring fixed.
	(org-deadline-warning-days): New default value 14.
	(org-edit-timestamp-down-means-later): New option.
	(org-tag-alist): Docstring fixed.
	(org-fast-tag-selection-include-todo): New option.
	(org-export-language-setup): New languages added.
	(org-set-regexps-and-options): Compute the new variables.
	(org-paste-subtree): Cleaning up.
	(org-remember-apply-template): New escape %A.
	(org-todo): Call fast TODO selection.
	(org-fast-todo-selection): New function.
	(org-add-log-note): Allow prefix for abort exit.
	(org-at-property-p, org-entry-properties)
	(org-columns-get-autowidth-alist): Use :alpha: class.
	(org-get-wdays): New function.
	(org-agenda-remove-date): New variable.
	(org-agenda-get-deadlines): Use `org-get-wdays'.
	(org-agenda-get-deadlines): Reverse ee before returning.
	(org-format-agenda-item): New argument REMOVE-RE.
	(org-agenda-convert-date): Baha'i calendar added.
	(org-infile-export-plist): Also find DATE line.
	(org-get-min-level): New function.
	(org-export-as-html, org-export-as-ascii): Use the date format.
	(org-shiftup, org-shiftdown): Use.
	`org-edit-timestamp-down-means-later'.
	(org-assign-fast-keys): New function.

2007-09-08  Fredrik Axelsson  <f.axelsson@gmail.com>

	* cus-start.el (all): Add prefer-window-split-horizontally from
	window.c.

2007-09-08  Eli Zaretskii  <eliz@gnu.org>

	* net/browse-url.el (browse-url-galeon): Fix last change.
	(top-level): Require cl when compiling.

2007-09-08  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org-export-latex.el: arch-tag restored.

	* textmodes/org-publish.el: arch-tag restored.

2007-09-08  Masatake YAMATO  <jet@gyve.org>

	* progmodes/which-func.el (which-func-modes): Add diff-mode.

	* progmodes/cc-langs.el: Support new keywords added to
	objective-c frontend of gcc.
	(c-simple-stmt-kwds): Add @throw.
	(c-block-stmt-2-kwds): Add @synchronized.
	(c-block-stmt-1-kwds): Add @finally and @try.

2007-09-07  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el (org-edit-timestamp-down-means-later): New option.
	(org-agenda-after-show-hook): New variable.
	(org-columns-compile-format)
	(org-columns-get-autowidth-alist, org-buffer-property-keys)
	(org-entry-properties, org-at-property-p): Allow [:alnum:] in
	property names.
	(org-get-wdays): New function.

2007-09-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (normal-erase-is-backspace-setup-frame): Massage.

	* term/xterm.el (xterm-function-map): Initialize in the declaration.

	* vc-arch.el (vc-arch-checkin): Fix typo.

2007-09-07  Johan Bockgård  <bojohan@gnu.org>

	* cus-face.el (custom-theme-set-faces): Set face attributes
	locally for each frame.

2007-09-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/fortran.el (fortran-mode): Set font-lock-syntactic-keywords
	via font-lock-defaults.

	* emacs-lisp/bytecomp.el (byte-compile-log-file): Check major-mode via
	derived-mode-p.

2007-09-07  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* progmodes/autoconf.el (autoconf-definition-regexp):
	Handle optional square brackets around definition name.

2007-09-07  Johannes Weiner  <hannes@saeurebad.de>

	* net/browse-url.el (browse-url-browser-function): Add elinks.
	(browse-url-elinks-wrapper): New option.
	(browse-url-encode-url, browse-url-elinks)
	(browse-url-elinks-sentinel): New functions.
	(browse-url-file-url, browse-url-netscape, browse-url-mozilla)
	(browse-url-firefox, browse-url-galeon, browse-url-epiphany):
	Use new function browse-url-encode-url.

2007-09-07  Glenn Morris  <rgm@gnu.org>

	* version.el (emacs-version): Revert 2007-08-29 change: no need to
	say if multi-tty is present.

2007-09-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* cus-start.el (split-window-preferred-function): Add custom info.

	* calendar/holidays.el (holiday-list, calendar-check-holidays)
	(calendar-mark-holidays, calendar-list-holidays)
	(holiday-filter-visible-calendar): New names to clean up namespace.
	(filter-visible-calendar-holidays, list-calendar-holidays)
	(mark-calendar-holidays, check-calendar-holidays, list-holidays):
	Add compatibility aliases.
	(calendar-check-holidays, calendar-mark-holidays)
	(calendar-holiday-list, holiday-filter-visible-calendar): Use dolist.
	(holiday-sexp): Replace append with list.
	(holiday-filter-visible-calendar): Replace append with push.

	* woman.el: Remove spurious * in docstrings.
	(woman-mini-help, woman-non-underline-faces, woman0-rename)
	(woman-topic-all-completions-merge, woman-file-name-all-completions)
	(woman-select-symbol-fonts, woman-expand-directory-path): Use dolist.
	(woman-write-directory-cache, woman-display-extended-fonts)
	(WoMan-log-begin, WoMan-log-1): Use with-current-buffer.
	(woman-really-find-file): Use pop-to-buffer if switch-to-buffer fails.
	(woman-mode): Use inhibit-read-only.
	(woman-negative-vertical-space): Use dotimes.
	(woman2-tagged-paragraph, woman-tab-to-tab-stop): Use insert-char.

2007-09-06  Romain Francoise  <romain@orebokech.com>

	* vc-bzr.el (vc-bzr-admin-lastrev): New defconst.
	(vc-bzr-workfile-version): Use it.

2007-09-06  Sean O'Rourke  <sorourke@cs.ucsd.edu>

	* complete.el (PC-do-completion): Don't try to treat
	empty string as an abbreviation.

2007-09-06  Johan Bockgård  <bojohan@dd.chalmers.se>

	* help-fns.el (describe-variable): Keep doc's text properties.

2007-09-06  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el (vc-default-diff-tree): Pass a list to the diff vc command
	instead of a file.

2007-09-06  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/checkdoc.el (checkdoc-minor-mode-string): New.
	(checkdoc-minor-mode): Allow user to specify lighter via
	checkdoc-minor-mode-string.

2007-09-05  Richard Stallman  <rms@gnu.org>

	* startup.el (fancy-startup-text): Rename from fancy-splash-text.
	Several items removed, simplified, or put on one line.
	(fancy-about-text): Add substantial contents, part of startup text.
	(fancy-splash-head): Make "GNU" or "GNU/Linux" a link.
	(normal-splash-screen): Call normal-mouse-startup-screen,
	normal-no-mouse-startup-screen, or normal-about-screen.
	(normal-mouse-startup-screen): New fn, broken out, shortened.
	(normal-no-mouse-startup-screen): New fn, broken out.
	(normal-about-screen): New function, contents all new.

2007-09-05  Michaël Cadilhac  <michael@cadilhac.name>

	* emacs-lisp/rx.el (rx): Fix typo in docstring.

2007-09-05  Glenn Morris  <rgm@gnu.org>

	* cus-edit.el (custom-buffer-create-internal): Check tool-bar-mode
	is bound.

2007-09-05  Johan Bockgård  <bojohan@dd.chalmers.se>

	* emacs-lisp/advice.el (ad-make-advised-docstring): Highlight note
	in doc string.

2007-09-04  Dan Nicolaescu  <dann@ics.uci.edu>

	* server.el (server-start, server-unload-hook): Undo previous change.

	* xt-mouse.el: Undo previous change.

2007-09-04  Juri Linkov  <juri@jurta.org>

	* startup.el (fancy-about-text): New variable.
	(fancy-splash-delay, fancy-splash-max-time): Remove user options.
	(fancy-current-text, fancy-splash-stop-time)
	(fancy-splash-outer-buffer): Remove variables.
	(fancy-splash-head, fancy-splash-tail): Add new optional argument
	`startup' and use it to conditionally display different texts for
	Startup and About screens.  Don't display Help commands on the About
	screen.
	(fancy-splash-screens-1): Remove function and move its content to
	`fancy-splash-screens' to the part that displays the About screen.
	(exit-splash-screen): Don't treat specially exiting from
	alternating screens.
	(fancy-splash-screens): Rename argument `static' to `startup'.
	Fix docstring.  Remove code for displaying alternating screens.
	Use arg `startup' in calls to `fancy-splash-head', `fancy-splash-tail'.
	Remove let-bind for `fancy-splash-outer-buffer' and add let-bind
	for `inhibit-read-only'.
	(normal-splash-screen): Rename argument `static' to `startup'.
	Fix docstring.  Use argument `startup' to conditionally display
	different texts for Startup and About screens.  Don't display Help
	commands on the About screen.  Remove `unwind-protect' `sit-for'
	delay and `kill-buffer' after it.
	(display-startup-echo-area-message): Remove call to
	`use-fancy-splash-screens-p' because image.el is preloaded and
	doesn't display "Loading image... done".
	(display-splash-screen): Rename argument `static' to `startup'.
	Fix docstring.

2007-09-04  Dan Nicolaescu  <dann@ics.uci.edu>

	* server.el (server-start, server-unload-hook):
	suspend-tty-functions has been renamed to suspend-tty-hook.

	* xt-mouse.el: Likewise.  resume-tty-functions has been renamed to
	resume-tty-hook.

2007-09-03  Emanuele Giaquinta  <e.giaquinta@glauco.it>  (tiny change)

	* loadup.el: Fix merge problem, only load "button" once.

2007-09-03  Glenn Morris  <rgm@gnu.org>

	* vc-svn.el (vc-svn-print-log): If there is only one file, use
	"Working file:" as the prefix, for the sake of
	log-view-current-file.

2007-09-02  Dan Nicolaescu  <dann@ics.uci.edu>

	* term/xterm.el (xterm-modify-other-keys-terminal-list): New variable.
	(xterm-turn-on-modify-other-keys): Only turn on modify-other-keys
	if the selected frames is in
	xterm-modify-other-keys-terminal-list.
	(xterm-turn-off-modify-other-keys): Add an optional frame
	parameter.  Only turn off modify-other-keys if FRAME is in
	xterm-modify-other-keys-terminal-list.
	(xterm-remove-modify-other-keys): New function.
	(terminal-init-xterm): Use it.  Deal with delete-frame hook.
	Add the selected frame to xterm-modify-other-keys-terminal-list.

2007-09-02  Jan Djärv  <jan.h.d@swipnet.se>

	* term/x-win.el (x-gtk-stock-map): Map diropen to system-file-manager.
	(icon-map-list): New variable.
	(x-gtk-map-stock): Use icon-map-list.

2007-09-02  Romain Francoise  <romain@orebokech.com>

	* log-view.el (log-view-current-file): Balance parens.

2007-09-02  Glenn Morris  <rgm@gnu.org>

	* comint.el (comint-mode): Don't set scroll-conservatively.

	* eshell/em-unix.el (eshell/time): Stringify and flatten the
	non-command arguments.

	* log-view.el (log-view-current-file): Give a more explicit error
	if log-view-file-re fails to find a match.

2007-09-01  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* emacs-lisp/bytecomp.el (byte-recompile-directory):
	Fix bug: Don't expand top-level file name more than once.
	Reported by Dmitry Antipov <dmantipov@yandex.ru>.

2007-09-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* server.el (server-process-filter): Don't display the splash screen.
	It's annoying enough on the initial screen and becomes positively
	obnoxious here.

2007-08-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/avl-tree.el: Use defstruct rather than macros.
	Change naming to use "avl-tree--" for internal functions.

2007-08-31  Dan Nicolaescu  <dann@ics.uci.edu>

	* term/x-win.el (x-menu-bar-open): Delete duplicated function from
	the merge.
	(global-set-key): Delete f10 mapping, now done in menu-bar.el.
	(provide): Move to the end of file.

	* vc-svn.el (vc-svn-diff-tree): Pass a list to vc-svn-diff.

2007-08-31  Michaël Cadilhac  <michael@cadilhac.name>

	* textmodes/flyspell.el (flyspell-mark-duplications-exceptions):
	New variable.  List of exceptions for the duplicated word rule.
	(flyspell-mark-duplications-flag): Mention it.
	(flyspell-word): Treat it.

	* files.el (create-file-buffer): If the filename sans directory starts
	with spaces, remove them.

2007-08-31  Jan Djärv  <jan.h.d@swipnet.se>

	* term/x-win.el (x-gtk-stock-map): Add etc/images to keys.
	(x-gtk-map-stock): Use two directory elements when matching
	file name.

2007-08-31  James Wright  <james@chumsley.org>

	* eshell/em-unix.el (eshell/info): New function.

2007-08-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	* frame.el (frame-initialize, make-frame):
	* server.el (server-process-filter):
	* faces.el (tty-set-up-initial-frame-faces): Don't set
	term-environment-variable since it's not used any more.

	* env.el (setenv): Don't treat $TERM specially.

	* startup.el (normal-top-level): Set $TERM to `dumb' so that unless
	stated otherwise, subprocesses do not send back escape sequences
	corresponding to the terminal from which Emacs was started.

2007-08-31  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* calculator.el: Require cl for compilation.

2007-08-30  Daniel Pfeiffer  <occitan@esperanto.org>

	* outline.el (outline-font-lock-levels): Comment out unused var.
	(outline-font-lock-face): Wrap around face list to handle any
	nesting depth gracefully.

2007-08-30  Michael Albinus  <michael.albinus@gmx.de>

	* net/ange-ftp.el: Add ange-ftp property to `set-file-modes' and
	`set-file-times'.

2007-08-30  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el (org-export-visible): Fix drawers before export.
	(org-do-sort): Allow sorting by priority.
	(org-agenda-files): Ignore non-existing files.
	(org-agenda-skip-unavailable-files): New variable.
	(org-ellipsis): All a face as value.
	(org-mode): Interpret the face value of `org-ellipsis'.
	(org-archive-save-context-info): New option.
	(org-archive-subtree): Store context info in archived entry.
	(org-fast-tag-selection-can-set-todo-state): New variable.
	(org-fast-tag-selection): Allow setting TODO states through this
	interface.
	(org-cycle): Docstring updated.
	(org-todo-keyword-faces): New option.
	(org-get-todo-face): New function.
	(org-set-font-lock-defaults, org-agenda-highlight-todo):
	Use `org-get-todo-face'.
	(org-switch-to-buffer-other-window): New function.
	(org-table-edit-field, org-table-show-reference)
	(org-table-edit-formulas, org-add-log-note)
	(org-fast-tag-selection, org-agenda, org-prepare-agenda)
	(org-timeline): Use `org-switch-to-buffer-other-window' instead of
	`switch-to-buffer-other-window' to make sure that the temporary
	windows show up on the current frame.
	(org-mhe-get-message-real-folder, org-batch-store-agenda-views)
	(org-get-entries-from-diary, org-replace-region-by-html):
	Don't allow pop-up frames.
	(org-agenda-get-deadlines, org-agenda-get-scheduled):
	Fix problems with time-of-day.
	(org-export-get-title-from-subtree): New function.
	(org-agenda-get-scheduled, org-agenda-get-deadlines): Fix problems
	with listing items that are DONE.
	(org-change-tag-in-region): New command.
	(org-agenda-skip-scheduled-if-done)
	(org-agenda-skip-deadline-if-done): Docstring clarified.
	(org-mode): Hide drawers on startup.
	(org-get-todo-face): New function.
	(org-todo-keyword-faces): New option.
	(org-set-regexps-and-options): Use `org-remove-keyword-keys'.
	(org-remove-keyword-keys): New function.

2007-08-30  Jari Aalto  <jari.aalto@cante.net>

	* progmodes/grep.el (grep-find-ignored-directories):
	Add monotone _MTN bookkeeping directory in workspaces.
	Add RCS control directory.  List items in alphabetical order.

	* progmodes/grep.el (grep-files-aliases): Add cc alias.
	Sort items in alphabetical order.  Fix parens.

2007-08-29  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-hg.el (vc-hg-extra-menu-map): New variable.
	(vc-hg-extra-menu, vc-hg-outgoing, vc-hg-incoming, vc-hg-push)
	(vc-hg-pull): New functions.
	(vc-hg-outgoing-mode, vc-hg-incoming-mode): New derived modes.

	* term/mac-win.el: Don't require url, only autoloaded url
	functions are used in this file.

2007-08-29  Andreas Schwab  <schwab@suse.de>

	* shell.el (shell): Return correct value from interactive spec.

2007-08-29  Glenn Morris  <rgm@gnu.org>

	* version.el (emacs-version): Increase to 23.0.50.

2007-08-29  Jan Djärv  <jan.h.d@swipnet.se>

	* term/x-win.el (x-gtk-stock-map): :version changed to 23.1.

2007-08-29  Juri Linkov  <juri@jurta.org>

	* loadup.el: Add "button" loading after "faces" and move "startup"
	to load after "button".

2007-08-29  Dan Nicolaescu  <dann@ics.uci.edu>

	* loadup.el: Load term/mac-win on a Mac using Carbon.

	* term/mac-win.el: Provide mac-win.
	(mac-initialized): New variable.
	(mac-initialize-window-system): New function.  Move global setup here.
	(handle-args-function-alist, frame-creation-function-alist):
	(window-system-initialization-alist): Add mac entries.
	(x-setup-function-keys): New function containing all the
	top level function key definitions.

	* term/x-win.el (x-menu-bar-open): Use accelerate-menu.

	* env.el (read-envvar-name): Don't consider the environment frame param.

	* env.el (setenv):
	* frame.el (frame-initialize, make-frame):
	* faces.el (tty-set-up-initial-frame-faces):
	* server.el (server-process-filter): Set
	display-environment-variable and term-environment-variable.

	* server.el (server-process-filter): Set COLORFGBG and COLORTERM.

2007-08-29  Jason Rumney  <jasonr@gnu.org>

	* loadup.el: Only load term/x-win when X is compiled in.
	Load term/w32-win and dependencies on windows-nt.

	* term/w32-win.el: Reorder to match x-win.el more closely.
	Provide w32-win.  Don't throw error when global window-system not w32.
	(internal-face-interactive): Remove obsolete function.
	(x-setup-function-keys): Use local-function-key-map.
	(w32-initialized): New variable.
	(w32-initialize-window-system): Set it.
	Move more global setup here.
	(x-setup-function-keys): New function.
	(w32-initialize-window-system): Move non function key global setup here.
	(x-cut-buffer-max): Remove.
	(w32-initialize-window-system): New function.
	(handle-args-function-alist, frame-creation-function-alist):
	(window-system-initialization-alist): Add w32 entries.

2007-08-29  David Kastrup  <dak@gnu.org>

	* env.el (getenv): Pass frame to getenv-internal.

2007-08-29  Károly Lőrentey  <lorentey@elte.hu>

	* version.el (emacs-version): Show if multi-tty is present.

	* loadup.el: Delay loading env; mule-conf gets confused by cl
	during bootstrap.  Also load termdev and term/x-win.

	* bindings.el (mode-line-client): New variable.
	(help-echo): Add it to the default mode-line format.

	* cus-start.el: Remove bogus window-system reference from GTK test.

	* progmodes/ebrowse.el (ebrowse-electric-list-mode-map)
	(ebrowse-electric-position-mode-map):
	* ebuff-menu.el (electric-buffer-menu-mode-map):
	* echistory.el (electric-history-map): Bind C-z to `suspend-frame',
	not `suspend-emacs'.

	* ediff-wind.el (ediff-setup-windows-automatic): New function.
	(ediff-window-setup-function): Use it as default.

	* files.el (save-buffers-kill-terminal): New function.
	(ctl-x-map): Change binding of C-x C-c to save-buffers-kill-terminal.

	* font-lock.el (lisp-font-lock-keywords-2): Add `let-environment'
	and `with-selected-frame'.

	* help-fns.el (describe-variable): Describe frame-local variables
	correctly.

	* simple.el (normal-erase-is-backspace-mode): Rewrite for multiple
	display support.
	(normal-erase-is-backspace-setup-frame): New function.

	* subr.el (with-selected-frame): New function.
	(read-quoted-char): Use terminal-local binding of
	local-function-key-map instead of function-key-map.

	* talk.el (talk): New function.
	(talk-handle-delete-frame): New function.
	(talk-add-display): Open a new frame only if FRAME was not a frame.

	* termdev.el: New file.

	* menu-bar.el (menu-bar-open): New function.  Bind it to f10.
	* term/x-win.el: Don't bind f10.
	* tmm.el: Remove autoload binding for f10.

	* international/encoded-kb.el (encoded-kbd-setup-display): Use
	`set-input-meta-mode'.  Fix broken condition before set-input-mode.
	Store the saved input method as a terminal parameter.  Add keymap
	parameter.  Use it instead of changing key-translation-map directly.
	(saved-key-translation-map, encoded-kbd-mode, saved-input-mode):
	Remove.
	(encoded-kbd-setup-display): New function.

	* international/mule-cmds.el (set-locale-environment): Fix getenv
	call.  Use save-buffers-kill-terminal.  Ignore window-system; always
	set the keyboard coding system.  Add DISPLAY parameter.
	(set-display-table-and-terminal-coding-system): Add DISPLAY
	parameter.  Pass it to set-terminal-coding-system.

	* international/mule.el (keyboard-coding-system): Test for
	encoded-kbd-setup-display, not encoded-kbd-mode.
	(set-terminal-coding-system, set-keyboard-coding-system): Add
	DISPLAY parameter.
	(set-keyboard-coding-system): Use encoded-kbd-setup-display.

	* term/README: Update.

	* term/linux.el (terminal-init-linux): Use `set-input-meta-mode'.

	* term/x-win.el (x-setup-function-keys): New function.  Move
	function-key-map tweaks here.  Protect against multiple calls on
	the same terminal.  Use terminal-local binding of
	local-function-key-map instead of function-key-map.
	(x-initialize-window-system): Make a copy of pure list.  Pass a
	frame getenv.

	* term/vt200.el, term/vt201.el, term/vt220.el, term/vt240.el:
	* term/vt300.el, term/vt320.el, term/vt400.el, term/vt420.el:
	* term/AT386.el, term/internal.el, term/iris-ansi.el, term/lk201.el:
	* term/mac-win.el, term/news.el, term/rxvt.el, term/sun.el:
	* term/tvi970.el, term/wyse50.el: Use terminal-local binding of
	local-function-key-map instead of function-key-map.

	* term/rxvt.el, term/xterm.el: Speed up load time by protecting
	`substitute-key-definition' and `define-key' calls against
	multiple execution.  Use terminal-local binding of
	local-function-key-map instead of function-key-map.  Pass a frame
	to getenv.

	* edmacro.el (edmacro-format-keys):
	* emulation/cua-base.el (cua--pre-command-handler):
	* isearch.el (isearch-other-meta-char):
	* xt-mouse.el: Use terminal-local binding of
	local-function-key-map instead of function-key-map.

	* fringe.el (set-fringe-mode): Simplify and fix using
	`modify-all-frames-parameters'.
	* scroll-bar.el (set-scroll-bar-mode): Ditto.
	* tool-bar.el (tool-bar-mode): Ditto.  Remove 'tool-bar-map length
	check before calling `tool-bar-setup'.
	(tool-bar-setup): New variable.
	(tool-bar-setup): Use it to guard against multiple calls.  Add
	optional frame parameter, and select that frame before adding items.
	(toggle-tool-bar-mode-from-frame): New function.

	* menu-bar.el (toggle-menu-bar-mode-from-frame): New function.
	(menu-bar-showhide-menu): Use toggle-menu-bar-mode-from-frame and
	toggle-tool-bar-mode-from-frame to change "Menu-bar" and
	"Tool-bar" toggles to reflect the state of the current frame.
	(menu-bar-mode): Simplify and fix using `modify-all-frames-parameters'.

	* env.el: Require cl for byte compilation (for `block' and `return').
	(environment, setenv-internal): New functions.
	(let-environment): New macro.
	(setenv, getenv): Add optional terminal parameter.  Update docs.
	(setenv): Use setenv-internal.  Always set process-environment.
	Handle `local-environment-variables'.
	(read-envvar-name, setenv, getenv): Use frame parameters
	to store the local environment, not terminal parameters.  Include
	`process-environment' as well.

	* faces.el (tty-run-terminal-initialization): New function.
	(tty-create-frame-with-faces): Use it.  Set up faces and
	background mode only after the terminal has been initialized.
	Call terminal-init-*.  Don't load the initialization file more
	than once.  Call set-locale-environment.
	(frame-set-background-mode): Handle the 'background-mode terminal
	parameter.
	(tty-find-type): New function.
	(x-create-frame-with-faces): Remove bogus check for
	first frame.  Call `tool-bar-setup'.  Don't make frame visible
	until we are done setting up all its parameters.  Call
	x-setup-function-keys.

	* frame.el (make-frame): Always inherit 'environment and 'client
	parameters.  Set up the 'environment frame parameter, when needed.
	Also inherit 'client parameter.  Don't override explicitly
	specified values with inherited ones.  Add 'terminal frame
	parameter.  Append window-system-default-frame-alist to parameters
	before calling frame-creation-function.
	(frame-initialize): Copy the environment from the initial frame.
	(window-system-default-frame-alist): Enhance doc string.
	(frame-notice-user-settings): Don't put 'tool-bar-lines in
	`default-frame-alist' when initial frame is on a tty.
	(modify-all-frames-parameters): Simplify using `assq-delete-all'.
	Remove specified parameters from `window-system-default-frame-alist'.
	(make-frame-on-tty, framep-on-display, suspend-frame):
	Extend doc string, update parameter names.
	(frames-on-display-list): Use terminal-id to get the display id.
	(frame-notice-user-settings): Extend to apply
	settings in `window-system-default-frame-alist' as well.
	(terminal-id, terminal-parameters, terminal-parameter)
	(set-terminal-parameter, terminal-handle-delete-frame): New functions.
	(delete-frame-functions): Add to `delete-frame-functions' hook.
	(blink-cursor-mode): Adapt blink-cursor-mode default
	value from startup.el.
	(make-frame-on-display): Protect condition on x-initialized when
	x-win.el is not loaded.  Update doc.
	(suspend-frame): Use display-controlling-tty-p to decide between
	suspend-emacs and suspend-tty.
	(frames-on-display-list): Update for display ids.
	(framep-on-display): Ditto.
	(suspend-frame): Use display-name, not frame-tty-name.
	(selected-terminal): New function.

	* server.el: Use `device' instead of `display' or `display-id' in
	variable and client parameter names.
	(server-select-display): Remove (unused).
	(server-tty-live-p, server-handle-delete-tty): Remove.
	(server-unquote-arg, server-quote-arg, server-buffer-clients):
	Update docs.
	(server-getenv-from, server-with-environment, server-send-string)
	(server-save-buffers-kill-terminal): New functions.
	(server-delete-client): Handle quits in kill-buffer.  Don't kill
	modified buffers.  Add extra logging.  Delete frames after
	deleting the tty.  Clear 'client parameter before deleting a frame.
	Use delete-display, not delete-tty.
	(server-visit-files): Don't set `server-existing-buffer' if the
	buffer already has other clients.  Return list of buffers
	created.  Update doc.  Don't set client-record when nowait.
	(server-handle-delete-frame): Delete the client if this was its
	last frame.  Check that the frame is alive.  Remove bogus comment.
	Add note on possible race condition.  Delete tty clients, if needed.
	(server-handle-suspend-tty): Use server-send-string.  Kill the
	client in case of errors from process-send-string.  Use the display
	parameter.
	(server-unload-hook): Remove obsolete delete-tty hook.
	(server-start): Ask before restarting if the old server still has
	clients.  Add feedback messages.  Remove obsolete delete-tty hook.
	(server-process-filter): Use server-send-string.  Accept `-dir'
	command.  Switch to *scratch* immediately after creating the frame,
	before evaluating any -evals.  Protect `display-splash-screen'
	call in a condition-case.  Explain why.  Call
	`display-startup-echo-area-message' before
	`display-splash-screen'.  Don't display the splash screen when no
	frame was created.  Show the Emacs splash screen and startup echo
	area message.  Display the *scratch* buffer by default.  Store the
	local environment in a frame (not terminal) parameter.  Do not try
	to decode environment strings.  Fix reference to the 'display
	frame parameter.  Change syntax of environment variables.  Put
	environment into terminal parameters, not client parameters.  Use
	a dummy client with --no-wait's X frames.  In `-position LINE'
	handler, don't ruin the request string until the line number is
	extracted.  Log opened files.  Handle -current-frame command.
	Don't create frames when it is given.  Don't bind X frames to the
	client when we are in -no-wait mode.  Set locale environment
	variables from client while creating tty frames.  Disable call to
	configure-display-for-locale.  When processing -position command,
	don't change the request string until the parameters are
	extracted.  Don't try to create an X frame when Emacs does not
	support it.  Improve logging.  Temporarily set ncurses-related
	environment variables to those of the client while creating a new
	tty frame.  Select buffers opened by nowait clients, don't leave
	them buried under others.  Set the display parameter, and use it
	when appropriate.

	* startup.el (display-startup-echo-area-message): Handle
	`inhibit-startup-echo-area-message' here.
	(command-line-1): Moved from here.
	(fancy-splash-screens): Use `overriding-local-map' instead of
	`overriding-terminal-local-map' for now; the latter doesn't work
	right, it loses keypresses to another terminal.  Use
	`overriding-terminal-local-map' to set up keymap.  Install a
	`delete-frame-functions' hook to catch `delete-frame' events.
	Ignore `select-window' events to cope better with
	`focus-follows-mouse'.  Don't switch back to the original buffer
	if the splash frame has been killed.  Restore previous buffer, even
	if it's *scratch*.
	(normal-splash-screen): Don't let-bind `mode-line-format'; it
	changes the global binding - setq it instead.  Use
	`save-buffers-kill-terminal'.
	(display-splash-screen): Don't do anything if the splash screen is
	already displayed elsewhere.
	(fancy-splash-exit, fancy-splash-delete-frame): New functions.
	(command-line): Replace duplicated code with a call to
	tty-run-terminal-initialization.  Don't load the terminal
	initialization file more than once.  Remove call to nonexistent
	function `set-locale-translation-file-name'.

	* xt-mouse.el (xterm-mouse-x, xterm-mouse-y): Convert to terminal
	parameters.
	(xterm-mouse-position-function, xterm-mouse-event): Update.
	(xterm-mouse-mode): Don't depend on current value of window-system.
	(turn-on-xterm-mouse-tracking, turn-off-xterm-mouse-tracking):
	Update for multi-tty.
	(turn-on-xterm-mouse-tracking-on-terminal)
	(turn-off-xterm-mouse-tracking-on-terminal)
	(xterm-mouse-handle-delete-frame): New functions.
	(delete-frame-functions, after-make-frame-functions)
	(suspend-tty-functions, resume-tty-functions): Install extra hooks
	for multi-tty.

2007-08-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (invisible-p): Remove: implemented in C now.
	(line-move-invisible-p): Remove obsolete alias.

2007-08-28  Juri Linkov  <juri@jurta.org>

	* image-mode.el (image-type): New variable.
	(image-mode): Set default major mode name to "Image[text]".
	(image-minor-mode): Change LIGHTER to display image-type in the
	mode line.
	(image-minor-mode): Set default image-type to "text".
	(image-toggle-display): After switching to text mode, set
	image-type to "text" and major mode name to "Image[text]".
	After switching to image mode, set image-type to actual image
	type, and add image type to major mode name.  Let-bind the same
	variable names as arguments of `image-type' and `create-image'.
	Bind `type' to the result of `image-type' and use it as arg
	of `create-image' to not determine the image type twice.

2007-08-28  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-handle-set-file-times): Flush the file properties.
	(tramp-set-file-uid-gid, tramp-get-local-uid)
	(tramp-get-local-gid): New defuns.
	(tramp-handle-copy-file): Handle new parameter PRESERVE-UID-GID.
	(tramp-do-copy-or-rename-file): New parameter PRESERVE-UID-GID.
	Improve fast track.
	(tramp-do-copy-or-rename-file-directly): Sync parameter list with
	the other tramp-do-copy-or-rename-file-* functions.  Major rewrite.
	(tramp-handle-file-local-copy, tramp-handle-insert-file-contents)
	(tramp-handle-write-region): Improve fast track.
	(tramp-handle-file-remote-p): IDENTIFICATION can also be `localname'.
	(tramp-maybe-open-connection): Let `process-adaptive-read-buffering'
	be nil.

2007-08-28  Ivan Kanis  <apple@kanis.eu>

	* time.el: New feature to display several time zones in a buffer.
	(display-time-world-mode, display-time-world-display)
	(display-time-world, display-time-world-timer): New functions.
	(display-time-world-list, display-time-world-time-format)
	(display-time-world-buffer-name, display-time-world-timer-enable)
	(display-time-world-timer-second, display-time-world-mode-map):
	New variables.

2007-08-28  Jan Djärv  <jan.h.d@swipnet.se>

	* term/x-win.el (x-gtk-stock-map): New variable.
	(x-gtk-map-stock): New function.

	* info.el (info-tool-bar-map): Add :rtl keyword to right/left-arrow and
	prev/next-node.

2007-08-28  Johan Bockgård  <bojohan@dd.chalmers.se>  (tiny change)

	* play/gamegrid.el (gamegrid-init): Set line-spacing to 0.

2007-08-28  Glenn Morris  <rgm@gnu.org>

	* progmodes/cc-langs.el (c-constant-kwds): Add java: null, true, false.

2007-08-27  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* progmodes/modula2.el (m2-definition, m2-module):
	Don't use previous-line.  Reported by T. V. Raman.

2007-08-27  YAMAMOTO Mitsuharu  <mituharu@math.s.chiba-u.ac.jp>

	* term/mac-win.el (mac-handle-toolbar-switch-mode): Add explicit
	argument to tool-bar-mode call.

2007-08-27  Glenn Morris  <rgm@gnu.org>

	* diff-mode.el (diff-find-file-name): Only accept regular files,
	to rule out /dev/null, directories, etc.

	* vc-svn.el (vc-svn-diff): If the repository version of all the
	files is the same as the specified OLDVERS, do a local diff.

2007-08-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* uniquify.el (uniquify-rationalize-file-buffer-names): Check liveness
	of buffers in uniquify-managed.

	* simple.el (invisible-p): Rename from text-invisible-p.
	Update callers.

	* progmodes/cperl-mode.el (defcustom, x-color-defined-p, cperl-is-face)
	(cperl-is-face, cperl-force-face, cperl-etags-snarf-tag, cperl-mode)
	(cperl-etags-snarf-tag, cperl-etags-goto-tag-location, cperl-init-faces)
	(cperl-etags-goto-tag-location): Use new style backquotes.

	* net/browse-url.el: Remove spurious * in custom docstrings.
	(browse-url-filename-alist): Use new-style backquote.

	* emacs-lisp/backquote.el (backquote-unquote-symbol)
	(backquote-splice-symbol): Clarify they're not new-style unquotes.

	* emacs-lisp/edebug.el (edebug-list-form, edebug-match-symbol, \,)
	(\,@): Backslash the , and ,@ which are not new-style unquotes.

	* textmodes/texinfmt.el (\,): Clarify it's not a new-style unquote.

	* net/socks.el (socks-username/password-auth-filter):
	Remove unused vars `state' and `desired-len'.
	(socks-parse-services, socks-nslookup-host): Use with-current-buffer.
	(socks-wait-for-state-change): Use new-style backquotes.

	* pcvs.el (cvs-mode-status): Fix long-standing typo.

	* emacs-lisp/bytecomp.el (byte-compile-from-buffer): Check old-style
	backquotes after each `read' rather than once per buffer.

	* dframe.el: Remove spurious * in custom docstrings.
	(dframe-xemacsp): Remove, use (featurep 'xemacs) instead.
	(dframe-xemacs20p): Remove, inline at the sole use point.
	(defface): Don't defvar the face, don't use old-style backquote.
	(defcustom): Don't use old-style backquote.
	(dframe-frame-parameter, dframe-mouse-event-p):
	Make it obvious that it's always defined.
	(dframe-popup-kludge): New function to replace
	dframe-xemacs-popup-kludge and dframe-xemacs-popup-kludge.
	(dframe-frame-mode, dframe-set-timer-internal)
	(dframe-mouse-set-point): Remove use of with-no-warnings from
	XEmacs-specific code.
	(dframe-set-timer-internal): Fix very old bug with
	post-command-idle-hook.

	* emacs-lisp/byte-opt.el (byte-optimize-featurep): Handle `sxemacs'.

	* emacs-lisp/bytecomp.el (byte-compile-from-buffer): Display a big fat
	warning if the file uses old style backquotes.

	* emacs-lisp/bytecomp.el (byte-compile-log-file)
	(byte-recompile-directory, byte-compile-file)
	(byte-compile-from-buffer): Use with-current-buffer.

	* simple.el (text-invisible-p): Rename from line-move-invisible-p.
	(line-move-invisible-p): Keep as an obsolete alias, just to be safe.
	(line-move-1, line-move-finish, line-move-to-column)
	(move-end-of-line, move-beginning-of-line): Use new name.

	* emacs-lisp/backquote.el (backquote-delay-process): Fix last change.

	* progmodes/ada-mode.el: Fix up comment style in header.
	(ada-check-emacs-version): Remove.
	(ada-mode): Set parse-sexp-* even if they don't exist: can't hurt.
	(ada-region-selected): Use (featurep 'xemacs) rather than contortions
	to try and quieten the byte-compiler.
	(ada-create-keymap): Use [(..)] keys, which work on both (X)Emacs.

	* vc.el (vc-annotate-warp-version): Don't use previous-line.

2007-08-27  Johan Bockgård  <bojohan@dd.chalmers.se>

	* net/browse-url.el (browse-url-emacs): New function.

2007-08-27  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* emacs-lisp/avl-tree.el: New file.

2007-08-26  Michaël Cadilhac  <michael@cadilhac.name>

	* hi-lock.el (hi-lock-unface-buffer): Show a x-menu only if the mouse
	was used.

2007-08-26  Sean O'Rourke  <seano@cs.ucsd.edu>

	* complete.el (PC-do-completion): Make RET accept a non-unique but
	complete expansion again.

2007-08-26  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* eshell/esh-opt.el (eshell-eval-using-options):
	Add debug declaration.

2007-08-26  Dan Nicolaescu  <dann@ics.uci.edu>

	* log-view.el (log-view-toggle-mark-entry): Add docstring.
	(log-view-get-marked): Likewise.

	* vc-hooks.el (vc-registered): Use mapc instead of mapcar.
	(vc-delete-automatic-version-backups): Likewise.

	* vc.el (vc-dired-buffers-for-dir): Likewise.

2007-08-25  Dan Nicolaescu  <dann@ics.uci.edu>

	* progmodes/cperl-mode.el (cperl-indent-level): Autoload the
	safe-local-variable setting.
	* progmodes/perl-mode.el (perl-indent-level): Likewise.

	* log-view.el (log-view-marked-list): Delete variable.
	(log-view-mode): Don't use it.
	(log-view-toggle-mark-entry): Likewise, simplify.
	(log-view-current-tag): Don't return properties.
	(log-view-get-marked): New function.

2007-08-25  Alexandre Julliard  <julliard@winehq.org>

	* vc-git.el (vc-git-mode-line-string): New function.

2007-08-25  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-langs.el (c-other-decl-block-key-in-symbols-alist):
	new language variable.

	* progmodes/cc-engine.el (c-brace-anchor-point): new function.
	(c-add-stmt-syntax): Give accurate anchor points for "namespace",
	"extern" etc., rather than BOI.  Fix addition of spurious
	syntactic-symbol 'defun-block-intro, replacing it with
	'innamespace, etc.

2007-08-25  Juri Linkov  <juri@jurta.org>

	* files.el (auto-mode-alist): Move "\\.x[bp]m\\'" to image-mode.el.

	* image-mode.el: Add autoloads to put associations in auto-mode-alist:
	associate "\\.x[bp]m\\'" with c-mode and image-mode-maybe, and
	"\\.svgz?\\'" with xml-mode and image-mode-maybe.

	* image.el (image-type-header-regexps): Use more complex regexp for svg.
	(image-type-file-name-regexps): Add ("\\.svgz?\\'" . svg).
	(image-type-auto-detectable): Add (svg . maybe).

	* jka-cmpr-hook.el (jka-compr-compression-info-list): Add .svgz
	to treat it like .tgz.

	* calendar/cal-bahai.el: Add file coding cookie.

2007-08-25  Reiner Steib  <Reiner.Steib@gmx.de>

	* pcvs.el (cvs-query-directory): Only prompt when prefix is given.
	Don't behave differently when executed via M-x.  Add doc string.

	* sort.el (sort-fold-case, sort-numeric-base): Mark as
	safe-local-variable.

2007-08-25  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-forms.el (var-TimeZone): Make nil explicitly
	the default value.
	(math-calendar-tzinfo): New variable.
	(math-get-calendar-tzinfo): New function.
	(calcFunc-tzone, calcFunc-dst): Use Emacs's calendar
	to get information when zone is nil.

2007-08-24  Dan Nicolaescu  <dann@ics.uci.edu>

	* log-view.el (log-view-toggle-mark-entry): New function.
	(log-view-mode-map): Bind it.
	(log-view-marked-list): New variable.
	(log-view-mode): Make it local.

2007-08-24  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* play/zone.el (zone-pgm-rat-race): New func.
	(zone-programs): Add `zone-pgm-rat-race'.

2007-08-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/byte-opt.el (byte-optimize-if): Don't presume `clause' is
	a list.

2007-08-24  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* progmodes/hideshow.el (hs-match-data): Delete alias.
	(hs-hide-block-at-point, hs-find-block-beginning)
	(hs-show-block): Use `match-data' directly.

2007-08-24  Martin Rudalics  <rudalics@gmx.at>

	* format.el (format-alist): Fix typo in doc-string.

2007-08-24  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-local-host-p): New defun.
	(tramp-handle-file-local-copy, tramp-handle-write-region):
	Implement fast track when being on the local host.
	(tramp-file-name-handler): Don't set "started" property.  It shall
	be reserved for the "ftp" method.
	(tramp-make-copy-program-file-name): Use `tramp-file-name-real-host'.

	* net/tramp-ftp.el (top): Autoload `tramp-set-connection-property'.
	(tramp-ftp-file-name-handler): Set "started" property.

2007-08-24  Ulrich Mueller  <ulm@gentoo.org>  (tiny change)

	* files.el (backup-buffer-copy): Don't wrap delete in
	condition-case, only try to delete if file exists.

2007-08-24  Glenn Morris  <rgm@gnu.org>

	* files.el (backup-buffer-copy): Revert 2007-08-22 change.

	* startup.el (tutorial-directory): Set with eval-at-startup so it
	gets the right value in an installed Emacs.

2007-08-24  Nikolaj Schumacher  <n_schumacher@web.de>

	* emacs-lisp/eldoc.el (eldoc-highlight-function-argument): New face.
	(eldoc-highlight-function-argument): Use it.

2007-08-23  Masatake YAMATO  <jet@gyve.org>

	* progmodes/cc-fonts.el (gtkdoc-font-lock-doc-comments): Highlight
	name of parameters in document body.

2007-08-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/bytecomp.el (byte-compile-output-docform)
	(byte-compile-output-as-comment): Use with-current-buffer rather than
	a weird set-buffer&prog1 combination.

	* emacs-lisp/byte-opt.el (byte-optimize-if): Move `progn' out of the
	test so as to optimize cases where the `progn's result is constant.

2007-08-23  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* locate.el (locate-get-file-positions):
	Use line-beginning-position and line-end-position.

2007-08-23  John Wiegley  <johnw@newartisans.com>

	* calendar/cal-bahai.el: Added in the diacriticals that were
	missing for many of the month names.

2007-08-22  Jason Rumney  <jasonr@gnu.org>

	* vc-hooks.el (vc-menu-map-filter): Reapply 2007-08-06 bugfix.

2007-08-22  Chong Yidong  <cyd@stupidchicken.com>

	* image-mode.el (image-minor-mode): Use image-mode-text-map.

2007-08-22  Sean O'Rourke  <sorourke@cs.ucsd.edu>

	* dabbrev.el (dabbrev--progress-reporter): New variable.
	(dabbrev--scanning-message): Delete func.
	(dabbrev--find-expansion): Use a progress reporter
	instead of dabbrev--scanning-message.

2007-08-22  Michael Albinus  <michael.albinus@gmx.de>

	* comint.el (comint-exec-1): Raise an error if
	`start-file-process' does not return a process object.

	* shell.el (shell): Prompt for `default-directory' if it is a
	remote file name, and if called with a prefix arg.

2007-08-22  Sam Steingold  <sds@gnu.org>

	* pcvs.el (cvs-vc-command-advice): Fix a typo in code (file->files).

2007-08-22  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org-export-latex.el: New file.

	* textmodes/org-publish.el (org-publish-org-to-latex): New function.

	* textmodes/org.el (org-agenda-skip): Allow a form for
	`org-agenda-skip-function'.
	(org-agenda-redo): Re-use local settings.
	(org-agenda): Store local settings.
	(org-agenda-deadline-faces): New option.
	(org-agenda-deadline-face): New function.
	(org-agenda-get-deadlines, org-agenda-get-scheduled): Also handle
	entries on their due date.
	(org-agenda-get-timestamps): No longer handle the due dates of
	schedules and deadline items.
	(org-insert-link-global, org-open-at-point-global): New commands.
	(org-export-as-ascii): Call `org-cleaned-string-for-export' with a
	:for-ascii parameter.
	(org-skip-comments): Function removed.
	(org-cleaned-string-for-export): Handle special table lines.
	(org-global-properties): New option.
	(org-entry-get-with-inheritance): Check global properties.
	(org-local-properties): New variable.
	(org-set-regexps-and-options): Find the #+PROPERTY line.
	(org-link-types): Change type into variable (was constant).
	(org-make-link-regexps): New function.
	(org-link-re-with-space, org-link-re-with-space2)
	(org-angle-link-re, org-plain-link-re, org-bracket-link-regexp)
	(org-bracket-link-analytic-regexp, org-any-link-re): Creation of
	these regular expressions happens now in the function
	`org-make-link-regexps'.
	(org-store-link): Call the functions in
	`org-store-link-functions'.
	(org-add-link-type): New function.
	(org-store-link-functions): New variable.
	(org-activate-tags): Force matches to be in headlines.
	(org-batch-store-agenda-views): Fix bug with killing agenda buffer.
	(org-columns-display-here): Make sure this works in a narrowed
	buffer by checking for point-min.
	(org-columns-display-here): Make the rest of the line intangible,
	so that point never can be there.
	(org-cleaned-string-for-export): Use `with-current-buffer'.
	(org-replace-region-by-html): Use `with-current-buffer'.
	(org-unfontify-region, org-do-occur, org-columns-display-here)
	(org-columns-remove-overlays, org-columns-quit)
	(org-columns-edit-value, org-columns-next-allowed-value)
	(org-eval-in-calendar, org-agenda-undo, org-no-read-only)
	(org-finalize-agenda, org-remove-subtree-entries-from-agenda)
	(org-agenda-todo, org-agenda-change-all-lines)
	(org-agenda-align-tags, org-agenda-priority)
	(org-agenda-set-tags, org-agenda-toggle-archive-tag)
	(org-agenda-show-new-time, org-cleaned-string-for-export)
	(org-export-grab-title-from-buffer)
	(org-export-as-ascii, org-export-as-html): Use `inhibit-read-only'
	instead of `buffer-read-only'.
	(org-export-as-html): Set `coding-system-for-write'.
	(org-remember-store-without-prompt): New option.
	(org-archive-subtree): Fixed bug with modifying TODO keyword.
	(org-beginning-of-line): Also treat C-a special in items.
	(org-table-convert-refs-to-rc): Fixed problem with column
	reference after "..".
	(org-columns-compute): Don't mark buffer modified because of text
	properties.
	(org-batch-store-agenda-views): Use the variable
	`default-directory', not the function.
	(org-clock-out-if-current): Respect `org-clock-out-when-done'.
	(org-clock-out-when-done): New option.
	(org-html-entities): Added HTML entities for smileys.

2007-08-22  Glenn Morris  <rgm@gnu.org>

	* image.el (create-image): Doc fix.

	* startup.el (tutorial-directory): New constant.
	(fancy-splash-text): Tutorials now in tutorial-directory.
	* tutorial.el (help-with-tutorial): Tutorials now in
	tutorial-directory.

2007-08-22  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (top): Require cl.el, when `copy-tree' is not available
	otherwise.
	(tramp-get-remote-path): New defun.  Replace occurrences of
	`tramp-default-remote-path' by this function.
	(tramp-set-remote-path): Move most of the code to
	`tramp-get-remote-path'.
	(tramp-get-ls-command, tramp-get-remote-id): Don't check for not
	existing directories, this is done already in
	`tramp-get-remote-path'.

2007-08-22  Paul Pogonyshev  <pogonyshev@gmx.net>

	* image-file.el (image-file-name-extensions): Add "svg".
	* image.el (image-type-header-regexps): Add svg entry.

2007-08-22  Glenn Morris  <rgm@gnu.org>

	* files.el (backup-buffer-copy): Check backup directory is
	writable, to avoid infloop deleting old backup.

	* mail/rmail.el (rmail-movemail-variant-p): Call on load to set
	movemail related variables.
	(rmail-insert-inbox-text): Use only rmail-movemail-program, which
	will now be set before this is called.

2007-08-21  Juri Linkov  <juri@jurta.org>

	* delsel.el (delete-selection-pre-hook):
	* emulation/cua-base.el (cua-paste): Use `mouse-region-match'
	instead of checking last-command.

2007-08-21  Juri Linkov  <juri@jurta.org>

	* loadup.el: Preload "button".

2007-08-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/bytecomp.el (byte-compile-interactive-only-functions):
	Add previous-line and next-line.

	* vc-arch.el (vc-arch-extra-menu-map): New var and fun.
	(vc-arch-find-file-not-found-hook): Remove, it's now the default.

	* vc-hooks.el (vc-menu-entry): New var.
	(vc-mode-line-map): Use it so that this menu also uses the extra-menu.
	(menu-bar-tools-menu): Add the VC menu here rather than in menu-bar.el.
	(vc-menu-map): Declare and initialize in one step.
	(vc-menu-map-filter): Move&rename from menu-bar.el:menu-bar-vc-filter.

	* menu-bar.el (vc-menu-map): Don't setup any more.
	Instead, just create the proper spot in the menu.

2007-08-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* smerge-mode.el (smerge-resolve): New arg `safe'.
	(smerge-resolve-all, smerge-batch-resolve): New function.
	(smerge-refine): Make sure `diff' returns the expected result.
	(smerge-parsep-re): New const.
	(smerge-mode): Use it to adjust paragraph-separate.

	* progmodes/perl-mode.el (perl-font-lock-syntactic-keywords):
	Correctly match / regexp matchers as first char on a line when
	fontifying only that line.

	* emacs-lisp/cl-macs.el (cl-transform-lambda): Preserve the match-data.

2007-08-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-bzr.el: Don't fiddle with vc-handled-backend.
	(vc-bzr-registered): Don't redundantly protect against
	file-error.  Actually use the format-specific code.
	(vc-bzr-buffer-nonblank-p): Remove.
	(vc-bzr-status): Change `kindchange' -> `kindchanged'.

2007-08-20  Juri Linkov  <juri@jurta.org>

	* startup.el (fancy-splash-text): Change multiple tabs into one
	tab.  Remove "Useful File menu items" section (with "Exit Emacs"
	and "Recover Crashed Session").
	(fancy-splash-screens): Set tab-width to 22.
	(normal-splash-screen): Replace literal tabs with \t and
	fix whitespace.  Remove "Useful File menu items" section (with
	"Exit Emacs" and "Recover Crashed Session").

2007-08-20  Johannes Weiner  <hannes@saeurebad.de>  (tiny change)

	* emacs-lisp/lisp-mode.el (preceding-sexp): New fun, the code was
	extracted from `eval-last-sexp-1'.
	(eval-last-sexp-1): Call `preceding-sexp'.

2007-08-20  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* vc-rcs.el (vc-rcs-annotate-command):
	Fix bug introduced 2007-07-18 (revision 1.51):
	Add back :vc-annotate-prefix propertization.

2007-08-20  Andreas Schwab  <schwab@suse.de>

	* mail/rmail.el (rmail-autodetect): Doc fix.

2007-08-19  Juri Linkov  <juri@jurta.org>

	* startup.el (normal-splash-screen): Add more links.

2007-08-19  Juri Linkov  <juri@jurta.org>

	* startup.el (splash-screen-keymap): Rename from `fancy-splash-keymap'
	because it's common to both types of splash screen: fancy and normal.
	Bind SPC to scroll-up, DEL to scroll-down and `q' to exit-splash-screen.
	(exit-splash-screen): Rename from `fancy-splash-quit'.
	Use `quit-window' instead of `kill-buffer'.
	(fancy-splash-head): Use make-button to insert GNU image link.
	(fancy-splash-screens, normal-splash-screen): Rename " About GNU
	Emacs" to "*About GNU Emacs*", and " GNU Emacs" to "*GNU Emacs*".
	(normal-splash-screen): Put "Browse manuals" on the same line with
	"Emacs manual".  Remove descriptions from "Useful tasks" and put
	all links in two columns on two lines.

2007-08-19  Michael Kifer  <kifer@cs.stonybrook.edu>

	* emulation/viper.el (viper-remove-hooks): Remove some additional
	viper hooks when the user calls viper-go-away.
	(viper-go-away): Restore the default of default-major-mode.
	Save the value of default-major-mode before viperization.

	* emulation/viper-cmd.el: Replace error "" with "Viper bell".

	* emulation/viper-ex.el: Replace error "" with "Viper bell".

	* ediff-util.el (ediff-make-temp-file): Use the coding system of the
	buffer for which file is created.

2007-08-19  Glenn Morris  <rgm@gnu.org>

	* Makefile.in (custom-deps, finder-data, autoloads, recompile)
	(progmodes/cc-mode.elc, mh-e/mh-loaddefs.el): Use $(emacs) rather
	than $(EMACS), so that EMACSLOADPATH is set.  Prevents any system
	shadow files messing up the compilation.

2007-08-18  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/eldoc.el (eldoc-get-fnsym-args-string): Add doc
	string.  Also apply eldoc-argument-case in the help-split-fundoc
	case.  Adapt for changed behavior of eldoc-function-argstring,
	eldoc-function-argstring-format, and
	eldoc-highlight-function-argument.
	(eldoc-highlight-function-argument): Handle nil INDEX argument,
	just call eldoc-docstring-format-sym-doc in that case.
	(eldoc-function-argstring): Change the behavior.  Now it converts
	an argument list to a string.
	(eldoc-function-argstring-format): Change the behavior.  Now it
	applies `eldoc-argument-case' to a string.

	* progmodes/scheme.el (scheme-mode-variables): Set
	font-lock-comment-start-skip.

2007-08-18  Martin Rudalics  <rudalics@gmx.at>

	* progmodes/ada-mode.el (ada-create-syntax-table): Move
	set-syntax-table from here to ...
	(ada-mode): ... here.  Do not change global value of
	comment-multi-line.  Call new function
	ada-initialize-syntax-table-properties and add new function
	ada-handle-syntax-table-properties to font-lock-mode-hook.
	(ada-deactivate-properties, ada-initialize-properties): Replace
	by new functions ...
	(ada-handle-syntax-table-properties)
	(ada-initialize-syntax-table-properties)
	(ada-set-syntax-table-properties): ... to set up syntax-table
	properties uniformly, independently from whether font-lock-mode
	is enabled or not.  Handle read-only buffers and do not change
	undo-list when setting syntax-table properties.
	(ada-after-change-function): Use ada-set-syntax-table-properties.

2007-08-18  Michaël Cadilhac  <michael@cadilhac.name>

	* progmodes/meta-mode.el (meta-indent-calculate-last): Remove.
	(meta-indent-current-nesting): Use a computation of the nesting
	instead.
	(meta-indent-current-indentation): Indentation is given according
	to nesting and if the previous line was finished or not.
	(meta-indent-unfinished-line): Tell if the current line ends with
	a finished expression.
	(meta-indent-looking-at-code): Like `looking-at', but checks if
	the point is in a string before.
	(meta-indent-level-count): Use it.  Don't count parenthesis as it's
	done in the nesting function.
	(meta-indent-in-string-p): Tell if the current point is in a
	string.
	(meta-indent-calculate): Treat b-o-b as a special case.  Use the
	previous functions.

2007-08-17  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* emacs-lisp/copyright.el (copyright-limit): New defsubst.
	(copyright-update-year, copyright-update)
	(copyright-fix-years): Use it.

2007-08-17  Kimit Yada  <kimitto@gmail.com>  (tiny change)

	* emacs-lisp/copyright.el (copyright-update-year):
	Fix bug: Handle nil copyright-limit.

2007-08-17  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-units.el (math-standard-units): Give exact
	conversion for tsp.

	* calc/calc.el (math-bignum-digit-length): Compute the
	appropriate value.

	* calc/calc-bin.el (math-bignum-logb-digit-size)
	(math-bignum-digit-power-of-two):
	* calc/calc-comb.el (math-small-factorial-table):
	* calc/calc-ext.el (math-approx-pi, math-approx-sqrt-e)
	(math-approx-gamma-const):
	* calc/calc-funcs.el (math-besJ0, math-besJ1, math-besY0)
	(math-besY1, math-bernoulli-b-cache):
	* calc/calc-math.el (math-approx-ln-10, math-approx-ln-2):
	Remove `eval-when-compile's.

2007-08-17  Bob Rogers  <rogers-emacs@rgrjr.dyndns.org>  (tiny change)

	* progmodes/cperl-mode.el (cperl-look-at-leading-count)
	(cperl-find-pods-heres): Fix an error when typing expressions like
	`s{a}{b}'.

2007-08-17  Michaël Cadilhac  <michael@cadilhac.name>

	* mail/emacsbug.el (report-emacs-bug): Remove the last number of
	`emacs-version', use the topic prefix ``version; ''.  Make MS-DOS
	a special case (there's no build number).

2007-08-17  T. V. Raman  <raman@users.sf.net>  (tiny change)

	* completion.el (symbol-under-point, symbol-before-point)
	(symbol-before-point-for-complete): Use buffer-substring-no-properties.

2007-08-17  Glenn Morris  <rgm@gnu.org>

	* progmodes/compile.el (compilation-get-file-structure): Make use
	of the directory part when checking for an existing entry, to
	handle files with same basename in different directories.

2007-08-17  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc.el (calc-language-alist): Add texinfo-mode.

2007-08-16  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el (ps-header-font-size, ps-header-title-font-size)
	(ps-footer-font-size, ps-line-number-font-size, ps-line-spacing)
	(ps-paragraph-spacing): Docstring fix.

2007-08-16  Glenn Morris  <rgm@gnu.org>

	* ps-print.el (ps-font-size): Doc fix.

2007-08-16  Richard Stallman  <rms@gnu.org>

	* emacs-lisp/copyright.el (copyright-names-regexp): Add custom group.

2007-08-15  Juri Linkov  <juri@jurta.org>

	* startup.el (initialization): Change parent group from `internal'
	to `environment'.
	(initial-buffer-choice): New variable.
	(command-line): Revert 2007-07-02 change that sets
	buffer-offer-save in *scratch* and enables auto-save in it.
	(fancy-splash-text): Add links to existing items.  Add new items
	with links for useful tasks.  Move information about Control-g to
	fancy-splash-head.  Move "Emacs Guided Tour" to the end.
	(fancy-splash-keymap): New variable.
	(fancy-splash-last-input-event): Remove variable.
	(fancy-splash-insert): Add processing of `:link' element.
	(fancy-splash-head): Replace "Type Control-l to begin editing"
	with "Type `q' to exit".
	(fancy-splash-screens-1): Let-bind inhibit-read-only to t.
	(fancy-splash-default-action, fancy-splash-special-event-action):
	Remove functions.
	(fancy-splash-quit): New function.
	(fancy-splash-screens): Rename input arg from `hide-on-input' to
	`static' and reverse the condition of its usage.  Don't preserve
	original values of `minor-mode-map-alist',
	`emulation-mode-map-alists', `special-event-map'.
	Rename startup-buffer from "*About GNU Emacs*" to " GNU Emacs".
	Rename about-buffer from " GNU Emacs" to " About GNU Emacs".
	Remove processing of special events.  Use local key map
	`fancy-splash-keymap'.  Set buffer to read-only.
	(normal-splash-screen): Rename input arg from `hide-on-input' to
	`static' and reverse the condition of its usage.
	Rename startup-buffer from "*About GNU Emacs*" to " GNU Emacs".
	Rename about-buffer from " GNU Emacs" to " About GNU Emacs".
	Add links to existing items.  Add new items with links for useful
	tasks.  Use local key map `fancy-splash-keymap'.
	(display-splash-screen): Rename input arg from `hide-on-input' to
	`static'.
	(about-emacs): Add alias to display-splash-screen.
	(command-line-1): Use `initial-buffer-choice'.

	* menu-bar.el (menu-bar-help-menu):
	* term/mac-win.el (mac-apple-event-map): Bind About Emacs menu
	item to about-emacs instead of display-splash-screen.

2007-08-15  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-units.el (math-standard-units): Update values.
	Put in exact, rational values when possible.
	(math-unit-prefixes): Replace floats with powers of ten.
	(math-standard-units-systems): Replace floats with integers.
	(math-make-unit-string): Remove extra spaces in output.

2007-08-15  Glenn Morris  <rgm@gnu.org>

	* mail/undigest.el (rmail-digest-parse-rfc1153sloppy): Be even
	sloppier, for the sake of GNU Mailman.
	(rmail-digest-rfc1153): Initialize `result' correctly.

2007-08-15  Michaël Cadilhac  <michael@cadilhac.name>

	* mail/emacsbug.el (report-emacs-bug): Put `Bug: emacs-version; '
	in the mail title.  Suggested by Reiner Steib.

2007-08-14  Chris Hecker  <checker@d6.com>  (tiny change)

	* calc/calc-aent.el (calc-do-quick-calc): Add binary
	representation of integers to the list of outputs.

2007-08-14  Glenn Morris  <rgm@gnu.org>

	* simple.el (bad-packages-alist): New constant.
	(bad-package-check): New function.  Together, these two add elements
	to `after-load-alist' to check for problematic external packages.
	* emulation/cua-base.el: Move CUA-mode check to `bad-packages-alist'.

2007-08-14  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-units.el (math-get-standard-units)
	(math-get-units, math-make-unit-string)
	(math-get-default-units, math-put-default-units): New functions.
	(math-default-units-table): New variable.
	(calc-convert-units, calc-convert-temperature): Add machinery
	to supply default values.

2007-08-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emulation/tpu-edt.el: Add tpu-extras's autoloads.
	(tpu-gold-map, tpu-global-map): Comment-out the bindings to nil.
	(tpu-gold-map): Bind F to tpu-cursor-free-mode.
	(minibuffer-local-map): Use funkey symbols rather than esc-sequence.

	* emulation/tpu-extras.el: Remove spurious * in docstrings.
	Put its autoloads into tpu-edt.el rather than loaddefs.el.
	(tpu-cursor-free-mode): Rename from tpu-cursor-free.
	Make into a proper minor-mode.
	(tpu-backward-char, tpu-next-line, tpu-previous-line)
	(tpu-next-end-of-line, tpu-current-end-of-line): Use new name.
	(tpu-trim-line-ends-if-needed): Rename from tpu-before-save-hook.
	(tpu-set-cursor-free, tpu-set-cursor-bound):
	Delegate to tpu-cursor-free-mode.
	(tpu-next-line, tpu-previous-line, tpu-forward-line)
	(tpu-backward-line, tpu-scroll-window-down, tpu-scroll-window-up):
	Use line-move or forward-line instead of next-line-internal.

2007-08-13  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gdb-ui.el (gdb-send): Handle CTRL-D more carefully.

2007-08-12  Richard Stallman  <rms@gnu.org>

	* pcvs.el (cvs-reread-cvsrc, cvs-checkout, cvs-mode-checkout)
	(cvs-execute-single-file): Use new name split-string-and-unquote.
	(cvs-header-msg): Use new name combine-and-quote-strings.

	* emulation/vi.el (vi-next-line): Ignore return value of line-move.

	* progmodes/gud.el (gud-common-init): Use new name
	split-string-and-unquote.

	* progmodes/flymake.el (flymake-err-line-patterns): Fix infloop
	in javac regexp.

	* pcvs-util.el (cvs-qtypedesc-strings): Use new names
	combine-and-quote-strings and split-string-and-unquote.

	* subr.el (combine-and-quote-strings): Rename from strings->string.
	(split-string-and-unquote): Rename from string->strings.

2007-08-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* log-view.el (log-view-font-lock-keywords): Use `eval' so as to adapt
	to buffer-local settings.

	* emacs-lisp/backquote.el (backquote-delay-process): New function.
	(backquote-process): Add internal arg `level'.  Use the two to
	correctly handle nested backquotes.

2007-08-09  Riccardo Murri  <riccardo.murri@gmail.com>

	* vc-bzr.el (vc-bzr-registered): Use \0 instead of literal NULs.
	(vc-bzr-state-words): Add "kind changed" state word.
	(vc-bzr-status): New function.  Return Bzr idea of file status,
	which is different from VC's.
	(vc-bzr-state): Use vc-bzr-status.
	(vc-workfile-unchanged-p): Use vc-bzr-status.
	(vc-bzr-revert): Use synchronous process; expect exitcode 0.
	(vc-dired-state): Process "kind changed" state word.

2007-08-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-hooks.el (vc-default-find-file-not-found-hook): Do nothing.

	* vc-rcs.el (vc-rcs-find-file-not-found-hook):
	Move from vc-default-find-file-not-found-hook.

2007-08-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* man.el: Remove spurious * in docstrings.
	Merge defvars and toplevel setq-defaults.
	(Man-highlight-references0): Limit=nil rather than point-max.
	(Man-mode-map): Move initialization into the declaration.
	(Man-strip-page-headers, Man-unindent): Use dolist & inhibit-read-only.
	(Man-view-header-file): Use expand-file-name rather than concat.
	(Man-notify-when-ready, Man-bgproc-sentinel): Use with-current-buffer.

	* man.el (Man-next-section): Make sure we do not move backward.

2007-08-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* files.el (auto-mode-alist): Use the purecopied text (duh!).

2007-08-08  Glenn Morris  <rgm@gnu.org>

	* Replace `iff' in doc-strings and comments.

2007-08-08  Martin Rudalics  <rudalics@gmx.at>

	* dired.el (dired-pop-to-buffer):
	* mouse-drag.el (mouse-drag-should-do-col-scrolling):
	* calendar/calendar.el (generate-calendar-window):
	* progmodes/compile.el (compilation-set-window-height):
	* textmodes/two-column.el (2C-two-columns, 2C-merge):
	Use window-full-width-p instead of comparing frame-width and
	window-width.

	* progmodes/compile.el (compilation-find-buffer): Remove extra
	argument in call to compilation-buffer-internal-p.

2007-08-07  Tom Tromey  <tromey@redhat.com>

	* progmodes/tcl.el (tcl-indent-level, tcl-continued-indent-level):
	Add safe-local-variable property.

2007-08-07  Chong Yidong  <cyd@stupidchicken.com>

	* image-mode.el (image-toggle-display): Use image-refresh.

2007-08-07  Riccardo Murri  <riccardo.murri@gmail.com>

	* vc-bzr.el: Remove comments about vc-bzr.el being a modified
	unofficial version.
	(vc-bzr-command): Remove redundant setting of process-connection-type.
	(vc-bzr-admin-checkout-format-file): Add autoload.
	(vc-bzr-root-dir): Remove in favor of vc-bzr-root.
	(vc-bzr-root): Switch to implementation of vc-bzr-root-dir.
	(vc-bzr-registered): Compare dirstate format tag with known good
	value, abort parsing if match fails.  Warn user in docstring.
	(vc-bzr-workfile-version): Case for different Bzr branch formats.
	See bzrlib/branch.py in Bzr sources.
	(vc-bzr-diff): First argument FILES may be a string rather than a list.
	(vc-bzr-shell-command): Remove in favor of
	vc-bzr-command-discarding-stderr.
	(vc-bzr-command-discarding-stderr): New function.

2007-08-06  Riccardo Murri  <riccardo.murri@gmail.com>

	* vc-bzr.el (vc-bzr-registered): Gracefully handle missing "bzr"
	program, and return nil.
	(vc-bzr-state): Gracefully handle missing "bzr" program, and return nil.
	(vc-bzr-state): Look for path names relative to the repository
	root after status keyword.
	(vc-bzr-file-name-relative): New function.
	(vc-bzr-admin-dirname): Reinstate, as other vc-bzr-admin-... paths
	depend on it.
	(vc-bzr-admin-dirname, ...-checkout-format-file)
	(...-branch-format-file, ...-revhistory): Paths to some Bzr internal
	files that we now parse directly for speed.
	(vc-bzr-root-dir): Use `vc-bzr-admin-checkout-format-file' as witness.
	(vc-bzr-registered): Only parse vc-bzr-admin-dirstate file if it exists.
	(vc-bzr-state): "bzr status" successful only if exitcode is 0.
	(vc-bzr-root): Use `vc-bzr-shell-command'.  Stderr may contain
	Bzr warnings, so we must discard it.
	(vc-bzr-workfile-version): Speedup counting lines from
	`vc-bzr-admin-revhistory' file, but fallback to spawning "bzr revno"
	if that file doesn't exist.
	(vc-bzr-responsible-p): Use `vc-bzr-root' instead of
	`vc-bzr-root-dir' for speed.  Add `vc-bzr-admin-dirname' (not ".bzr"!)
	to `vc-directory-exclusion-list'.
	(vc-bzr-shell-command): New function.

2007-08-06  Tom Tromey  <tromey@redhat.com>

	* diff-mode.el (diff-unified->context, diff-reverse-direction)
	(diff-fixup-modifs): Typo in docstring.

2007-08-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emulation/tpu-edt.el (tpu-current-line): Use posn-at-point and
	count-screen-lines.
	(tpu-edt-off): Disable relevant pieces of advice.

	* emulation/tpu-extras.el (tpu-before-save-hook): Rename from
	tpu-write-file-hook.  Activate it with add-hook on buffer-save-hook.
	(newline, newline-and-indent, do-auto-fill): Use advice instead of
	redefining the function.
	(tpu-set-scroll-margins): Activate the pieces of advice.

2007-08-06  Martin Rudalics  <rudalics@gmx.at>

	* help.el (resize-temp-buffer-window): Use window-full-width-p
	instead of comparing frame-width and window-width.

2007-08-13  Stephen Leake  <stephen_leake@stephe-leake.org>

	* pcvs-parse.el (cvs-parse-table): Handle additional instance of
	optional quotes around files in NEED-UPDATE . REMOVED case.

	* progmodes/ada-xref.el (ada-gnatls-args): Fix docstring.
	(ada-treat-cmd-string): Improve error message.
	(ada-do-file-completion): Call `ada-require-project-file', so
	project variables are set properly.
	(ada-prj-find-prj-file): Delete Emacs 20.2 support.
	(ada-gnatfind-buffer-name): New constant.
	(ada-find-any-references): Use new constant.  Set buffer name
	properly in compilation-start.  Toggle read-only properly.
	(ada-find-in-src-path): Fix spelling error in docstring.

	* progmodes/vhdl-mode.el (vhdl-update-progress-info): Avoid divide
	by zero error.

2007-08-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/autoload.el (autoload-print-form): Use print-quoted.

2007-08-12  Richard Stallman  <rms@gnu.org>

	* progmodes/sh-script.el (sh): Delete group `unix'.

	* progmodes/gud.el (gud): Change to group `processes'.

2007-08-11  Glenn Morris  <rgm@gnu.org>

	* progmodes/compile.el (compilation-buffer-name): Don't check
	compilation-arguments.  It is superfluous, and the variable isn't
	even set when this function is called.

2007-08-10  YAMAMOTO Mitsuharu  <mituharu@math.s.chiba-u.ac.jp>

	* term/mac-win.el (mac-ae-reopen-application): New function.
	(mac-apple-event-map): Bind "reopen application" Apple event to it.

2007-08-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/tex-mode.el (tex-font-lock-unfontify-region): Fix to
	take tex-font-script-display into account.
	(tex-font-script-display, tex-font-lock-suscript): Change from a cons
	cell to a list of 2 elements to simplify the unfontify code.

2007-08-08  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el (ps-default-fg, ps-default-bg): Docstring fix.
	(ps-begin-job): Use ps-default-fg and ps-default-bg only when
	ps-print-color-p is neither nil nor black-white.  Reported by Christian
	Schlauer <cs-muelleimer-rubbish.bin@arcor.de>.

2007-08-08  Andreas Schwab  <schwab@suse.de>

	* mail/mailabbrev.el (sendmail-pre-abbrev-expand-hook): Check for
	self-insert-command, not self-insert.

2007-08-08  Glenn Morris  <rgm@gnu.org>

	* emacs-lisp/eldoc.el (eldoc-get-fnsym-args-string): Make second
	argument optional, for backwards compatibility, and only highlight
	args when present.  Fix symbol name typo (doc/args).

	* help-mode.el (help-make-xrefs): Search for symbol constituents,
	rather than just `-'.

2007-08-07  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-units.el (calc-convert-temperature):
	Use `/' to create fractions.

2007-08-07  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-wrong-passwd-regexp): Make the regexp more
	global matching.
	(tramp-handle-shell-command): Handle OUTPUT-BUFFER and
	ERROR-BUFFER more robust.  Display output.
	(tramp-file-name-handler): Add a connection property when we found
	a foreign file name handler.  This allows backends like ftp to
	profit also from usr/host name completion based on connection
	cache.
	(tramp-send-command-and-read): Search for trash after the regexp
	until eol only.  In XEmacs, there is a problem with \n.

	* net/tramp-cache.el (top): Read persistent connection history
	when cache is empty.

2007-08-07  Nic Ferrier  <nferrier@tapsellferrier.co.uk>  (tiny change)

	* net/tramp.el (tramp-handle-process-file): Fix bug inserting
	resulting output.

2007-08-07  Sam Steingold  <sds@gnu.org>

	* progmodes/compile.el (compilation-start): Pass nil as startfile
	to comint-exec.

2007-08-07  Chong Yidong  <cyd@stupidchicken.com>

	* longlines.el (longlines-decoded): New variable.
	(longlines-mode): Avoid encoding or decoding the buffer twice.

2007-08-07  Martin Rudalics  <rudalics@gmx.at>

	* format.el (format-insert-file): Make sure that at most one undo
	entry is recorded for the insertion.  Inhibit point-motion and
	modification hooks around call to insert-file-contents.

2007-08-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc.el (vc-annotate): Select temp-buffer before running vc-exec-after.
	Select the buffer's window before moving point.

2007-08-07  Richard Stallman  <rms@gnu.org>

	* term.el (term): Remove parent group `unix'.

	* simple.el (default-indent-new-line): New function.
	It calls comment-line-break-function if there are comments.
	(do-auto-fill): Use that.

2007-08-07  Sean O'Rourke  <sorourke@cs.ucsd.edu>

	* complete.el (PC-lisp-complete-symbol): Complete symbol around point.
	(PC-do-completion): Add "acronym completion" for symbols and
	filenames, so e.g. "mvbl" expands to "make-variable-buffer-local".

2007-08-06  Sam Steingold  <sds@gnu.org>

	* mouse.el (mouse-buffer-menu): Pass mode-name through
	format-mode-line because it may be a list,
	e.g., (sgml-xml-mode "XML" "SGML"), and not a string.

2007-08-06  Vinicius Jose Latorre  <viniciusig@ig.com.br>

	* printing.el (pr-update-menus): Docstring fix.

2007-08-06  Jason Rumney  <jasonr@gnu.org>

	* menu-bar.el (menu-bar-vc-filter): Use vc-call-backend.

	* vc-hooks.el (vc-call): Add doc string.

2007-08-06  Michael Albinus  <michael.albinus@gmx.de>

	* net/ange-ftp.el (ange-ftp-hook-function): Catch also errors in
	process-filter.

2007-08-06  Kenichi Handa  <handa@m17n.org>

	* international/quail.el: Wrap (require 'help-mode) by
	eval-when-compile.
	(quail-help-init): New function.
	(quail-help): Call quail-help-init.
	(quail-store-decode-map-key): Change it to a function.

2007-08-05  Jason Rumney  <jasonr@gnu.org>

	* vc.el (vc-rollback): Add norevert argument back.
	(vc-revert-buffer): Add back as obsolete alias.

2007-08-05  Peter Povinec  <ppovinec@yahoo.com>  (tiny change)

	* term.el: Honor term-default-fg-color and term-default-bg-color
	settings when modifying term-current-face.
	(term-default-fg-color, term-default-bg-color): Initialize from
	default term-current-face.
	(term-mode, term-reset-terminal): Set term-current-face with
	term-default-fg-color and term-default-bg-color.
	(term-handle-colors-array): term-current-face has term-default-fg-color
	and term-default-bg-color after reset escape sequence.
	(term-handle-colors-array): Set term-current-color with
	term-default-fg/bg-color instead of ansi-term-color-vector when the
	index (term-ansi-current-color or term-ansi-current-bg-color) is zero.

2007-08-05  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-nlfit.el (math-nlfit-curve): Remove unnecessary variables.
	(math-nlfit-givens): Let bind free variables.

2007-08-05  Vinicius Jose Latorre  <viniciusig@ig.com.br>

	* printing.el: Require lpr and ps-print when loading printing package.
	Reported by Glenn Morris <rgm@gnu.org>.

2007-08-05  Michael Albinus  <michael.albinus@gmx.de>

	* files.el (set-auto-mode): Handle also remote files wrt
	`auto-mode-alist'.

2007-08-04  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calcalg3.el (calc-curve-fit): Add support for nonlinear
	curves and plotting.

	* calc/calc-nlfit.el: New file.

2007-08-04  Glenn Morris  <rgm@gnu.org>

	* autorevert.el (auto-revert-tail-mode): auto-revert-tail-pos is
	zero, not nil, when the library is first loaded.  Check for a file
	that has been modified on disk.

	* progmodes/cperl-mode.el (cperl-compilation-error-regexp-alist):
	Remove duplicate defvar preventing initialization.
	(cperl-mode): Fix compilation-error-regexp-alist-alist setting.

2007-08-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* diff-mode.el (diff-font-lock-keywords): Fix up false positives.
	(diff-beginning-of-file): Adjust to the fact that diff-file-header-re
	may match up to 4 lines.
	(diff-beginning-of-file-and-junk): Rewrite.

2007-08-03  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* printing.el: Evaluate require only during compilation.
	(pr-version): New version 6.9.1.
	(deactivate-mark): Replace (defvar VAR nil) by (defvar VAR).
	(pr-global-menubar): Fix code.

2007-08-03  Dan Nicolaescu  <dann@ics.uci.edu>

	* term.el (term-erase-in-display): Fix case when point is not at
	the beginning of the line.

2007-08-03  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-ext.el (math-get-value, math-get-sdev)
	(math-contains-sdev): New functions.

	* calc/calc-graph.el (calc-graph-format-data)
	(calc-graph-add-curve): Check for error forms.
	(calc-graph-set-styles): Add option for error forms.

2007-08-03  Miles Bader  <miles@gnu.org>

	* vc-hooks.el (vc-handled-backends): Change capitalization of VC
	backend names for new backends to `Git', `Hg', and `Bzr'.
	* vc-hg.el (vc-hg-dired-state-info): Use `Hg' as VC backend name,
	not `HG'.
	* vc-git.el (vc-git-dired-state-info): Use `Git' as VC backend
	name, not `GIT'.
	* vc-bzr.el (vc-bzr-dir-state, vc-bzr-dired-state-info)
	(vc-bzr-unload-hook): Use `Bzr' as VC backend name, not `BZR'.

2007-08-03  Richard Stallman  <rms@gnu.org>

	* mail/rmailsum.el (rmail-make-summary-line): Find end of msg number
	to update deleted flag.

	* cus-edit.el (customize-apropos, customize-apropos-options)
	(customize-apropos-faces, customize-apropos-groups): Improve prompt.

	* menu-bar.el (menu-bar-help-menu): Add "About GNU" menu item.

	* startup.el (fancy-splash-head, startup-echo-area-message):
	Change message text.

	* emulation/tpu-edt.el (next-line-internal): Setting deleted.
	All callers use line-move.

	* progmodes/compile.el (compilation-find-buffer): Return current
	buffer immediately if suitable.
	(compile, compilation-buffer-name, compilation-start): Doc fixes.

2007-08-03  Daiki Ueno  <ueno@unixuser.org>

	* faces.el (face-normalize-spec): New function.
	(frame-set-background-mode): Normalize face-spec before calling
	face-spec-match-p.

2007-08-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* server.el (server-window): Add switch-to-buffer-other-frame option.

2007-08-03  Glenn Morris  <rgm@gnu.org>

	* cus-edit.el (customize-apropos): Make the error message indicate
	what kind of thing the user was trying to customize.

	* net/telnet.el (telnet-mode): Set comint-use-prompt-regexp to t.

	* progmodes/fortran.el (fortran-font-lock-syntactic-keywords):
	Fix off-by-one error in previous change.

2007-08-03  Drew Adams  <drew.adams@oracle.com>

	* emacs-lisp/pp.el (pp-eval-expression): Add progress message.
	Make buffer writable.

2007-08-01  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-math.el (math-sqrt-raw, math-sin-raw-2)
	(math-cos-raw-2, math-arctan-raw, math-ln-raw):
	Use native Emacs functions, when appropriate.

2007-08-01  Dan Nicolaescu  <dann@ics.uci.edu>
            Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc.el: Document new VC operation `extra-menu'.

	* vc-hooks.el (vc-default-extra-menu): New function.

	* menu-bar.el (menu-bar-vc-filter): New function.
	(menu-bar-tools-menu): Use it as a filter.

2007-08-01  Eric Hanchrow  <offby1@blarg.net>

	* ibuf-ext.el (ibuffer-mark-old-buffers): Docstring fix.

2007-08-01  Glenn Morris  <rgm@gnu.org>

	* progmodes/fortran.el: Remove leading `*' from all defcustom doc
	strings.
	(fortran-tab-mode-default): Remove needless autoload.
	(fortran-tab-mode-string): Add help-echo and mouse properties, and
	mark as risky.
	(fortran-line-length): New buffer-local variable, safe if integer.
	(fortran-if-start-re, fortran-end-prog-re1, fortran-end-prog-re):
	Change from variables to constants.
	(fortran-font-lock-syntactic-keywords): Delete as a variable,
	replace with a new function definition.
	(fortran-mode): Use fortran-line-length, and
	fortran-font-lock-syntactic-keywords as a function.  Add a
	hack-local-variables-hook function.
	(fortran-line-length, fortran-hack-local-variables): New functions.
	(fortran-window-create, fortran-strip-sequence-nos): Doc fix.
	Use fortran-line-length rather than 72.
	(fortran-window-create-momentarily): Doc fix.

2007-07-31  Drew Adams  <drew.adams@oracle.com>  (tiny change)

	* cus-edit.el (custom-group-value-create, custom-goto-parent):
	Fix parent groups link.

2007-07-31  Paul Pogonyshev  <pogonyshev@gmx.net>

	* progmodes/python.el (python-current-defun): Adjust to never fall
	into infinite loop.

2007-07-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcvs.el (cvs-vc-command-advice): Handle the new fileset case.

2007-07-29  Kimit Yada  <kimitto@gmail.com>  (tiny change)

	* emacs-lisp/copyright.el (copyright-update-year, copyright-update)
	(copyright-fix-years, copyright): Correctly handle the case where
	copyright-limit is nil.

2007-07-28  Konstantin Novitsky  <knovitsk@Bear.com>  (tiny change)

	* progmodes/python.el (run-python): Fix path separator under w32.

2007-07-30  Richard Stallman  <rms@gnu.org>

	* emacs-lisp/lisp-mode.el (emacs-lisp-mode-syntax-table):
	Treat non-break space as whitespace in Lisp.

2007-07-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc.el (vc-dired-hook): Use inhibit-read-only.

	* progmodes/compile.el (compilation-forget-errors):
	Reset compilation-auto-jump-to-next.

2007-07-30  Michael Olson  <mwolson@gnu.org>

	* cus-edit.el (custom-group-save): Fix void function definition
	error.  Thanks to Zhang Wei for the report.

	* ps-print.el: Check in trivial changes to the autoloads section
	caused by the build process.  These autoloads really ought to be
	placed in a separate file, methinks.

2007-07-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* calendar/calendar.el (calendar-mode): Make sure
	displayed-(month|year) are set.
	(calendar-basic-setup): Display buffer before adjusting window sizes.
	(generate-calendar-window): Use inhibit-read-only.  Simplify.
	Generate buffer and set displayed-month and displayed-year before
	calling update-calendar-mode-line.

2007-07-29  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el:
	* net/tramp-uu.el:
	* net/trampver.el: Use utf-8 encoding with coding cookie.

	* net/tramp-cache.el:
	* net/tramp-fish.el:
	* net/tramp-ftp.el:
	* net/tramp-gw.el:
	* net/tramp-smb.el: Remove coding cookie.

	* net/tramp.el (tramp-handle-verify-visited-file-modtime):
	Flush buffer file-name's file property.
	(tramp-handle-file-remote-p): The first parameter is FILENAME.

	* net/trampver.el: Update release number.

2007-07-29  Juri Linkov  <juri@jurta.org>

	* dired.el (dired-mode-map): Bind C-x C-q to dired-toggle-read-only.
	Filter out menu item "Edit File Names" `wdired-change-to-wdired-mode'
	when major-mode is not dired-mode.
	(dired-toggle-read-only): New function.
	(dired-recursive-deletes): Remove obsolete comments about old
	default value.
	(dired-do-flagged-delete, dired-do-delete): Refill docstring.

	* wdired.el (wdired-exit): New function.
	(wdired-mode-map): Bind C-x C-q to wdired-exit.

2007-07-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* cus-edit.el (customize-read-group): New fun.
	(customize-group-other-window, customize-face-other-window):
	Prompt before delegating to customize-(group|face).
	Bind pop-up-windows rather than use the other-window argument.
	(customize-group, customize-face): Prompt from the interactive spec.
	Remove args `prompt-for-group' and `other-window'.

	* emacs-lisp/advice.el (ad-interactive-form): Re-introduce.
	(ad-body-forms, ad-advised-interactive-form): Revert this part of
	last change.

2007-07-28  Masatake YAMATO  <jet@gyve.org>

	* vc.el (vc-dired-mode): Add a menu for VC related operation.
	Use backend name as the menu label.  Suggested by David Kastrup.

2007-07-28  Alan Mackenzie  <acm@muc.de>

	Fix problem with modes derived from CC Mode:
	* progmodes/cc-mode.el (c-make-emacs-variables-local): Move this
	macro to cc-langs.
	(c-init-language-vars-for): Remove call to above macro.
	* progmodes/cc-langs.el (c-make-emacs-variables-local): Macro has
	been moved to here.
	(c-make-init-lang-vars-fun): Call c-make-emacs-variables-local.

2007-07-28  Eli Zaretskii  <eliz@gnu.org>

	* net/trampver.el: Fix the `coding' cookie.

2007-07-28  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-git.el (vc-git-print-log): Support both the old single file
	interface and the new one.

2007-07-28  Nick Roberts  <nickrob@snap.net.nz>

	* bindings.el (mode-line-remote): Use updated %@ construct.

2007-07-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* calendar/cal-bahai.el (calendar-bahai-month-name-array)
	(calendar-bahai-epoch, calendar-bahai-leap-year-p)
	(calendar-bahai-leap-base, calendar-bahai-prompt-for-date)
	(diary-list-bahai-entries, diary-bahai-mark-entries)
	(calendar-bahai-mark-date-pattern, diary-insert-bahai-entry)
	(diary-bahai-insert-monthly-entry, diary-bahai-insert-yearly-entry):
	New names to clean up namespace.
	(list-bahai-diary-entries, mark-bahai-diary-entries)
	(insert-bahai-diary-entry, insert-monthly-bahai-diary-entry)
	(insert-yearly-bahai-diary-entry, mark-bahai-calendar-date-pattern):
	Add compatibility aliases.

	* calendar/appt.el: Don't wrap defvar within eval-when-compile.

	* calendar/cal-move.el (calendar-scroll-left, calendar-scroll-right)
	(calendar-scroll-left-three-months)
	(calendar-scroll-right-three-months): Clean up namespace.
	(scroll-calendar-left, scroll-calendar-right)
	(scroll-calendar-left-three-months)
	(scroll-calendar-right-three-months): Add compatibility aliases.

	* calendar/cal-move.el (calendar-scroll-left, calendar-scroll-right):
	Behave like mouse-scroll-calendar-* when used from the mouse.

	* calendar/cal-menu.el (cal-menu-scroll-menu)
	(cal-menu-global-mouse-menu):
	* calendar/calendar.el (calendar-mode-map):
	Use new calendar-scroll-* names.
	(mouse-scroll-calendar-left, mouse-scroll-calendar-right):
	Remove.  Use calendar-scroll-* directly instead.

2007-07-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/advice.el (ad-interactive-p, ad-interactive-form): Remove.
	(ad-body-forms, ad-advised-interactive-form, ad-make-cache-id)
	(ad-make-advised-definition, ad-cache-id-verification-code):
	Use commandp and interactive-form instead.

2007-07-26  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-git.el: Relicense to GPLv3 or later.
	(vc-directory-exclusion-list, vc-handled-backends): Remove.

	* vc-hooks.el (vc-handled-backends): Add GIT.

	* vc.el (vc-directory-exclusion-list): Add .git.

2007-07-26  Alexandre Julliard  <julliard@winehq.org>

	* vc-git.el (vc-git-revision-table)
	(vc-git-revision-completion-table): New functions.

2007-07-25  Glenn Morris  <rgm@gnu.org>

	* Relicense all FSF files to GPLv3 or later.

	* COPYING: Switch to GPLv3.

2007-07-25  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcvs.el (cvs-temp-buffer): Undo last ill-conceived change.
	Replace it with another one which disables undo before calling
	erase-buffer and then turns it back on if needed.

2007-07-24  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-hg.el (vc-hg-revision-completion-table): Temporarily comment out.

2007-07-24  Glenn Morris  <rgm@gnu.org>

	* calendar/cal-tex.el (cal-tex-holidays, cal-tex-diary)
	(cal-tex-rules, cal-tex-buffer, cal-tex-24)
	(cal-tex-cursor-month-landscape, cal-tex-cursor-month)
	(cal-tex-cursor-week, cal-tex-cursor-week2)
	(cal-tex-cursor-week-iso, cal-tex-week-hours)
	(cal-tex-cursor-week-monday, cal-tex-weekly4-box)
	(cal-tex-cursor-filofax-2week, cal-tex-cursor-filofax-week)
	(cal-tex-cursor-filofax-daily, cal-tex-daily-page): Doc fix.

2007-07-25  Stefan Monnier  <monnier@iro.umontreal.ca>

	* calendar/calendar.el (calendar-mode-map): Move initialization
	into declaration.  Add menu bindings (used to be done in cal-menu).
	(calendar-mode): Don't add an activate-menubar-hook.

	* calendar/cal-menu.el: Break dependency on calendar.el (i.e. do not
	modify calendar-mode-map), use easy-menu, and make sure that C-h k
	can be used on the menu entries.
	(cal-menu-holiday-window-suffix, cal-menu-set-date-title): New funs.
	(cal-menu-moon-menu, cal-menu-diary-menu, cal-menu-holidays-menu)
	(cal-menu-goto-menu, cal-menu-scroll-menu): New consts.
	(cal-menu-context-mouse-menu, cal-menu-global-mouse-menu): New menus.
	(calendar-flatten, cal-menu-update): Remove.
	(calendar-mouse-insert-hebrew-diary-entry)
	(calendar-mouse-insert-islamic-diary-entry)
	(calendar-mouse-insert-bahai-diary-entry):
	Remove (fold into cal-menu-diary-menu).
	(calendar-mouse-2-date-menu, calendar-mouse-cal-tex-menu)
	(cal-tex-mouse-filofax): Remove (fold into cal-menu-context-mouse-menu).
	(calendar-mouse-3-map): Remove (turn into cal-menu-global-mouse-menu).
	(calendar-mouse-view-diary-entries): Minor simplifications.
	(calendar-event-to-date): Use with-current-buffer.

2007-07-25  Nick Roberts  <nickrob@snap.net.nz>

	* add-log.el (change-log-redate): Remove (not needed anymore and
	doesn't appear to work).

2007-07-25  Stefan Monnier  <monnier@iro.umontreal.ca>

	* frame.el: Use mapc and dolist instead of mapcar where possible.
	(close-display-connection): New command.

2007-07-25  Alexandre Julliard  <julliard@winehq.org>

	* vc-git.el (vc-git-log-view-mode): Port to the multi-file vc interface.
	(vc-git-create-snapshot, vc-git-retrieve-snapshot): New functions.

2007-07-25  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el (ps-multibyte-buffer): Docstring fix.

	* ps-mule.el: Doc fix.
	(ps-multibyte-buffer, ps-mule-font-info-database-default)
	(ps-mule-external-libraries, ps-mule-begin-job): Docstring fix.

2007-07-25  Glenn Morris  <rgm@gnu.org>

	* calendar/cal-tex.el (cal-tex-which-days, cal-tex-holidays)
	(cal-tex-diary, cal-tex-daily-string, cal-tex-daily-start)
	(cal-tex-daily-end, cal-tex-hook)
	(cal-tex-cal-one-month, cal-tex-cal-multi-month)
	(cal-tex-year, cal-tex-cursor-week, cal-tex-cursor-week2)
	(cal-tex-cursor-week-iso, cal-tex-week-hours)
	(cal-tex-cursor-week-monday, cal-tex-weekly4-box)
	(cal-tex-cursor-day, cal-tex-insert-preamble): Doc fix.
	(cal-tex-day-prefix, cal-tex-day-name-format)
	(cal-tex-cal-one-month, cal-tex-cal-multi-month, cal-tex-myday)
	(cal-tex-caldate, cal-tex-LaTeX-hourbox)
	(cal-tex-LaTeX-subst-list): Change from variables to constants.
	(cal-tex-preamble, cal-tex-arg, cal-tex-nl): Simplify with `format'.
	(cal-tex-cursor-filofax-year, cal-tex-weekly4-box): Use \textbf,
	etc, rather than \bf.
	(cal-tex-mini-calendar): Fix typos in previous change.
	(cal-tex-latexify-list): Remove inner let binding.
	(cal-tex-end-document, cal-tex-banner): Use multi-line
	cal-tex-comment.
	(cal-tex-comment): Handle embedded newlines.
	(cal-tex-LaTeXify-string): Use substring-no-properties.

2007-07-25  Joakim Verona  <joakim@verona.se>  (tiny change)

	* progmodes/compile.el (compilation-error-regexp-alist-alist):
	Add support for the Maden build tool.

2007-07-25  William Xu  <william.xwl@gmail.com>  (tiny change)

	* net/webjump.el (webjump-url-encode): Fix for non-ASCII characters.

2007-07-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcvs.el (cvs-temp-buffer): Disable undo in temp buffers.

2007-07-24  Dan Nicolaescu  <dann@ics.uci.edu>

	* dired.el (dired-mode-map): Bind wdired-change-to-wdired-mode to
	C-x C-q.

	* vc-git.el (vc-git-print-log): Fix previous change.

2007-07-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* window.el (save-selected-window): Minor optimization.
	(bw-adjust-window): If operation failed, try with a smaller delta.
	(window-fixed-size-p): New function.
	(window-area-factor): New var.
	(balance-windows-area): New command.

	* ps-mule.el (ps-multibyte-buffer): Docstring fixes.
	(ps-mule-encode-ethiopic): Make it clear that it's always defined.
	(ps-mule-prepare-font-for-components, ps-mule-encode-header-string)
	(ps-mule-encode-bit, ps-mule-encode-ucs2): Use dotimes.
	(ps-mule-begin-job): Use dolist.

2007-07-24  Michael Albinus  <michael.albinus@gmx.de>

	* subr.el (start-file-process-shell-command)
	(process-file-shell-command): New defuns.

	* progmodes/compile.el (compilation-start):
	Apply `start-file-process-shell-command'.

2007-07-24  Alexandre Julliard  <julliard@winehq.org>

	* vc-git.el (vc-git-checkout, vc-directory-exclusion-list): Fix typos.

2007-07-24  Alan Mackenzie  <acm@muc.de>

	* emacs-lisp/bytecomp.el (byte-compile-from-buffer):
	Initialize byte-compile-unresolved-functions before rather than
	after a compilation.
	(byte-compile-unresolved-functions): Amplify doc string.

2007-07-24  Glenn Morris  <rgm@gnu.org>

	* startup.el (normal-splash-screen): Use `emacs-copyright'.

	* calendar/cal-tex.el (cal-tex-holidays, cal-tex-diary)
	(cal-tex-rules, cal-tex-buffer, cal-tex-24)
	(cal-tex-cursor-month-landscape, cal-tex-cursor-month)
	(cal-tex-cursor-week, cal-tex-cursor-week2)
	(cal-tex-cursor-week-iso, cal-tex-week-hours)
	(cal-tex-cursor-week-monday, cal-tex-weekly4-box)
	(cal-tex-cursor-filofax-2week, cal-tex-cursor-filofax-week)
	(cal-tex-cursor-filofax-daily, cal-tex-daily-page): Doc fix.

	* calendar/cal-tex.el: Remove leading `*' from defcustom docs.
	(cal-tex-daily-string, cal-tex-daily-start, cal-tex-daily-end)
	(cal-tex-day-name-format, cal-tex-cal-one-month)
	(cal-tex-cal-multi-month, cal-tex-myday, cal-tex-preamble)
	(cal-tex-comment, cal-tex-nl, cal-tex-cmd, cal-tex-e-parbox)
	(cal-tex-mini-calendar, cal-tex-em): Doc fix.
	(cal-tex-list-holidays, cal-tex-cursor-year)
	(cal-tex-cursor-year-landscape, cal-tex-year)
	(cal-tex-cursor-filofax-year, cal-tex-cursor-month-landscape)
	(cal-tex-cursor-month, cal-tex-insert-days)
	(cal-tex-insert-day-names, cal-tex-insert-blank-days)
	(cal-tex-first-blank-p, cal-tex-cursor-week)
	(cal-tex-cursor-week2, cal-tex-cursor-week-iso)
	(cal-tex-week-hours, cal-tex-cursor-week-monday)
	(cal-tex-weekly4-box, cal-tex-cursor-filofax-2week)
	(cal-tex-cursor-filofax-week, cal-tex-cursor-filofax-daily)
	(cal-tex-cursor-day, cal-tex-daily-page, cal-tex-mini-calendar)
	(cal-tex-latexify-list, cal-tex-previous-month)
	(cal-tex-next-month, cal-tex-insert-preamble): General tidy-up and
	modernization, including using dotimes rather than
	calendar-for-loop.
	(cal-tex-LaTeX-subst-list): Remove `@'.
	(cal-tex-em, cal-tex-bf, cal-tex-Huge-bf, cal-tex-large-bf):
	Use \textit and \textbf rather than \em and \it.

	* calendar/cal-bahai.el (list-bahai-diary-entries)
	* calendar/cal-hebrew.el (list-hebrew-diary-entries)
	* calendar/cal-islam.el (list-islamic-diary-entries)
	* calendar/calendar.el (generate-calendar, generate-calendar-month)
	* calendar/diary-lib.el (diary-list-entries)
	(mark-calendar-date-pattern): Use `dotimes' rather than
	`calendar-for-loop'.

	* calendar/calendar.el (calendar-for-loop): Doc fix.

2007-07-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* ses.el (ses-cleanup): Prevent Emacs from spuriously checking if the
	underlying file is uptodate.

2007-07-23  Christopher J. Madsen  <cjm@cjmweb.net>

	* replace.el (perform-replace): Use isearch-no-upper-case-p.

2007-07-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-hooks.el (vc-mode-line-map): New const.
	(vc-mode-line): Use it.

2007-07-23  Alexandre Julliard  <julliard@winehq.org>

	* vc-git.el (vc-git-delete-file, vc-git-rename-file)
	(vc-git-unregister): New functions.
	(vc-git-find-version): Use the result of ls-files as a parameter
	for cat-file.

2007-07-23  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (tramp-perl-file-attributes)
	(tramp-perl-directory-files-and-attributes)
	(tramp-handle-file-attributes-with-stat)
	(tramp-handle-directory-files-and-attributes-with-stat)
	(tramp-convert-file-attributes): Handle huge file sizes.

2007-07-23  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-message-function): New variable.
	(isearch-update, isearch-search): Use it.

	* simple.el (goto-history-element): New function created from
	next-history-element.
	(next-history-element): Most code moved to goto-history-element.
	Call goto-history-element with (- minibuffer-history-position n).
	(previous-history-element): Call goto-history-element with (+
	minibuffer-history-position n).
	(minibuffer-setup-hook): Add minibuffer-history-isearch-setup.
	(minibuffer-history-isearch-message-overlay): New buffer-local variable.
	(minibuffer-history-isearch-setup, minibuffer-history-isearch-end)
	(minibuffer-history-isearch-search, minibuffer-history-isearch-message)
	(minibuffer-history-isearch-wrap, minibuffer-history-isearch-push-state)
	(minibuffer-history-isearch-pop-state): New functions.

2007-07-23  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* vc-hooks.el (vc-stay-local-p): Fix bug: Avoid remove-if-not.
	Also, if FILE is a list, return non-nil if any of its elements
	should stay local.  Update docstring.

2007-07-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/copyright.el (copyright-update-year): Fix 2007-05-25
	change by reverting a small part.

2007-07-23  Richard Stallman  <rms@gnu.org>

	* progmodes/octave-inf.el (inferior-octave-prompt): Accept .exe.

2007-07-23  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-git.el (vc-git-checkin): Delete unused parameter and the code
	handling it.  Use vc-git-command.
	(vc-git-find-version, vc-git-diff-tree): New functions.
	(vc-git-revert): Use vc-git-command.
	(vc-git--run-command): Delete.

2007-07-23  Alexandre Julliard  <julliard@winehq.org>

	* vc-git.el (vc-git-workfile-unchanged-p): Update comment.

2007-07-20  Kenichi Handa  <handa@m17n.org>

	* international/utf-8.el (utf-8-post-read-conversion):
	Temporarily bind utf-8-compose-scripts to nil while running
	*-compose-region functions.

2007-07-23  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-git.el: Update status.
	(vc-directory-exclusion-list): Use eval-after-load.

2007-07-22  Nick Roberts  <nickrob@snap.net.nz>

	* bindings.el (mode-line-remote): New variable.
	(help-echo): Add to default values of mode-line-format.

	* files.el: Mark mode-line-remote as risky.

2007-07-22  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-edit-string): Save old point and
	isearch-other-end to old-point and old-other-end before reading
	the search string from minibuffer.  After exiting minibuffer set
	point to old-other-end if point and the search direction is the
	same as before reading the search string.
	(isearch-del-char): Don't set isearch-yank-flag to t.  Put point
	to isearch-other-end.  Instead of isearch-search-and-update call
	three functions isearch-search, isearch-push-state and isearch-update.

2007-07-22  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-git.el (vc-git-register, vc-git-checkin): Use vc-git-command,
	deal with multiple file arguments.
	(vc-git-print-log): Deal with multiple file arguments.

2007-07-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* diff-mode.el (diff-refine-ignore-spaces-hunk): Rename from
	diff-refine-hunk.  Adjust users.
	(diff-unified-hunk-p, diff-splittable-p): New functions.
	(diff-mode-menu): Use it to disable Split when it doesn't work.

2007-07-22  Dan Nicolaescu  <dann@ics.uci.edu>

	* diff-mode.el (diff-mode-menu): New entries.

2007-07-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* diff-mode.el (diff-unified->context): Use the new `apply' undo entry
	if applicable, so as to save undo-log space.

	* diff-mode.el (diff-find-file-name): Add arg `batch'.

	* diff-mode.el (diff-beginning-of-file-and-junk): New function.
	(diff-file-kill): Use it.
	(diff-beginning-of-hunk): Add arg `try-harder' using it.
	(diff-restrict-view, diff-find-source-location, diff-refine-hunk):
	Use it so they find the hunk even when we're in the file header.

2007-07-22  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-git.el (vc-git-revision-granularity, vc-git-root)
	(vc-git-command, vc-git-dir-state, vc-git-dired-state-info)
	(vc-git-create-repo): New functions.
	(vc-git-registered): New autoloaded function definition.
	(vc-git-registered): Use vc-git-root.
	(vc-git-responsible-p): New defalias.
	(vc-git-annotate-extract-revision-at-line): Uncomment.
	(vc-git-print-log): Add the file name to the log.
	(vc-git-log-view-mode): New derived mode.
	(vc-git-diff, vc-git-annotate-command): Use vc-git-command.

2007-07-22  Michael Albinus  <michael.albinus@gmx.de>

	* progmodes/grep.el (grep-compute-defaults): Keep default values.

2007-07-22  Ralf Angeli  <angeli@caeruleus.net>

	* textmodes/reftex.el (reftex-access-parse-file): Create parse
	file in a way that does not interfere with recentf mode.
	(reftex-access-parse-file): Do not risk destroying an existing
	buffer.

2007-07-22  Alexandre Julliard  <julliard@winehq.org>

	* vc-git.el: New file.

2007-07-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/tex-mode.el (tex-font-script-display): Change default.

2007-07-22  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-cvs.el (vc-cvs-mode-line-string): Add support for tooltips
	for branches and new files.

	* vc-hooks.el (vc-default-mode-line-string): Move mouse-face and
	local-map handling ...
	(vc-mode-line): ... here.  Improve handling of help-echo.

	* vc.el (mode-line-string): Document help-echo usage.

2007-07-22  Michael Albinus  <michael.albinus@gmx.de>

	Sync with Tramp 2.1.10.

	* net/tramp.el (tramp-get-ls-command): Fix typo.

	* net/trampver.el: Update release number.

2007-07-22  Jan Djärv  <jan.h.d@swipnet.se>

	* startup.el (command-line-x-option-alist): Use x-handle-no-bitmap-icon.

	* term/x-win.el (x-handle-no-bitmap-icon): New function.

2007-07-22  Martin Rudalics  <rudalics@gmx.at>

	* add-log.el (change-log-fill-parenthesized-list): New function.
	(change-log-indent): Call change-log-fill-parenthesized-list.
	(change-log-fill-paragraph): Bind fill-indent-according-to-mode to t.
	Have lines with leading asterisk start a paragraph.

2007-07-21  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-math.el (math-emacs-precision)
	(math-largest-emacs-expt, math-smallest-emacs-expt):
	New variables.
	(math-use-emacs-fn): New function.
	(math-exp-raw): Evaluate with `math-use-emacs-fn', when
	appropriate.

2007-07-21  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* image-dired.el (image-dired-sane-db-file): New func.
	(image-dired-write-tags, image-dired-remove-tag)
	(image-dired-list-tags, image-dired-write-comments)
	(image-dired-get-comment, image-dired-mark-tagged-files)
	(image-dired-create-gallery-lists): Call new func.
	Reported by Dieter Wilhelm <dieter@duenenhof-wilhelm.de>.

2007-07-21  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-hg.el (vc-hg-dir-state): Fix loop.
	(vc-hg-print-log): Fix expected return value for vc-hg-command.
	(vc-hg-next-version, vc-hg-delete-file, vc-hg-rename-file)
	(vc-hg-register, vc-hg-create-repo, vc-hg-checkin)
	(vc-hg-revert): Likewise.
	(vc-hg-revision-table, vc-hg-revision-completion-table): New
	functions.

2007-07-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* add-log.el (change-log-resolve-conflict): Don't lose data if the
	merge fails.

2007-07-20  Dan Nicolaescu  <dann@ics.uci.edu>

	* progmodes/compile.el (compilation-auto-jump-to-first-error):
	Add group and version.

2007-07-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* add-log.el (add-log-file-name): Use file-relative-name.
	(add-change-log-entry): Delay reading
	add-log-(full-name|mailing-address) to after we've switched to the
	ChangeLog buffer so we get the right value.
	(add-change-log-entry, add-log-current-defun, change-log-merge):
	Use derived-mode-p rather than checking major-mode directly.

	* pcvs.el (cvs-mode-add-change-log-entry-other-window): Use a directory
	name for buffer-file-name if it refers to a directory.

	* vc-arch.el (vc-arch-diff): Fix last change.

	* progmodes/compile.el (compilation-start): Remember the original
	directory in a buffer-local compilation-directory.
	(compile): Set the global value of compilation-directory.
	(recompile): Use compilation-directory even in the compilation buffer.

2007-07-20  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-hg.el (vc-hg-diff): Use vc-hg-command.

2007-07-20  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el: Problem with foreground and background color when
	printing a buffer with and without faces.  Reported by Christian
	Schlauer <cs-muelleimer-rubbish.bin@arcor.de>.
	(ps-print-version): New version 6.7.5.
	(ps-default-fg): Change default value to nil, so black color is used
	when a face does not specify a foreground color.
	(ps-default-bg): Change default value to nil, so white color is used
	for background color.
	(ps-begin-job): Fix code.

2007-07-20  Eli Zaretskii  <eliz@gnu.org>

	* makefile.w32-in (install-lisp-SH): Don't create subdirectories
	in $(INSTALL_DIR)/lisp/ if they already exist.

2007-07-20  Dhruva Krishnamurthy  <dhruvakm@gmail.com>  (tiny change)

	* makefile.w32-in (install-lisp-CMD): Don't create subdirectories
	in $(INSTALL_DIR)/lisp/ if they already exist.

2007-07-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/vera-mode.el (vera-re-search-forward)
	(vera-re-search-backward): Remove use of store-match-data.
	(vera-mode-map): Move initialization into declaration.

	* progmodes/flymake.el (flymake-buildfile-dirs): Remove.
	(flymake-find-buildfile): Use locate-dominating-file.

	* vc.el (vc-delistify): Use mapconcat.
	(vc-do-command): Minor simplification.
	(vc-expand-dirs): Use push.

	* vc-mcvs.el (vc-mcvs-create-repo):
	* vc-cvs.el (vc-cvs-create-repo): Remove.

	* vc-hooks.el (vc-find-root): Fix case where `file' is the current
	directory and the root as well.

2007-07-20  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-hooks.el (vc-default-workfile-unchanged-p): Pass a list
	instead of a file.

	* vc-hg.el (vc-hg-print-log): Deal with multiple file arguments.
	(vc-hg-registered): Replace if with when.
	(vc-hg-state): Deal with nonexistent files and handle removed files.
	(vc-hg-dir-state, vc-hg-dired-state-info): New functions.
	(vc-hg-checkout): Re-enable.
	(vc-hg-create-repo): Fix typos.
	(vc-hg-print-log): Fix for multiple files.
	(vc-hg-workfile-unchanged-p): New function.

	* vc.el: Fix typo.
	(vc-print-log): Fix call to print-log.
	(vc-default-comment-history): Likewise.
	(vc-directory-exclusion-list): Add .hg and .bzr.
	(vc-diff-internal): Pass a list instead of a file.

	* vc-mcvs.el (vc-mcvs-create-repo): Fix typos.

	* vc-bzr.el (vc-bzr-create-repo): New function.

2007-07-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-hooks.el (vc-find-root): Walk up the tree to find an existing
	`file' from which to start the search.

2007-07-19  Eric S. Raymond  <esr@snark.thyrsus.com>

	* vc-cvs.el (vc-cvs-checkin, vc-cvs-diff): Finish transition from
	having a single file argument to having a list of files as the
	first argument.

2007-07-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* files.el (locate-dominating-file): New function.

2007-07-18  Michael Albinus  <michael.albinus@gmx.de>

	* progmodes/grep.el (grep-host-defaults-alist): New defvar.
	(grep-compute-defaults): Use it.

2007-07-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* uniquify.el: Docstring fixes.

2007-07-18  Eric S. Raymond  <esr@snark.thyrsus.com>

	* vc.el (revision-granularity, create-repo): Document new vc
	backend properties.
	(vc-rollback): Renamed from vc-cancel-version.  Update references.
	Pass a list instead of a file.
	(vc-revert): Renamed from vc-revert-buffer.  Update references.
	(vc-delistify, vc-expand-dirs): New functions.
	(vc-do-command): Rename FILE to FILE-OR-LIST and deal with a list
	of files instead of a single file.
	(vc-position-context, vc-resync-window, vc-diff-internal)
	(vc-print-log): Pass a list instead of a file.

	* vc-hooks.el (vc-stay-local-p, vc-backend)
	(vc-backend-subdirectory-name): Work on a file list, not a single
	file.
	(vc-workfile-version): Update docstring.
	(vc-menu-map): Use vc-rollback instead of vc-cancel-version and
	vc-revert instead of vc-revert-buffer.
	(vc-prefix-map): Likewise.  Bind vc-update.

	* vc-svn.el (vc-svn-revision-granularity, vc-svn-create-repo)
	(vc-svn-wash-log): New functions.
	(vc-svn-register, vc-svn-checkin, vc-svn-print-log)
	(vc-svn-command): Deal with a list of files, not a single file.

	* vc-rcs.el (vc-rcs-revision-granularity, vc-rcs-create-repo)
	(vc-rcs-wash-log): New functions.
	(vc-rcs-register, vc-rcs-checkin, vc-rcs-diff, vc-rcs-print-log):
	Deal with a list of files, not a single file.
	(vc-rcs-rollback): Likewise.  Rename from vc-rcs-cancel-version.

	* vc-sccs.el (vc-sccs-revision-granularity, vc-sccs-wash-log): New
	functions.
	(vc-sccs-register, vc-sccs-checkin, vc-sccs-diff): Deal with a
	list of files, not a single file.

	* vc-mcvs.el (vc-mcvs-revision-granularity, vc-mcvs-create-repo):
	New functions.
	(vc-mcvs-register, vc-mcvs-checkin, vc-mcvs-print-log)
	(vc-mcvs-diff): Deal with a list of files, not a single file.

	* vc-hg.el (vc-hg-revision-granularity, vc-hg-create-repo): New
	functions.
	(vc-hg-print-log): Deal with a list of files, not a single file.
	(vc-hg-diff-tree): New function, replace defalias with the same
	name.
	(vc-hg-register, vc-hg-checkin, vc-hg-command): Rename FILE to
	FILES to denote that it is a file list, not a single file.

	* vc-cvs.el (vc-cvs-create-repo, vc-cvs-wash-log): New functions.
	(vc-cvs-register, vc-cvs-checkin): Deal with a list of files, not
	a single file.
	(vc-cvs-print-log, vc-cvs-command): Rename FILE to FILES to denote
	that it is a file list, not a single file.
	(vc-cvs-diff): Likewise.  Simplify.

	* vc-arch.el (vc-arch-register, vc-arch-checkin, vc-arch-diff):
	Deal with a list of files, not a single file.

	* vc-bzr.el (vc-bzr-register, vc-bzr-command, vc-bzr-checkin)
	(vc-bzr-print-log): Update FILE parameter name to denote that it
	is a file list, not a single file.
	(vc-bzr-diff): Likewise.  Use the car of files.

2007-07-18  Juanma Barranquero  <lekktu@gmail.com>

	* follow.el (follow-mode-hook, follow-mode-off-hook, follow-mode)
	(follow-delete-other-windows-and-split, follow-recenter)
	(follow-windows-aligned-p, follow-point-visible-all-windows-p)
	(follow-redisplay, follow-estimate-first-window-start)
	(follow-xemacs-scrollbar-support, follow-intercept-process-output):
	Fix typos in docstrings.

2007-07-18  Martin Rudalics  <rudalics@gmx.at>

	* add-log.el (change-log-mode): Use fill-nobreak-predicate to
	avoid that filling introduces lines with a single asterisk.

	* kmacro.el (kmacro-end-macro): When ignoring empty macro
	avoid incorrect kmacro-ring-empty-p messages.
	Reported by Michael Schierl <schierlm@gmx.de>.

2007-07-17  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el: Add more info about the vc-registered function.

2007-07-17  Michael Albinus  <michael.albinus@gmx.de>

	* files.el (file-remote-p): Introduce optional parameter
	IDENTIFICATION.

	* recentf.el (recentf-keep-default-predicate): Adapt call of
	`file-remote-p'.

	* progmodes/grep.el (grep-probe): Use `process-file'.
	(grep-compute-defaults): Handle variables host specific.

	* net/ange-ftp.el (ange-ftp-file-remote-p): Handle optional
	parameter IDENTIFICATION.

	* net/tramp.el (tramp-handle-file-remote-p): Handle optional
	parameter IDENTIFICATION.
	(tramp-handle-set-file-times): New defun.  Replaces `tramp-touch'.
	(tramp-file-name-handler-alist, tramp-file-name-for-operation):
	Add entry for `set-file-times'.
	(tramp-do-copy-or-rename-file-via-buffer)
	(tramp-do-copy-or-rename-file-out-of-band): Use `set-file-times'.
	(tramp-handle-unhandled-file-name-directory): Rewrite.
	(tramp-convert-file-attributes): Add error handling when inode is
	extraordinary big.
	(tramp-get-inode): Change parameter from FILE to VEC.
	(tramp-handle-start-file-process): Use (current-buffer) if BUFFER
	is nil.  This is according to the specification.  Goto (point-max)
	when ready.
	(tramp-handle-shell-command): Rewrite completely, using
	`process-file' and `start-file-process'.
	(tramp-methods, tramp-find-shell)
	(tramp-open-connection-setup-interactive-shell)
	(tramp-maybe-open-connection): Guard against $PROMPT_COMMAND shell
	var.  Reported by Steve Youngs <steve@sxemacs.org>.

	* net/tramp-fish.el (tramp-fish-file-name-handler-alist): Add
	entry for `set-file-times'.  Rename `start-process' into
	`start-file-process'.  Remove `call-process' entry.
	(tramp-fish-handle-set-file-times): New defun.
	(tramp-fish-handle-executable-find): Use `process-file'.
	(tramp-fish-handle-process-file): New defun.  Replaces
	`tramp-fish-handle-call-process'.
	(tramp-fish-do-copy-or-rename-file-directly): Use
	`set-file-times'.
	(tramp-fish-get-file-entries): Change `tramp-get-inode' parameter.

	* net/tramp-smb.el (tramp-smb-handle-file-attributes): Change
	`tramp-get-inode' parameter.

2007-07-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-bzr.el (vc-bzr-version, vc-bzr-at-least-version)
	(vc-bzr-post-command-function): Remove.  Version 0.8 is already old
	nowadays, and by the time Emacs-23 comes out, nobody will even remember
	it has ever existed.

2007-07-17  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el: Undo previous change.

2007-07-16  Eli Zaretskii  <eliz@gnu.org>

	* makefile.w32-in (clean): Don't delete *~.

2007-07-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/tex-mode.el (tex-verbatim-environments):
	Add safe-local-variable property.
	(tex-font-lock-syntactic-keywords): Lookup tex-verbatim-environments
	when starting font-lock rather than when loading tex-mode.el.

	* progmodes/sh-script.el (sh-font-lock-quoted-subshell): Skip over the
	whole $( rather than just the $.  Rename from sh-quoted-subshell.
	(sh-font-lock-syntactic-keywords): Adjust call accordingly.

2007-07-16  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* bookmark.el (bookmark-maybe-sort-alist): Don't modify
	bookmark-alist.  Instead, if not sorting, simply return it.
	(bookmark-bmenu-list): Call bookmark-maybe-sort-alist
	for its return value, not for its side effect.

	* emacs-lisp/lisp-mode.el (calculate-lisp-indent): In the
	case of alignment under a constant symbol, find and consider
	the sexp actually at indentation to be the "last sexp".

2007-07-16  Drew Adams  <drew.adams@oracle.com>

	* mouse.el (mouse-yank-secondary): Better error message if no
	secondary selection.

2007-07-16  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-hooks.el (vc-handled-backends): Move BZR later in the list.

	* term/xterm.el (xterm-turn-on-modify-other-keys)
	(xterm-turn-off-modify-other-keys): New functions.
	(terminal-init-xterm): Enable the modifyOtherKeys feature if the
	terminal supports it.

2007-07-16  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* bookmark.el (bookmark-show-all-annotations):
	Make sure each inserted annotation ends with newline.

2007-07-15  Richard Stallman  <rms@gnu.org>

	* kmacro.el (kmacro-bind-to-key): Avoid comparisons on function keys.

	* tutorial.el (tutorial--find-changed-keys):
	Handle C-x specially like ESC.

2007-07-15  Aaron S. Hawley  <aaronh@garden.org>

	* tar-mode.el (tar-get-descriptor): No error for zero-length file.

2007-07-15  Juri Linkov  <juri@jurta.org>

	* delsel.el (delete-selection-pre-hook):
	* emulation/cua-base.el (cua-paste): Before a yank command,
	check also whether last-command is one of mouse-save-then-kill,
	mouse-secondary-save-then-kill, mouse-set-region, mouse-drag-region.

2007-07-15  Michael Albinus  <michael.albinus@gmx.de>

	* recentf.el (recentf-keep-default-predicate): New defun.
	(recentf-keep): Use it as initial value.

2007-07-15  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el: Revert revision 1.90 (commitid mWoPbju3pgNotDps),
	thus restoring bookmark bindings to three slots under C-x r.  See
	http://lists.gnu.org/archive/html/emacs-devel/2007-07/msg00705.html.

2007-07-15  Jeff Miller  <jmiller@cablespeed.com>  (tiny change)

	* calendar/calendar.el (calendar-goto-bahai-date): Autoload it.

2007-07-15  Jason Rumney  <jasonr@gnu.org>

	* w32-fns.el (set-default-process-coding-system): Use dos line ends
	for input to cmdproxy on all versions of Windows.
	Use dos line ends for input to plink.

	* comint.el (comint-simple-send): Concat newline before sending.
	(comint-password-prompt-regexp): Recognize plink's passphrase prompt.

2007-07-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/autoload.el (generated-autoload-file): Autoload the
	safe-local-variable setting.

2007-07-14  David Kastrup  <dak@gnu.org>

	* emacs-lisp/advice.el (defadvice): Doc fix.

2007-07-14  Juanma Barranquero  <lekktu@gmail.com>

	* subr.el (when, unless): Doc fix.

2007-07-13  Dan Nicolaescu  <dann@ics.uci.edu>

	* replace.el (match): Use yellow1 instead of yellow.

	* progmodes/gdb-ui.el (breakpoint-enabled): Use red1 instead of
	red.

	* pcvs-info.el (cvs-unknown): Likewise.

2007-07-13  Eli Zaretskii  <eliz@gnu.org>

	* makefile.w32-in (install-lisp-SH, install-lisp-CMD): New targets.
	(install): Use them to copy all *.el files before *.elc.

2007-07-13  Drew Adams  <drew.adams@oracle.com>

	* bookmark.el (bookmark-jump-other-window): New function.
	(bookmark-map): Bind it to "o".

	http://lists.gnu.org/archive/html/emacs-devel/2007-07/msg00633.html
	and its thread contains discussion about this change.
	The original patch was slightly tweaked by Karl Fogel
	<kfogel@red-bean.com> before committing.

2007-07-13  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el: Shorten some comments to fit within 80 lines.

2007-07-13  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el: Don't define bookmark keys under the "C-xr" map;
	instead, make "C-xp" a prefix for bookmark-map.  Patch by Drew
	Adams <drew.adams@oracle.com>, mildly tweaked by me.  See
	http://lists.gnu.org/archive/html/emacs-devel/2007-07/msg00633.html.

2007-07-13  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el: Bug fixes.
	(org-end-of-line): Move to end of line if in headline without tags.

2007-07-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-hooks.el: Remove spurious * in docstrings.
	(vc-handled-backends): Add BZR.

	* vc-hooks.el (vc-find-file-hook): Use with-demoted-errors.

2007-07-12  Davis Herring  <herring@lanl.gov>

	* desktop.el (desktop-buffer-info, desktop-save):
	Use `desktop-dirname' instead of `dirname'.

2007-07-12  Paul Pogonyshev  <pogonyshev@gmx.net>

	* progmodes/which-func.el (which-func-modes): Add `python-mode'.

	* progmodes/python.el (python-which-func-length-limit): New var.
	(python-which-func): New function.
	(python-current-defun): Add optional `length-limit' and try to fit
	computed function name to that length.
	(python-mode): Hook `python-which-func' up.

2007-07-12  Sean O'Rourke  <sorourke@cs.ucsd.edu>  (tiny change)

	* pcomplete.el (pcomplete-entries): Obey pcomplete-ignore-case.

	* comint.el (comint-dynamic-complete-as-filename):
	Use read-file-name-completion-ignore-case.

2007-07-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* comint.el (comint-dynamic-list-filename-completions):
	Use read-file-name-completion-ignore-case.

	* vc-cvs.el: Require CL.
	(vc-cvs-revision-table, vc-cvs-revision-completion-table):
	New functions to provide completion of revision names.

	* vc-cvs.el (vc-functions): Clear up the cache when reloading the file.
	(vc-cvs-annotate-first-line-re): New const.
	(vc-cvs-annotate-process-filter): New fun.
	(vc-cvs-annotate-command): Use them and run the command asynchronously.

2007-07-12  Paul Pogonyshev  <pogonyshev@gmx.net>

	* emacs-lisp/eldoc.el (eldoc-last-data): Revise documentation.
	(eldoc-print-current-symbol-info): Adjust for changed helper
	function signatures.
	(eldoc-get-fnsym-args-string): Add `args' argument.  Use new
	`eldoc-highlight-function-argument'.
	(eldoc-highlight-function-argument): New function.
	(eldoc-get-var-docstring): Format documentation with
	`font-lock-variable-name-face'.
	(eldoc-docstring-format-sym-doc): Add `face' argument and apply it
	where suited.
	(eldoc-fnsym-in-current-sexp): Return a list with argument index.
	(eldoc-beginning-of-sexp): Return number of skipped sexps.

2007-07-11  Michael Albinus  <michael.albinus@gmx.de>

	* progmodes/compile.el (compilation-start): `start-process' must
	still be redefined when calling `start-process-shell-command'.

	* progmodes/gud.el (gud-file-name): When `default-directory' is a
	remote file name, prepend its remote part to the filename.
	(gud-common-init): When `default-directory' is a remote file name,
	make the filename relative to it.
	Based on a patch by Nick Roberts <nickrob@snap.net.nz>.

2007-07-11  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-hooks.el (vc-default-mode-line-string): Add a mouse face,
	mouse binding and a tooltip.

2007-07-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* menu-bar.el (vc-menu-map): New defalias.

2007-07-10  Richard Stallman  <rms@gnu.org>

	* emacs-lisp/lisp-mode.el (eval-defun):
	Explain special handling of `defface'.

2007-07-10  Jim Meyering  <jim@meyering.net>  (tiny change)

	* emacs-lisp/copyright.el (copyright-current-gpl-version): Set to 3.

	* autoinsert.el (auto-insert-alist): s/2/3/ in the generated comment.

2007-07-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl.el: Load cl-loaddefs.el quietly.

	* vc-arch.el (vc-arch-complete): Remove.
	(vc-arch-revision-completion-table): Use complete-with-action.

	* subr.el (condition-case-no-debug, with-demoted-errors): New macros.
	(complete-with-action): New function.
	(dynamic-completion-table): Use it.

2007-07-10  Michael Albinus  <michael.albinus@gmx.de>

	* comint.el (make-comint, make-comint-in-buffer)
	(comint-exec-1): Replace `start-process' by `start-file-process'.

	* progmodes/compile.el (compilation-start): Revert redefining
	`start-process'.

2007-07-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/autoload.el (autoload-generate-file-autoloads): Be careful
	with EOLs when generating MD5 checksums.

	* follow.el: Don't change the global map from the follow-mode-map
	defvar, but from the toplevel.  Use easy-menu to unify the Emacs and
	XEmacs code.
	(turn-on-follow-mode, turn-off-follow-mode): Remove interactive spec
	since `follow-mode' should be used instead for that.

	* emacs-lisp/easymenu.el (easy-menu-binding): New function.
	(easy-menu-do-define): Use it.
	(easy-menu-do-add-item): Inline into easy-menu-add-item and then remove.

	* progmodes/compile.el (compilation-auto-jump-to-first-error)
	(compilation-auto-jump-to-next): New vars.
	(compilation-auto-jump): New function.
	(compilation-error-properties): Use them to jump to first error.
	(compilation-start): Set the var if requested.

	* emacs-lisp/autoload.el (update-directory-autoloads): Remove
	duplicates without also removing entries from other directories.

2007-07-10  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el (org-agenda-day-view, org-agenda-week-view):
	Remember span as default.
	(org-columns-edit-value): Rename from `org-column-edit'.
	(org-columns-display-here-title): Rename from
	`org-overlay-columns-title'.
	(org-columns-remove-overlays): Rename from org-remove-column-overlays.
	(org-columns-get-autowidth-alist): Rename from
	`org-get-columns-autowidth-alist'.
	(org-columns-display-here): Rename from `org-overlay-columns'.
	(org-columns-new-overlay): Rename from `org-new-column-overlay'.
	(org-columns-quit): Rename from `org-column-quit'.
	(org-columns-show-value): Rename from `org-column-show-value'.
	(org-columns-content, org-columns-widen)
	(org-columns-next-allowed-value)
	(org-columns-edit-allowed, org-columns-store-format)
	(org-columns-uncompile-format, org-columns-redo)
	(org-columns-edit-attributes, org-delete-property)
	(org-set-property, org-columns-update)
	(org-columns-compute, org-columns-eval)
	(org-columns-not-in-agenda, org-columns-compute-all)
	(org-property-next-allowed-value)
	(org-columns-compile-format)
	(org-fill-paragraph-experimental)
	(org-string-to-number, org-property-action)
	(org-columns-move-left, org-columns-new)
	(org-column-number-to-string)
	(org-property-previous-allowed-value)
	(org-at-property-p, org-columns-delete)
	(org-columns-previous-allowed-value)
	(org-columns-move-right, org-columns-narrow)
	(org-property-get-allowed-values)
	(org-verify-version, org-column-string-to-number)
	(org-delete-property-globally): New functions.
	(org-columns-current-fmt): Rename from `org-current-columns-fmt'.
	(org-columns-overlays): Rename from `org-column-overlays'.
	(org-columns-map): Rename from `org-column-map'.
	(org-columns-current-maxwidths): Rename from
	`org-current-columns-maxwidths'.
	(org-columns-begin-marker, org-columns-current-fmt-compiled)
	(org-previous-header-line-format)
	(org-columns-inhibit-recalculation)
	(org-columns-top-level-marker): New variables.
	(org-columns-default-format): Rename from `org-default-columns-format'.
	(org-property-re): New constant.

2007-07-10  Guanpeng Xu  <herberteuler@hotmail.com>

	* subr.el (looking-at-p, string-match-p): New functions.

2007-07-09  Reiner Steib  <Reiner.Steib@gmx.de>

	* textmodes/tex-mode.el (tex-fontify-script)
	(tex-font-script-display): New variables to make display of
	superscripts and subscripts customizable.
	(tex-font-lock-suscript, tex-font-lock-match-suscript): Use them.

2007-07-09  Richard Stallman  <rms@gnu.org>

	* isearch.el (isearch-edit-string): Call to isearch-push-state
	after the search.

2007-07-09  Jan Djärv  <jan.h.d@swipnet.se>

	* window.el (fit-window-to-buffer): Remove setting of window-min-height
	to 1 as enlarge-window uses the value to resize/shrink windows other
	than WINDOW if needed.

2007-07-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* cus-start.el (file-coding-system-alist): Fix custom type.

2007-07-08  Chong Yidong  <cyd@stupidchicken.com>

	* longlines.el (longlines-wrap-region): Avoid marking buffer as
	modified.
	(longlines-auto-wrap, longlines-window-change-function):
	Remove unnecessary calls to set-buffer-modified-p.

2007-07-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-cvs.el (vc-cvs-revert): Use vc-default-revert.
	(vc-cvs-checkout): Remove last arg now unused; simplify.

2007-07-08  Michael Albinus  <michael.albinus@gmx.de>

	* files.el (file-remote-p): Introduce optional parameter CONNECTED.

	* net/tramp.el:
	* net/tramp-ftp.el:
	* net/tramp-smb.el:
	* net/tramp-uu.el:
	* net/trampver.el: Migrate to Tramp 2.1.

	* net/tramp-cache.el:
	* net/tramp-fish.el:
	* net/tramp-gw.el: New Tramp packages.

	* net/tramp-util.el:
	* net/tramp-vc.el: Removed.

	* net/ange-ftp.el: Add ange-ftp property to 'start-file-process.
	(ange-ftp-file-remote-p): Handle optional parameter CONNECTED.

	* net/rcompile.el (remote-compile): Handle Tramp 2.1 arguments.

	* progmodes/compile.el (compilation-start): Redefine
	`start-process' temporarily when `default-directory' is remote.
	Remove case of synchronous compilation, this won't happen ever.
	(compilation-setup): Make local variable `comint-file-name-prefix'
	for remote compilation.

2007-07-08  Martin Rudalics  <rudalics@gmx.at>

	* novice.el (disabled-command-function): Fit window to buffer to
	make last line visible.
	Reported by Stephen Berman <Stephen.Berman at gmx.net>.

	* mouse.el (mouse-drag-track): Reset transient-mark-mode to nil
	when handling the terminating event.

2007-07-07  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc.el (math-read-number-simple): Remove leading 0s.
	(math-bignum-digit-length): Change to optimal value.

	* calc/calc-bin.el (math-bignum-logb-digit-size)
	(math-bignum-digit-power-of-two): Evaluate when compiled.

	* calc/calc-comb.el (math-small-factorial-table)
	(math-init-random-base, math-prime-test): Remove unnecessary calls
	to `math-read-number-simple'.

	* calc/calc-ext.el (math-approx-pi, math-approx-sqrt-e)
	(math-approx-gamma-const): Add docstrings.

	* calc/calc-forms.el (math-julian-date-beginning)
	(math-julian-date-beginning-int): New constants.
	(math-format-date-part, math-parse-standard-date, calcFunc-julian):
	Use the new constants.

	* calc/calc-funcs.el (math-gammap1-raw): Add docstring.

	* calc/calc-math.el (math-approx-ln-10, math-approx-ln-2):
	Add docstrings.

2007-07-07  Tom Tromey  <tromey@redhat.com>

	* vc.el (vc-annotate): Jump to line and output message only after the
	process is really all done.

2007-07-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc.el (vc-exec-after): Don't move point from the sentinel.
	Forcefully read all the remaining text in the pipe upon process exit.
	(vc-annotate-display-autoscale, vc-annotate-lines):
	Don't stop at the first unrecognized line.
	(vc-annotate-display-select): Run autoscale after the process is done
	since it depends on the whole result.

2007-07-07  Eli Zaretskii  <eliz@gnu.org>

	* term/w32-win.el (menu-bar-open): New function.
	Bind <f10> to it.

2007-07-07  Michael Albinus  <michael.albinus@gmx.de>

	* simple.el (start-file-process): New defun.

2007-07-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* files.el (find-file-confirm-nonexistent-file): Rename from
	find-file-confirm-inexistent-file.  Update users.

	* emacs-lisp/autoload.el (autoload-find-destination): Understand a new
	format of autoload block where the file's time-stamp is replaced by its
	MD5 checksum.
	(autoload-generate-file-autoloads): Use MD5 checksum instead of
	time-stamp for secondary autoloads files.
	(update-directory-autoloads): Remove duplicate entries.
	Use time-less-p for time-stamps, as done in autoload-find-destination.

2007-07-07  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc.el (math-read-number): Replace number by variable.
	(math-read-number-simple): Properly parse small integers.

2007-07-07  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc.el: Fix doc for the checkout function.

2007-07-06  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-hg.el (vc-hg-root): New function.
	(vc-hg-registered): Use it.
	(vc-hg-diff-tree): New defalias.
	(vc-hg-responsible-p): Likewise.
	(vc-hg-checkout): Comment out, not needed.
	(vc-hg-delete-file, vc-hg-rename-file, vc-hg-could-register)
	(vc-hg-find-version, vc-hg-next-version): New functions.

2007-07-06  Andreas Schwab  <schwab@suse.de>

	* emacs-lisp/lisp-mode.el (eval-last-sexp): Avoid introducing any
	dynamic bindings around the evaluation of the expression.
	Reported by Jay Belanger <jay.p.belanger@gmail.com>.

2007-07-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* autorevert.el (auto-revert-tail-handler): Use inhibit-read-only.
	Run before-revert-hook.  Suggested by Denis Bueno <denbuen@sandia.gov>.
	Use run-hooks rather than run-mode-hooks.

2007-07-05  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-comb.el (math-random-digit): Rename to
	`math-random-three-digit-number'.
	(math-random-digits): Don't depend on representation of integer.

	* calc/calc-bin.el (math-bignum-logb-digit-size)
	(math-bignum-digit-power-of-two): New constants.
	(math-and-bignum, math-or-bignum, math-xor-bignum, math-diff-bignum)
	(math-not-bignum, math-clip-bignum): Use the constants
	`math-bignum-digit-power-of-two' and `math-bignum-logb-digit-size'
	instead of their values.
	(math-clip): Use math-small-integer-size instead of its value.

	* calc/calc.el (math-add-bignum): Replace number by constant.

2007-07-05  Chong Yidong  <cyd@stupidchicken.com>

	* wid-edit.el (widget-documentation-string-value-create):
	Insert indentation spaces.

2007-07-05  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* emacs-lisp/byte-opt.el: Revert last change.

2007-07-05  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-hooks.el (vc-handled-backends): Add HG.

	* vc-hg.el (vc-handled-backends): Remove, done in vc-hooks.el now.

2007-07-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	* complete.el (PC-do-complete-and-exit): Add support for the new
	`confirm-only' confirmation mode.

2007-07-05  Chong Yidong  <cyd@stupidchicken.com>

	* cus-edit.el (custom-commands): New variable.
	(custom-tool-bar-map): New variable.  Initialize using
	`custom-commands'.
	(custom-mode): Use `custom-tool-bar-map'.
	(custom-buffer-create-internal): Insert action buttons only if
	tool bar is not used.  Use `custom-commands'.
	(Custom-help, custom-command-apply): New function.
	(custom-command-apply, Custom-set, Custom-save)
	(Custom-reset-current, Custom-reset-saved, Custom-reset-standard):
	Use `custom-command-apply' instead of duplicating code.
	(customize-group-other-window): Call `customize-group' instead of
	duplicating code.
	(customize-face-other-window): Call `customize-face' instead of
	duplicating code.
	(customize-group, customize-face): Add optional args for opening
	in another window.
	(custom-variable-tag): Don't inherit `variable-pitch' face.
	(custom-group-tag): Inherit `variable-pitch' face.
	(custom-variable-value-create): Set documentation indentation.
	(custom-group-value-create): Make group name a link, instead of
	using an extra "go to group" button.
	(custom-prompt-variable, custom-group-set, custom-group-save)
	(custom-group-reset-current, custom-group-reset-saved)
	(custom-group-reset-standard): Minor cleanup.

2007-07-05  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* Makefile.in (bootstrap-prepare): When copying from
	ldefs-boot.el, make sure loaddefs.el is writable.

	(bootstrap-prepare): Make $(lisp)/ps-print.el
	and $(lisp)/emacs-lisp/cl-loaddefs.el writable, as well.

2007-07-05  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-hg.el (vc-hg-internal-status): Inline in `vc-hg-state', the
	only caller, and delete.
	(vc-hg-state): Deal with exceptions and only parse the output on
	successful return.
	(vc-hg-internal-log): Inline in `vc-hg-workfile-version', the only
	caller, and delete.
	(vc-hg-workfile-version): Deal with exceptions and only parse the
	output on successful return.
	(vc-hg-revert): New function.

2007-07-04  Jay Belanger  <jay.p.belanger@gmail.com>

	* calculator.el (calculator-expt): Use more cases to determine
	the value.

2007-07-03  Dan Nicolaescu  <dann@ics.uci.edu>

	* progmodes/gud.el (auto-mode-alist): Match more valid gdb init
	file names.

2007-07-03  Jay Belanger  <jay.p.belanger@gmail.com>

	* calculator.el (calculator-expt, calculator-integer-p):
	New functions.
	(calculator-fact): Check to see if the factorial will be too
	large before computing it.
	(calculator-initial-operators): Use `calculator-expt' to
	compute "^".
	(calculator-mode): Mention that results which are too large
	will return inf.
	* calc/calc-comb.el (math-small-factorial-table): Replace list
	by vector.

2007-07-03  David Kastrup  <dak@gnu.org>

	* shell.el: On request of the authors, remove their addresses for
	the sake of bug reports, and add the developer list address as
	maintainer information.

2007-07-03  Richard Stallman  <rms@gnu.org>

	* files.el (make-directory): Doc fix.
	(find-file-confirm-inexistent-file): Make it a defcustom.
	Make nil the default.

2007-07-02  Richard Stallman  <rms@gnu.org>

	* startup.el (command-line): Set buffer-offer-save in *scratch*
	and enable auto-save in it.

2007-07-02  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el (orgstruct-mode-map): New variable.
	(orgstruct-mode): New minor mode.
	(turn-on-orgstruct, orgstruct-error, orgstruct-setup)
	(orgstruct-make-binding, org-context-p, org-get-local-variables)
	(org-run-like-in-org-mode): New functions.
	(org-cycle-list-bullet): New command.
	(org-special-properties, org-property-start-re)
	(org-property-end-re): New constants.
	(org-with-point-at): New macro.
	(org-get-property-block, org-entry-properties, org-entry-get)
	(org-entry-delete, org-entry-get-with-inheritance)
	(org-entry-put, org-buffer-property-keys): New functions.
	(org-insert-property-drawer): New command.
	(org-entry-property-inherited-from): New variable.
	(org-column): New face.
	(org-column-overlays, org-current-columns-fmt)
	(org-current-columns-maxwidths, org-column-map): New variables.
	(org-column-menu): New menu.
	(org-new-column-overlay, org-overlay-columns)
	(org-overlay-columns-title, org-remove-column-overlays)
	(org-column-show-value, org-column-quit, org-column-edit):
	New functions.
	(org-columns, org-agenda-columns): New commands.
	(org-get-columns-autowidth-alist): New functions.
	(org-properties): New customize group.
	(org-default-columns-format): New option.
	(org-priority): Realign tags after changing priority.
	(org-preserve-lc): New macro.
	(org-update-checkbox-count): Catch case when there is no headline.
	(org-agenda-quit): Remove any column overlays.
	(org-beginning-of-item-list): Fixed bug when non-item line is
	indented too deep.
	(org-cached-props): New variable.
	(org-cached-entry-get): New function.
	(org-make-tags-matcher): Handle property matches.
	(org-table-recalculate): Swap evaluation order: Field formula
	first, then column formulas, but don't allow them to overwrite the
	field formulas.
	(org-table-eval-formula): New argument untouchable.
	(org-table-put-field-property): New function.

2007-07-02  Martin Rudalics  <rudalics@gmx.at>

	* help-mode.el (help-make-xrefs): Skip spaces too when
	skipping tabs.

	* ffap.el (dired-at-point-prompter): Improve prompt in
	list-directory case.

2007-07-01  Richard Stallman  <rms@gnu.org>

	* files.el (find-file-visit-truename): Fix safe-local-variable value.

2007-07-01  Richard Stallman  <rms@gnu.org>

	* cus-start.el (max-mini-window-height): Added.

2007-07-01  Sean O'Rourke  <sorourke@cs.ucsd.edu>  (tiny change)

	* complete.el (partial-completion-mode): Remove advice of
	read-file-name-internal.
	(PC-do-completion): Rebind minibuffer-completion-table.
	(PC-read-file-name-internal): New function doing what
	read-file-name-internal advice did.

2007-07-01  Paul Pogonyshev  <pogonyshev@gmx.net>

	* emacs-lisp/byte-opt.el: Set `binding-is-magic'
	property on a few symbols.
	(byte-compile-side-effect-free-dynamically-safe-ops): New defconst.
	(byte-optimize-lapcode): Remove bindings that are not referenced
	and certainly will not effect through dynamic scoping.

2007-07-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* files.el (find-file-confirm-inexistent-file): New var.
	(find-file, find-file-other-window, find-file-other-frame)
	(find-file-read-only, find-file-read-only-other-window)
	(find-file-read-only-other-frame): Use it.

2007-06-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/rx.el (rx-constituents): Fix up `anything'.

2007-06-29  Juanma Barranquero  <lekktu@gmail.com>

	* generic-x.el (generic-define-mswindows-modes)
	(generic-define-unix-modes, apache-log-generic-mode)
	(bat-generic-mode-keymap, java-manifest-generic-mode)
	(show-tabs-generic-mode): Fix typos in docstrings.

2007-06-29  Ryan Yeske  <rcyeske@gmail.com>

	* net/rcirc.el (rcirc-server-alist): Rename from rcirc-connections.
	(rcirc-default-full-name): Rename from rcirc-default-user-full-name.
	(rcirc-clear-activity): Make sure RCIRC-ACTIVITY isn't modified.
	(rcirc-print): Never ignore messages from ourself.

2007-06-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* font-lock.el (lisp-font-lock-keywords-2): Recognize the new \(?1:..\)
	syntax as well.  Reported by Juri Linkov <juri@jurta.org>.

2007-06-28  Jan Djärv  <jan.h.d@swipnet.se>

	* dnd.el (dnd-get-local-file-name): Set fixcase to t in call to
	replace-regexp-in-string.

2007-06-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl.el: Set edebug and indentation before loading
	cl-loaddefs.el so that its use of dolist doesn't load cl-macs.

2007-06-28  Andreas Schwab  <schwab@suse.de>

	* Makefile.in ($(lisp)/mh-e/mh-loaddefs.el): Depend on
	$(lisp)/subdirs.el.

2007-06-28  Juanma Barranquero  <lekktu@gmail.com>

	* speedbar.el (speedbar-handle-delete-frame): Don't try to delete
	the speedbar frame if nil; that deletes the current frame or
	causes an error if it is the only frame.
	Reported by Angelo Graziosi <Angelo.Graziosi@roma1.infn.it>.

2007-06-28  Kevin Ryde  <user42@zip.com.au>

	* textmodes/nroff-mode.el: Groff \# comments.
	(nroff-mode-syntax-table): \# comment intro,
	plain # as punct per global table.
	(nroff-font-lock-keywords): Add # as a single char escape.
	(nroff-mode): In comment-start-skip, match \#.

2007-06-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-bzr.el (vc-functions): Clear up the cache when reloading the file.
	(vc-bzr-workfile-version, vc-bzr-could-register): Don't hardcode
	point-min == 1.

2007-06-28  Nick Roberts  <nickrob@snap.net.nz>

	* pcvs-util.el (cvs-strings->string, cvs-string->strings):
	Rename and move to...

	* subr.el (strings->string, string->strings): ...here.

	* pcvs.el (cvs-reread-cvsrc, cvs-header-msg, cvs-checkout)
	(cvs-mode-checkout, cvs-execute-single-file): Use new function names.

	* progmodes/gud.el (gud-common-init): Call string->strings instead
	of split-string.

2007-06-27  Michael Albinus  <michael.albinus@gmx.de>

	* dired-aux.el: Remove `dired-call-process'.
	(dired-check-process): Call `process-file'.

	* wdired.el (wdired-do-perm-changes): Call `process-file'.

	* net/ange-ftp.el (ange-ftp-dired-call-process): Reimplement it as
	`ange-ftp-process-file'.

2007-06-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/cl.el: Use cl-loaddefs.el rather than manual autoloads.

	* emacs-lisp/cl-extra.el:
	* emacs-lisp/cl-seq.el:
	* emacs-lisp/cl-macs.el: Set generated-autoload-file to cl-loaddefs.el.
	Add autoload cookies on all defs autoloaded manually in cl.el.

	* emacs-lisp/cl-loaddefs.el: New file.

	* textmodes/texinfmt.el (texinfo-raisesections-alist)
	(texinfo-lowersections-alist): Merge definition and declaration.
	(texinfo-start-of-header, texinfo-end-of-header): Remove.
	(texinfo-format-syntax-table): Merge init into declaration.
	(texinfo-format-parse-line-args, texinfo-format-parse-args)
	(texinfo-format-parse-defun-args, texinfo-format-node)
	(texinfo-push-stack, texinfo-multitable-widths)
	(texinfo-define-info-enclosure, texinfo-alias)
	(texinfo-format-defindex, batch-texinfo-format): Use push.
	(texinfo-footnote-number): Remove duplicate declaration.

	* ps-print.el: Update with auto-generated autoloads.

	* ps-mule.el: Set generated-autoload-file to "ps-print.el".

2007-06-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/autoload.el (autoload-generated-file): Interpret names
	relative to current dir for file-local settings.
	(autoload-generate-file-autoloads): Add `outfile' arg.
	(update-directory-autoloads): Use it to directly call
	autoload-generate-file-autoloads instead of going through
	update-file-autoloads so we avoid redundant searches and so we can know
	the set of buffers changed so we can save them all.

	* emacs-lisp/autoload.el (autoload-find-destination): Return nil
	rather than throwing `up-to-date'.
	(autoload-generate-file-autoloads): Adjust correspondingly.
	(update-file-autoloads): Be careful to let-bind
	autoload-modified-buffers and adjust to new calling conventions.
	(autoload-modified-buffers): Make it a dynamically scoped var.
	(update-directory-autoloads): Use file-relative-name instead of
	autoload-trim-file-name.
	(autoload-insert-section-header): Don't use autoload-trim-file-name
	since the file is already relative now.
	(autoload-trim-file-name): Remove.

	* vc-arch.el (vc-arch-add-tagline): Do a slightly cleaner job.
	(vc-arch-complete, vc-arch--version-completion-table)
	(vc-arch-revision-completion-table): New functions to provide
	completion of revision names.
	(vc-arch-trim-find-least-useful-rev, vc-arch-trim-make-sentinel)
	(vc-arch-trim-one-revlib, vc-arch-trim-revlib): New functions
	to let the user trim the revlib.

	* vc.el: Add new VC operation `revision-completion-table'.
	(vc-default-revision-completion-table): New function.
	(vc-version-diff, vc-version-other-window): Use it to provide
	completion of revision names if the backend provides it.

	* log-edit.el (log-edit-changelog-entries): Use with-current-buffer.

	* vc-svn.el (vc-svn-repository-hostname): Adjust to non-XML format
	of newer .svn/entries.

2007-06-25  David Kastrup  <dak@gnu.org>

	* calc/calc-poly.el (math-padded-polynomial)
	(math-partial-fractions): Add some function comments.

2007-06-25  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/autoload.el (autoload-generate-file-autoloads):
	Make `outbuf' optional.
	(update-file-autoloads): Use it.

2007-06-25  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/autoload.el (autoload-modified-buffers): New var.
	(autoload-find-destination): Keep it uptodate.
	(autoload-save-buffers): New fun.
	(update-file-autoloads): Use it.  Re-add the "up to date" message.

	* emacs-lisp/autoload.el: Refactor for upcoming changes.
	(autoload-find-destination): New function extracted from
	update-file-autoloads.
	(update-file-autoloads): Use it.
	(autoload-generate-file-autoloads): New function extracted from
	generate-file-autoloads.  Use file-relative-name.  Delay computation of
	output-start to the first cookie.  Remove done-any, replaced by
	output-start.
	(generate-file-autoloads): Use it.

2007-06-24  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-comb.el (math-init-random-base, math-prime-test):
	Use math-read-number-simple to insert constants.
	(math-prime-test): Redo calculation of sum.

	* calc/calc-misc.el (math-div2-bignum): Use math-bignum-digit-size.

	* calc/calc-math.el (math-scale-bignum-digit-size): Rename from
	math-scale-bignum-3.
	(math-isqrt-bignum): Use math-scale-bignum-digit-size and
	math-bignum-digit-size.
	(math-isqrt-small): Add another possible initial guess.

2007-06-23  Roland Winkler  <Roland.Winkler@physik.uni-erlangen.de>

	* textmodes/bibtex.el (bibtex-entry-format): New options
	`whitespace', `braces', and `string'.
	(bibtex-field-braces-alist, bibtex-field-strings-alist)
	(bibtex-field-braces-opt, bibtex-field-strings-opt)
	(bibtex-cite-matcher-alist): New variables.
	(bibtex-font-lock-keywords): Use bibtex-cite-matcher-alist.
	(bibtex-flash-head): Use blink-matching-delay.
	(bibtex-insert-kill, bibtex-mark-entry): Use push-mark.
	(bibtex-format-entry, bibtex-reformat): Handle new options of
	bibtex-entry-format.
	(bibtex-field-re-init, bibtex-font-lock-cite, bibtex-dist):
	New functions.
	(bibtex-complete-internal): Do not display messages while
	minibuffer is used.  Do not leave around a completions buffer
	that is out of date.
	(bibtex-copy-summary-as-kill): New optional arg.
	(bibtex-font-lock-url): New optional arg no-button.
	(bibtex-find-crossref): Use `bibtex-cite-matcher-alist'.
	(bibtex-url): Allow multiple URLs per entry.

2007-06-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/autoload.el (autoload-generated-file): New function.
	(update-file-autoloads, update-directory-autoloads): Use it.
	(autoload-file-load-name): New function.
	(generate-file-autoloads, update-file-autoloads): Use it.
	(autoload-find-file): Accept non-absolute argument.  Set default-dir.
	(generate-file-autoloads): If the autoloaded form is malformed,
	indicate the problem with a warning instead of aborting.

2007-06-23  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* simple.el (next-error-recenter): Accept `(4)' as well;
	also, specify `integer' instead of `number'.

2007-06-23  Eli Zaretskii  <eliz@gnu.org>

	* ls-lisp.el (insert-directory): If an invalid regexp error is
	thrown, try using FILE as a literal file name, not a wildcard.

2007-06-23  Juanma Barranquero  <lekktu@gmail.com>

	* ruler-mode.el (ruler-mode): Prevent clobbering the original
	`header-line-format' when reentering ruler mode.

2007-06-23  Eli Zaretskii  <eliz@gnu.org>

	* ls-lisp.el (insert-directory): Don't treat FILE as a wildcard if
	FILE exists as a file.

2007-06-22  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc.el (math-bignum-digit-length)
	(math-bignum-digit-size, math-small-integer-size):
	New constants.
	(math-normalize, math-bignum-big, math-make-float)
	(math-div10-bignum, math-scale-left, math-scale-left-bignum)
	(math-scale-right, math-scale-right-bignum, math-scale-rounding)
	(math-add, math-add-bignum, math-sub-bignum, math-sub, math-mul)
	(math-mul-bignum, math-mul-bignum-digit, math-idivmod)
	(math-quotient, math-div-bignum, math-div-bignum-digit)
	(math-div-bignum-part, math-format-bignum-decimal)
	(math-read-bignum): Use math-bignum-digit-length,
	math-bignum-digit-size and math-small-integer-size.

	* calc/calc-ext.el (math-fixnum-big): Use the variable
	math-bignum-digit-size.

2007-06-23  Dan Nicolaescu  <dann@ics.uci.edu>

	* log-view.el (log-view-mode-menu): New menu.

2007-06-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* diff-mode.el (diff-font-lock-keywords): Fix M. Kifer's last change
	differently.

	* vc-hg.el (vc-hg-registered): Add an autoloaded version.
	(vc-hg-log-view-mode): Use log-view-font-lock-keywords.

2007-06-22  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-hg.el (vc-hg-print-log): Insert the file name.
	(vc-hg-log-view-mode): Fontify the file name.

2007-06-22  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-forms.el (math-format-date-part, calc-parse-standard-date)
	(calcFunc-julian): Fix incorrect number used in calculations.

2007-06-22  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* simple.el (next-error-recenter): New defcustom.
	(next-error, next-error-internal): Recenter if specified,
	immediately prior to running `next-error-hook'.

	* progmodes/hideshow.el (hs-show-block): Use line-end-position.
	(hs-hide-block-at-point, hs-hide-comment-region): Likewise.

	* progmodes/hideshow.el (hs-hide-all): Use progress reporter.

2007-06-22  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc-comb.el (math-small-factorial-table): New variable.
	(calcFunc-fact): Use `math-small-factorial-table'.

	* calc/calc-ext.el (math-defcache): Allow forms to evaluate
	initial values.
	(math-approx-pi, math-approx-sqrt-e, math-approx-gamma-const):
	New variables to use in caches.

	* calc/calc-forms.el (math-format-date-part, math-parse-standard-date)
	(calcFunc-julian): Use `math-read-number-simple' to insert bignums.

	* calc/calc-funcs.el (math-besJ0, math-besJ1, math-besY0, math-besY1)
	(math-bernoulli-b-cache): Use math-read-number-simple to insert
	bignums.

	* calc/calc-math.el (math-approx-ln-10, math-approx-ln-2):
	New variables to use in caches.

2007-06-22  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-bzr.el (vc-bzr-log-view-mode): Add + to the email address regexp.

	* vc-hg.el (vc-hg-log-view-mode): New mode.

2007-06-21  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc.el (math-read-number-simple): New function.

2007-06-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/vera-mode.el (vera-mode): Fix `comment-end-skip' setting.
	(vera-font-lock-match-item): Fix doc string.
	(vera-in-comment-p): Remove unused function.
	(vera-skip-forward-literal, vera-skip-backward-literal): Improve code,
	use `syntax-ppss'.
	(vera-forward-syntactic-ws): Fix argument order.
	(vera-prepare-search): Use `with-syntax-table'.
	(vera-indent-line): Fix doc string.
	(vera-electric-tab): Fix doc string.
	(vera-expand-abbrev): Define alias instead of using `fset'.
	(vera-comment-uncomment-region): Use `comment-start-skip'.

2007-06-21  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el (org-export-with-footnotes): New option.
	(org-export-as-html): Fix replacement bug for XEmacs.
	(org-agenda-default-appointment-duration): New option.

2007-06-21  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-hg.el: Add to do items.
	(vc-hg-diff): Add support for comparing different revisions.
	(vc-hg-diff, vc-hg-annotate-command, vc-hg-annotate-time)
	(vc-hg-annotate-extract-revision-at-line)
	(vc-hg-previous-version, vc-hg-checkin): New functions.
	(vc-hg-annotate-re): New constant.

2007-06-20  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc.el (math-standard-ops): Fix precedence of multiplication.

2007-06-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* log-view.el (log-view-font-lock-keywords): Use `eval' to consult the
	buffer-local value of log-view-*-re if applicable.

	* vc-bzr.el (vc-bzr-dir-state): Use setq rather than set.
	Use vc-bzr-command rather than the ill defined vc-bzr-command*.
	(vc-bzr-command*): Remove both (incompatible) versions.
	(vc-bzr-do-command*): Remove.
	(vc-bzr-with-process-environment, vc-bzr-std-process-invocation):
	Remove by folding into its only caller vc-bzr-command.
	(vc-bzr-command): Always set the environment, even when ineffective.
	(vc-bzr-version): Minor fix up.
	(vc-bzr-admin-dirname): New var.
	(vc-bzr-bzr-dir): Remove.
	(vc-bzr-root-dir): New fun.
	(vc-bzr-registered): Use it.  Add an autoloaded version.
	(vc-bzr-responsible-p): Use vc-bzr-root-dir as well.
	(vc-bzr-view-log-function): Remove.
	(vc-bzr-log-view-mode): New major mode to replace it.
	(vc-bzr-print-log): Only activate the old hack if needed.

	* vc.el (vc-default-log-view-mode): New function.
	(vc-print-log): Add new `log-view-mode' VC operation.

2007-06-20  Juanma Barranquero  <lekktu@gmail.com>

	* ido.el (ido-find-file-in-dir): Don't signal an error for
	empty directories.

	* add-log.el (change-log-mode): Set `show-trailing-whitespace'.

	* desktop.el (desktop-read): Run `desktop-not-loaded-hook' in the
	directory where the desktop file was found, as the docstring says.
	(desktop-kill): Use `read-directory-name'.

2007-06-20  Alan Mackenzie  <acm@muc.de>

	* progmodes/cc-mode.el (c-remove-any-local-eval-or-mode-variables):
	When removing lines, also remove the \n.  Correction of patch of
	2007-04-21.

2007-06-20  Martin Rudalics  <rudalics@gmx.at>

	* mouse.el (mouse-drag-mode-line-1): Quit mouse tracking when
	event is not a cons cell.  Do not unread drag-mouse-1 events.
	Select right window in check whether space was stolen from
	window above.

	* help-mode.el (help-make-xrefs): Adjust position of new forward
	button.

2007-06-20  Riccardo Murri  <riccardo.murri@gmail.com>

	* vc-bzr.el (vc-bzr-with-process-environment)
	(vc-bzr-std-process-invocation): New macros.
	(vc-bzr-command, vc-bzr-command*): Use them.
	(vc-bzr-with-c-locale): Remove.
	(vc-bzr-dir-state): Replace its use with vc-bzr-command.
	(vc-bzr-buffer-nonblank-p): New function.
	(vc-bzr-state-words): New const.
	(vc-bzr-state): Look for `bzr status' keywords in output.
	Display everything else as a warning message to the user.
	Fix status report with bzr >= 0.15.

2007-06-20  Dan Nicolaescu  <dann@ics.uci.edu>

	* vc-hg.el (vc-hg-global-switches): Simplify.
	(vc-hg-state): Handle more states.
	(vc-hg-diff): Fix doc-string.
	(vc-hg-register): New function.
	(vc-hg-checkout): Likewise.

2007-06-20  Reto Zimmermann  <reto@gnu.org>

	* progmodes/vera-mode.el: New file.

2007-06-19  Jay Belanger  <jay.p.belanger@gmail.com>

	* calc/calc.el (calc-multiplication-has-precedence):
	New variable.
	(math-standard-ops, math-standard-ops-p, math-expr-ops):
	New functions.
	(math-expr-opers): Define using math-standard-ops rather than
	math-standard-opers.
	* calc/calc-aent.el (calc-do-calc-eval): Let math-expr-opers
	equal the function math-standard-ops rather than the variable
	math-standard-opers.
	(calc-algebraic-entry): Let math-expr-opers equal
	math-standard-ops or math-expr-ops, as appropriate.
	(math-expr-read-level, math-read-factor): Let math-expr-opers
	equal math-expr-ops.
	* calc/calc-embed.el (calc-embedded-finish-edit):
	Let math-expr-opers equal the function math-standard-ops
	rather than the variable math-standard-opers.
	* calc/calc-ext.el (math-read-plain-expr)
	(math-format-flat-expr-fancy): Let math-expr-opers equal the
	function math-standard-ops rather than the variable
	math-standard-opers.
	* calc/calc-lang.el (calc-set-language, math-read-big-rec):
	Let math-expr-opers equal the function math-standard-ops rather
	than the variable math-standard-opers.
	* calc/calc-prog.el (calc-read-parse-table): Let math-expr-opers
	equal the function math-standard-ops rather than the variable
	math-standard-opers.
	* calc/calc-yank.el (calc-finish-stack-edit): Let math-expr-opers
	equal the function math-standard-ops rather than the variable
	math-standard-opers.
	* calc/calccomp.el (math-compose-expr): Let math-expr-opers equal
	math-expr-ops.

2007-06-19  Ivan Kanis  <apple@kanis.eu>

	* vc-hg.el: New file.

2007-06-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/sh-script.el (sh-font-lock-paren): Mark the relevant text
	with font-lock-multiline.

2007-06-17  Glenn Morris  <rgm@gnu.org>

	* lpr.el (lpr-page-header-switches): Move %s to separate element
	for correct quoting.  Doc fix.

2007-06-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/sgml-mode.el (sgml-xml-guess): Return the result rather
	than setting sgml-xml-mode.
	(sgml-mode, html-mode): Set sgml-xml-mode.
	(sgml-skip-tag-backward): Tell if we skipped over matched tags.
	(sgml-skip-tag-backward, sgml-electric-tag-pair-overlays): New var.
	(sgml-electric-tag-pair-before-change-function)
	(sgml-electric-tag-pair-flush-overlays): New functions.
	(sgml-electric-tag-pair-mode): New minor mode.
	(sgml-font-lock-keywords-2, sgml-get-context, sgml-unclosed-tag-p)
	(sgml-calculate-indent): Use assoc-string.

2007-06-16  Karl Fogel  <kfogel@red-bean.com>

	* thingatpt.el (thing-at-point-email-regexp): Don't require two
	chars before the "@" in an email address.  Andreas Roehler noticed
	this problem.

2007-06-15  Karl Fogel  <kfogel@red-bean.com>

	* thingatpt.el: Add support for email addresses (`email').
	(thing-at-point, bounds-of-thing-at-point): Document `email' support.
	(thing-at-point-email-regexp): New variable.
	(`email'): Put `bounds-of-thing-at-point' and `thing-at-point'
	properties on this symbol, with lambda forms for values.

2007-06-15  Masatake YAMATO  <jet@gyve.org>

	* vc-bzr.el (vc-bzr-root): Cache the output of shell command execution.

	* vc.el (vc-dired-hook): Check the backend returned from
	`vc-responsible-backend' can really handle `subdir'.

2007-06-15  Chong Yidong  <cyd@stupidchicken.com>

	* wid-edit.el (widget-add-documentation-string-button):
	Fix handling of documentation indent.

2007-06-15  Miles Bader  <miles@fencepost.gnu.org>

	* mb-depth.el: New file.

2007-06-15  Masatake YAMATO  <jet@gyve.org>

	* vc.el (vc-dired-mode): Show backend name as part of mode name.

2007-06-14  Chong Yidong  <cyd@stupidchicken.com>

	* wid-edit.el (widget-default-create): Move ?h handling here...
	(widget-default-format-handler): ...from here.
	(widget-docstring, widget-add-documentation-string-button): New funs.
	(documentation-string): Add :visibility-widget property.
	(widget-documentation-string-value-create): Use it.

	* cus-edit.el (custom-split-regexp-maybe): Simplify.
	(custom-buffer-create-internal): Simplify message.
	(custom-variable-tag): Reduce height to normal.
	(custom-variable-value-create, custom-face-value-create)
	(custom-visibility): New widget.
	(custom-visibility): New face.
	(custom-group-value-create):
	Call widget-add-documentation-string-button, using `custom-visibility'.

2007-06-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/bytecomp.el (byte-compile-current-group)
	(byte-compile-nogroup-warn, byte-compile-file): Revert part of last
	change.  Apparently the "warning even if the group is implicit" is
	a feature rather than a bug.

2007-06-14  Michael Kifer  <kifer@cs.stonybrook.edu>

	* emulation/viper.el (viper-describe-key-ad)
	(viper-describe-key-briefly-ad): Different advices for Emacs and XEmacs.
	Compile them conditionally.
	(viper-version): Belated version change.

2007-06-14  Juanma Barranquero  <lekktu@gmail.com>

	* follow.el (follow-all-followers, follow-generic-filter):
	* pcomplete.el (pcomplete-restore-windows):
	* x-dnd.el (x-dnd-maybe-call-test-function, x-dnd-save-state)
	(x-dnd-drop-data):
	* emacs-lisp/edebug.el (edebug-pop-to-buffer, edebug-display):
	* progmodes/python.el (python-complete-symbol):
	* term/mac-win.el (mac-dnd-drop-data): Remove redundant check.

2007-06-13  Ryan Yeske  <rcyeske@gmail.com>

	* net/rcirc.el (rcirc-format-response-string): Use rcirc-nick-syntax
	around bright and dim regexps.  Make sure bright and dim matches
	use word anchors.  Send text through rcirc-markup functions.
	(rcirc-url-regexp): Add single quote character.
	(rcirc-connect): Write logs to disk on auto-save-hook.
	Make server a non-optional argument.
	(rcirc-log-alist): New variable.
	(rcirc-log-directory): Make customizable.
	(rcirc-log-flag): New customizable variable.
	(rcirc-log): New function.
	(rcirc-print): Use above function.
	(rcirc-log-write): New function.
	(rcirc-generate-new-buffer-name): Strip text properties.
	(rcirc-switch-to-buffer-function): Remove variable.
	(rcirc-last-non-irc-buffer): Remove variable.
	(rcirc-non-irc-buffer): Add function.
	(rcirc-next-active-buffer): Use above function.
	(rcirc-keepalive): Send KEEPALIVE ctcp instead of a PING.
	(rcirc-handler-ctcp-KEEPALIVE): Add handler.
	(rcirc-handler-CTCP): Don't print KEEPALIVE responses.
	(rcirc-omit-mode): Add minor-mode.
	(rcirc-mode-map): Change C-c C-o binding.
	(rcirc-mode): Clear mode-line-process.  Use a custom
	fill-paragraph-function.  Set up buffer-invisibility-spec.
	(rcirc-response-formats): Remove timestamp code.
	(rcirc-omit-responses): Add variable.
	(rcirc-print): Don't put the overlay arrow on potentially omitted
	lines.  Log line to disk.  Record activity for private messages
	from /dim nicks.  Facify the fill-prefix with rcirc-timestamp face.
	(rcirc-jump-to-first-unread-line): Print message if there is no
	unread text.
	(rcirc-clear-unread): New function.
	(rcirc-markup-text-functions): Add variable.
	(rcirc-markup-timestamp, rcirc-markup-fill): Add functions.
	(rcirc-debug): Don't mess with window configuration.
	(rcirc-send-message): Send message before printing locally.
	Add SILENT argument, do not print message if non-nil.
	(rcirc-visible-buffers): New function and variable.
	(rcirc-window-configuration-change-1): Add function.
	(rcirc-target-buffer): Make sure ACTIONs don't get sent to the
	server buffer.
	(rcirc-clean-up-buffer): Set rcirc-target to nil when finished.
	(rcirc-fill-paragraph): Add function.
	(rcirc-record-activity, rcirc-window-configuration-change-1):
	Only update the activity string if it has actually changed.
	(rcirc-update-activity-string): Remove padding characters from the
	mode-line string.
	(rcirc-disconnect-buffer): New function to be called when a
	channel is parted or the user quits.
	(rcirc-server-name): Warn when the server-name hasn't been set.
	(rcirc-window-configuration-change): Postpone work until
	post-command-hook.
	(rcirc-window-configuration-change-1): Update mode-line and
	overlay arrows here.
	(rcirc-authenticate): Fix hanserv identification.
	(rcirc-default-server): Remove variable.
	(rcirc): Connect according to rcirc-connections.
	(rcirc-connections): Add variable.
	(rcirc-startup-channels-alist): Remove variable.
	(rcirc-startup-channels): Remove function.

2007-06-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* diff-mode.el (diff-font-lock-keywords): Fix M. Kifer's last change.

2007-06-13  Johan Bockgård  <bojohan@dd.chalmers.se>  (tiny change)

	* term/xterm.el (terminal-init-xterm): Escape parens in character
	constants.

2007-06-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/sh-script.el: Remove unneeded * from docstrings.
	Use [:alpha:] and [:alnum:] where applicable.
	(sh-quoted-subshell): Rewrite to correctly
	handle nested mixes of `...' and $(...).
	(sh-apply-quoted-subshell): Remove.
	(sh-font-lock-syntactic-keywords): Adjust call to sh-quoted-subshell.

	* vc-arch.el (vc-arch-command): Remove bzr.  It's a different program.

2007-06-13  Michael Kifer  <kifer@cs.stonybrook.edu>

	* ediff-ptch.el (ediff-context-diff-label-regexp): Partially undo
	previous change.

2007-06-12  Tom Tromey  <tromey@redhat.com>

	* subr.el (user-emacs-directory): New defconst.
	* cmuscheme.el (scheme-start-file):
	* shell.el (shell):
	* completion.el (save-completions-file-name):
	* custom.el (custom-theme-directory):
	* term/x-win.el (emacs-session-filename):
	* filesets.el (filesets-menu-cache-file):
	* thumbs.el (thumbs-thumbsdir):
	* server.el (server-auth-dir):
	* image-dired.el (image-dired-dir):
	(image-dired-db-file):
	(image-dired-temp-image-file):
	(image-dired-gallery-dir):
	(image-dired-temp-rotate-image-file):
	* play/gamegrid.el (gamegrid-user-score-file-directory):
	* savehist.el (savehist-file):
	* tutorial.el (tutorial--saved-dir):
	* startup.el (auto-save-list-file-prefix): Use user-emacs-directory.

2007-06-12  Ralf Angeli  <angeli@caeruleus.net>

	* scroll-lock.el (scroll-lock-mode): Doc fix.

2007-06-12  Michael Kifer  <kifer@cs.stonybrook.edu>

	* ediff-ptch.el (ediff-context-diff-label-regexp): Spurious parenthesis.

	* ediff-init.el: Doc strings.

2007-06-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/bytecomp.el (byte-compile-current-group): New var.
	(byte-compile-file): Bind it.
	(byte-compile-nogroup-warn): Use it to avoid spurious warnings when the
	group argument is provided implicitly.
	(byte-compile-format-warn, byte-compile-from-buffer)
	(byte-compile-insert-header): Don't hardcode point-min==1.
	(byte-compile-file-form-require): Remove unused var old-load-list.
	(byte-compile-eval): Remove unused vars old-autoloads and hist-nil-new.

2007-06-12  Michael Kifer  <kifer@cs.stonybrook.edu>

	* emulation/viper-cmd.el (viper-prefix-arg-com, viper-prefix-arg-value):
	Display error messages.
	(viper-prev-destructive-command, viper-insert-prev-from-insertion-ring):
	Get rid of cl.el dependencies.

	* emulation/viper-init.el (viper-suppress-input-method-change-message):
	New variable.
	(viper-activate-input-method-action)
	(viper-inactivate-input-method-action):
	Use viper-suppress-input-method-change-message.

	* emulation/viper-keym.el (viper-vi-basic-map): Disable the bindings
	for C-s, C-r.

	* emulation/viper-util.el (viper-set-cursor-color-according-to-state):
	Use viper-replace-overlay-cursor-color instead of
	viper-replace-overlay-cursor-color.
	(viper-sit-for-short): Use sit-for with 3 arguments.

	* emulation/viper.el (viper-insert-state-mode-list): Add gud-mode.
	(viper-major-mode-modifier-list): Add viper-comint-mode-modifier-map
	to gud-mode.

	* ediff-mult.el (ediff-meta-buffer-brief-message)
	(ediff-meta-buffer-verbose-message): New variables.
	(ediff-meta-buffer-message): Variable deleted.
	(ediff-verbose-help-enabled): New variable.
	(ediff-toggle-verbose-help-meta-buffer): New function.
	(ediff-redraw-directory-group-buffer): Made aware of short/verbose
	message options.

	* ediff-ptch.el (ediff-context-diff-label-regexp): Better regexp.
	(ediff-fixup-patch-map): Improve heuristic.

2007-06-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* log-view.el (log-view-file-re, log-view-message-re): Use \(?1:...\).
	(log-view-font-lock-keywords): Simplify.
	(log-view-current-file, log-view-current-tag): Simplify.

2007-06-12  Sam Steingold  <sds@gnu.org>

	* vc-arch.el (vc-arch-command): Also try "baz" and "bzr".

2007-06-12  Juanma Barranquero  <lekktu@gmail.com>

	* desktop.el (desktop-load-locked-desktop): New option.
	(desktop-read): Use it.
	(desktop-truncate, desktop-outvar, desktop-restore-file-buffer):
	Use `when'.

2007-06-12  Davis Herring  <herring@lanl.gov>

	* desktop.el (desktop-save-mode-off): New function.
	(desktop-base-lock-name, desktop-not-loaded-hook): New variables.
	(desktop-full-lock-name, desktop-file-modtime, desktop-owner)
	(desktop-claim-lock, desktop-release-lock): New functions.
	(desktop-kill): Tell `desktop-save' that this is the last save.
	Release the lock afterwards.
	(desktop-buffer-info): New function.
	(desktop-save): Use it.  Run `desktop-save-hook' where the doc
	says to.  Detect conflicts, and manage the lock.
	(desktop-read): Detect conflicts.  Manage the lock.

2007-06-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emulation/tpu-mapper.el (tpu-emacs-map-key): Use new keymap names.

	* emulation/tpu-edt.el (tpu-gold-map): Rename from GOLD-map.
	(tpu-lucid-emacs-p): Remove.  Use (featurep 'xemacs) instead.
	(CSI-map, GOLD-CSI-map, GOLD-SS3-map, SS3-map): Delete vars.
	(tpu-gold-map, tpu-global-map): Add all the SS3 and CSI bindings, using
	keysyms rather than byte sequences.
	(tpu-copy-keyfile): Don't force the user to use tpu-mapper.el.

2007-06-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* font-lock.el (font-lock-add-keywords): In case font-lock was only
	half-activated, forcefully activate it completely.

2007-06-11  Richard Stallman  <rms@gnu.org>

	* cus-edit.el (custom-variable-type): Doc fix.

2007-06-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/sh-script.el (sh-font-lock-backslash-quote)
	(sh-font-lock-flush-syntax-ppss-cache): New functions.
	(sh-font-lock-syntactic-keywords): Use them to distinguish the
	different possible cases for \'.

	* complete.el (PC-bindings): Don't bind things already bound in the
	parent keymap.

	* textmodes/bibtex-style.el: New file.

2007-06-11  Riccardo Murri  <riccardo.murri@gmail.com>

	* vc-bzr.el: New file.

2007-06-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-svn.el (vc-svn-program): New var.
	(vc-svn-command): Use it.

2007-06-11  Juanma Barranquero  <lekktu@gmail.com>

	* server.el (server-switch-buffer): Remove redundant check.

2007-06-10  Martin Rudalics  <rudalics@gmx.at>

	* emacs-lisp/bytecomp.el (byte-compile-find-cl-functions):
	Match against file-name-nondirectory.
	Fix text on user customization variables.
	Reported by Johan Bockgård <bojohan@dd.chalmers.se>.

2007-06-09  Alfred M. Szmidt  <ams@gnu.org>  (tiny change)

	* mail/rmail.el (rmail-movemail-variant-in-use): Fix doc typo.

2007-06-09  Davis Herring  <herring@lanl.gov>

	* desktop.el (desktop-minor-mode-table): Doc fix.

2007-06-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/css-mode.el (css-navigation-syntax-table):
	Use set-char-table-range so it also works in the Unicode branch.

2007-06-08  Nick Roberts  <nickrob@snap.net.nz>

	* help-mode.el (help-xref-forward-stack)
	(help-xref-stack-forward-item, help-forward-label): New variables.
	(help-forward): New button type.
	(help-setup-xref): Initialize help-xref-forward-stack.
	(help-make-xrefs): Add forward button, if appropriate.
	(help-xref-go-back): Push item on forward stack.
	(help-xref-go-forward, help-go-forward): New functions.

2007-06-07  Chong Yidong  <cyd@stupidchicken.com>

	* dired.el (dired-mode-map): Remove spurious separator.

2007-06-07  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/ebrowse.el (ebrowse-draw-file-member-info): Doc fix.

	* progmodes/mixal-mode.el (mixal-operation-codes-alist):
	* progmodes/idlwave.el (idlwave-one-key-select): Fix typo in docstring.

2007-06-07  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el: Version number fixed.

2007-06-07  Glenn Morris  <rgm@gnu.org>

	* version.el (emacs-copyright): New constant.
	* startup.el (fancy-splash-tail): Use emacs-copyright.
	* calc/calc-help.el (calc-full-help): Use emacs-copyright.

	* emacs-lisp/bytecomp.el (byte-compile-warnings): Add new option
	`make-local'.
	(byte-compile-warnings-safe-p): Add `make-local'.
	(byte-compile-make-variable-buffer-local):
	Allow byte-compile-warnings to suppress this warning.

	* tutorial.el (tutorial--describe-nonstandard-key): Adjust for new
	format of "menu" description.
	(tutorial--find-changed-keys): Describe the specific menu a
	command is in.

	* dframe.el (dframe-frame-parameter, dframe-mouse-event-p):
	Rewrite compatibility functions to silence byte-compiler.

2007-06-07  Alfred M. Szmidt  <ams@gnu.org>  (tiny change)

	* mail/rmailsum.el (rmail-summary-save-buffer): New command.
	(rmail-summary-mode-map): Add rmail-summary-save-buffer.

2007-06-07  Eric M. Ludlam  <eric@siege-engine.com>

	* emacs-lisp/checkdoc.el (checkdoc-ispell-lisp-words): Remove "iff".

2007-06-07  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/ebrowse.el (ebrowse-member-table):
	* textmodes/org.el (org-export-ascii-bullets, org-batch-agenda)
	(org-batch-agenda-csv): Fix typos in docstrings.

2007-06-06  Juanma Barranquero  <lekktu@gmail.com>

	* pgg.el (pgg-sign-region, pgg-sign):
	* ses.el (ses-call-printer):
	* calendar/icalendar.el (icalendar--diarytime-to-isotime):
	* textmodes/org.el (org-cycle): Fix typos in docstrings.

2007-06-06  Carsten Dominik  <dominik@science.uva.nl>

	* textmodes/org.el (org-export-region-as-html)
	(org-replace-region-by-html, org-number-to-letters)
	(org-table-fedit-finish, org-normalize-color)
	(org-table-fedit-ref-right, org-date-to-gregorian)
	(org-table-fedit-move, org-table-convert-refs-to-rc)
	(org-calendar-holiday, org-table-fedit-toggle-ref-type)
	(org-write-agenda, org-colgroup-info-to-vline-list)
	(org-agenda-todo-previousset, org-defkey, org-encode-for-stdout)
	(org-indent-line-function, org-export-as-html-to-buffer)
	(org-store-agenda-views, org-update-mode-line)
	(org-find-if, org-delete-all)
	(org-table-fedit-convert-buffer, org-emphasize)
	(org-uniquify, org-table-fedit-lisp-indent)
	(org-table-fedit-scroll, org-get-todo-sequence-head)
	(org-table-fedit-scroll-down, org-table-fedit-line-down)
	(org-table-fedit-ref-left, org-agenda-export-csv-mapper)
	(org-table-fedit-toggle-coordinates, org-dvipng-color)
	(org-table-fedit-line-up, org-table-fedit-ref-down)
	(org-table-formula-from-user, org-mode-flyspell-verify)
	(org-cycle-show-empty-lines, org-ctrl-c-ret)
	(org-table-formula-to-user, org-diary-to-ical-string)
	(orgtbl-export, org-table-fedit-post-command)
	(org-closed-in-range, org-shiftcontrolright)
	(org-table-convert-refs-to-an, org-table-hline-and-move)
	(org-table-formula-less-p, org-format-table-ascii)
	(org-agenda-get-sexps, org-shift-refpart)
	(org-diary-sexp-entry, org-time-string-to-absolute)
	(org-table-show-reference, org-letters-to-number)
	(org-fix-agenda-info, org-table-fedit-ref-up)
	(org-table-fedit-shift-reference, org-table-fedit-abort)
	(org-closest-date, org-shiftcontrolleft)
	(org-at-heading-or-item-p, org-rematch-and-replace)
	(org-agenda-todo-nextset, org-export-grab-title-from-buffer):
	New functions.
	(org-table-edit-scroll-down, org-finish-edit-formulas)
	(org-table-edit-next-field, org-abort-edit-formulas)
	(org-font-lock-level, org-export-find-first-heading-line)
	(org-table-edit-line-down, org-table-edit-backward-field)
	(org-edit-formula-lisp-indent, org-table-edit-move)
	(org-check-log-option, org-this-word)
	(org-table-edit-line-up, org-table-edit-formulas-post-command)
	(org-agenda-file-to-end, org-expand-file-name)
	(org-fake-empty-table-line, org-table-edit-scroll)
	(org-toggle-log-option, org-show-reference): Function removed.
	(org-inhibit-invisibility, org-table-formula-make-cmp-string):
	New defsubsts.
	(org-unmodified, org-batch-store-agenda-views)
	(org-batch-agenda-csv): New macro.
	(org-agenda-export): New customization group.
	(org-agenda-skip-deadline-if-done, org-agenda-remove-tags)
	(org-highest-priority, org-agenda-exporter-settings)
	(org-log-done-with-time, org-replace-disputed-keys)
	(org-format-latex-header, org-export-table-header-tags)
	(org-cycle-separator-lines, org-export-table-data-tags)
	(org-icalendar-include-sexps)
	(org-empty-line-terminates-plain-lists)
	(org-log-repeat, org-special-ctrl-a)
	(org-table-use-standard-references, org-disputed-keys)
	(org-export-skip-text-before-1st-heading, org-agenda-with-colors)
	(org-agenda-export-html-style): New option.
	(org-allow-auto-repeat, org-agenda-remove-tags-when-in-prefix)
	(org-CUA-compatible): Option removed.
	(org-agenda-structure, org-sexp-date): New face.
	(org-todo-keywords-for-agenda, org-not-done-keywords)
	(org-planning-or-clock-line-re, org-agenda-name)
	(org-table-colgroup-info, org-todo-sets)
	(constants-unit-system, org-clock-mode-line-entry)
	(org-mode-line-timer, org-table-current-begin-pos)
	(org-todo-keywords-1, org-mode-line-string)
	(org-table-clean-did-remove-column, org-table-fedit-map)
	(org-clock-heading, org-table-buffer-is-an)
	(org-agenda-info, org-done-keywords)
	(org-done-keywords-for-agenda, org-todo-heads)
	(org-todo-kwd-alist, org-clock-start-time): New variable.
	(org-todo-kwd-priority-p, org-edit-formulas-map)
	(org-repeat-re, org-todo-kwd-max-priority)
	(org-version, org-done-string)
	(org-table-clean-did-remove-column-1, org-disputed-keys):
	Remove variables.
	(org-table-translate-regexp, org-repeat-re, org-version): New consts.
	(org-ts-lengths): Constant removed.
	(org-follow-gnus-link): Don't ask how many articles to read.
	(org-export-find-first-export-line): Rename from
	`org-export-find-first-heading'.
	Use `org-export-skip-text-before-1st-heading'.
	(org-table-fedit-post-command): Rename from
	`org-table-edit-formulas-post-command'.
	(org-table-fedit-finish): Rename from `org-finish-edit-formulas'.
	(org-table-fedit-abort): Rename from `org-abort-edit-formulas'.
	(org-table-fedit-lisp-indent): Rename from
	`org-edit-formula-lisp-indent'.
	(org-table-show-reference): Rename from `org-show-reference'.
	(org-table-store-formulas): Use `org-table-formula-less-p'.
	(org-table-edit-formulas): Position cursor to current field equation.
	(org-update-checkbox-count, org-hide-archived-subtrees)
	(org-timestamp-up-day, org-timestamp-down-day)
	(org-shiftmetaleft, org-shiftmetaright, org-shiftmetaup)
	(org-shiftmetadown, org-metaleft, org-metaright, org-metaup)
	(org-metadown, org-shiftup, org-shiftdown, org-shiftright)
	(org-shiftleft, org-ctrl-c-ctrl-c, org-context):
	Let `org-on-heading-p' also check for invisible heading.
	(org-read-date): Match am/pm times.
	(org-eval-in-calendar): Fix default date in prompt.

2007-06-05  Chong Yidong  <cyd@stupidchicken.com>

	* files.el (auto-mode-alist): Separate "ChangeLog.1" and
	"ChangeLog.a" entries, giving the latter lower priority.

2007-06-05  Juanma Barranquero  <lekktu@gmail.com>

	* faces.el (face-id): If the argument is a face alias,
	return the ID of the target face.

2007-06-05  Michael Albinus  <michael.albinus@gmx.de>

	* net/socks.el (top): Remove unnecessary copyright line.

2007-06-04  Chong Yidong  <cyd@stupidchicken.com>

	* longlines.el (longlines-auto-wrap): Handle argument correctly.

2007-06-04  Michael Albinus  <michael.albinus@gmx.de>

	* net/socks.el: New file, taken from w3 repository.
	(top): Update Copyright.  Don't load cl.el.
	(all): Replace `case' by `cond', `string-to-int' by
	`string-to-number', and `process-kill-without-query' by
	`set-process-query-on-exit-flag'.
	(socks-char-int): Remove defalias and all occurrences.

2007-06-04  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/compile.el (compilation-find-file, compilation-handle-exit):
	Fix typos in docstrings.
	(compilation-search-path, compilation-buffer-name-function): Doc fixes.
	(compilation-finish-function): Fix typo in obsolescence declaration.

2007-06-03  Sam Steingold  <sds@gnu.org>

	* progmodes/compile.el: Add TIMESTAMP to the LOC data structure, to
	handle unending automatic recompilation of changed files (`omake -P').
	(compilation-loop): VISITED is now 5th CDR.
	(compilation-next-error-function): Set TIMESTAMP.

2007-06-03  Sam Steingold  <sds@gnu.org>

	* files.el (kill-buffer-ask): New function.
	(kill-some-buffers): Use it.
	(kill-matching-buffers): New user command.

2007-06-01  David Kastrup  <dak@gnu.org>

	* dired.el (dired-recursive-deletes, dired-recursive-copies):
	Change default to `top'.

2007-05-31  Richard Stallman  <rms@gnu.org>

	* dired.el (dired-do-flagged-delete, dired-do-delete): Doc fix.

2007-05-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/css-mode.el: New file.

2007-05-30  Michael Olson  <mwolson@gnu.org>

	* emacs-lisp/tq.el (tq-queue-pop): Stifle error when a process has
	died and we are trying to send a signal to it.  The program using
	tq.el should periodically check to see whether the process has
	died and react appropriately -- this is not the responsibility of
	tq.el, and is consistent with the rest of the tq.el source code.

2007-05-29  Martin Rudalics  <rudalics@gmx.at>

	* textmodes/table.el (table--point-entered-cell-function)
	(table--point-left-cell-function):
	Bind `inhibit-point-motion-hooks' to t.

2007-05-29  Nikolaj Schumacher  <n_schumacher@web.de>

	* emacs-lisp/rx.el (rx): Doc fix.

2007-05-28  Juanma Barranquero  <lekktu@gmail.com>

	* progmodes/idlwave.el (idlwave-routines): Fix typo in docstring.

2007-05-28  Michael Albinus  <michael.albinus@gmx.de>

	Sync with Tramp 2.0.56.

	* net/tramp.el:
	* net/tramp-ftp.el:
	* net/tramp-smb.el:
	* net/tramp-util.el:
	* net/tramp-vc.el:
	Don't load cl.el, because that pollutes the namespace.  Replace cl
	macros by their implementations where necessary.  Requested by
	Richard Stallman <rms@gnu.org>.

	* net/tramp.el (top): Make `set-buffer-multibyte' an alias if it
	doesn't exist.
	(with-parsed-tramp-file-name): Protect debug spec during compilation.
	(tramp-handle-insert-directory): Check (featurep 'ls-lisp).
	(tramp-file-name-p, tramp-file-name-multi-method)
	(tramp-file-name-method, tramp-file-name-user)
	(tramp-file-name-host, tramp-file-name-localname): New defuns,
	replacing defstruct `tramp-file-name'.
	(tramp-handle-file-remote-p, tramp-completion-dissect-file-name1)
	(tramp-dissect-file-name, tramp-dissect-multi-file-name):
	Apply `vector' instead of `make-tramp-file-name'.
	(tramp-handle-make-auto-save-file-name):
	Apply `tramp-temporary-file-directory' for compatibility reasons.
	(tramp-completion-mode): Use `natnump' instead of `wholenump'
	because of XEmacs.
	(tramp-completion-mode): `last-input-event' is nil when XEmacs is
	started.

2007-05-28  Chong Yidong  <cyd@stupidchicken.com>

	* textmodes/sgml-mode.el (sgml-point-entered): Use condition-case.

2007-05-27  Tetsurou Okazaki  <okazaki@be.to>  (tiny change)

	* log-edit.el (log-edit-changelog-paragraph): Return point-max
	as the end of the ChangeLog paragraph when it ends without a line
	termination.

2007-05-27  Ryan Yeske  <rcyeske@gmail.com>

	* net/webjump.el (webjump-sample-sites):
	Add simple Wikipedia query.

2007-05-25  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/derived.el (define-derived-mode): Remove bogus
	compatibility code.

	* emacs-lisp/copyright.el (copyright-names-regexp): New var.
	(copyright-update-year): Use it.

	* edmacro.el (edmacro-format-keys): Use current-active-maps.

	* ediff-init.el (ediff-defvar-local, ediff-with-current-buffer):
	Add indentation and debugging info.  Fix up comment convention.

	* cus-dep.el (custom-make-dependencies): Simplify.

	* composite.el (compose-region, decompose-region):
	Use inhibit-read-only and restore-buffer-modified-p.

	* xt-mouse.el (xterm-mouse-truncate-wrap): New function.
	(xterm-mouse-event): Use it.

2007-05-25  Juanma Barranquero  <lekktu@gmail.com>

	* bs.el (bs-cycle-previous): Don't modify the cycle list until
	`switch-to-buffer' has returned successfully.
	(bs-cycle-next): Ditto.  Also, don't bury the buffer when the
	window is dedicated (it could iconify the frame).

2007-05-25  Miles Bader  <miles@fencepost.gnu.org>

	* vc-hooks.el (vc-find-root): Fix file attribute test.

2007-05-24  Richard Stallman  <rms@gnu.org>

	* textmodes/flyspell.el (flyspell-correct-word-before-point):
	Don't let opoint be nil.
	(flyspell-emacs-popup): Explicit error if no dialogs.

2007-05-24  Chong Yidong  <cyd@stupidchicken.com>

	* image-mode.el (image-forward-hscroll, image-backward-hscroll)
	(image-next-line, image-previous-line, image-scroll-up)
	(image-scroll-down, image-bol, image-eol, image-bob, image-eob):
	New functions.
	(image-mode-map): Remap motion commands.
	(image-mode-text-map): New keymap for viewing images as text.
	(image-mode): Use image-mode-map.
	(image-toggle-display): Toggle auto-hscroll-mode and mode keymaps.

2007-05-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/fill.el (canonically-space-region): Make the second arg
	a marker if it's not already the case.

2007-05-23  Eli Zaretskii  <eliz@gnu.org>

	* tar-mode.el (tar-header-block-summarize, tar-summarize-buffer)
	(tar-get-descriptor): Handle type 55, an extended pax header.

2007-05-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* autoinsert.el (auto-insert-alist): Quote elisp sample code so as not
	to confuse outline-minor-mode.

2007-05-23  Eli Zaretskii  <eliz@gnu.org>

	* tar-mode.el (tar-file-name-handler): New function.
	(tar-extract): Bind file-name-handler-alist to it to force
	find-buffer-file-type-coding-system behave as if the file being
	extracted existed.  Use last-coding-system-used to force
	buffer-file-coding-system to what decode-coding-region actually
	used to decode the file.

2007-05-23  Nikolaj Schumacher  <n_schumacher@web.de>

	* progmodes/compile.el (compilation-handle-exit):
	`compilation-finish-function' may change the current buffer.

2007-05-22  Richard Stallman  <rms@gnu.org>

	* files.el (set-auto-mode): Doc fix.

2007-05-22  Jan Djärv  <jan.h.d@swipnet.se>

	* help-fns.el (find-source-lisp-file): New function.
	(describe-function-1): Use find-source-lisp-file to find source
	file in compile tree.

2007-05-22  Eli Zaretskii  <eliz@gnu.org>

	* dos-w32.el (find-buffer-file-type-coding-system): Doc fix.

2007-05-22  Juanma Barranquero  <lekktu@gmail.com>

	* emacs-lisp/easy-mmode.el (define-minor-mode)
	(easy-mmode-define-navigation): Fix typos in docstrings.

2007-05-22  Glenn Morris  <rgm@gnu.org>

	* files.el (auto-mode-alist): Open `.asd' files in lisp-mode.

2007-05-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mail/mail-extr.el (mail-extract-address-components):
	Recognize non-ASCII characters except for NBSP as words.

2007-05-21  Trent W. Buck  <trentbuck@gmail.com>  (tiny change)

	* net/rcirc.el (rcirc-fill-column): Allow `window-width'.
	(rcirc-print): Handle `window-width'.
	(rcirc-buffer-maximum-lines): Doc fix.

2007-05-21  Chong Yidong  <cyd@stupidchicken.com>

	* image-mode.el (image-toggle-display): Don't clear image cache.
	Only use filename in image spec if the file is readable.
	Call image-refresh.

	* image.el (image-type-from-file-name, image-type): Simplify.
	(image-type-auto-detected-p): Don't scan auto-mode-alist.

	* files.el (magic-mode-alist): Remove image-type-auto-detected-p.
	(magic-fallback-mode-alist): Add image-type-auto-detected-p.

2007-05-20  Nick Roberts  <nickrob@snap.net.nz>

	* t-mouse.el (t-mouse-mode): Reset t-mouse-mode to nil if there
	is an error.

	* term/linux.el (terminal-init-linux): Don't signal an error
	if gpm isn't running.

2007-05-20  Nick Roberts  <nickrob@snap.net.nz>

	* t-mouse.el: Reduce to a minor-mode macro call.
	(t-mouse-mode): Remove the lighter.

	* term/linux.el (terminal-init-linux): Enable t-mouse by default.

2007-05-19  Dan Nicolaescu  <dann@ics.uci.edu>

	* files.el (auto-mode-alist): Change the regexp so that
	ChangeLog.unicode and ChangeLog.multi-tty use change-log-mode.

2007-06-02  Chong Yidong  <cyd@stupidchicken.com>

	* Version 22.1 released.

2007-05-19  Chong Yidong  <cyd@stupidchicken.com>

	* paren.el (show-paren-function): Undo 2007-04-19 and 2007-04-20
	changes.

2007-05-19  Kevin Ryde  <user42@zip.com.au>

	* info.el (Info-fontify-node): Fontify https as well as http and ftp.

2007-05-18  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* textmodes/sgml-mode.el: Revert last change.

2007-05-18  Richard Stallman  <rms@gnu.org>

	* simple.el (push-mark): Doc fix.

2007-05-18  Rob Riepel  <riepel@Stanford.EDU>

	* emulation/tpu-edt.el (CSI-map, SS3-map): Move from global-map to
	tpu-global-map.
	(tpu-original-global-map): Variable deleted.
	(tpu-control-keys-map): New keymap variable.
	(tpu-set-control-keys): Use tpu-reset-control-keys rather than
	setting keymapping directly.
	(tpu-reset-control-keys): Use tpu-control-keys-map instead of
	tpu-global-map.
	(tpu-edt-on): Activate the tpu-global-map.
	(tpu-edt-off): Deactivate the tpu-global-map.

2007-05-18  Ryan Yeske  <rcyeske@gmail.com>

	* textmodes/ispell.el (ispell-get-word): Return markers
	for start and end positions.
	(ispell-word): Assume END is a marker.

2007-05-17  Christian Plate  <cplate@web.de>  (tiny change)

	* textmodes/sgml-mode.el (sgml-tag):
	Fix bug: Call sgml-transformation-function.

2007-05-17  Martin Rudalics  <rudalics@gmx.at>

	* hilit-chg.el (highlight-changes-rotate-faces): Don't set
	modified flag of buffer.  Use `inhibit-modification-hooks'.

2007-05-16  Richard Stallman  <rms@gnu.org>

	* buff-menu.el (Buffer-menu-sort-column): Doc fix.

2007-05-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* files.el (magic-mode-alist, magic-fallback-mode-alist):
	Move the *ml, PostScript, and XmCD entries to the fallback part.

	* files.el (magic-fallback-mode-alist):
	Rename from file-start-mode-alist.

2007-05-16  Nikolaj Schumacher  <n_schumacher@web.de>

	* progmodes/compile.el (compilation-handle-exit): Quote first
	argument of `run-hook-with-args'.

2007-05-16  Juanma Barranquero  <lekktu@gmail.com>

	* buff-menu.el (Buffer-menu-sort-column):
	* dabbrev.el (dabbrev-upcase-means-case-search):
	* dired.el (dired-recursive-deletes, dired-recursive-copies):
	* info.el (Info-current-subfile):
	* ls-lisp.el (ls-lisp-verbosity):
	* msb.el (msb-menu-cond):
	* pcvs.el (cvs-dired-use-hook):
	* simple.el (set-mark-command-repeat-pop):
	* time.el (display-time-24hr-format, display-time-mail-file):
	Doc fixes.

	* tutorial.el (get-lang-string, tutorial--find-changed-keys):
	* printing.el (pr-ps-fast-fire): Fix typos in docstrings.

	* view.el (view-inhibit-help-message): Fix typo in docstring.
	(view-scroll-auto-exit, view-try-extend-at-buffer-end): Doc fixes.

2007-05-16  Martin Rudalics  <rudalics@gmx.at>

	* textmodes/ispell.el (ispell-start-process): Defend against bad
	default-directory.

2007-05-14  Eli Zaretskii  <eliz@gnu.org>

	* mail/rmail.el (rmail-convert-to-babyl-format): Check
	content-transfer-encoding _last_, because it's its position that
	we need as value of base64-header-field-end.

2007-05-14  Juanma Barranquero  <lekktu@gmail.com>

	* files.el (mode-require-final-newline, require-final-newline)
	(enable-local-variables, enable-local-eval): Doc fixes.

2007-05-13  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el: Use default color when foreground or background color
	are unspecified.  Reported by Leo <sdl.web@gmail.com>.
	(ps-print-version): New version 6.7.4.
	(ps-rgb-color): New argument.  Use default color when color is
	unspecified.
	(ps-begin-job): Fix code.

2007-05-12  Chong Yidong  <cyd@stupidchicken.com>

	* longlines.el (longlines-mode): Make longlines-auto-wrap
	buffer-local.  Add hooks unconditionally.
	(longlines-auto-wrap): Toggle wrapping.
	(longlines-after-change-function)
	(longlines-post-command-function): Check longlines-auto-wrap.

2007-05-12  Nick Roberts  <nickrob@snap.net.nz>

	* xt-mouse.el (xterm-mouse-debug-buffer): New variable.
	(xterm-mouse-translate): Use it.

2007-05-10  Richard Stallman  <rms@gnu.org>

	* international/iso-cvt.el (iso-cvt-read-only): Ignore arguments.
	(iso-cvt-write-only): Likewise.

	* emacs-lisp/easy-mmode.el (define-minor-mode):
	Fix generated doc string.

	* startup.el (fancy-splash-text): Add URL of guided tour.
	Adjust horizontal and vertical whitespace.

	* progmodes/compile.el (compilation-handle-exit):
	Use run-hook-with-args to run compilation-finish-functions.

	* files.el (file-start-mode-alist): New variable.
	(magic-mode-regexp-match-limit): Doc fix.
	(set-auto-mode): Handle file-start-mode-alist.
	A little cleanup of structure.

	* dabbrev.el (dabbrev-eliminate-newlines):
	Renamed from dabbrev--eliminate-newlines.  All uses changed.

2007-05-10  Michaël Cadilhac  <michael@cadilhac.name>

	* man.el (Man-next-section): Don't consider the last line of the page
	as being part of any section.

2007-05-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/sgml-mode.el (sgml-value): Fix handling of attributes which
	can take any number of values.

2007-05-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/tex-mode.el (tex-font-lock-keywords-2): Add citet and citep
	to the list of citation commands.

2007-05-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-hooks.el (vc-find-root): Stop searching when the user changes.

2007-05-09  Edward O'Connor  <hober0@gmail.com>  (tiny change)

	* progmodes/python.el (python-font-lock-keywords)
	(python-open-block-statement-p, python-mode): Add support for the new
	"with" keyword.

2007-05-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* diff-mode.el (diff-apply-hunk, diff-test-hunk): Don't do by default
	the exact opposite of diff-goto-source.

	* emacs-lisp/advice.el (ad-special-forms): Remove.
	(ad-special-form-p): Use subr-arity.

	* newcomment.el (comment-search-forward): Make sure we search forward.
	(comment-enter-backward): Try and distinguish the non-matching case at
	EOB from the non-matching case with a missing comment-end-skip for
	a 2-char comment ender.
	(comment-choose-indent): New function extracted from comment-indent.
	Improve the alignment algorithm.
	(comment-indent): Use it.

	* textmodes/sgml-mode.el (sgml-lexical-context): Add handling of
	XML style Processing Instructions.
	(sgml-parse-tag-backward): Handle XML-style PIs.  Also ensure progress.
	(sgml-calculate-indent): Handle `pi' context.

	* vc.el: Ensure that update-changelog issues an error when used with
	a backend that does not implement it.
	(vc-update-changelog-rcs2log): Rename from vc-default-update-changelog.
	Remove `backend' argument.  Use expand-file-name.
	(vc-cvs-update-changelog, vc-rcs-update-changelog): New aliases.

	* progmodes/python.el (python-end-of-block): Revert last change.
	(python-end-of-statement): Make sure we move *forward*.

2007-05-08  Richard Stallman  <rms@gnu.org>

	* mail/mailabbrev.el (sendmail-pre-abbrev-expand-hook):
	Don't include non-self-insert commands in the exception for `-'.

2007-05-08  David Reitter  <david.reitter@gmail.com>

	* progmodes/python.el (python-guess-indent): Check non-nullness
	before comparing indent against the 2..8 interval.

2007-05-07  YAMAMOTO Mitsuharu  <mituharu@math.s.chiba-u.ac.jp>

	* term/mac-win.el (mac-ts-unicode-for-key-event): Check if text is
	available.

2007-05-06  Richard Stallman  <rms@gnu.org>

	* emacs-lisp/eldoc.el (turn-on-eldoc-mode): Doc fix.

2007-05-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	* diff.el (diff): Use buffer-local vars diff-old-file and diff-new-file
	rather than storing their value in the revert-buffer function.

2007-05-04  Nick Roberts  <nickrob@snap.net.nz>

	* t-mouse.el (t-mouse-mode): Do nothing on a graphical display
	when disabling t-mouse-mode.

2007-05-01  Davis Herring  <herring@lanl.gov>

	* calendar/timeclock.el: Update version number.
	(timeclock-modeline-display): Mention timeclock-use-display-time
	in explanatory message.
	(timeclock-in): Fix non-interactive workday specifications.
	(timeclock-log): Don't kill the log buffer if it already existed.
	Suppress warnings when finding the log.  Don't check for a nil
	project twice.  Run hooks after killing the buffer (if applicable).
	(timeclock-geometric-mean): Rename to `timeclock-mean' (it never
	was geometric).  All uses changed.
	(timeclock-generate-report): Support prefix argument.

2007-05-03  Ryan Yeske  <rcyeske@gmail.com>

	* net/rcirc.el (rcirc-timeout-seconds): Increase to prevent unwanted
	disconnections.

2007-05-01  Romain Francoise  <romain@orebokech.com>

	* dired-x.el: Revert 2007-04-06 change.

2007-04-29  Stephen Berman  <Stephen.Berman@gmx.net>

	* find-dired.el (find-dired-filter): Propertize all text down to eob.

2007-04-29  Richard Stallman  <rms@gnu.org>

	* international/mule.el (auto-coding-alist): Add pdf => no-conversion.

2007-04-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/cc-mode.el (c-before-change): Use point-min rather
	than 1.

2007-04-28  Richard Stallman  <rms@gnu.org>

	* progmodes/sh-script.el (sh-mode): Recognize .profile as sh style.

2007-04-28  Nick Roberts  <nickrob@snap.net.nz>

	* progmodes/gud.el (gud-menu-map): Pdb can't handle SIGINT so
	don't put stop on toolbar.

2007-04-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-hooks.el (vc-ignore-dir-regexp): Add /.../ for the DFS filesystem.

2007-04-28  Eli Zaretskii  <eliz@gnu.org>

	* makefile.w32-in ($(lisp)/mh-e/mh-loaddefs.el): Use ./mh-e
	instead of $(lisp)/mh-e.

2007-04-28  Glenn Morris  <rgm@gnu.org>

	* image-dired.el (image-dired-cmd-create-thumbnail-options)
	(image-dired-cmd-create-temp-image-options): Replace option
	+profile "*" with -strip.

2007-04-27  Chong Yidong  <cyd@stupidchicken.com>

	* textmodes/flyspell.el (flyspell-auto-correct-previous-word):
	Use window-start and window-end.

2007-04-27  Andreas Schwab  <schwab@suse.de>

	* emacs-lisp/sregex.el (sregexq): Fix doc string quoting.

2007-04-27  Eli Zaretskii  <eliz@gnu.org>

	* textmodes/fill.el (fill-paragraph): Doc fix.

2007-04-26  Luc Teirlinck  <teirllm@dms.auburn.edu>

	* locate.el (locate-in-alternate-database): Doc fix.

2007-04-26  Glenn Morris  <rgm@gnu.org>

	* button.el (button): Use underline if supported, else fall back
	to color.

	* version.el (emacs-version): Increase to 22.1.50.

2007-04-25  Richard Stallman  <rms@gnu.org>

	* hi-lock.el (hi-lock-file-patterns-policy): Default to `ask'.

2007-04-25  J.D. Smith  <jdsmith@as.arizona.edu>

	* progmodes/idlwave.el (idlwave-beginning-of-subprogram)
	(idlwave-end-of-subprogram): Take optional NOMARK arg to prevent
	pushing mark.
	(idlwave-current-routine): Don't push mark.

2007-04-25  Mathias Dahl  <mathias.dahl@gmail.com>

	* image-dired.el (image-dired-display-image): Derive image-type from
	filename rather than assuming jpeg, in case no resizing was needed.

2007-04-25  Johan Bockgård  <bojohan@dd.chalmers.se>

	* custom.el (defface): Doc fix.

See ChangeLog.12 for earlier changes.

;; Local Variables:
;; coding: utf-8
;; End:

  Copyright (C) 2007-2012  Free Software Foundation, Inc.

  This file is part of GNU Emacs.

  GNU Emacs is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  GNU Emacs is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with GNU Emacs.  If not, see <http://www.gnu.org/licenses/>.
