2012-05-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-msg.el (gnus-msg-mail): Ensure that gnus-newsgroup-name is
	a string so that Gcc works (bug#11514).

2012-04-21  Andreas Schwab  <schwab@linux-m68k.org>

	* gnus.el (debbugs-gnu): Don't override existing autoload definition.

2012-04-12  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-msg.el (gnus-inews-insert-gcc): Don't do the alist stuff when we
	don't have a current group.

2012-04-10  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-msg.el (gnus-inews-insert-gcc): Protect against when we don't
	have a group name.

	* gnus-art.el (article-wash-html): Ensure that we insert the HTML into
	a multibyte buffer (bug#7410).
	(article-wash-html): Parse the original article buffer to get the
	unencoded data (bug#7410).

	* gnus-start.el (gnus-read-newsrc-el-file): Protect against broken
	.newsrc.el files.

2012-03-22  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* auth-source.el (auth-source-netrc-create): Quote tokens that contain
	"#" to avoid having them interpreted as comments.

2012-03-19  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-insert): Update the text state properly to avoid
	inserting spurious paragraph starts.

2012-03-14  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-update-marks): Don't propagate marks unless
	requested (bug#10961).

	* shr.el (shr-table-widths): Divide the extra width more fairly over
	the TDs (bug#10973).
	(shr-render-td): Don't delete too much padding.
	(shr-natural-width): Compute the natural width more correctly.
	(shr-insert): Allow the natural width to be computed for tables again.
	(shr-tag-table-1): Rework how the natural widths are computed by
	rendering the table a third time.
	(shr-natural-width): Removed.
	(shr-buffer-width): New function.
	(shr-expand-newlines): Use it.

	* gnus-msg.el (gnus-bug): Don't delete the other windows.  We may be
	using a `gnus-use-full-window' setup (bug#11013).

2012-03-12  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-int.el (gnus-backend-trace): Flip default to nil before Emacs
	24.1 release.

2012-03-10  David Edmondson  <dme@dme.org>

	* mm-uu.el (mm-uu-forward-extract): Allow for blank lines between the
	'Forwarded Message' header and the start of the message.

2012-03-04  Thierry Volpiatto  <thierry.volpiatto@gmail.com>

	* gnus-msg.el (gnus-msg-mail): Call `message-mail' correctly when Gnus
	isn't running (bug#10897).

2012-02-25  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-column-specs): Protect against TDs with "width: 0%".

2012-02-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nntp.el (nntp-send-authinfo): Work for secure nntp entry in authinfo.

2012-02-20  Lars Ingebrigtsen  <larsi@gnus.org>

	* mm-decode.el (mm-shr): Remove "soft hyphens".

	* nnimap.el (nnimap-request-list): Return the group names encoded as
	utf8.  Otherwise non-European group names don't work.
	(nnimap-request-newgroups): Ditto.

	* gnus-sum.el (gnus-summary-insert-old-articles): Fix the syntax for
	the default in `read-string' (bug#10757).

	* gnus-msg.el (gnus-group-post-news): Don't bug out on `C-u a' on
	topics (bug#10843).

	* nnimap.el (nnimap-log-command): Add the IMAP address to the log
	buffer.  Suggested by Herbert Valerio Riedel.
	(nnimap-request-move-article): Delete the message from the correct IMAP
	server.

2012-02-19  Vida Gábor  <vidagabor@gmail.com>  (tiny change)

	* gnus-demon.el (gnus-demon-init): Don't multiply time twice.
	Reported by Peter Münster.

2012-02-18  Lars Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-image-fetched): Make sure we really kill the right
	buffer.

2012-02-16  Leo Liu  <sdl.web@gmail.com>

	* gnus-start.el (gnus-1): Avoid duplicate entries.

2012-02-15  Lars Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-remove-trailing-whitespace): Really delete the padding on
	too-wide lines.

2012-02-15  Paul Eggert  <eggert@cs.ucla.edu>

	* shr.el (shr-rescale-image): Undo previous change; see
	<http://lists.gnu.org/archive/html/emacs-devel/2012-02/msg00540.html>.

2012-02-13  Lars Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-record-commands): New variable.
	(nnimap-log-command): Use it.
	(nnimap-make-process-buffer): Add a space to the process buffer.
	(nnimap-transform-headers): Don't bug out on header lines containing
	stuff that look like IMAP length encodings.

	* shr.el (shr-rescale-image): Allow viewing large images.

2012-02-12  Lars Ingebrigtsen  <larsi@gnus.org>

	* nnml.el (nnml-request-compact-group): Delete the marks file after
	compaction (bug#10800).

	* gnus-art.el (gnus-stop-downloads): Stop `url-queue' downloads on
	group exit.

	* nnimap.el (nnimap-parse-flags): Parse correctly when we have mixed
	QRESYNC/FETCH output.

2012-02-11  Glenn Morris  <rgm@gnu.org>

	* sieve-manage.el (sieve-manage-default-stream):
	* shr.el (shr):
	* nnir.el (nnir-ignored-newsgroups, nnir-summary-line-format)
	(nnir-retrieve-headers-override-function)
	(nnir-imap-default-search-key, nnir-notmuch-program)
	(nnir-notmuch-additional-switches, nnir-notmuch-remove-prefix)
	(nnir-method-default-engines):
	* message.el (message-cite-reply-position):
	* gssapi.el (gssapi-program):
	* gravatar.el (gravatar):
	* gnus-sum.el (gnus-refer-thread-use-nnir):
	* gnus-registry.el (gnus-registry-unfollowed-addresses)
	(gnus-registry-max-pruned-entries):
	* gnus-picon.el (gnus-picon-inhibit-top-level-domains):
	* gnus-int.el (gnus-after-set-mark-hook)
	(gnus-before-update-mark-hook):
	* gnus-async.el (gnus-async-post-fetch-function):
	* auth-source.el (auth-source-cache-expiry):
	Add missing :version tags to new defcustoms and defgroups.

2012-02-10  Lars Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-default-send-mail-function): Made into own
	function for reuse by emacsbug.el.

2012-02-09  Juanma Barranquero  <lekktu@gmail.com>

	* gnus.el (gnus-method-ephemeral-p): Move after declaration of defsubst
	`gnus-sloppily-equal-method-parameters' to avoid a warning.

2012-02-09  Lars Ingebrigtsen  <larsi@gnus.org>

	* gnus-msg.el (gnus-msg-mail): Use `message-mail' if Gnus isn't
	running.

	* nnimap.el (nnimap-wait-for-response): Minor fixup of message string.

	* gnus.el (gnus-server-extend-method): Don't add an -address component
	if the method already has one (bug#9676).

2012-02-08  Lars Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-summary-insert-old-articles): Use a default instead
	of an initial-input for consistency (bug#10757).

	* shr.el: Inhibit getting and sending cookies when fetching pictures.

	* gnus-html.el (gnus-html-schedule-image-fetching): Ditto.

2012-02-07  Lars Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-remove-trailing-whitespace): Don't strip whitespace from
	lines that are narrower than the window width.  Otherwise background
	"blocks" will look less readable.

2012-02-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-summary-show-thread): Revert last two changes.

2012-02-07  Lars Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-transform-headers): Remove unused variable.
	(nnimap-transform-headers): Fix parsing BODYSTRUCTURE elements that
	have newlines within the strings, and where the UID comes after the
	BODYSTRUCTURE element (bug#10537).

	* shr-color.el (shr-color-set-minimum-interval): Rename to add prefix
	(bug#10732).

	* shr.el (shr-insert-document): Add doc string.
	(shr-visit-file): Ditto.
	(shr-remove-trailing-whitespace): New function.
	(shr-insert-document): Use it to clean up trailing whitespace as the
	final step (bug#10714).

2012-02-06  Lars Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-summary-exit-no-update): Really deaden the summary
	buffer if `gnus-kill-summary-on-exit' is nil.

2012-02-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-summary-show-thread):
	next-single-char-property-change may return nil in XEmacs.

2012-02-06  Lars Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-handle-ephemeral-exit): Allow exiting from Gnus
	when just reading a single group from "without" Gnus.

2012-02-06  Chong Yidong  <cyd@gnu.org>

	* gnus-sum.el (gnus-summary-show-thread):
	next-single-char-property-change never returns nil (Bug#8657).

2012-02-05  Lars Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-open-server): Allow switching the nnoo server
	without reconnecting.
	(nnimap-possibly-change-group): Ditto.
	(nnimap-finish-retrieve-group-infos): Don't reconnect if the server
	connection has died before being called.

2012-02-02  Lars Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-retrieve-group-data-early): Don't say we're doing
	an initial sync unless we're really doing one.

	* gnus-group.el (gnus-group-read-ephemeral-group): Don't add a new
	address parameter if one already exists (bug#9676).

	* gnus-msg.el (gnus-summary-mail-forward): Respect the process marks,
	not the prefix, as documented (bug#10689).

2012-02-01  Lars Ingebrigtsen  <larsi@gnus.org>

	* gnus.el (gnus-valid-select-methods): nnmaildir also saves marks in
	the "server".

	* gnus-group.el (gnus-group-get-new-news-this-group): Don't overwrite
	the real error message with the useless "previously known to be down".
	Which isn't even correct.

	* nntp.el (nntp-open-connection): Report the error message if the nntp
	server can't be reached.

	* nnimap.el (nnimap-retrieve-group-data-early): Keep track of how many
	groups we do a total scan for.
	(nnimap-wait-for-response): Say that we're doing a total scan, if we're
	doing that.

2012-01-31  Jim Meyering  <jim@meyering.net>

	* gnus-agent.el (gnus-agent-expire-unagentized-dirs):
	Correct a comment (insert "not") and hide nominally-doubled "to".

2012-01-30  Philipp Haselwarter  <philipp.haselwarter@gmx.de>  (tiny change)

	* gnus-agent.el (gnus-agent-auto-agentize-methods): Point to the Agent
	section in the manual.

2012-01-30  Lars Ingebrigtsen  <larsi@gnus.org>

	* rfc2047.el (rfc2047-encode-region): Allow not folding the encoded
	words.
	(rfc2047-encode-string): Ditto.
	(rfc2047-encode-parameter): Don't fold parameters.  Some MUAs do not
	understand folded filename="..." parameters, for instance.

	* nnimap.el (nnimap-wait-for-response): Include the imap server name in
	the message for greater debuggability.

2012-01-28  Lars Ingebrigtsen  <larsi@gnus.org>

	* mm-view.el (mm-display-inline-fontify): Bind `font-lock-support-mode'
	instead of setting it locally, since the latter doesn't seem to have
	any effect (most of the time).

2012-01-27  Elias Pipping  <pipping@lavabit.com>  (tiny change)

	* shr.el (shr-browse-url): Fix the name of the `browse-url-mail'
	function call.

2012-01-27  Vida Gábor  <vidagabor@gmail.com>  (tiny change)

	* gnus-demon.el (gnus-demon-run-callback, gnus-demon-init): Convert to
	seconds, and make the repeat clause with HH:MM specs work as
	documented.

2012-01-27  Lars Ingebrigtsen  <larsi@gnus.org>

	* gnus-start.el (gnus-get-unread-articles): Clear out "early" methods
	so that previous errors don't prohibit getting new news.

	* nnimap.el (nnimap-retrieve-group-data-early): Ditto.

	* nntp.el (nntp-retrieve-group-data-early): Ditto.

2012-01-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-summary-mode): Don't make bidi-paragraph-direction
	bound globally in old Emacsen and XEmacsen.

2012-01-26  Nick Alcock  <nick.alcock@oracle.com>  (tiny change)

	* gnus.el (gnus-group-find-parameter): Check for liveness of the
	buffer, not of the string which is its name.

2012-01-26  Lars Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-summary-move-article): Don't propagate marks to
	non-server-marks groups.
	(gnus-group-make-articles-read): Ditto.

	* gnus-srvr.el (gnus-server-prepare): Use it to avoid showing ephemeral
	methods (bug#9676).

	* gnus.el (gnus-method-ephemeral-p): New function.

2012-01-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-summary-mode): Force paragraph direction to be
	left-to-right.

2012-01-26  Lars Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnir-search-thread): Autoload to avoid a compilation
	warning.

2012-01-25  Lars Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-summary-line-format-alist): Don't try to
	macroexpand the nnir things, since they haven't been defined yet, and
	nnir requires gnus-sum.

2012-01-21  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mm-decode.el (mm-interactively-view-part): Fix prompt.

2012-01-10  Teodor Zlatanov  <tzz@lifelogs.com>

	* nntp.el (nntp-send-authinfo): Query `auth-source-search' with the
	logical server name in addition to the actual machine address.

	* auth-source.el (auth-source-user-and-password): Add convenience
	wrapper to search by just host and optionally user.

2012-01-07  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-visit-file): Move point to the beginning of the buffer
	after rendering.

2012-01-07  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-summary-read-group): Document more parameters
	(bug#9693).
	(gnus-summary-setup-buffer): Document return value (bug#9697).

	* mm-decode.el (mm-interactively-view-part): Use `completing-read',
	since ido doesn't work on symbols (bug#9632).

	* gnus.el (gnus-group-fast-parameter): Use the same precedence rules
	when getting a single value as when getting all the values.  This means
	that atoms like `gcc-self' work cumulatively, like variable settings,
	instead of getting the value from the last matching clause.
	(gnus-group-find-parameter): Protect against the group buffer not
	existing (bug#9585).

2012-01-06  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-start.el (gnus-activate-group): Document more parameters
	(bug#9694).

	* gnus-group.el (gnus-group-read-ephemeral-group): Doc clarification
	(bug#9692).

	* gnus-agent.el (gnus-agent-store-article): Tell the Agent when the
	article was fetched, so that it can be expired later (bug#9958).
	(gnus-agent-summary-fetch-series): Add doc string.
	(gnus-agent-summary-fetch-group): Don't remove tick and dormant marks
	(bug#9517).

	* nntp.el (nntp-retrieve-groups): Refuse to do retrieval when an async
	retrieval is happening.

	* gnus.el (gnus-parameters): Doc fix.

2012-01-06  Dave Abrahams  <dave@boostpro.com>

	* gnus-sum.el (gnus-summary-refer-thread): If the subtree is hidden,
	show the thread after expansion.

2012-01-06  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-art.el (article-narrow-to-head): If the head is completely
	empty, narrow to the empty region (bug#9764).

	* gnus-sum.el (gnus-summary-mark-article-as-unread): Mark articles as
	read, and then mark them as unread only when the unread mark is used.
	This makes `C-- T k' actually work, even though it's confusing.

	* gnus-win.el (gnus-all-windows-visible-p): Ensure that the buffer is
	alive before we try to find its window.

2012-01-06  Brian Sniffen  <bsniffen@akamai.com>  (tiny change)

	* mm-decode.el (mm-display-external): Use a longer timeout for the
	deletion to allow slow programs to display the file.

2012-01-06  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-art.el (gnus-article-browse-delete-temp-files): Fix up the
	prompt to be less confusing.

	* gnus-msg.el (gnus-summary-reply): Do not give a `switch-to-buffer'
	argument to `message-reply'.  This broke `special-display-*' frame
	pop-uping (bug#10238).

2012-01-05  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* starttls.el (starttls-available-p): Return nil on Windows/MS-DOS
	systems, since these allegedly don't work there.

2012-01-04  Chris Gray  <chrismgray@gmail.com>  (tiny change)

	* mm-decode.el (mm-shr): Check that `gnus-summary-buffer' really is a
	live buffer.

2012-01-04  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnir.el (nnir-retrieve-headers): Protect against the article not
	existing on the server (bug#10335).

2012-01-04  Wolfgang Jenkner  <wjenkner@inode.at>  (tiny change)

	* gnus-agent.el (gnus-agent-load-local): Recompute
	gnus-agent-article-local on changing method.

2012-01-04  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus.el (gnus-parameters): Note precedence.

2012-01-04  Leo Liu  <sdl.web@gmail.com>

	* nndraft.el (nndraft-update-unread-articles): Don't move point around
	in the group buffer.

2012-01-04  Julien Danjou  <julien@danjou.info>

	* nnimap.el (nnimap-update-info): Fix an error when all articles UIDs
	change.

2012-01-04  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-rescale-image): Add :ascent 100 to the rescaled picture,
	too.

	* nntp.el (nntp-retrieve-group-data-early): Use it.

2012-01-03  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nntp.el (nntp-retrieval-in-progress): New variable.
	(nntp-make-process-buffer): Make it buffer-local.

	* gnus-demon.el (gnus-demon-time-to-step): Resurrect function lost in
	2010.
	(gnus-demon-init): Use it to compute the time if time is on the form
	"04:23".

	* gnus-topic.el (gnus-topic-history): Define `gnus-topic-history'.

	* nnimap.el (nnimap-finish-retrieve-group-infos): Check the connection
	status in the correct buffer.

2012-01-03  Leo Liu  <sdl.web@gmail.com>

	* gnus-topic.el (gnus-topic-goto-next-group): Don't move point around
	when opening topics (bug#10407).

2011-12-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-view.el (mm-display-inline-fontify): Add comment.

2011-12-15  Juri Linkov  <juri@jurta.org>

	* mm-decode.el (mm-inline-media-tests): Add missing
	`mm-handle-media-subtype'.

2011-12-09  Tassilo Horn  <tassilo@member.fsf.org>

	* message.el (message-valid-fqdn-regexp): Update with newly approved
	top-level domain names ".tel" and ".asia".

2011-12-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-summary-show-article): Don't load shr
	unconditionally.

2011-12-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-pop-to-buffer): Use pop-to-buffer instead of
	pop-to-buffer-same-window for old Emacsen.

2011-12-04  Chong Yidong  <cyd@gnu.org>

	* message.el (message-pop-to-buffer): Partially revert 2011-11-30
	change (Bug#10200).

2011-12-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* compface.el (uncompface):
	* gnus-art.el (gnus-article-x-face-command): Update the header format
	of icon data for the most recent icontopbm program.

2011-12-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-msg.el (gnus-inews-do-gcc):
	* message.el (message-send-mail):
	* mml.el (mml-generate-mime): Share the value of the buffer-local
	`message-options' variable between a draft buffer and temprary working
	buffers.

2011-11-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* message.el (message-pop-to-buffer): Revert 2011-09-11 change.

2011-11-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-browse-html-parts): Convert link file names
	for Cygwin.

2011-11-24  Glenn Morris  <rgm@gnu.org>

	* starttls.el: Fix case of "GnuTLS".

2011-11-24  Juanma Barranquero  <lekktu@gmail.com>

	* gnus-group.el (gnus-group-highlight): Fix typo.

2011-11-24  Adam W  <adam_w67@yahoo.com>  (tiny change)

	* mail-source.el (mail-source-fetch-maildir): Don't expect the return
	value of `delete-file', that returns nil for a local file but returns t
	for a remote file using ssh.

2011-11-22  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-table-horizontal-line): Use "?\s" instead of "? " to
	avoid later breakage.

2011-11-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-setup-buffer): Decode group name used for
	article buffers' name.

2011-11-22  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-table-horizontal-line): Revert infinite loops introduced
	by Paul Eggert's spellfixes two days ago.

2011-11-21  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mm-view.el (mm-display-inline-fontify): Make the font-lock variables
	buffer-local instead of binding them to avoid warnings.  Also demote
	errors (bug#10063).
	(font-lock-mode-hook): Shut up byte compiler.

2011-11-20  Juanma Barranquero  <lekktu@gmail.com>

	* mm-util.el (mm-charset-after): Fix typo.

2011-11-16  Juanma Barranquero  <lekktu@gmail.com>

	* gnus-sum.el (gnus-summary-make-menu-bar):
	* gnus-uu.el (gnus-uu-decode-postscript)
	(gnus-uu-decode-postscript-and-save):
	* mailcap.el (mailcap-print-command):
	* registry.el (registry-lookup, registry-lookup-breaks-before-lexbind):
	Fix typos.

2011-11-15  Juanma Barranquero  <lekktu@gmail.com>

	* gnus-art.el (gnus-article-part-wrapper):
	* shr-color.el (shr-color-visible-distance-min)
	(shr-color-relative-to-absolute, set-minimum-interval)
	(shr-color-visible): Fix typos.

2011-11-03  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-articles-to-read): Change wording in prompt to be
	slightly clearer.

2011-11-03  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-send-and-exit): Document `arg'.

2011-11-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* nnimap.el (nnimap-open-connection-1): Use tcp-keealive if possible.

2011-11-02  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-util.el (gnus-bound-and-true-p): Another comment to explain why
	we don't use `bound-and-true-p'.

2011-11-01  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-util.el (gnus-bound-and-true-p): Remove.
	(gnus-bound-and-true-dumber-p): Rename to `gnus-bound-and-true-p'.
	* nnir.el: Use it.
	* nnmairix.el: Use it.

2011-10-31  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-util.el (gnus-bound-and-true-dumber-p): Define new, slower, dumb
	function because `gnus-bound-and-true-p' doesn't work well in XEmacs
	for reasons unknown.
	* nnir.el: Use it.
	* nnmairix.el: Use it.

	* nnregistry.el: Remove unnecessary `gnus-registry-enabled' defvar.
	* nnir.el: Ditto.
	* nnmairix.el: Ditto.

	* gnus-registry.el (gnus-registry-enabled): Default to nil.

2011-10-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* message.el (message-completion-function): Make sure
	message-tab-body-function is not attempted if one of
	message-completion-alist fails to find a completion (bug#9158).

2011-10-26  Daiki Ueno  <ueno@unixuser.org>

	* mml.el (mml-quote-region): Quote <#secure> tag.
	(mml-generate-mime-1): Unquote <#secure> tag.

2011-10-20  Chong Yidong  <cyd@gnu.org>

	* gnus-cite.el (gnus-message-citation-mode): Doc fix (in Emacs 24,
	calling a minor mode from Lisp with nil arg enables it, so we have to
	make the wording a bit ambiguous here).

2011-10-18  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-util.el (gnus-bound-and-true-p): Macro for XEmacs compatibility.
	* nnir.el (nnir-mode): Use it.
	* nnmairix.el (nnmairix-determine-original-group-from-registry):
	Use it.

	* nnir.el (gnus-registry-enabled): Defvar to keep the compiler happy.
	* nnmairix.el (gnus-registry-enabled): Ditto.

2011-10-17  Dave Abrahams  <dave@boostpro.com>

	* gnus-registry.el (gnus-registry-enabled): Add new variable (bug#9691).
	(gnus-registry-install-shortcuts): Set `gnus-registry-install' to 'ask
	only while we need to find out if it should be t or nil.
	(gnus-registry-initialize): Don't set `gnus-registry-install' to t.
	(gnus-registry-install-hooks): Set `gnus-registry-enabled' to t when
	the registry is installed.  Set it to nil when it's unloaded.
	(gnus-registry-install-p): Provide user guidance for the initial value
	of `gnus-registry-install' when it's 'ask, otherwise return its value.
	* nnregistry.el (nnregistry-open-server, nnregistry-server-opened):
	Use `gnus-registry-enabled' instead of `gnus-registry-install'.
	* nnmairix.el (nnmairix-determine-original-group-from-registry):
	Use `gnus-registry-enabled' instead of `gnus-registry-install'.
	* nnir.el (nnir-mode): Use `gnus-registry-enabled' instead of
	`gnus-registry-install'.

2011-10-17  Daiki Ueno  <ueno@unixuser.org>

	* mml2015.el (mml2015-epg-find-usable-key): Add comment about the
	previous change.
	* mml1991.el (mml1991-epg-find-usable-key): Skip the whole key if the
	primary key is marked as disabled.

2011-10-17  Christian von Roques  <roques@mti.ag>  (tiny change)

	* mml2015.el (mml2015-epg-find-usable-key): Skip the whole key if the
	primary key is marked as disabled.

2011-10-11  Andreas Schwab  <schwab@linux-m68k.org>

	* html2text.el (html2text-clean-anchor): Check for quotes around
	`href' value.

2011-10-11  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-check-BBDB): Simplify and support BBDB 3.x when
	searching.  Drop `bbdb-cache'.

2011-10-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-signed-or-encrypted-p): Exclude header when
	checking if there is signed or encrypted body in text/plain message.

2011-10-09  Andreas Schwab  <schwab@linux-m68k.org>

	* html2text.el (html2text-get-attr): Correctly handle attribute values
	containing "=".

2011-09-22  Kan-Ru Chen  <kanru@kanru.info>

	* ecomplete.el (ecomplete-display-matches): Use a local keymap to
	handle bindings.

2011-10-06  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-win.el (gnus-configure-windows): Protect against reading
	ephemeral groups outside of Gnus.

2011-10-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* shr.el (shr-tag-img): Don't get images displayed in tables.

2011-10-03  Glenn Morris  <rgm@gnu.org>

	* gnus-group.el (gnus-bug-group-download-format-alist): Once again get
	the "maintainer" version of debbugs.gnu.org reports.

2011-10-02  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-tag-img): Add a space at the end of an ALT image text to
	make asynchronous adjacent image insertion work better.

2011-09-27  Daiki Ueno  <ueno@unixuser.org>

	* plstore.el (plstore-select-keys, plstore-encrypt-to): Clarify
	documentation.

2011-09-27  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-uu.el (gnus-uu-grab-articles): Require gnus-async so that
	`gnus-asynchronous' isn't shadowed.

2011-09-26  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-wait-for-response): Message less (bug#9540).
	(nnimap-insert-partial-structure): The charset parameter isn't
	case-sensitive.

	* nnheader.el (nnheader-message-maybe): New function.

	* shr.el (shr-tag-table): Render totally broken tables better.

	* mml.el (mml-generate-mime-1): Don't alter the contents if we're
	computing the boundary.

2011-09-26  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* pop3.el (pop3-number-of-responses): Remove.
	(pop3-wait-for-messages): Rewrite to take linear time instead of
	exponential time.

2011-09-24  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-summary-show-article): Bind `shr-ignore-cache' to
	re-fetch images.

	* shr.el (shr-tag-img): Support a new variable `shr-ignore-cache' to
	re-fetch images when hitting `g' in Gnus.

2011-09-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mml.el (mml-inhibit-compute-boundary): New internal variable.
	(mml-compute-boundary): Don't check collision if it is non-nil.
	(mml-compute-boundary-1): Use mml-generate-mime-1 to encode part
	before checking collision.

2011-09-21  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-indent-citation): Really make sure there's a
	newline at the end.

	* nnimap.el (nnimap-parse-flags): Make regexp less prone to overflows.
	Fix suggested by John Wiegley.

	* pop3.el (pop3-open-server): Fix +OK end-of-command regexp.

	* gnus-art.el (gnus-treat-hide-citation): Add doc.

	* message.el (message-default-send-rename-function): Break out into its
	own function.

	* ecomplete.el (ecomplete-display-matches): Revert patch since it
	doesn't work under XEmacs.

	* nnimap.el (nnimap-map-port): New function to connect to 993 instead
	of "imaps" to word around Windows problems.
	(nnimap-open-connection-1): Use it.

	* message.el (message-indent-citation): Revert last change which made
	`F' not work.

2011-09-13  Kan-Ru Chen  <kanru@kanru.info>

	* ecomplete.el (ecomplete-display-matches): Intercept key sequence from
	terminal as well.

2011-09-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-view.el (mm-display-inline-fontify): Don't run doc-view-mode
	because it displays images using overlays that aren't easy to copy to
	the article buffer.

2011-09-20  Łukasz Stelmach  <lukasz.stelmach@iem.pw.edu.pl>  (tiny change)

	* message.el (message-indent-citation): Fix empty line removal at the
	end of the citation.

2011-09-20  Julien Danjou  <julien@danjou.info>

	* auth-source.el (auth-source-netrc-create): Use default value for
	password if specified.  Evaluate default.
	(auth-source-plstore-create): Ditto.
	(auth-source-plstore-create, auth-source-netrc-create): Fix default
	value evaluation.
	(auth-source-netrc-create): Typo fix.
	(auth-source-plstore-create): Ditto.

	* auth-source.el (auth-source-format-cache-entry): New function.

2011-09-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-fun.el (gnus-convert-image-to-x-face-command): Doc fix.

2011-09-18  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mm-decode.el (mm-inline-media-tests): Fix typo in regexp.

2011-09-19  Julien Danjou  <julien@danjou.info>

	* auth-source.el (auth-source-netrc-parse): Use an obfuscation method
	which work with things that are not ASCII.

2011-09-17  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mm-decode.el (mm-inline-media-tests): Support imagemagick images.

2011-09-15  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-summary-read-group-1): Bump the "Retrieving"
	message level.

2011-09-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-read-from-minibuffer): Make abbrev expansion work.

2011-09-12  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus.el (gnus-interactive-exit): Update defcustom spec.

2011-09-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* gnus.el (gnus-nntp-server): Move to gnus-int.el to silence bytecomp.
	* gnus-int.el (gnus-nntp-server): Move from gnus.el.

2011-09-12  Andrew Cohen  <cohen@andy.bu.edu>

	* gnus-group.el (gnus-group-list-limit-map, gnus-group-list-flush-map)
	(gnus-group-list-plus-map): Allow limiting, flushing and plusing ticked
	articles.

2011-09-11  Chong Yidong  <cyd@stupidchicken.com>

	* message.el (message-pop-to-buffer): Default to switch-to-buffer.
	(message-mail-other-window, message-mail-other-frame)
	(message-news-other-window, message-news-other-frame):
	Use switch-to-buffer-other-frame and switch-to-buffer-other-window
	instead of setting buffer display variables.

2011-09-11  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-group.el (gnus-group-list-limit): Explain what the command does.

	* gnus-sum.el (gnus-fetch-headers): Bump message level.

2011-09-11  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-dup.el (gnus-dup-suppress-articles): Move "Suppressing
	duplicates" to a higher level.

	* gnus-util.el (gnus-verbose): Lower default to 6 to get rid of the
	most egregious messages.

2011-09-10  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-msg.el (gnus-summary-mail-forward): Minuscule doc fix.

2011-09-10  Tetsuo Tsukamoto  <tt.tetsuo.tsukamoto@gmail.com>  (tiny change)

	* nnrss.el (nnrss-retrieve-groups): Decode the charset before looking
	up the file (bug#9351).

2011-09-10  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el: Redo the charset handling.  Let Gnus encode the names, as
	it does with all other backends, but decode the names immediately after
	getting them.

	* gnus-group.el (gnus-group-name-charset): Always return `utf-7' when
	decoding nnimap groups.

	* gnus.el (gnus-variable-list): Don't save `gnus-format-specs' in the
	newsrc file.  It doesn't seem like an important optimization any more.

2011-09-10  Dave Abrahams  <dave@boostpro.com>

	* nnimap.el (nnimap-transform-headers): Fix regexp to be less prone to
	overflows.

2011-09-10  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus.el (gnus-article-mark-lists): Remove `recent'.
	(gnus-interactive-exit): Extend to `quiet'.

	* gnus-sum.el (gnus-offer-save-summaries): Use it.

	* gnus-art.el (gnus-treat-hide-citation-maybe): Add more doc to the
	string.

	* plstore.el (plstore--get-buffer): Silence compiler warnings by
	renaming function arguments from `this'.

	* gnus-sum.el (gnus-newsgroup-recent): Remove.

	* gnus-spec.el (gnus-lrm-string-p): `bidi-string-mark-left-to-right'
	has been renamed.
	(gnus-lrm-string-p): Include RLM and PDF, too.

	* gnus-int.el (gnus-open-server): Make the "denied" message clearer
	(bug#9225).

2011-09-10  Eli Zaretskii  <eliz@gnu.org>

	Add autoload cookies for functions used by sendmail.el.
	* mm-encode.el (mm-default-file-encoding): Add autoload cookie.

	* mml.el (mml-to-mime, mml-attach-file): Add autoload cookies.

2011-09-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (article-date-ut): Work properly even when there are
	things like Date header in the body; work for forwarded parts.

2011-09-05  Andrew Cohen  <cohen@andy.bu.edu>

	* gnus-sum.el (gnus-summary-exit): Ensure we kill the proper
	original-article-buffer.

2011-09-05  Kan-Ru Chen  <kanru@kanru.info>

	* nnir.el (nnir-compose-result): Fix matching of server type.
	(nnir-run-swish++): Ditto.
	(nnir-run-namazu): Ditto.
	(nnir-run-notmuch): Ditto.

2011-09-04  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus.el (gnus-home-directory): Add warning about setting in .gnus.el
	(bug#9405).

	* gnus-score.el (gnus-summary-increase-score): Doc clarification
	(bug#9421).

	* gnus-spec.el (gnus-face-0): Make all the face specs into defcustoms
	(bug#9425).

	* gnus-art.el (gnus-treatment-function-alist): Remove CRs as the first
	thing (bug#9426).

2011-09-03  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-open-connection-1): Use the correct port number in
	the error message.

2011-09-02  Eli Zaretskii  <eliz@gnu.org>

	* message.el (message-setup-1): Return t (Bug#9392).

2011-09-01  Andrew Cohen  <cohen@andy.bu.edu>

	* gnus-sum.el: When adding article headers to a summary buffer also
	update gnus-newsgroup-articles (bug#9386).

2011-08-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* auth-source.el: Autoload help-mode.

2011-08-30  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-group.el (gnus-group-name-charset): Don't bug out on server
	names.

2011-08-27  Daiki Ueno  <ueno@unixuser.org>

	* mml-smime.el (mml-smime-epg-verify): Don't use the 4th arg of
	mm-replace-in-string for compatibility issues.
	* mml2015.el (mml2015-epg-verify): Ditto.

2011-08-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mailcap.el (mailcap-mime-data): Regexp-quote MIME subtype.

	* gnus-msg.el (gnus-setup-message): Remove extra apostrophe.

2011-08-21  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnmail.el (nnmail-get-new-mail-1): If one mail source bugs out,
	continue on and do the clean-up phase (bug#9188).

	* gnus-sum.el (gnus-summary-expire-articles): When expiring articles,
	just ignore groups that can't be opened instead of erroring out
	(bug#9225).

	* gnus-art.el (gnus-article-update-date-headers): Flip the default to
	nil since some many people are fuddy-duddies.

	* gnus-html.el (gnus-html-image-fetched): Don't cache zero-length
	images.

	* nntp.el (nntp-authinfo-file): Mark as obsolete -- use auth-source
	instead.

	* pop3.el (pop3-wait-for-messages): Don't use Gnus functions here.

	* gnus-util.el (gnus-process-live-p): Copy over compat function.

	* pop3.el (pop3-wait-for-messages): If the pop3 process dies, stop
	processing.

	* nntp.el (nntp-kill-buffer): Kill the process before killing the
	buffer to avoid warnings.

2011-08-20  Simon Josefsson  <simon@josefsson.org>

	* gnus-agent.el (gnus-agent-expire-done-message): Use %.f as format
	specified to reduce precision.

2011-08-19  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-transform-headers): Protect against (NIL ...)
	bodystructures (bug#9314).

2011-08-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-insert-mime-button, gnus-mime-display-alternative):
	Make button keymap non-sticky after buttons.

2011-08-18  David Engster  <dengste@eml.cc>

	* nnmairix.el (nnmairix-request-set-mark)
	(nnmairix-goto-original-article): Remove adding of article to registry,
	since `gnus-registry-add-group' isn't available anymore.
	(nnmairix-determine-original-group-from-registry):
	Use `gnus-registry-get-id-key' since `gnus-registry-fetch-groups' isn't
	available anymore.

2011-08-12  Simon Josefsson  <simon@josefsson.org>

	* starttls.el (starttls-any-program-available): Define as obsolete
	function.

2011-08-18  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-util.el (gnus-y-or-n-p): Reinstate the message-clearing y-or-n-p
	versions which Gnus use when appropriate.

	* gnus-group.el (gnus-group-clear-data): Add a y-or-n query, since it's
	a pretty destructive command.

	* nnmail.el (nnmail-extra-headers): Clarify slightly (bug#9302).

2011-08-17  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-fix-before-sending): Make a different warning
	about NUL characters (bug#9270).

	* gnus-sum.el (gnus-auto-select-subject): Allow specifying a function
	from custom (bug#9260).

	* gnus-spec.el (gnus-lrm-string): Use 8206 instead of ?\x200e to make
	things work in Emacs 22 and XEmacs, too.

	* gnus-sum.el (gnus-summary-from-or-to-or-newsgroups): LRM-ify the
	default From.

	* gnus-spec.el (gnus-lrm-string-p): New macro.
	(gnus-lrm-string): New constant.
	(gnus-summary-line-format-spec): LRM-ify the from.
	(gnus-tilde-max-form): LRM-ify string chopping.

	* gnus-ems.el (gnus-string-mark-left-to-right): New function.

	* message.el (message-is-yours-p): Allow disabling canlock checking
	(bug#9295).
	(message-shoot-gnksa-feet): Add `canlock-verify'.
	(message-auto-save-directory): Use ~/ as the auto-save directory if the
	message directory isn't writable (bug#9304).

	* auth-source.el (auth-source-netrc-saver): Make the .authinfo file
	non-world-readable.

2011-08-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nndraft.el (nndraft-update-unread-articles): Don't send delayed
	articles.

2011-08-13  Andreas Schwab  <schwab@linux-m68k.org>

	* gnus-score.el (gnus-all-score-files): Use copy-sequence instead of
	copy-list.

2011-08-12  Sam Steingold  <sds@gnu.org>

	* gnus-score.el (gnus-score-find-alist): Keep the score files already
	in the reverse order to avoid modifying the cache with `nreverse'.
	(gnus-all-score-files): Do not modify the value returned by
	`gnus-score-find-alist' because it lives in a cache variable.
	(gnus-current-home-score-file): No need to `nreverse' the return value
	of `gnus-score-find-alist', it is already in the correct order.

2011-08-11  Andrew Cohen  <cohen@andy.bu.edu>

	* nnimap.el (nnimap-transform-headers): BODYSTRUCTURE for messages of
	type MESSAGE and subtype RFC822 is slightly different from those of
	type TEXT.

2011-08-05  Andrew Cohen  <cohen@andy.bu.edu>

	* gnus-sum.el (gnus-summary-refer-article): Warp to article.
	This allows article-referral to work from an nnir group.

2011-08-04  Andrew Cohen  <cohen@andy.bu.edu>

	* gnus.el (registry-ignore): Add nnir groups to the ignore-list.

2011-08-04  Daiki Ueno  <ueno@unixuser.org>

	* mml1991.el (mml1991-epg-find-usable-key)
	(mml1991-epg-find-usable-secret-key): New function.
	(mml1991-epg-sign): Check if signing key is usable.
	(mml1991-epg-encrypt): Check if encrypting key is usable (bug#8955).

2011-08-03  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (nnir-read-server-parm): Add an argument to restrict to
	server-variables only.  This should fix a bug introduced with commit
	e1889675b7f4adf057833c5513c9374134c4e053.
	(nnir-run-query): 'nnir-search-engine should not be set from the global
	environment.

2011-08-02  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (nnir-search-thread): Position point on referring article
	line.
	(nnir-warp-to-article): Clean up summary buffers.

	* nnimap.el (nnimap-request-thread): Whitespace fix.

2011-08-02  Steve Purcell  <steve@sanityinc.com>  (tiny change)

	* nnimap.el (nnimap-get-groups): Decode "&" correctly.

2011-08-02  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* starttls.el (starttls-available-p): Rename from
	`starttls-any-program-available' and changed return convention.

2011-07-31  Lars Ingebrigtsen  <larsi@gnus.org>

	* nnmaildir.el (nnmaildir-request-accept-article): Don't call
	`unix-sync' unless it's defined.

2011-07-31  Marcus Harnisch  <marcus.harnisch@gmx.net>  (tiny change)

	* gnus-art.el (gnus-article-stop-animations): Use `elt' instead of
	`aref' for XEmacs compatibiltiy.

2011-07-31  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* spam.el (spam-fetch-field-fast): Rewrite slightly for clarity.

2011-07-31  Dave Abrahams  <dave@boostpro.com>

	* gnus-sum.el (gnus-summary-refer-thread): Since lambdas aren't
	closures, quote the form properly (bug#9194).

2011-07-31  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-summary-insert-new-articles): Clean up slightly.
	(gnus-summary-insert-new-articles): Protect against servers that are
	down.

2011-07-29  Daniel Dehennin  <daniel.dehennin@baby-gnu.org>

	* mm-decode.el (mm-dissect-buffer): Add a default content-disposition
	in mm handle if none is specified.

2011-07-24  Andrew Cohen  <cohen@andy.bu.edu>

	* nnimap.el (nnimap-make-thread-query): Quote message-ids for gmail.

2011-07-23  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (nnir-search-thread): New function to make an nnir group
	based on a thread query.

	* gnus-sum.el (gnus-refer-thread-use-nnir): New variable to control use
	of nnir in thread referral.
	(gnus-summary-refer-thread): Use it.

	* nnimap.el (nnimap-request-thread): Use it.

2011-07-20  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-tag-comment): Ignore HTML comments.

2011-07-20  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (gnus-group-make-nnir-group): Allow optional search query
	argument.
	(gnus-group-make-nnir-group, nnir-request-group, nnir-run-query):
	Use `nnir-address' to handle server info rather than passing an arg.

	* nnimap.el (nnimap-make-thread-query): New utility function to format
	an imap thread search query.
	(nnimap-request-thread): Use it.

	* gnus-sum.el (gnus-handle-ephemeral-exit): Ensure we are setting the
	right select-method if we are not going back to the group buffer.

2011-07-19  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-group.el (gnus-group-read-ephemeral-group): Make sure we don't
	enter invalid buffer configurations into the quit form (bug#9107).
	(gnus-group-tool-bar-gnome): Replace connect/disconnect with
	unplugged/plugged.

	* gnus-sum.el (gnus-summary-refer-thread): When inserting new headers,
	keep track of which ones are unread (bug#9061).

	* gnus.el (gnus-refer-article-method): Allow entering any sexp
	(bug#9055).

	* gnus-art.el (gnus-article-show-images): Allow working if using w3m
	(bug#9041).

	* gnus-html.el (mm-util): Require (bug#9073).

	* gnus-sum.el (gnus-delete-duplicate-headers): New function.
	(gnus-summary-refer-thread): Use it to remove duplicates in the
	un-threaded view (bug#9053).
	(gnus-summary-insert-subject): Document USE-OLD-HEADER (bug#9070).

2011-07-07  Kan-Ru Chen  <kanru@kanru.info>

	* nnir.el (nnir-read-server-parm): Use default value from global
	variable.  Without this the default search engine parameters aren't
	used at all.

2011-07-19  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-unique-id): Don't use the undocumented return
	value from (random t) (bug#9118).

2011-07-16  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-auto-save-directory): If the ~/Mail directory
	doesn't exist, use ~ as the auto-save directory (bug#4432).

	* gnus-group.el (gnus-group-read-ephemeral-group): Start Gnus if it
	hasn't already been started.

2011-07-15  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus.el (debbugs-gnu): Rename from debbugs-emacs.

	* message.el (message-reply): Work around mysterious bug where
	`message-mode' seems to overwrite the locally bound `subject' variable.

2011-07-14  Andrew Cohen  <cohen@andy.bu.edu>

	* nnimap.el (nnimap-request-thread): Ensure search is performed in
	correct group.

	* gnus-int.el (gnus-request-thread): Add group argument.

	* gnus-sum.el (gnus-summary-refer-thread): Use it.

2011-07-10  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-group.el (gnus-read-ephemeral-emacs-bug-group): `debbugs-*'
	renamed to `debbugs-gnu-*'.

2011-07-08  Daiki Ueno  <ueno@unixuser.org>

	* plstore.el: Revert the editing feature since it is not urgent.
	(plstore-mode, plstore-mode-toggle-display, plstore-mode-original)
	(plstore-mode-decoded): Remove.

2011-07-07  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-msg.el (gnus-bug): Don't insert user variables.  It usually
	isn't very interesting any more, and it leaks potentially secret data.
	(gnus-debug): Remove.

	* gnus-art.el (gnus-ignored-headers): Remove obsolete and non-working
	use of :custom-show.

2011-07-07  Daiki Ueno  <ueno@unixuser.org>

	* plstore.el: Add documentation.
	(plstore-mode): New mode to edit plstore file.
	(plstore-mode-toggle-display, plstore-mode-original)
	(plstore-mode-decoded): New command.
	(plstore--encode, plstore--decode, plstore--write-contents-functions)
	(plstore--insert-buffer, plstore--make): New function.
	(plstore-open, plstore-save): Simplify by using them.

2011-07-06  Glenn Morris  <rgm@gnu.org>

	* gnus-group.el (gnus-read-ephemeral-emacs-bug-group): Silence compiler.

2011-07-05  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus.el (gnus-refer-article-method): Remove mention of nnspool, which
	no longer is much used.
	(gnus-summary-line-format): Link to "Marking Articles" instead of "Read
	Articles".

2011-04-03  Kan-Ru Chen  <kanru@kanru.info>

	* nnir.el (nnir-notmuch-program, nnir-notmuch-additional-switches)
	(nnir-notmuch-remove-prefix, nnir-engines, nnir-run-notmuch): New nnir
	`notmuch' backend.

2011-07-05  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mm-decode.el (mm-text-html-renderer): Doc fix.

	* gnus-msg.el (gnus-bug): Fix the MML tag.

	* pop3.el (pop3-open-server): -ERR is a valid response to CAPA.

2011-07-05  Daiki Ueno  <ueno@unixuser.org>

	* gnus-start.el (gnus-get-unread-articles): Don't connect to the
	secondary methods if started with `gnus-no-server'.

2011-07-05  Juanma Barranquero  <lekktu@gmail.com>

	* message.el (message-return-action): Fix typo in docstring.

2011-07-04  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-group.el (gnus-read-ephemeral-bug-group): Allow fetching several
	bug reports at once.

	* nnimap.el (nnimap-request-scan): Say that splitting has finished.

2011-07-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nndraft.el: Require gnus-group.
	(nndraft-request-list): Declare.

	* nndraft.el (nndraft-update-unread-articles): Don't show group having
	no unread article unless it matches gnus-permanently-visible-groups.

	* nndraft.el (nndraft-update-unread-articles): New function.
	(nndraft-request-associate-buffer): Use it to update the number of
	unread articles for the nndraft groups in the group buffer when saving
	or killing a draft message.

2011-07-03  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-group.el (gnus-read-ephemeral-bug-group): Bind the coding
	systems to binary before writing and reading the mbox files.

	* gnus.el (gnus-summary-line-format): Link to the info node for %U
	instead of trying to list them all (bug#8978).

2011-07-03  Wolfgang Jenkner  <wjenkner@inode.at>  (tiny change)

	* pop3.el (pop3-open-server): Use :end-of-capability.

2011-07-03  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-group.el (gnus-read-ephemeral-emacs-bug-group): Make sure that
	the id is always a number.

	* gnus-group.el (gnus-read-ephemeral-emacs-bug-group): Hook into
	debbugs mode, if possible.

2011-07-02  Daiki Ueno  <ueno@unixuser.org>

	* auth-source.el (auth-source-token-passphrase-callback-function):
	Reindent.
	(epg-context-operation): Remove unnecessary autoload.

2011-07-02  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus.el (gnus-list-debbugs): New command.

	* gnus-group.el (gnus-bug-group-download-format-alist): Get the
	mboxstat instead of the maintbox, since the stat seems to be fuller.

	* gnus-msg.el (gnus-configure-posting-styles): Don't try to select dead
	summary buffers.

	* message.el (message-get-reply-headers): Delete all duplicates,
	instead of the first.
	(message-get-reply-headers): Ensure that we have progress while
	deleting duplicates.

	* gnus-msg.el (gnus-configure-posting-styles): Get the local
	gnus-posting-style value from the summary buffer to make it easier to
	make that a per-buffer conf.

2011-07-02  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (nnir-run-imap): Allow halting a search when an article is
	found by setting `shortcut' in 'query.
	(nnir-request-article): Use `shortcut' setting when requesting article
	by Message-ID.

2011-07-02  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-msg.el (gnus-bug): Give the Version and Package headers to
	debbugs with the X-Debbugs-Package and X-Debbugs-Version headers.
	Bring the pseudo-headers back too.

2011-07-01  Daiki Ueno  <ueno@unixuser.org>

	* auth-source.el (auth-source-token-passphrase-callback-function):
	Simplify and remove EPA dependency.

2011-07-01  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (nnir-request-article): Fix error message text.

2011-07-01  Daiki Ueno  <ueno@unixuser.org>

	* auth-source.el (plstore-delete): Autoload.
	(auth-source-plstore-search): Support delete operation.
	* plstore.el (plstore-delete): New function.

2011-07-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-draft.el (gnus-draft-clear-marks): Revert last change;
	mark actually existing articles as unread rather than the ones that
	active asserts.

2011-07-01  Paul Eggert  <eggert@cs.ucla.edu>

	* nntp.el (nntp-record-command):
	* gnus-util.el (gnus-message-with-timestamp-1):
	Use format-time-string rather than decoding time stamps by hand.
	This is simpler and insulates the code from potential changes to
	current-time format.

2011-07-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-draft.el (gnus-draft-clear-marks): Mark deleted articles as read.

2011-07-01  Daiki Ueno  <ueno@unixuser.org>

	* plstore.el (plstore-select-keys, plstore-encrypt-to): New variable.
	(plstore-save): Support public key encryption.
	(plstore--init-from-buffer): New function.
	(plstore-open): Use it; fix error when opening a non-existent file.
	(plstore-revert): Use plstore--init-from-buffer.

2011-07-01  Daiki Ueno  <ueno@unixuser.org>

	* auth-source.el (auth-source-backend): Fix :initarg for data slot.

2011-06-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mml2015.el (mml2015-use): Replace string-match-p with string-match
	for old Emacsen.

2011-06-30  Daiki Ueno  <ueno@unixuser.org>

	* mml2015.el (mml2015-use): Don't try to load PGG on Emacs 24, when EPG
	is not fully working.

2011-06-30  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* dgnushack.el: Autoload sha1 on XEmacs.

	* gnus-group.el (gnus-read-ephemeral-emacs-bug-group): Take an optional
	quit window configuration.

	* auth-source.el (epg-context-set-passphrase-callback):
	Remove duplicate autoload.

2011-06-30  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (nnir-request-article): Allow requesting articles by
	Message-ID with nnimap.

	* gnus-sum.el (gnus-refer-article-methods): Allow (nnir) entry to use
	current server.

2011-06-30  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el: Autoload EPA/EPG functions.
	(auth-source-netrc-use-gpg-tokens): Clarify that it should not be
	changed when EPA/EPG is not available.
	(auth-source-backend): Rename "arg" member to "data".
	(auth-source-backend-parse, auth-source-plstore-search)
	(auth-source-plstore-create): Use it.

2011-06-30  Andrew Cohen  <cohen@andy.bu.edu>

	* gnus-art.el (gnus-request-article-this-buffer): Use existing function
	`gnus-refer-article-methods'.

2011-06-30  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el: Require EPA and EPG.
	(auth-source-passphrase-alist): New variable.
	(auth-source-passphrase-callback-function)
	(auth-source-token-passphrase-callback-function): Callbacks for the
	netrc field encryption (GPG tokens).
	(auth-source-epa-extract-gpg-token, auth-source-epa-make-gpg-token):
	Symmetric encryption and decryption of the netrc GPG tokens.
	(auth-source-netrc-normalize): Use them, simplifying the closure.

2011-06-30  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-split-incoming-mail): If `nnimap-split-fancy' is
	non-nil, and `nnimap-split-methods' is nil, use the former.

2011-06-30  Daiki Ueno  <ueno@unixuser.org>

	* plstore.el (plstore-revert): New function.
	(plstore-open): Use it; hide the buffer from user.

2011-06-30  Daiki Ueno  <ueno@unixuser.org>

	* auth-source.el (auth-source-backend): New member "arg".
	(auth-source-backend-parse): Handle new backend 'plstore.
	* plstore.el: New file.

2011-06-30  Glenn Morris  <rgm@gnu.org>

	* gnus-fun.el (gnus-convert-image-to-x-face-command): Doc fix.

	* mm-util.el (mm-charset-synonym-alist): Move definition before use.

2011-06-30  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-process-expiry-targets): Say what target we're
	expiring articles to.

	* mm-util.el (mm-charset-to-coding-system): Recognize all ANSI.x3.4
	variations as ASCII (bug#5458).

2011-06-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnmh.el (nnmh-request-list-1): Work on MS Windows.

2011-06-30  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-point-in-header-p): Tweak the function to default
	to saying that we're not in the headers if there is no separator at
	all.  This makes it possible to use the Message version of `M-q' in
	buffers with no headers (bug#7987).
	(message-point-in-header-p): Fix last checkin to work with an empty
	mail-header-separator, too.

	* auth-source.el (auth-source-netrc-saver): If the user says "don't ask
	again, save the choice via customize.

2011-06-29  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-send-mail-function): Add `sendmail-query-once'.

	* nnimap.el (nnimap-finish-retrieve-group-infos): If the server has
	ended the connection, bail out before waiting infinitely on a new
	connection.

2011-06-28  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-msg.el (gnus-bug): Add Package and Version pseudo-headers to bug
	reports.

	* gnus.el (gnus-bug-package): Use "gnus."
	(gnus-maintainer): Direct bug reports to submit@debbugs.gnu.org.

2011-06-26  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-art.el (gnus-article-stop-animations): New function to stop any
	animations going on at article exit time.

	* gnus-registry.el (gnus-registry-user-format-function-M): Reinstate,
	since removing it breaks people upgrading.

	* shr.el (shr-put-image): Use the new interface for animating images.
	(shr-put-image): Animate for 60 seconds.

	* auth-source.el (with-auth-source-epa-overrides): Fix compilation
	error with `find-file-hooks' on Emacs 22.
	(with-auth-source-epa-overrides): Ugly hack to Wrap the
	`find-file-hook' things in `symbol-value' to avoid compilation warnings
	on all architectures.

	* spam.el (spam-stat): Require in a normal fashion without binding
	`spam-stat-install-hooks' to avoid compilation warnings.

	* spam-stat.el (spam-stat-install-hooks): Remove.
	(spam-stat-install-hooks): Don't run automatically.

2011-06-26  Timo Juhani Lindfors  <timo.lindfors@iki.fi>  (tiny change)

	* gnus-msg.el (gnus-summary-reply-to-list-with-original): New command
	and keystroke.

2011-06-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* auth-source.el (auth-source-netrc-cache): Move forward.

2011-06-22  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* auth-source.el (auth-source-netrc-create): Don't query the bits that
	we already know.
	(auth-source-forget-all-cached): Clear auth-source-netrc-cache, too.
	(auth-source-netrc-create): Don't prompt for the stuff we already know.

2011-06-21  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* auth-source.el (auth-source-netrc-create): Don't print all tokens in
	%S format, since that looks odd.
	(auth-sources): Prefer the ~/.authinfo file over the ~/.authinfo.gpg
	file, especially when saving.

2011-06-21  Andrew Cohen  <cohen@andy.bu.edu>

	* nnimap.el (nnimap-find-article-by-message-id): Return nil when no
	article found.

2011-06-18  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el (auth-source-netrc-use-gpg-tokens): Replace
	`auth-source-save-secrets' with a more sensitive alist that can be
	configured per file.  Experimental, so defaults to 'never.
	(auth-source-netrc-create): Use it.  Still experimental code.
	(with-auth-source-epa-overrides): Use `find-file-hooks' if
	`find-file-hook' is unbound (XEmacs fix).  Fix backquoting bug.

2011-06-16  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el (auth-source-save-secrets): New variable to control if
	secret tokens should be saved encrypted.
	(auth-source-netrc-parse, auth-source-netrc-search): Pass the file name
	to `auth-source-netrc-normalize'.
	(with-auth-source-epa-overrides): Add convenience macro.  Don't depend
	on the EPA variables being defined.
	(auth-source-epa-make-gpg-token): Convert text to a "gpg:" token.
	(auth-source-netrc-normalize): Convert "gpg:" tokens back to text in
	the lexical-let closure.
	(auth-source-netrc-create): Create "gpg:" tokens according to
	`auth-source-save-secrets'.

2011-06-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-group.el (gnus-group-update-group): Add new argument
	`info-unchanged' that stops updating dribble buffer.

	* gnus-start.el (gnus-dribble-enter): Add new argument `regexp' that
	deletes lines matching to it in dribble buffer.

	* gnus-agent.el (gnus-agent-fetch-group-1):
	* gnus-group.el (gnus-group-update-group-line, gnus-group-make-group):
	* gnus-srvr.el (gnus-server-update-server, gnus-server-set-info):
	* gnus-start.el (gnus-group-change-level):
	* gnus-sum.el (gnus-summary-move-article): Delete old dribble entry.

	* gnus-sum.el (gnus-summary-update-info): Don't update dribble buffer
	if newsgroup info is not changed.

	* gnus-group.el (gnus-group-get-new-news-this-group):
	* gnus-sum.el (gnus-summary-read-group-1, gnus-summary-exit-no-update):
	Don't update dribble buffer.

2011-06-01  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-remove-ignored): New function to
	remove entries with groups we ignore.

2011-05-31  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-rescale-image): Add an :ascent of 100 to images so that
	the underline comes at the bottom.

2011-05-31  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-article-marks-to-chars): Rename from
	`gnus-registry-user-format-function-M' and declare the latter obsolete.
	(gnus-registry-article-marks-to-names): Rename from
	`gnus-registry-user-format-function-M2'.

2011-05-31  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-summary-exit): Make sure to kill article buffer in
	ephemeral group.

2011-05-31  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-browse-image): Copy the URL if called interactively.

2011-05-30  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-group.el (gnus-group-mark-article-read): It's possible that we
	want to have `gnus-newsgroup-unselected' kept sorted.  If this isn't
	done, then unselected articles may be marked as read.

	* pop3.el (pop3-open-server): Erase the buffer after the greeting,
	since not doing this seems to lead to a race condition in pop3-logon.

	* nnvirtual.el (nnvirtual-request-article): Bind `gnus-command-method'
	so that the call chain it correct when we call "upwards".

	* gnus-sum.el (gnus-select-newsgroup): Auto-expiry doesn't make sense
	in read-only groups.

	* gnus-group.el (gnus-group-mark-article-read): Ditto.

	* message.el (message-cite-reply-position): Doc string fix.

	* nnimap.el (nnimap-transform-headers): Simplify regexp to hopefully
	avoid regexp overflow.
	(nnimap-transform-split-mail): Ditto.

	* pop3.el (pop3-retr): Error out if the server closes the connection.

2011-05-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mml1991.el (mml1991-mailcrypt-encrypt): Remove use of ill-designed
	mm-with-unibyte-current-buffer.  The buffer should not contain any
	multibyte chars anyway at this stage.

2011-05-29  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-urlify): Use shr-add-font to make underlines be less ugly
	at the end of lines.

2011-05-29  Julien Danjou  <julien@danjou.info>

	* smiley.el (gnus-smiley-file-types): Add gif as supported file type.

2011-05-27  Glenn Morris  <rgm@gnu.org>

	* gnus-group.el (gnus-bug-group-download-format-alist):
	Use the "maintainer" version of debian reports as well.

2011-05-26  Glenn Morris  <rgm@gnu.org>

	* gnus-group.el (gnus-bug-group-download-format-alist):
	Use the "maintainer" version of debbugs.gnu.org reports.

2011-05-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-mime-delete-part): Fix mm-handle-filename usage.

2011-05-20  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-sum.el (gnus-summary-hide-thread): Fix bug where moving to hide
	the thread moves us backwards and so we loop forever.

2011-05-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-bodies.el (mm-decode-content-transfer-encoding): Allow leading
	whitespace in base64 data lines.

2011-05-18  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-user-format-function-M):
	Use `mapconcat'.
	(gnus-registry-user-format-function-M2): Use to see the full text of
	the marks.  Make "," the mark text separator.

	* nntp.el (nntp-send-authinfo): Use the "force" token for NNTP
	authentication with auth-source.

2011-05-17  Glenn Morris  <rgm@gnu.org>

	* gnus-group.el (gnus-import-other-newsrc-file):
	Use insert-file-contents.

2011-05-16  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-sum.el (gnus-summary-hide-all-threads): Add update message every
	1000 iterations.

2011-05-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nntp.el (nntp-open-connection): Check if process-type is available.

2011-05-16  Julien Danjou  <julien@danjou.info>

	* shr.el (shr-tag-del): Add support for del tag.

2011-05-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-html.el (gnus-html-put-image): Register a displayer.

	* shr.el (shr-image-displayer): Don't remove text props from alt text.

2011-05-13  Teodor Zlatanov  <tzz@lifelogs.com>

	* registry.el (prune-factor): New initialization parameter defaulting
	to 0.1.
	(registry-prune-hard): Use it.

	* gnus-registry.el (gnus-registry-fixup-registry): Set prune-factor to
	0.1 expicitly.

2011-05-13  Glenn Morris  <rgm@gnu.org>

	* message.el (message-send-mail-with-sendmail): Assume sendmail-program
	is bound, since this function requires sendmail.

2011-05-11  Teodor Zlatanov  <tzz@lifelogs.com>

	* registry.el (registry-usage-test): Disable pruning test.

2011-05-10  Teodor Zlatanov  <tzz@lifelogs.com>

	* registry.el (registry-prune-hard-candidates)
	(registry-prune-soft-candidates): Helper methods for registry pruning.
	(registry-prune): Use them.  Make the sort function optional.

2011-05-10  Jim Meyering  <meyering@redhat.com>

	* shr.el (shr-colorize-region): Fix typo "on on -> on".

2011-05-10  Julien Danjou  <julien@danjou.info>

	* shr.el (shr-put-color-1): Do not bug out when old-props is a face
	symbol and not a list.

2011-05-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-mode): Move binding of
	shr-put-image-function here from gnus-article-prepare-display.

	* shr.el (shr-put-image-function): New variable.
	(shr-image-fetched, shr-image-displayer, shr-tag-img): Funcall it.
	(shr-put-image): Return scaled image.

	* gnus-art.el (gnus-shr-put-image): New function.
	(gnus-article-prepare-display): Bind shr-put-image-function to it.

	* gnus-html.el (gnus-html-wash-images): Register scaled images, not
	original ones, as deletable.

2011-05-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* nntp.el (nntp-open-connection): Set TCP keepalive option.

2011-05-09  Teodor Zlatanov  <tzz@lifelogs.com>

	* registry.el (registry-full): Add convenience method.  Fix logic.
	(registry-insert): Use it.  Fix logic here too.

	* gnus-registry.el (gnus-registry-insert): Add wrapper that calls
	`registry-prune' if `registry-full' returns t.
	(gnus-registry-handle-action)
	(gnus-registry-get-or-make-entry, gnus-registry-set-id-key)
	(gnus-registry-usage-test): Use it.

2011-05-07  Julien Danjou  <julien@danjou.info>

	* shr.el (shr-link): Make shr-link inherit from link by default.

2011-05-06  Teodor Zlatanov  <tzz@lifelogs.com>

	* shr.el (shr-urlify, shr-link): Fix shr-link face.

2011-05-05  Teodor Zlatanov  <tzz@lifelogs.com>

	* shr.el (shr-urlify, shr-link): Still broken but at least doesn't
	error out because the face is not a list.

2011-05-05  Glenn Morris  <rgm@gnu.org>

	* gnus-start.el (gnus-propagate-marks): Declare.

2011-05-04  Teodor Zlatanov  <tzz@lifelogs.com>

	* registry.el (registry-reindex): Fix percentage message.

2011-05-03  Teodor Zlatanov  <tzz@lifelogs.com>

	* shr.el: Add shr-link face for links.
	(shr-urlify): Use it.

	* registry.el (registry-insert): Make error message more helpful.

2011-05-02  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-html.el (gnus-html-schedule-image-fetching):
	Use url-queue-retrieve, if it exists.

	* shr.el (shr-tag-img): Ditto.

	* gnus.el: Autoload more gnus-agent functions.

	* gnus-art.el (gnus-request-article-this-buffer): Store articles in the
	agent if we haven't already (bug#8502).

	* gnus-async.el (gnus-async-article-callback): Put prefetched articles
	into the Agent, too.

	* gnus-agent.el (gnus-agent-store-article): New function.

	* nnheader.el (nnheader-insert-buffer-substring): Rename from nntp-
	and moved from that file for reuse.

	* pop3.el (pop3-open-server): Error messages are "-ERR".

2011-05-01  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* pop3.el (pop3-open-server): Upgrade opportunistically to STARTTLS.
	(open-tls-stream): Remove superfluous tls/starttls autoloads.

2011-05-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* gnus-sum.el (gnus-summary-next-article): Don't bug out if the summary
	buffer has moved to a different frame.

2011-05-01  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-request-article): Use nntp-insert-buffer-substring
	to get the conversion from unibyte to multibyte buffers to work on
	Emacs 22.

	* nntp.el (nntp-request-article): Slight clean-up.

2011-04-29  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-strike-through): New face.
	(shr-tag-s): Use it to provide <s> support.
	(shr-tag-s): Remove duplicate definition.

2011-04-25  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-ignore-group-p): Don't call
	`gnus-parameter-registry-ignore' if the *Group* buffer doesn't exist.

2011-04-23  Glenn Morris  <rgm@gnu.org>

	* gnus-sum.el (gnus-extra-headers): Bump :version.

2011-04-24  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-tag-sup): New function.
	(shr-tag-sub): Ditto.

2011-04-22  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-ignore-group-p): Test specifically
	for the case where `gnus-registry-ignored-groups' is a list of lists,
	and don't call `gnus-parameter-registry-ignore' otherwise.

2011-04-21  Teodor Zlatanov  <tzz@lifelogs.com>

	* nnimap.el (nnimap-user): New backend variable.
	(nnimap-open-connection-1): Use it.
	(nnimap-credentials): Accept user parameter so it's explicit what user
	name is desired.

	* gnus-sum.el (gnus-extra-headers): Add Keywords, Cc, and Gcc to
	default.

	* gnus.el (gnus-registry-ignored-groups): Provide default in gnus.el,
	not gnus-registry.el.

	* gnus-registry.el: Mention in comments how to modify
	`gnus-extra-headers' for proper recipient tracking and that it may
	already have To and Cc recently, which it does as of this commit.
	(gnus-registry-ignored-groups): Remove defcustom.
	Explain why in comments.
	(gnus-registry-action): Fix data-header reference to use the extra
	headers.  Explain in package commentary how to add To and Cc headers to
	the gnus-extra-headers.
	(gnus-registry-ignored-groups): Adjust defaults to match the parameter.
	(gnus-registry-ignore-group-p): Adjust to take either a group/topic
	parameter list or a string list in `gnus-registry-ignored-groups'.
	Fix logic error.

2011-04-21  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-expand-url): Protect against null urls.

2011-04-20  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-base): New binding.
	(shr-tag-base): Keep track of <base>.
	(shr-expand-url): New function used throughout.

2011-04-20  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el
	(gnus-registry--split-fancy-with-parent-internal): Fix loop bugs.
	(gnus-registry-ignored-groups): New variable.
	(gnus-registry-ignore-group-p): Use it.
	(gnus-registry-handle-action): Use `gnus-registry-ignore-group-p' and
	set the destination group to nil (same as delete) if it's ignored.

2011-04-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-registry.el (gnus-registry-action)
	(gnus-registry-fetch-header-fast):
	Don't use mail-header that looks an internal function of mailheader.el.

2011-04-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-registry.el: Eliminate cl functions.
	(gnus-registry-sort-addresses): New function that replaces mapcan.
	(gnus-registry-action, gnus-registry-spool-action)
	(gnus-registry-split-fancy-with-parent)
	(gnus-registry-fetch-recipients-fast): Use it.
	(gnus-registry-import-eld): Replace delete* with dolist + delq.

	* registry.el (initialize-instance, registry-lookup)
	(registry-lookup-breaks-before-lexbind, registry-lookup-secondary)
	(registry-lookup-secondary-value, registry-search, registry-delete)
	(registry-insert, registry-reindex, registry-size, registry-prune):
	Use eval-and-compile.

2011-04-16  Teodor Zlatanov  <tzz@lifelogs.com>

	* registry.el (registry-reindex): New method to recreate the secondary
	registry indices.

	* gnus-registry.el (gnus-registry-fixup-registry): Use it if the
	tracked field changes.
	(gnus-registry-unfollowed-addresses, gnus-registry-track-extra)
	(gnus-registry-action, gnus-registry-spool-action)
	(gnus-registry-handle-action)
	(gnus-registry--split-fancy-with-parent-internal)
	(gnus-registry-split-fancy-with-parent)
	(gnus-registry-register-message-ids): Add recipient tracking on spool,
	move, and delete actions, and for fancy splitting with parent.
	(gnus-registry-extract-addresses)
	(gnus-registry-fetch-recipients-fast)
	(gnus-registry-fetch-header-fast): Convenience functions.
	(gnus-registry-misc-test): ERT test of
	`gnus-registry-extract-addresses'.

2011-04-15  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry--split-fancy-with-parent-internal):
	Track by subject first, then sender.

2011-04-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* message.el (message-bogus-system-names): Replace ^...$ => \`...\'.

	* gnus.el (gnus-splash-svg-color-symbols): Don't use insert-file from
	Lisp.

	* gnus-draft.el (gnus-draft-setup): New arg `dont-pop'.
	(gnus-draft-send): Use it to avoid popping
	up frames from gnus-group-send-queue.

2011-04-14  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el: Updated gnus-registry docs.

2011-04-12  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry--split-fancy-with-parent-internal):
	Fix logic bug.
	(gnus-registry-post-process-groups): Fix logging of no results and
	quote sender and subject.

2011-04-12  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-start.el (gnus-get-unread-articles): Slight cleanup.
	(gnus-read-active-for-groups): Don't try to finish getting stuff where
	we had no early-data returned.
	(gnus-get-unread-articles): Add a sanity check so that we don't issue
	two async commands to the same server at the same time.

2011-04-12  Stig Sandbeck Mathisen  <ssm@fnord.no>  (tiny change)

	* gnus-sum.el (gnus-summary-select-article-buffer): Doc fix.

2011-04-12  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-registry.el (gnus-registry-remake-db): Put the warning on a
	"warning" level.

	* mm-url.el (mm-url-package-name): Remove to ease third-party reuse.
	(mm-url-insert-file-contents): Don't set the package names.

2011-04-11  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-action): Remove properties and
	simplify subject in `gnus-registry-handle-action'.
	(gnus-registry-spool-action): Get subject and sender from message if
	they are not passed in.
	(gnus-registry-handle-action): Remove properties and simplify subject
	consistently.

2011-04-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* registry.el: Require CL before using defmacro*.

2011-04-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (article-treat-date): Assume that
	gnus-article-date-headers may be a group parameter.

2011-04-07  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-handle-action): More debugging.

	* gnus-start.el (gnus-gnus-to-newsrc-format): Add a way to run
	interactively so the newsrc file can contain foreign groups too.
	Useful for debugging but not much for users.

2011-04-07  David Engster  <dengste@eml.cc>

	* registry.el (registry-usage-test): Only do
	`registry-lookup-breaks-before-lexbind' testing for Emacs24 with
	lexical binding.

2011-04-06  David Engster  <dengste@eml.cc>

	* registry.el, gnus-registry.el: Use `ignore-errors' instead of third
	argument NOERROR for `require', since XEmacs 21.4 does not support it.

2011-04-06  David Engster  <dengste@eml.cc>

	* registry.el (initialize-instance): Change :after to :AFTER to be
	compatible with old EIEIO version in XEmacs.

2011-04-06  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-post-process-groups)
	(gnus-registry--split-fancy-with-parent-internal): Fix splitting bugs
	and provide better messaging.

2011-04-06  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el: Don't use ERT if it's not available.  Load it
	unconditionally anyway, discarding errors.
	(gnus-registry-delete-entries): New convenience function.
	(gnus-registry-import-eld): Import from old .eld registry.

	* registry.el: Don't use ERT if it's not available.  Load it
	unconditionally anyway, discarding errors.

	* proto-stream.el (gnutls-negotiate): Revert inadvertent commit of the
	version from the Claudio Bley GnuTLS patch (extra optional parameters
	and host name).

2011-04-05  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-fixup-registry): New function to
	fixup the parameters that can be customized by the user between
	save/read cycles.
	(gnus-registry-read): Use it.
	(gnus-registry-make-db): Use it.
	(gnus-registry-spool-action, gnus-registry-handle-action):
	Fix messaging.
	(gnus-registry--split-fancy-with-parent-internal): Fix loop.
	Map references to actual group names with sender and subject tracking.
	(gnus-registry-post-process-groups): Use `cond' for better messaging.
	(gnus-registry-usage-test): Add subject lookup test.

	* registry.el (registry-db, initialize-instance): Set up constructor
	instead of :initform arguments for the sake of older Emacsen.
	(registry-lookup-breaks-before-lexbind): New method to demonstrate
	pre-lexbind merge bug.
	(registry-usage-test): Use it.
	(initialize-instance, registry-db): Move the non-function initforms
	back to the class definition.

2011-04-03  Teodor Zlatanov  <tzz@lifelogs.com>

	* registry.el: New library to manage gnus-registry-style data.

	* gnus-registry.el: Use it (major rewrite).

	* nnregistry.el: Use it.

	* spam.el: Use it.

2011-04-03  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-update-marks): Reinstate the code to not alter
	marks on non-selected articles.

2011-04-02  Chong Yidong  <cyd@stupidchicken.com>

	* proto-stream.el: Move to Emacs core, at net/network-stream.el.

	* nnimap.el (nnimap-open-connection-1): Pass explicit :end-of-command
	parameter to open-protocol-stream.

2011-04-01  Julien Danjou  <julien@danjou.info>

	* mm-view.el (mm-display-inline-fontify): Do not fontify with
	fundamental-mode.

2011-04-01  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-start.el (gnus-get-unread-articles): Don't try to contact denied
	servers.

2011-03-30  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-update-marks): Revert intersection change, which
	made marks not propagate, again.

2011-03-30  Chong Yidong  <cyd@stupidchicken.com>

	* proto-stream.el (open-protocol-stream): Bring back `network' type.
	Make this the default type.
	(proto-stream-open-plain): Rename from proto-stream-open-default.
	(open-protocol-stream, proto-stream-open-starttls)
	(proto-stream-open-tls, proto-stream-open-shell): Replace `default'
	with `plain'.

	* nnimap.el (nnimap-stream, nnimap-open-connection-1): Accept `network'
	value.

	* nntp.el (nntp-open-connection-function): Document the fact that some
	values are not functions but are instead handled specially.
	Recognize nntp-open-plain-stream value.
	(nntp-open-connection): Recognize that value.

2011-03-29  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gssapi.el (open-gssapi-stream): Remove the last mentions of the IMAP
	stuff.

	* gnus-score.el (gnus-score-string): Fix calling convention of
	`gnus-simplify-buffer-fuzzy' after last patches.

	* gnus-sum.el (gnus-update-marks): Don't send any marks updates to the
	server for articles we didn't get any headers for.  This is a sanity
	check.

2011-03-29  Michael Welsh Duggan  <md5i@md5i.com>

	* nnimap.el (nnimap-open-connection-1): Is the login responds with a
	new CAPABILITY, use it.

2011-03-29  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-agent.el (gnus-agent-fetch-headers): Don't message if we're not
	downloading anything.

	* gnus.el (gnus-splash-svg-color-symbols): Remove superfluous `and'.

2011-03-29  Adam Sjøgren  <asjo@koldfront.dk>

	* gnus.el (gnus-group-startup-message): Prefer svg file and replace
	colors.
	(gnus-splash-svg-color-symbols): New function.

2011-03-29  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-simplify-buffer-fuzzy): Take the regexp explicitly
	instead of using the global gnus-simplify-subject-fuzzy-regexp.
	(gnus-simplify-subject-fuzzy): Use the local
	gnus-simplify-subject-fuzzy-regex instead of the global one.
	This makes using this variable in group parameters work.

2011-03-29  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-unfollowed-groups):
	Add "archive:sent" to the unfollowed group regex (for the recent Gnus
	archive:sent-YYYY-MM-DD groups).
	(gnus-registry-split-fancy-with-parent): Bail out early in sender
	tracking if there are more than `gnus-registry-max-track-groups'
	matches.

2011-03-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* message.el (message--yank-original-internal): New function to do the
	insertion cleanly inside eval in `message-yank-original'.
	(message-yank-original): Use it.

2011-03-29  Julien Danjou  <julien@danjou.info>

	* mm-view.el (mm-display-inline-fontify): Use `set-normal-mode' with
	local variables disabled rather than `normal-mode'.

2011-03-26  Chong Yidong  <cyd@stupidchicken.com>

	* proto-stream.el: Changes preparatory to merging open-protocol-stream
	with open-network-stream.
	(proto-stream-always-use-starttls): Option removed.
	(open-protocol-stream): Return a process object by default.  Provide a
	new parameter :return-list specifying a list-type return value, which
	now has the form (PROP . PLIST) instead of a fixed-length list.  Change
	:type `network' to `try-starttls', and `network-only' to `default'.
	Make `default' the default, for compatibility with open-network-stream.
	Handle the no-parameter case exactly as open-network-stream, with no
	additional stream processing.  Search plists using plist-get.
	Explicitly add :end-of-commend parameter if it is missing.
	(proto-stream-open-default): Rename from
	proto-stream-open-network-only.  Return 'default as the type.
	(proto-stream-open-starttls): Rename from proto-stream-open-network.
	Use plist-get.  Don't return `tls' as the type if STARTTLS negotiation
	failed.  Always return a list with a (possibly dead) process as the
	first element, for compatibility with open-network-stream.
	(proto-stream-open-tls): Use plist-get.  Always return a list.
	(proto-stream-open-shell): Return `default' as connection type.
	(proto-stream-capability-open): Use plist-get.
	(proto-stream-eoc): Function deleted.

	* nnimap.el (nnimap-stream, nnimap-open-connection)
	(nnimap-open-connection-1): Handle renaming of :type parameter for
	open-protocol-stream.
	(nnimap-open-connection-1): Pass a :return-list parameter
	open-protocol-stream to obtain a list return value.  Parse this list
	using plist-get.

	* nntp.el (nntp-open-connection): Handle renaming of :type parameter
	for open-protocol-stream.  Accept open-protocol-stream return value
	that is a subprocess object instead of a list.  Handle the case of a
	dead returned process.

2011-03-25  Teodor Zlatanov  <tzz@lifelogs.com>

	* mm-util.el (mm-handle-filename): Move to mm-decode.el (bug#8330).

	* mm-decode.el (mm-handle-filename): Move from mm-util.el (bug#8330).

2011-03-21  Julien Danjou  <julien@danjou.info>

	* mm-view.el (mm-display-inline-fontify): Make mode optional, and call
	normal-mode if not set.  Set temp buffer unmodified to avoid kill-buffer
	query.
	(mm-inline-text): Render normal text with fontification whenever
	possible.

	* gnus-sum.el (gnus-summary-save-parts-1):
	* gnus-art.el (gnus-article-browse-html-save-cid-content)
	(gnus-article-browse-html-parts, gnus-mime-delete-part)
	(gnus-mime-copy-part, gnus-mime-inline-part, gnus-insert-mime-button):
	Use `mm-handle-filename'.

	* mm-util.el (mm-handle-filename): New function, return the filename of
	an handle.

2011-03-18  Julien Danjou  <julien@danjou.info>

	* gnus-util.el (gnus-buffer-live-p): Simplify gnus-buffer-live-p.
	(gnus-buffer-live-p): Check that buffer is not nil.

2011-03-17  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-art.el: Require mouse, which the build bot seems to say is
	needed.

	* gravatar.el (gravatar-retrieve-synchronously): Use `url-retrieve' on
	XEmacs, since it doesn't have url-retrieve-synchronously.

2011-03-17  Antoine Levitt  <antoine.levitt@gmail.com>

	* gnus-group.el (gnus-group-list-ticked): New function.
	(gnus-group-make-menu-bar): Provide a menu entry for it.
	(gnus-group-list-map): Provide a binding for it.

2011-03-17  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-visit-file): New command.

	* nnimap.el (nnimap-fetch-inbox): Rewrite slightly last patch.

2011-03-17  Bjørn Mork  <bjorn@mork.no>

	* nnimap.el (nnimap-fetch-inbox): Don't download bodies on ver4-capable
	servers.

2011-03-16  Julien Danjou  <julien@danjou.info>

	* mm-uu.el (mm-uu-dissect-text-parts): Only dissect handle that are
	inline.

	* gnus-art.el (article-hide-list-identifiers):
	Use gnus-group-get-list-identifiers.

	* gnus-sum.el (gnus-group-get-list-identifiers): New function.
	(gnus-summary-remove-list-identifiers):
	Use gnus-group-get-list-identifiers to get regexp.
	(gnus-select-newsgroup, gnus-summary-insert-subject)
	(gnus-summary-insert-articles):
	Call gnus-summary-remove-list-identifiers unconditionally.

2011-03-15  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-articles-to-read): Revert back to old behavior if
	we're selecting a group with unread articles.

	* nnimap.el (nnimap-open-connection-1): Allow `network-only', too.

	* gssapi.el: New file separated out from imap.el to provide a general
	Kerberos 5 connection facility for Emacs.

	* message.el (message-elide-ellipsis): Document the format spec
	ellipsis.

2011-03-15  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-elide-region): Allow the ellipsis to say how many
	lines were removed.

2011-03-15  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-win.el (gnus-configure-frame): Protect against trying to restore
	window configurations containing buffers that are now dead.

	* nnimap.el (nnimap-parse-flags): Remove all MODSEQ entries before
	parsing to avoid integer overflows.
	(nnimap-parse-flags): Simplify the last change.
	(nnimap-parse-flags): Store HIGHESTMODSEQ as a string, since it may be
	too large for 32-bit Emacsen.

2011-03-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* auth-source.el (auth-source-netrc-create):
	* message.el (message-yank-original): Fix use of `case'.

2011-03-15  Nelson Ferreira  <nelson.ferreira@ieee.org>  (tiny change)

	* gnus-art.el (gnus-article-treat-body-boundary): Fix boundary width on
	XEmacs, which was one character too wide.

2011-03-09  Antoine Levitt  <antoine.levitt@gmail.com>

	* gnus-sum.el (gnus-articles-to-read): Use gnus-large-newsgroup as
	default number of articles to display.
	(gnus-articles-to-read): Use pretty names for prompt.

2011-03-15  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-int.el (gnus-open-server): Ditto.

	* gnus-start.el (gnus-activate-group): Give a backtrace if
	debug-on-quit is set and the user hits `C-g'.
	(gnus-read-active-file): Ditto.

	* gnus-group.el (gnus-group-read-ephemeral-group): Ditto.

2011-03-15  Teodor Zlatanov  <tzz@lifelogs.com>

	* message.el (message-yank-original): Use cond instead of CL case.

2011-03-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* auth-source.el (auth-source-netrc-create): Use usual format for the
	default in prompts.

2011-03-13  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el (auth-source-netrc-create): Show the default in the
	prompt when prompting for token creation.

2011-03-12  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el (auth-source-format-prompt): Always convert the value
	to a string to avoid evaluating non-string arguments.
	(auth-source-netrc-create): Offer default properly, not as initial
	content in `read-string'.
	(auth-source-netrc-saver): Use a cache keyed by file name and MD5 hash
	of line to determine if we've been run before.  If so, don't run again,
	but print a trivial message to indicate the cache was hit instead.

2011-03-11  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-sync.el (gnus-sync-install-hooks, gnus-sync-unload-hook):
	Don't install `gnus-sync-read' to any hooks by default.  It's buggy.
	The user will have to run `gnus-sync-read' manually and wait for Cloudy
	Gnus.

2011-03-11  Julien Danjou  <julien@danjou.info>

	* mm-uu.el (mm-uu-type-alist): Add support for diff starting with "===
	modified file".

2011-03-09  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el (auth-source-read-char-choice): New function to read a
	character choice using `dropdown-list', `read-char-choice', or
	`read-char'.  It appends "[a/b/c] " to the prompt if the choices were
	'(?a ?b ?c).  The `dropdown-list' support is disabled for now.  Use
	`eval-when-compile' to load `dropdown-list'.  Remove `dropdown-list'.
	(auth-source-netrc-saver): Use it.
	(auth-source-pick-first-password): New convenience function.

2011-03-08  Teodor Zlatanov  <tzz@lifelogs.com>

	* nnimap.el (nnimap-credentials): Keep the :save-function as the third
	parameter in the credentials.
	(nnimap-open-connection-1): Use it after a successful login.
	(nnimap-credentials): Add IMAP-specific user and password prompt.

	* auth-source.el (auth-source-search): Add :require parameter, taking a
	list.  Document it and the :save-function return token.  Pass :require
	down.  Change the CREATED message from a warning to a debug statement.
	(auth-source-search-backends): Pass :require down.
	(auth-source-netrc-search): Pass :require down.
	(auth-source-netrc-parse): Use :require, if it's given, as a filter.
	Change save prompt to indicate all modifications saved here are
	deletions.
	(auth-source-netrc-create): Take user login name as default in user
	prompt.  Move all the save functionality to a lexically bound function
	under the :save-function token in the returned list.  Set up clearer
	default prompts for user, host, port, and secret.
	(auth-source-netrc-saver): New function, intended to be wrapped for
	:save-function.

2011-03-07  Chong Yidong  <cyd@stupidchicken.com>

	* Version 23.3 released.

2011-03-07  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-table-horizontal-line): Change the defaults for the table
	lines to be spaces instead.

2011-03-07  Julien Danjou  <julien@danjou.info>

	* sieve-manage.el (sieve-sasl-auth): Create auth-info if not found.
	(sieve-sasl-auth): Check that auth-source-search did return something,
	or just return an empty string.

2011-03-05  Antoine Levitt  <antoine.levitt@gmail.com>

	* gnus.el (gnus-interactive): Use read-directory-name.

	* gnus-uu.el (gnus-uu-decode-uu-and-save)
	(gnus-uu-decode-unshar-and-save, gnus-uu-decode-save)
	(gnus-uu-decode-binhex, gnus-uu-decode-yenc)
	(gnus-uu-decode-save-view, gnus-uu-decode-postscript-and-save):
	Likewise.

	* gnus-group.el (gnus-group-make-directory-group): Likewise.

2011-03-05  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-start.el (gnus-group-change-level): Allow putting foreign groups
	onto the list of killed groups, too.  This makes killed nnimap groups,
	for instance, more reliably not reappear.

	* nnimap.el (nnimap-request-thread): Don't bug out when we can't find
	the parent.

	* gnus-sum.el (gnus-update-read-articles): Fix typo.

	* gnus.el (gnus-valid-select-methods): Mark nnimap as a backend that
	really have server-side marks.

	* gnus-sum.el (gnus-propagate-marks): Change default back to nil again,
	since most backends do not usefully have server-side marks.
	(gnus-update-read-articles): Propagate marks to all backends that
	really have server-side marks.

2011-03-05  Antoine Levitt  <antoine.levitt@gmail.com>

	* message.el (message-cite-reply-position, message-cite-style):
	New variables.
	(message-yank-original): Use the new citation styles.

2011-03-04  Daiki Ueno  <ueno@unixuser.org>

	* message.el (message-options): Revert the change that's a workaround
	for XEmacs buffer-local issue; don't mark it buffer-local when running
	under XEmacs.

2011-03-03  Tassilo Horn  <tassilo@member.fsf.org>

	* nnimap.el (nnimap-parse-flags): Add a workaround for FETCH lines with
	numbers too big to be `read'.

2011-03-02  Teodor Zlatanov  <tzz@lifelogs.com>

	* message.el (message-options): Make buffer-local two ways to attempt
	to fix a XEmacs bug.

2011-03-02  Julien Danjou  <julien@danjou.info>

	* gnus-art.el (gnus-with-article-buffer): Fix buffer live check.

2011-03-01  Julien Danjou  <julien@danjou.info>

	* gnus-art.el (list-identifier): Add list-identifier as a parameter
	group.
	(article-hide-list-identifiers): Use list-identifier group parameter.

2011-02-28  Julien Danjou  <julien@danjou.info>

	* sieve.el (sieve-buffer-script-name): New local variable to store
	sieve script name.
	(sieve-edit-script): Store sieve script name.
	(sieve-upload): Use sieve script name when uploading.
	(sieve-upload): Use substitute-command-keys.
	(sieve-edit-script): Use substitute-command-keys.
	(sieve-refresh-scriptlist): Use substitute-command-keys.
	(sieve-manage-mode-map): Define keymap properly.
	(sieve-manage-mode): Do not set mode name manually, change mode-name to
	(sieve-refresh-scriptlist): Use substitute-command-keys."Sieve-manage".
	Remove commented code about cvs.
	(sieve-manage-quit): New function.
	(sieve-manage-mode-map): Bind 'q' to sieve-manage-quit.

2011-02-27  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-group.el (gnus-import-other-newsrc-file): New function.

2011-02-25  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el (auth-source-search): Cache empty result sets.

	* auth-source.el (auth-source-save-behavior): New variable to replace
	`auth-source-never-create'.
	(auth-source-netrc-create): Use it.
	(auth-source-never-save): Remove.

2011-02-25  Lars Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-stream): Doc fix.
	(nnimap-open-connection-1): Reverse the order of the ports to that the
	prompted-for port is first.

	* gnus-start.el (gnus-get-unread-articles): Don't clobber the async
	retrieval by the no-group selection.

	* gnus-demon.el (gnus-demon-init): run-with-timer should be called with
	numerical parameters.

2011-02-25  Julien Danjou  <julien@danjou.info>

	* gnus-gravatar.el: Use gnus-with-article-buffer.

	* gnus-art.el (gnus-with-article-buffer): Check that the
	gnus-article-buffer is alive.

2011-02-24  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el (auth-source-creation-prompts): New variable to manage
	creation-time prompts.
	(auth-source-search): Document it.
	(auth-source-format-prompt): Add utility function.
	(auth-source-netrc-create): Don't default the user name to
	user-login-name.  Use `auth-source-creation-prompts' and some default
	prompts for user, host, port, and password (the default generic prompt
	remains ugly).
	(auth-source-never-save): Add customizable option to never save info.
	(auth-source-netrc-create): Use it and improve save prompts.  Fix help
	mode excursion.

2011-02-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* auth-source.el (auth-source-netrc-create): Use `read-char' with no
	argument that XEmacs doesn't support.

2011-02-23  Julien Danjou  <julien@danjou.info>

	* gnus-art.el (article-make-date-line): Ignore errors if time is
	invalid and not convertible.
	(article-make-date-line): Only add lapsed time if time is not nil.

2011-02-23  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el (auth-source-netrc-create): Use `read-char' instead of
	`read-char-choice' for backwards compatibility.
	(auth-source-netrc-element-or-first): New function to DTRT for
	parameter extraction.
	(auth-source-netrc-create): Use it and fix multiple parameter print
	bug.  Use the default passed from above (given-default) or the
	built-in (user-login-name for :user).

2011-02-23  Lars Ingebrigtsen  <larsi@gnus.org>

	* gnus-start.el (gnus-dribble-read-file):
	Set buffer-save-without-query, since we always want to save the dribble
	file, probably.

	* nnmail.el (nnmail-article-group): Allow a final "" split to work on
	nnimap.

	* gnus-sum.el (gnus-user-date-format-alist): Rename back again from
	-summary- since it's a user-visible variable.

	* nnimap.el (nnimap-retrieve-group-data-early): Don't do QRESYNC the
	first time you use the new Gnus.

2011-02-22  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el: Don't load netrc.el.
	(auth-sources): Search ~/.netrc as well by default.
	(auth-source-debug): Add 'trivia option for extra output.
	(auth-source-do-trivia): Use it.
	(auth-source-search): Simplify logic to use
	`auth-source-search-backends'.  Use `auth-source-do-trivia' where
	appropriate.  Don't keep a running count at this level.  Layer :create
	and :delete options appropriately on the first and second passes.
	Don't track the backend with the search results.
	(auth-source-search-backends): New function to search a list of
	backends for a processed spec.
	(auth-source-netrc-parse): Cache all netrc files, making
	auth-source-netrc-cache an alist keyed by the file name and using the
	file mtime as the caching criterion.  Keep the obfuscated data secret
	with a lexical bind.
	(auth-source-netrc-search): Don't calculate the length of the results
	unnecessarily.
	(auth-source-search-backends): Fix bug.
	(auth-source-netrc-create): Rework prompts.

2011-02-22  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (nnir-imap-search-arguments,nnir-imap-default-search-key):
	Lower case names of search constraints.
	(nnir-run-query): Cache and reuse search constraints for all imap
	servers.

2011-02-22  Sam Steingold  <sds@gnu.org>

	* gnus-msg.el (gnus-setup-message): Also bind `winconf-name'.

2011-02-22  Lars Ingebrigtsen  <larsi@gnus.org>

	* gnus-msg.el (gnus-inews-add-send-actions): Restore the winconf name
	after exit.
	(gnus-setup-message): Define missing variable from last checkin.

	* gnus-sum.el (gnus-summary-show-article): When called with t as the
	value, show the raw article.

2011-02-21  Lars Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-open-connection-1): Revert last change, since
	auth-source now accepts numbers.

	* auth-source.el (auth-source-netrc-parse): Accept a number as the port
	spec, too.
	(auth-source-ensure-strings): New function.

	* gnus-art.el (gnus-article-update-date-headers): Doc fix.
	(gnus-article-setup-buffer): Always restart the date timer so that user
	changes to the frequency is respected.

	* nnimap.el (nnimap-open-connection-1): auth-source expects strings as
	port numbers, so make sure it gets that if nnimap-server-port is
	explicit.

2011-02-21  Simon Josefsson  <simon@josefsson.org>

	* nnimap.el (nnimap-inbox): Doc fix.

2011-02-20  Chong Yidong  <cyd@stupidchicken.com>

	* shr-color.el (shr-color->hexadecimal): Use renamed function names
	color-rgb-to-hex, color-name-to-rgb, color-srgb-to-lab, and
	color-lab-to-srgb.

2011-02-21  Lars Ingebrigtsen  <larsi@gnus.org>

	* nntp.el (nntp-finish-retrieve-group-infos): Add a kludge to use the
	given method as in the group name if we're using an extended method.
	(nntp-finish-retrieve-group-infos): Wait for the end of the LIST ACTIVE
	command, if we're using that, instead of waiting for the beginning.

	* gnus-start.el (gnus-get-unread-articles): Extend the methods so that
	we're sure to get unique server names, and we don't output two async
	commands in the same buffer.  This fixes an NNTP hang for some users.

2011-02-21  Lars Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-summary-next-article): Add a kludge to reselect the
	summary buffer before reading going to the next buffer.  This avoids
	putting the point in the group buffer if you `C-g' the command.

	* auth-source.el (auth-source-netrc-parse): Add an in-memory netrc
	cache (for now) to make ~/.authinfo.gpg files usable.

	* nnfolder.el (copyright-update): Define for the compiler.

	* auth-source.el (auth-source-search): Fix unbound variable.

2011-02-19  Glenn Morris  <rgm@gnu.org>

	* gnus.el (gnus-meta): Doc fix.

2011-02-19  Chong Yidong  <cyd@stupidchicken.com>

	* nnfolder.el (nnfolder-save-buffer): Don't let-bind copyright-update,
	in case it's not yet loaded.

2011-02-20  Lars Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-wait-for-response): Ensure that we get the entire
	line we're waiting for.

2011-02-19  Darren Hoo  <darren.hoo@gmail.com>  (tiny change)

	* gnus-art.el (gnus-article-next-page-1): Because customized mode-line
	face with line-width greater than zero will cause RET in gnus summary
	buffer to scroll down article page-wise because auto vscroll happens,
	it should be temporally disabled when doing a scroll-up.

2011-02-19  Lars Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-parse-copied-articles): Allow for "<foo> OK"
	outputs from the server.

2011-02-18  Antoine Levitt  <antoine.levitt@gmail.com>  (tiny change)

	* gnus-art.el (gnus-article-prepare): Run gnus-article-prepare-hook
	later so that bbdb can hook in easier.

2011-02-18  Lars Ingebrigtsen  <larsi@gnus.org>

	* auth-source.el (auth-source-search): Don't try to create credentials
	if the caller doesn't want that.
	(auth-source-search): If we don't find a match, don't bug out on
	non-bound variables.
	(auth-source-search): Only ask a single backend to create the
	credentials.

	* nnimap.el (nnimap-log-command): Add a newline to the inhibited
	logging.
	(nnimap-credentials): Protect against auth-source-search returning nil.
	(nnimap-request-list): Protect against not being able to open the
	server.

2011-02-17  Lars Ingebrigtsen  <larsi@gnus.org>

	* auth-source.el (auth-source-search): Do a two-phase search, one with
	no :create to get the responses from all backends.

	* nnimap.el (nnimap-open-connection-1): Delete duplicate server names
	when getting credentials.

	* gnus-util.el (gnus-delete-duplicates): New function.

2011-02-17  Teodor Zlatanov  <tzz@lifelogs.com>

	* nnimap.el (nnimap-credentials): Instead of picking the first port as
	a creation default, pass the whole port list down.  It will be
	completed.

	* auth-source.el (auth-source-search): Updated docs to talk about
	multiple creation choices.
	(auth-source-netrc-create): Accept a list as a value (from the search
	parameters) and do completion on that list.  Keep a separate netrc line
	with the password obscured for showing the user.

	* nnimap.el (nnimap-open-connection-1): Make the `nnimap-address' the
	first choice to `auth-source-search' so it will be used for entry
	creation instead of the server's Gnus-specific name.
	(nnimap-credentials): Rely on the auth-source library to select which
	port is actually wanted in the new netrc entry, so don't override
	`auth-source-creation-defaults'.

	* auth-source.el (auth-source-netrc-parse): Use :port instead of
	:protocol and accept a missing user, host, or port as a wildcard match.
	(auth-source-debug): Default to off.

	(auth-source-netrc-search, auth-source-netrc-create)
	(auth-source-secrets-search, auth-source-secrets-create)
	(auth-source-user-or-password, auth-source-backend, auth-sources)
	(auth-source-backend-parse-parameters, auth-source-search): Use :port
	instead of :protocol.

	* nnimap.el (nnimap-credentials): Pass a port default to
	`auth-source-search' in case an entry needs to be created.
	(nnimap-open-connection-1): Use :port instead of :protocol.

2011-02-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* auth-source.el (auth-source-secrets-search): Use mm-delete-duplicates
	instead of delete-dups that is not available in XEmacs 21.4.

2011-02-16  Lars Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-propagate-marks): Change default to t again, since
	nil means that nnimap doesn't get updated.

2011-02-16  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el (auth-source-netrc-create): Return a synthetic search
	result when the user doesn't want to write to the file.
	(auth-source-netrc-search): Expect a synthetic result and proceed
	accordingly.
	(auth-source-cache-expiry): New variable to override
	`password-cache-expiry'.
	(auth-source-remember): Use it.

	* nnimap.el (nnimap-credentials): Remove the `inhibit-create'
	parameter.  Create entry if necessary by using :create t.
	(nnimap-open-connection-1): Don't pass `inhibit-create'.

2011-02-15  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el (auth-source-debug): Enable by default and don't
	mention the obsolete `auth-source-hide-passwords'.
	(auth-source-do-warn): New function to debug unconditionally.
	(auth-source-do-debug): Use it.
	(auth-source-backend-parse): Use it for invalid `auth-sources' entries
	and for Secrets API entries when the secrets.el library is not
	available.

2011-02-14  Lars Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-propagate-marks): Default to nil.
	(gnus-summary-exit): Kill the correct article buffer on exit from a
	`C-d' group.

	* gnus-start.el (gnus-use-backend-marks): Removed, since it duplicates
	gnus-propagate-marks.

	* gnus-sum.el (gnus-summary-exit-no-update): Restore the group conf
	before killing the buffers so that a non-full window conf gets handled
	correctly.
	(gnus-summary-exit): Ditto.
	(gnus-summary-read-group-1): Ditto.

	* nntp.el (nntp-retrieve-group-data-early): Reinstate the two-part
	async code again so that we can debug it properly.

	* message.el (message-reply): Take an optional switch-buffer parameter
	so that Gnus window confs are respected better.

2011-02-14  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el (auth-source-backend-parse-parameters): Don't rely on
	`plist-get' to accept non-list parameters (XEmacs issue).
	Fix docstring.
	(auth-source-secrets-search): Use `delete-dups', `append mapcar', and
	`butlast' instead of `remove-duplicates', `mapcan', and `subseq'.
	(auth-sources, auth-source-backend-parse, auth-source-secrets-search):
	Login collection is "Login" and not "login".

2011-02-14  Lars Ingebrigtsen  <larsi@gnus.org>

	* gnus-art.el (article-update-date-lapsed): Don't bug out when updating
	multiple headers.

	* nnimap.el (nnimap-inhibit-logging): New variable.
	(nnimap-log-command): Don't log login commands.

	* auth-source.el (auth-source-netrc-search): The asserts seem to want
	to have more parameters.

	* nnimap.el (nnimap-send-command): Mark the command time for each
	command, so that we don't get NOOPs stepping on our toes.

	* gnus-art.el (article-date-ut): Get the date from the Date header on
	`t'.

2011-02-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* auth-source.el (auth-source-search): Use copy-sequence instead of
	the cl.el copy-list.

2011-02-13  Adam Sjøgren  <asjo@koldfront.dk>

	* gnus-delay.el (gnus-delay-article) Fix number of seconds per day.
	Improve prompt.

2011-02-13  Lars Ingebrigtsen  <larsi@gnus.org>

	* gnus-art.el (gnus-article-mode-line-format): Remove the article
	washing status from the default format.  It isn't very informative.

2011-02-13  Tassilo Horn  <tassilo@member.fsf.org>  (tiny change)

	* nnimap.el (nnimap-request-accept-article, nnimap-process-quirk):
	Fix Gcc processing on imap.

2011-02-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* message.el (message-bury): Don't pop up a new window when selected
	window is dedicated.

2011-02-10  Antoine Levitt  <antoine.levitt@gmail.com>  (tiny change)

	* gnus-sum.el (gnus-summary-save-parts): Use read-directory-name.

2011-02-10  Teodor Zlatanov  <tzz@lifelogs.com>

	* sieve-manage.el: Autoload `auth-source-search'.
	(sieve-sasl-auth): Use it.

2011-02-09  Teodor Zlatanov  <tzz@lifelogs.com>

	* nnimap.el: Autoload `auth-source-forget+'.
	(nnimap-open-connection-1): Use it if the connection fails.

	* auth-source.el: Require `password-cache'.
	(auth-source-hide-passwords, auth-source-cache): Remove and mark
	obsolete.
	(auth-source-magic): Marker for `password-cache' keys.
	(auth-source-do-cache): Update docstring.
	(auth-source-search): Use and check cache.
	(auth-source-forget-all-cached, auth-source-remember)
	(auth-source-recall, auth-source-forget, auth-source-forget+)
	(auth-source-specmatchp): Caching support functions.
	(auth-source-forget-user-or-password, auth-source-forget-all-cached):
	Remove and obsolete.
	(auth-source-user-or-password): Remove caching to further discourage
	using it.  Always hide passwords.

2011-02-09  Lars Ingebrigtsen  <larsi@gnus.org>

	* nntp.el (nntp-retrieve-group-data-early-disabled): Disable the async
	code for now, since it doesn't work for all users.

2011-02-09  Julien Danjou  <julien@danjou.info>

	* message.el (message-options): Make message-options really buffer
	local.

2011-02-08  Teodor Zlatanov  <tzz@lifelogs.com>

	* mail-source.el: Autoload `auth-source-search'.
	(mail-source-keyword-map): Note order matters.
	(mail-source-set-1): Get all the mail-source source values and
	defaults and search auth-source on those if needed.  This can all
	probably be simplified.

	* nnimap.el: Autoload `auth-source-search'.
	(nnimap-credentials): Use it.
	(nnimap-open-connection-1): Ask for the virtual server and physical
	address in one shot.

	* nntp.el: Autoload `auth-source-search'.
	(nntp-send-authinfo): Use it.  Note TODO.

2011-02-08  Julien Danjou  <julien@danjou.info>

	* shr.el (shr-tag-body): Add support for text attribute in body
	markups.

	* message.el (message-options): Make message-options a local variable.

2011-02-07  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el (auth-source-secrets-search)
	(auth-source-user-or-password): Use `append' instead of `nconc'.
	(auth-source-user-or-password): Build return list better and protect
	against nil :secret.

2011-02-07  Lars Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-update-info): Refactor slightly.
	(nnimap-update-info): Tell Gnus whether there are any \Recent messages.
	(nnimap-update-info): Clean up slightly.
	(nnimap-quirk): Add quirk for Gmail IMAP which bugs out on NUL
	characters.
	(nnimap-process-quirk): Rename function to avoid collision.
	(nnimap-update-info): Fix macrology bug-out.
	(nnimap-update-info): Simplify split history test.

2011-02-06  Michael Albinus  <michael.albinus@gmx.de>

	* auth-source.el (top): Require 'eieio unconditionally.
	Autoload `secrets-get-attributes' instead of `secrets-get-attribute'.
	(auth-source-secrets-search): Limit search when `max' is greater than
	number of results.

2011-02-06  Lars Ingebrigtsen  <larsi@gnus.org>

	* nntp.el (nntp-finish-retrieve-group-infos): Protect against the first
	part not returning any data.

	* proto-stream.el (open-protocol-stream): Document the return value.

2011-02-06  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el (auth-source-secrets-search): Add examples.

2011-02-06  Julien Danjou  <julien@danjou.info>

	* message.el (message-setup-1): Handle message-generate-headers-first
	set to t.

2011-02-06  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el (auth-sources): Allow for simpler defaults for Secrets
	API with a string "secrets:collection-name" and with 'default.
	(auth-source-backend-parse): Parse "secrets:collection-name" and
	'default.  Recurse on parses instead of repeating code.  Use the
	Secrets API is the source is not nil and 'ignore otherwise.  Emit a
	message when ignoring a source.
	(auth-source-search): List ignored search keys at the top level.
	(auth-source-netrc-create): Use `case' instead of `cond'.
	(auth-source-secrets-search): Created with TODOs.
	(auth-source-secrets-create): Created with TODOs.
	(auth-source-retrieve, auth-source-create, auth-source-delete)
	(auth-source-protocol-defaults, auth-source-user-or-password-imap)
	(auth-source-user-or-password-pop3, auth-source-user-or-password-ssh)
	(auth-source-user-or-password-sftp)
	(auth-source-user-or-password-smtp): Remove.
	(auth-source-user-or-password): Deprecated and modified to be a wrapper
	around `auth-source-search'.  Not tested thoroughly.

2011-02-04  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el: Bring in assoc and eioeio libraries.
	(secrets-enabled): New variable to track the status of the Secrets API.
	(auth-source-backend): New EIOEIO class to represent a backend.
	(auth-source-creation-defaults): New variable to set prompt defaults
	during token creation (see the `auth-source-search' docstring for
	details).
	(auth-sources): Simplify to allow a simple string as a netrc backend
	spec.
	(auth-source-backend-parse): Parse a backend from an `auth-sources' spec.
	(auth-source-backend-parse-parameters): Fill in the backend parameters.
	(auth-source-search): Main auth-source API entry point.
	(auth-source-delete): Wrapper around `auth-source-search' for deletion.
	(auth-source-search-collection): Helper function for searching.
	(auth-source-netrc-parse, auth-source-netrc-normalize)
	(auth-source-netrc-search, auth-source-netrc-create): Netrc backend.
	Supports search, create, and delete.
	(auth-source-secrets-search, auth-source-secrets-create): Secrets API
	backend stubs.
	(auth-source-user-or-password): Call `auth-source-search' but it's not
	ready yet.

2011-02-04  Lars Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-setup-1): Remove the read-only stuff, since it
	doesn't work under XEmacs, for some reason.

	* gnus-sum.el (gnus-user-date): Rename back from
	gnus-summary-user-date since user code refers to it.

	* shr.el (shr-render-td): Store the actual background color used.

	* message.el (message-setup-1): Don't bind the constant
	-forbidden-properties.
	(message-setup-1): Revert previous change, since it needs to bind the
	props to insert them.
	(message-resend): Allow removing the read-only separator line.

2011-02-03  Lars Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-request-accept-article): Give an error message if
	the APPEND wasn't successful.

2011-02-03  Adam Sjøgren  <asjo@koldfront.dk>

	* gnus-start.el (gnus-get-unread-articles): Fix the call to methods
	that have no groups.

2011-02-03  Julien Danjou  <julien@danjou.info>

	* gnus-draft.el: Remove progn around gnus-draft-setup.

2011-02-03  Lars Ingebrigtsen  <larsi@gnus.org>

	* gnus-start.el (gnus-read-active-for-groups): This function is never
	called with a nil `infos', so clean that up.
	(gnus-get-unread-articles): Request active files from primary/secondary
	methods that have no groups (yet).

2011-02-03  Julien Danjou  <julien@danjou.info>

	* message.el (message-setup-1): Always generate References first.
	(message-mail): Return the return value of message-setup, not always t.
	(message-setup-1): Insert mail-header-separator with read-only and
	intangible properties set.

	* gnus.el (gnus-summary-line-format): Add missing semi-colon for
	user-date in docstring.

	* gnus-art.el (gnus-article-jump-to-part): Remove useless sit-for.

	* gnus.el (gnus-summary-line-format): Mention &user-date format in
	docstring.

	* gnus.el (gnus-user-date-format-alist): Change default value.
	Use defcustom, with type and group.  Move from gnus-util.el.
	Rename to gnus-summary-user-date-format-alist.

2011-02-03  Glenn Morris  <rgm@gnu.org>

	* nnimap.el (gnus-fetch-headers): Declare.

	* nnheader.el (gnus-range-add, gnus-remove-from-range): Autoload.

2011-02-03  Lars Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-forward-make-body-digest-plain)
	(message-followup, message-reply): Clean up things noted by Stefan.

	* gnus-art.el (gnus-article-setup-buffer): Stop the date timer if
	gnus-article-update-date-headers is nil.
	(gnus-article-date-headers): Rip out the old -treat-date-* stuff, since
	it didn't really work with defcustom.
	(article-update-date-lapsed): Make sure the window start doesn't move,
	either.

2011-02-01  Julien Danjou  <julien@danjou.info>

	* mm-uu.el (mm-uu-type-alist): Add support for git format-patch diff
	format.

	* mm-decode.el (mm-inline-media-tests): Do not check for diff-mode it's
	standard in Emacs nowadays.

2011-02-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* message.el (message-expand-name): Don't trust the return value of
	bbdb-complete-name.
	(message-check-news-header-syntax): Remove unused var `start'.
	(message-idna-to-ascii-rhs-1): Remove unused vars `rhs' and `address'.
	(message-inhibit-body-encoding): Move to before first use.
	(mail-abbrev-mode-regexp, Expires, User-Agent, Lines, Distribution)
	(To, References, In-Reply-To, Newsgroups, Subject, Path, From)
	(Organization, Message-ID, Date, mh-previous-window-config):
	Defvar the vars using dynamic scoping.

2011-02-01  Lars Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-render-td): Only do colors at the final rendering.
	Should be slightly faster.
	(shr-insert-table): Fix up TD background colors when doing the
	vertical padding.

	* gnus-art.el (article-date-ut): Protect against articles with no Date
	header.
	(article-update-date-lapsed): Don't use current-column to find the
	horizontal position.  It's fragile in the presence of \003 characters.

	* gnus-start.el (gnus-read-active-file-1): Remove dead parameter infos.

2011-01-31  Lars Ingebrigtsen  <larsi@gnus.org>

	* gnus-art.el (article-transform-date): Rewrite to still work when
	there are several rfc2822 parts.
	(article-transform-date): Fix infinite recursion.
	(article-date-ut): Replace infinitely many Date headers with a single
	one when called interactively.

	* nnimap.el (nnimap-wait-for-response): Wait for results in a more
	secure manner.

	* gnus-art.el (article-update-date-lapsed): Try to avoid having point
	move around by not using save-window-excursion.  It seems to work...

2011-01-31  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (article-make-date-line): Work for user-defined format.

2011-01-31  Lars Ingebrigtsen  <larsi@gnus.org>

	* nntp.el (nntp-retrieve-group-data-early)
	(nntp-finish-retrieve-group-infos): Implement the asynchronous data
	fetching functions.

	* gnus-start.el (gnus-read-active-for-groups): Read the active files
	thoroughly for all backends that have no known groups.  This should
	allow new nnml methods to retrieve mail.

	* gnus-group.el (gnus-group-jump-to-group): Allow jumping to groups
	that Gnus doesn't know exists again.

	* gnus-art.el (gnus-article-date-lapsed-new-header): Remove.
	(gnus-treat-date-ut): Ditto.
	(gnus-article-update-date-header): Rename.
	(gnus-treat-date-local): Remove.
	(gnus-treat-date-english): Remove.
	(gnus-treat-date-lapsed): Remove.
	(gnus-treat-date-combined-lapsed): Remove.
	(gnus-treat-date-original): Remove.
	(gnus-treat-date-iso8601): Remove.
	(gnus-treat-date-user-defined): Remove.
	(gnus-article-date-headers): New variable to control all the date
	header options.
	(article-date-ut): Rewrite to allow using the new way to format date
	headers(s).

2011-01-30  Lars Ingebrigtsen  <larsi@gnus.org>

	* nnmail.el (nnmail-article-group): Check for a direct fancy split
	method.
	(nnmail-article-group): A better test for fanciness.

	* nnimap.el (nnimap-request-head): Protect against not finding the
	article by Message-ID.

2011-01-29  Lars Ingebrigtsen  <larsi@gnus.org>

	* gnus-art.el (article-update-date-lapsed): Try a better way to really
	keep point at the "same place".

2011-01-28  Lars Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-select-newsgroup): Don't try to alter the active
	data if the group is inactive.

2011-01-28  Julien Danjou  <julien@danjou.info>

	* gnus-win.el: Remove dead function gnus-window-configuration-element.
	(gnus-all-windows-visible-p): Remove old compatibility code.
	(gnus-window-top-edge): Add docstring.

	* gnus-group.el (gnus-group-jump-to-group): Set must match to t.

2011-01-28  Lars Ingebrigtsen  <larsi@gnus.org>

	* gnus-int.el (gnus-request-marks): Call *-request-marks instead of the
	older request-update-info.

	* gnus-art.el (article-make-date-line): Limit the length a bit more.

2011-01-28  Daiki Ueno  <ueno@unixuser.org>

	* mml2015.el (mml2015-epg-sign, mml2015-epg-encrypt):
	Give mml2015-signers higher precedence over mml2015-sign-with-sender.

2011-01-27  Lars Ingebrigtsen  <larsi@gnus.org>

	* gnus-group.el (gnus-group-refresh-group): Refresh even non-visible
	groups.  This makes the nndraft:queue group pop up if it's not already
	there.

	* gnus-sum.el (gnus-summary-read-group-1): Fix the "contains no
	messages" logic, which was reversed.

	* gnus-art.el (article-update-date-lapsed): Ensure that point stays at
	the "same place" even if point is on the line being replaced.
	(article-update-date-lapsed): Allow updating both the combined lapsed
	and the lapsed headers.
	(article-update-date-lapsed): Skip past all the X-Sent/Date headers.
	(article-make-date-line): Limit the number of segments dynamically to
	avoid too-long lines.

2011-01-27  Julien Danjou  <julien@danjou.info>

	* mml2015.el (mml2015-epg-sign): Add and use mml2015-sign-with-sender.
	(mml2015-epg-encrypt): Use mml2015-sign-with-sender.

2011-01-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* shr.el (shr-expand-newlines, shr-previous-newline-padding-width):
	Use plist-get instead of the cl function getf.

2011-01-27  Glenn Morris  <rgm@gnu.org>

	* gnus-util.el (float-time): Get rid of compiler warning, again.

2011-01-27  Lars Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-put-color): Special-case background colors: Do put them
	at the blank parts at the front of the lines.

	* gnus-draft.el (gnus-draft-clear-marks): New function to be run as an
	exit hook to nix out all data on readedness on group exit.

	* gnus-util.el (float-time): If float-time is bound, always use it on
	all Emacsen.  It's unclear why the subrp check was there.
	(time-date): Require to make some autoload issues on XEmacs go away.

	* shr.el (shr-put-color): Don't do the box padding in tables, since
	they're already padded.

2011-01-26  Lars Ingebrigtsen  <larsi@gnus.org>

	* gnus-art.el (gnus-article-next-page): When the last line of the
	article is displayed, scroll down once more instead of going to the
	next article at once.
	(article-lapsed-string): Refactor out and allow specifying how many
	segments you want.
	(gnus-article-setup-buffer): Start updating the lapsed header directly.
	(gnus-article-update-lapsed-header): New variable.

	* shr.el: Revert change that made headings use different-sized faces.
	The Emacs display engine isn't advanced enough that, for instance,
	tables can comfortably use differently-sized faces.

2011-01-25  Lars Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-open-connection-1): Store the actual stream type
	used.
	(nnimap-login): Prefer plain LOGIN if it's enabled (since it requires
	fewer round trips than CRAM-MD5, and it's less likely to be buggy), and
	we're using an encrypted connection.

	* proto-stream.el: Alter the interface functions to also return the
	actual stream type used: network or TLS.

2011-01-25  Julien Danjou  <julien@danjou.info>

	* mm-view.el (mm-display-shell-script-inline): Fix typo in docstring.
	(mm-display-javascript-inline): New function.

	* mm-decode.el (mm-inline-media-tests): Add application/javascript
	viewing function.

2011-01-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* shr.el (shr-expand-newlines): Fix variable name.

2011-01-25  Lars Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-expand-newlines): Make nested boxes work.

2011-01-24  Lars Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-expand-newlines): Proof of concept implementation of boxy
	backgrounds.
	(shr-expand-newlines): Switch to using overlays to enable kill'n'yank
	in a more sensible manner.

2011-01-24  Teodor Zlatanov  <tzz@lifelogs.com>

	* mml-smime.el (mml-smime-use): Make it a defcustom and default to 'epg
	if EPG is loaded.

2011-01-24  Julien Danjou  <julien@danjou.info>

	* shr.el: Use defface to create shr-tag-h[1-6] faces to fontify h[1-6]
	tags.

2011-01-24  Lars Ingebrigtsen  <larsi@gnus.org>

	* gnus-art.el (gnus-article-read-summary-keys): Don't call disabled
	commands.

	* gnus-gravatar.el (gnus-gravatar-insert): Don't move point around
	in the article buffer.
	(gnus-gravatar-insert): Use blank space from the current buffer to
	avoid breaking text properties.  This makes X-Sent updating work again.

	* gravatar.el (gravatar-retrieve): Be silent when retrieving.

2011-01-23  Lars Ingebrigtsen  <larsi@gnus.org>

	* gnus-html.el (gnus-html-image-fetched): Kill the buffer anyway, and
	fix the bug in url-http.el instead.

	* shr.el (shr-image-fetched): Ditto.

	* shr.el (shr-image-fetched): Avoid having point move in the article
	buffer.

	* gnus-html.el (gnus-html-image-fetched): Don't kill the temporary
	buffer after being called.  It's apparently being killed by url.el, and
	killing it made point move to end-of-buffer in a random buffer.

	* shr.el (shr-image-fetched): Ditto.

2011-01-23  Julien Danjou  <julien@danjou.info>

	* mm-decode.el (mm-inline-media-tests): Change text/org to text/x-org.

	* mm-uu.el (mm-uu-org-src-code-block-extract): Change text/org to
	text/x-org.

2011-01-22  Lars Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-summary-move-article): Protect against backends
	(i.e., nnimap) returning nil as the article number.

2011-01-22  Kazuhiro Ito  <kzhr@d1.dion.ne.jp>  (tiny change)

	* flow-fill.el (fill-flowed): Make `delete-space' option correspond to
	"DelSp" parameter in RFC3676.

2011-01-22  Lars Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-check-recipients): Display the encoded version of
	the bogus address if they differ.

	* gnus-draft.el (gnus-group-send-queue): Really refresh the queue group
	after sending.

	* gnus-agent.el (gnus-agent-send-mail): Ditto.

	* gnus-group.el (gnus-group-refresh-group): New convenience function.

	* gnus-draft.el (gnus-group-send-queue): Update the queue group in the
	group buffer after sending the queue.

	* gnus-agent.el (gnus-agent-send-mail): Ditto.

2011-01-22  Julien Danjou  <julien@danjou.info>

	* mailcap.el (mailcap-mime-extensions): Rename text/org to text/x-org.

2011-01-22  Lars Ingebrigtsen  <larsi@gnus.org>

	* mm-decode.el (mm-preferred-alternative-precedence): Don't bug out on
	nested related parts.

	* nnfolder.el (nnfolder-request-expire-articles): Return the list of
	unexpired articles.  This fixes the regression that led expiry marks to
	disappear from nnfolder groups.

2011-01-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* gnus-art.el (gnus-button-alist, gnus-button-handle-info-keystrokes):
	Don't confuse the "ret" of "retrograde" with RET.

2011-01-21  Julien Danjou  <julien@danjou.info>

	* gnus-art.el (gnus-mime-display-single): Use mm-display-inline rather
	than mm-insert-inline.

2011-01-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-remove-images, gnus-article-show-images):
	Widen article buffer.

2011-01-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mm-util.el (mm-find-buffer-file-coding-system): Don't forget to kill
	the temp buffer.
	* message.el (message-mailer-swallows-blank-line): Use with-temp-buffer.

2011-01-20  Julien Danjou  <julien@danjou.info>

	* mm-decode.el (mm-inline-media-tests): Add text/x-sh.

	* gnus-art.el (gnus-mime-inline-part): Use mm-display-inline rather
	than mm-insert-inline to insert inline part: this respect
	mm-inline-media-tests displayers.

	* mm-view.el (mm-display-shell-script-inline): New function.

	* mm-decode.el (mm-inline-media-tests): Add x-shellscript and x-sh.

	* mm-uu.el (mm-uu-type-alist): Add org block.
	(mm-uu-org-src-code-block-extract): New function.

	* mm-view.el (mm-display-org-inline): New function.

	* mm-decode.el (mm-automatic-display): Add text/org.

	* mailcap.el (mailcap-mime-extensions): Add .org.

2011-01-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-highlight): Remove argument passed to
	gnus-article-add-buttons.

2011-01-19  Tom Rauchenwald  <sehnsucht.nach.unendlichkeit@quantentunnel.de>  (tiny change)

	* spam.el (spam-spamassassin-register-with-sa-learn): Insert a full
	From header with a date and "nobody" as the sender.

2011-01-19  Julien Danjou  <julien@danjou.info>

	* gnus-art.el (gnus-article-add-buttons): Simplify condition.
	(gnus-button-push): Remove gnus-button-entry function, it fails heavily
	if you have the same regexp several times.
	(gnus-button-push): Fix matching when regexp is symbol.

2011-01-15  Glenn Morris  <rgm@gnu.org>

	* message.el (message-mail): A compose-mail function should
	accept headers as strings.

2011-01-13  Chong Yidong  <cyd@stupidchicken.com>

	* message.el (message-tool-bar-gnome): Tweak tool-bar items.
	Add :vert-only tags.
	(message-mail): New arg RETURN-ACTION.
	(message-return-action): New var.
	(message-bury): Use it.
	(message-mode): Make it buffer-local.
	(message-send-and-exit): Always call message-bury.

	* gnus-msg.el (gnus-msg-mail): New arg RETURN-ACTION.  Pass it to
	message-mail.

2011-01-11  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-convert-partial-article): Protect against
	zero-length body parts.

	* mm-decode.el (mm-preferred-alternative-precedence):
	Discourage showing empty parts.

	* gnus-int.el (gnus-request-accept-article): Don't try to update marks
	and stuff if the backend didn't return the article number.  This fixes
	an Exchange-related nnimap bug.

	* gnus-sum.el (gnus-summary-next-article): Remove hack to reselect
	group window, because it does the wrong thing when a separate frame
	displays the group buffer.

	* proto-stream.el (open-protocol-stream): Protect against the low-level
	transport functions returning nil.

2011-01-07  Daiki Ueno  <ueno@unixuser.org>

	* mml2015.el (epg-sub-key-fingerprint): Autoload.
	(mml2015-epg-find-usable-secret-key): New function.
	(mml2015-epg-sign): Use mml2015-epg-find-usable-secret-key instead of
	mml2015-epg-find-usable-key (Bug#7797).
	(mml2015-epg-encrypt): Ditto.

2011-01-03  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* flow-fill.el (fill-flowed-encode): Do encoding citation-aware.

2011-01-03  Glenn Morris  <rgm@gnu.org>

	* sieve-manage.el (sieve-manage-open): Correctly set sieve-manage-port.

	* sieve.el (sieve-open-server): Give a more explicit error if
	sieve-manage-open returns nil.  (Bug#7720)

2011-01-02  Karl Fogel  <kfogel@red-bean.com>

	* gnus-msg.el (gnus-message-replyencrypt): Default to `t'.

2011-01-02  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-login): Prefer AUTH=CRAM-MD5, if it's available.
	This avoids sending passwords in plain text over non-encrypted
	channels.

	* shr.el (shr-rescale-image): Display all GIF images as animated images.

	* nnimap.el (nnimap-login): Refactored out into own function, and
	implement CRAM-MD5.
	(nnimap-wait-for-line): Refactored out.

	* mm-view.el (mml-smime): Require.

2010-12-20  David Engster  <deng@eml.cc>

	* mm-view.el (mm-view-pkcs7-decrypt): If mml-smime-use is set to 'epg,
	use EPG to decrypt S/MIME messages instead of openssl.

2011-01-02  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-request-group): Avoid double SELECT on `M-g'.

	* gnus-group.el (gnus-group-kill-group): Don't try to update the group
	status is the group clearly is unreachable.

	* auth-source.el (auth-source-create): Add the optional second
	parameter to `local-variable-p' to be compatible with XEmacs.

2011-01-02  Wang Diancheng  <dcwang@kingbase.com.cn>  (tiny change)

	* nnml.el (nnml-request-article): Allow requesting by Message-ID to
	work when using a compressed nnml folder.

2011-01-02  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-select-newsgroup): Don't propagate marks to
	backends after sanitising on entry, because this never makes sense:
	If the articles have gone missing, then the data no longer exists on
	the backend, and if they haven't, then Gnus is wrong, and shouldn't
	overwrite anything anyway.

	* shr.el (shr-insert-document): Bind shr-width dynamically to
	window-width if it's nil.

2010-12-30  Tassilo Horn  <tassilo@member.fsf.org>

	* shr.el (shr-width, shr-insert-document): Allow nil as shr-width value
	with the meaning of using the full emacs window width for rendering.

2010-12-27  Daiki Ueno  <ueno@unixuser.org>

	* mml2015.el (mml2015-epg-sign, mml2015-epg-encrypt): Take care the
	case when sender is not given.

2010-12-23  Julien Danjou  <julien@danjou.info>

	* gnus-gravatar.el (gnus-gravatar-transform-address): Set
	`mail-extr-ignore-realname-equals-mailbox-name' to nil when extracting
	the addresses, otherwise we might misplaced the gravatar.

2010-12-21  Daiki Ueno  <ueno@unixuser.org>

	* mml1991.el (pgg-sign-region, pgg-encrypt-region):
	* gnus-art.el (pgg-snarf-keys-region): Autoload since PGG is now
	obsolete in Emacs.

2010-12-20  Julien Danjou  <julien@danjou.info>

	* gnus-util.el (gnus-rescale-image): Revert last change.

2010-12-17  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-group.el (gnus-group-delete-articles): New command.

2010-12-17  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (nnir-mode): Make sure 'gnus-registry-install is bound.

2010-12-17  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-get-newsgroup-headers): Revert the last change
	here, since it's up to the backends to do CRLF removal if their
	protocol has it.

	* nnimap.el (nnimap-retrieve-headers): Remove CRLF from the headers.

2010-12-17  Julien Danjou  <julien@danjou.info>

	* gnus-util.el (gnus-rescale-image): Allow to resize images even if
	they are from file.  Can also scale up.

2010-12-17  Andrew Cohen  <cohen@andy.bu.edu>

	* gnus-sum.el (gnus-summary-refer-thread): Simplify code.
	Restore gnus-use-agent.
	(gnus-get-newsgroup-headers): Avoid unwanted spaces at eol.

	* nnir.el (nnir-get-active): Ignore nnir-ignored-newsgroups if null.

2010-12-17  Julien Danjou  <julien@danjou.info>

	* gravatar.el (gravatar-retrieve-synchronously): New function.
	(gravatar-get-data): Make more robust.

2010-12-16  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-wait-for-response): Fix the end-point calculation
	to really consider the last line.

2010-12-16  Daiki Ueno  <ueno@unixuser.org>

	* auth-source.el (auth-source-gpg-encrypt-to): New variable to set the
	list of recipient keys, or use symmetric encryption if not a list.
	(auth-source-create): Use it to make `epa-file-encrypt-to' local for an
	EPA override, replacing the call to `netrc-store-data'.

2010-12-16  Dan Davison  <dandavison7@gmail.com>  (tiny change)

	* gnus-srvr.el: Avoid passing nil regexp argument to
	delete-matching-lines.

2010-12-16  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-html.el (gnus-html-schedule-image-fetching): Make sure the HTML
	fetching stops when Gnus exits.

	* nnfolder.el (nnfolder-save-all-buffers): Refactor out into its own
	function.
	(nnfolder-request-expire-articles): Save all the buffers after doing
	expiry.

	* nnmail.el (nnmail-expiry-target-group): Revert the "all articles are
	the last article", since that led to serious performance regressions
	when expiring nnml groups.

2010-12-16  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el: Improve customizations.

2010-12-16  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-start.el (gnus-subscribe-newsgroup): Notify the backend.

	* gnus-group.el (gnus-group-kill-group): Notify the backend that the
	group has been killed.
	(gnus-group-yank-group): Ditto.

	* gnus-srvr.el (gnus-browse-unsubscribe-group): Ditto.

	* nnimap.el (nnimap-request-update-group-status): New function.

	* gnus-int.el (gnus-request-update-group-status): New interface
	function.

	* gnus-sum.el (gnus-summary-push-marks-to-backend): Fix the logic for
	copying read-ness to the backends.

	* nnimap.el (nnimap-quirk): New function.
	(nnimap-retrieve-group-data-early): Use it.
	(nnimap-quirks): New alist.

2010-12-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* shr.el (shr-insert): Set shr-start after deleting trailing space;
	don't delete it within indentation.

2010-12-16  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-wait-for-response): Always look (at least) at the
	previous line.

2010-12-15  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-retrieve-group-data-early): Fix the syntax of the
	QRESYNC command by deleting a superfluous space which broke Cyrus
	servers.  This change will break other servers that are buggy the other
	way around.

2010-12-14  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el: Reindent and fix long lines.
	(spam-copy-or-move-routine): Exclude invalid move destinations.

2010-12-14  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (nnir-mode): Don't install registry hooks if user hasn't
	installed the registry.

2010-12-13  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (nnir-run-gmane): Better check for gmane groups: error out if
	groupname doesn't contain "gmane".

2010-12-13  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-start.el (gnus-matches-options-n): Fix typo in last change.
	(gnus-1): Don't create the nndrafts group twice.
	(gnus-setup-news): There's no need to read the active file here, since
	that's done again later on a per-backend basis.
	(gnus-start-draft-setup): Make sure that the new group is started out
	empty.

	* gnus-agent.el (gnus-agentize): Don't create the queue group
	automatically on startup.  It'll be created later, if needed.

	* gnus-start.el (gnus-auto-subscribed-groups): Add nnimap to the list
	of automatically subscribed groups.
	(gnus-auto-subscribed-categories): New variable.
	(gnus-matches-options-n): Use it.
	(gnus-default-subscribed-newsgroups): Remove unused variable.
	(gnus-start-draft-setup): Message a bit less.

2010-12-13  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (nnir-run-imap): Return article list in order of increasing
	UID.

2010-12-13  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-summary-enter-digest-group):
	Mention gnus-auto-select-on-ephemeral-exit.

	* proto-stream.el (proto-stream-open-network-only): Fix the calling
	convention of the network-only option.

2010-12-10  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* proto-stream.el (proto-stream-open-network-only): New function to
	have a way to specify non-STARTTLS upgrade connections.

2010-12-10  Julien Danjou  <julien@danjou.info>

	* gnus-gravatar.el (gnus-gravatar-transform-address): Fix error when
	email address is nil.

	* message.el (message-bogus-recipient-p): Set address to "" if nil.

2010-12-10  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (nnir-request-expire-articles): Ignore expiry except for
	deletion.
	(nnir-run-imap): Only need to parse list once.

2010-12-09  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-tag-script): Ignore <script>.
	(shr-tag-label): Add <label> support.

2010-12-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-util.el (mm-ucs-to-char): Use eval-and-compile.

	* shr.el (shr-image-displayer): Work for images lined side by side.

2010-12-08  Robert Pluim  <rpluim@gmail.com>

	* gnus-demon.el (gnus-demon-init): Call run-with-timer with an integer
	parameter, since XEmacs doesn't accept t as a parameter.

2010-12-08  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (nnir-retrieve-headers): Use rassq when comparing article
	ids.
	(nnir-run-gmane): Simplify groupspec formatting.
	(nnir-request-expire-articles): New function.

2010-12-07  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-parse-flags): Tweak VANISHED regexp to avoid regexp
	overflow, possibly.

	* shr.el (shr-tag-table-1): Use bg/gfcolor specs on tables.
	(shr-render-td): Handle td style="" better.
	(shr-tag-table): Use the color from the style sheet.
	(shr-render-td): Make sure we copy over all the overlays, too.

2010-12-07  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (nnir-run-gmane): Restore sub-optimal test for gmane server.
	(nnir-request-article): Improve article retrieval.

2010-12-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-util.el (mm-extra-numeric-entities): New variable.

	* mm-url.el (mm-url-decode-entities):
	* mm-decode.el (mm-shr): Use it to decode extra numeric entities.

2010-12-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* message.el: Use completion-at-point.
	(message-completion-function): New fun, extracted from message-tab.
	(message-mode): Use it for completion-at-point-functions.
	(message-tab): Use it and completion-at-point.

2010-12-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* shr.el (shr-find-fill-point): Don't break a line after a kinsoku-bol
	character if a non-breakable character follows.

2010-12-06  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* proto-stream.el (proto-stream-open-tls): Return nil if we don't get
	any stream.

	* shr.el (shr-tag-font): Colorize the region.
	(shr-tag-body): Ditto.
	(shr-tag-font): Actually let the styles be inherited instead of
	overwriting them.
	(shr-tag-font): Get the background color right.
	(shr-tag-style): Ignore all <style> tags for the moment.

	* gnus-int.el (gnus-request-thread): Rework to take a header instead of
	a Message-ID to avoid having nnimap depend on gnus-sum.

	* shr.el (shr-descend): Only colorize something if we have a node that
	sets colors.

2010-12-06  Julien Danjou  <julien@danjou.info>

	* shr.el (shr-render-td): Render td content with shr-descend, so style
	will be applied to <td> too.
	(shr-colorize-region): Colorize region even if we only have a background.
	(shr-tag-body): Fix color and background color inheritance.
	Do not recolorize after shr-generic.
	(shr-tag-font): Let shr-generic colorize via inheritance.

2010-12-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* shr.el (shr-find-fill-point): Don't regard apostrophe as kinsoku-bol.

2010-12-06  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (nnir-request-move-article): Remove obsolete code.

2010-12-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-util.el (gnus-macroexpand-all): Use eval-and-compile.

2010-12-05  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-summary-respool-article): The completion function
	expects a list instead of an alist.

	* nntp.el (nntp-snarf-error-message): nnheader-report takes a format
	string as the parameter.

	* gnus.el (gnus-valid-select-methods): Allow nnimap to respool.

	* shr.el (shr-stylesheet): New dynamic variable for cascading the
	styles.
	(shr-colorize-region): New function.
	(shr-insert-background-overlay): Remove.
	(shr-render-td): Background setting should be taken care of on a higher
	level.
	(shr-tag-body): Use post-hoc colorizations.
	(shr-tag-body): Set up a style sheet based on bgcolor/fgcolor.
	(shr-put-color-1): Don't overwrite old colors.
	(shr-colorize-region): When the background color isn't explicit, use
	a fixed background.

	* gnus-util.el (gnus-output-to-mail): Require nnmail before using
	nnmail variables.

2010-12-05  Bjørn Mork  <bjorn@mork.no>

	* nnimap.el (nnimap-process-expiry-targets): Avoid downloading articles
	unless necessary.

2010-12-05  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (nnir-run-gmane): Use more careful test for gmane nntp
	server.

2010-12-04  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-html.el (gnus-html-put-image): Use widget instead of local maps
	so that TAB works.

	* gnus-sum.el (gnus-summary-show-article): Reverse the meanings of `C-u
	C-u g' and `C-u g' so that `C-u g' does what it traditionally did.

	* shr.el (shr-urlify): Show the URL before the title to avoid
	misleading URLs.

2010-12-04  Adam Sjøgren  <asjo@koldfront.dk>

	* shr.el (shr-urlify): Display the title in <a> tags.

2010-12-04  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (nnir-categorize): Replace mapcar with mapc.

2010-12-03  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el: Rearrange code to allow macros to be autoloaded by
	gnus-sum.el.
	(nnir-retrieve-headers-override-function): Make this variable
	customizable.
	(nnir-retrieve-headers): Remove obsolete subject-mangling code.

	* gnus-sum.el (nnir-article-group,nnir-article-rsv): Autoload macros
	from nnir.el.

2010-12-03  Julien Danjou  <julien@danjou.info>

	* gnus-demon.el (gnus-demon-init): Fix time computing when time is nil.

2010-12-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-util.el (gnus-macroexpand-all): Don't modify argument;
	allow optional argument `environment'.

2010-12-03  Glenn Morris  <rgm@gnu.org>

	* mm-extern.el (message-goto-body): Update declaration.

2010-12-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-util.el (gnus-macroexpand-all): New function.

	* gnus-sum.el (gnus-summary-line-format-alist): Use gnus-macroexpand-all
	instead of macroexpand-all that is unavailable in XEmacs.

2010-12-02  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (nnir-summary-line-format): New variable.
	(nnir-mode): Use it.
	(nnir-artlist-*,nnir-aritem-*): Reimplement as macros.
	(nnir-article-ids): Reimplement as defsubst.
	(nnir-retrieve-headers): Don't mangle the subject header.
	(nnir-run-imap): Use 100 as RSV score.
	(nnir-run-find-grep): Fix for full server searching.
	(nnir-run-gmane): Better restriction to gmane groups.

	* gnus-sum.el (gnus-summary-line-format-alist): Add specs for nnir
	summary buffers.

2010-12-02  Julien Danjou  <julien@danjou.info>

	* gnus-win.el (gnus-configure-frame): Remove old compatibility code.

	* gnus-msg.el: Mark gnus-outgoing-message-group as obsolete.

	* gnus-win.el (gnus-configure-windows): Remove Gnus 3.x setting
	support.

2010-12-01  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el: Update to handle the registry better.
	(autoload): Silence byte-compiler.
	(nnir-open-server): Add a hook for nnir groups.
	(nnir-request-move-article): Don't mangle the header.  Better to use
	formatting variables (which will be added in the future).
	(nnir-registry-action): Update the registry using the original article
	group name.
	(nnir-mode): Install nnir-specific hooks for updating the registry.

	* gnus-sum.el
	(gnus-article-original-subject,gnus-newsgroup-original-name):
	Remove obsolete variables.
	(gnus-summary-move-article): Remove use of obsolete variables.
	(gnus-summary-local-variables): Make move and delete hooks local to
	summary buffers.

2010-12-01  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* rtree.el: New file.

2010-12-01  Julien Danjou  <julien@danjou.info>

	* message.el (message-user-organization): Do not use
	gnus-local-organization.

	* gnus.el: Remove gnus-local-organization.

	* gnus-msg.el: Remove nastygram thing.

2010-12-01  Teodor Zlatanov  <tzz@lifelogs.com>

	* nnmaildir.el (nnmaildir-request-set-mark): Add article to add-mark
	funcall.

2010-12-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-gravatar.el (gnus-gravatar-insert): Allow LWSP in the middle of
	names.

	* shr.el (shr-find-fill-point): Don't break line between kinsoku-bol
	characters.

	* gnus-gravatar.el (gnus-gravatar-insert): Delete unnecessary binding
	to t of inhibit-read-only since it is inside gnus-with-article-headers.
	Suggested by Štěpán Němec <stepnem@gmail.com>.
	(gnus-gravatar-transform-address): Use mail-extract-address-components
	that supports non-ASCII names rather than mail-header-parse-addresses.

2010-11-30  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* proto-stream.el (open-protocol-stream): All STARTTLS connections are
	handled by the network handler.

2010-11-30  Julien Danjou  <julien@danjou.info>

	* nnimap.el (nnimap-open-connection-1): Use gnus-string-match-p.
	(nnimap-open-connection-1): Fix PREAUTH.

	* gnus-gravatar.el (gnus-gravatar-size): Set gnus-gravatar-size to nil.

2010-11-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* shr.el (shr-char-breakable-p, shr-char-nospace-p)
	(shr-char-kinsoku-bol-p, shr-char-kinsoku-eol-p): New macros.
	(shr-insert): Use them.
	(shr-find-fill-point): Work better for kinsoku chars and apostrophes.

2010-11-29  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (nnir-request-move-article): Bail out if original group
	doesn't support article moves.
	(nnir-get-active): Improve active list retrieval.

2010-11-29  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-find-fill-point): Don't break before apostrophes.

2010-11-29  Binjo  <binjo.cn@gmail.com>  (tiny change)

	* nnimap.el (nnimap-open-connection-1): w32 open-network-stream doesn't
	seem to accept strings-with-numbers as port numbers,

2010-11-29  Andrew Cohen  <cohen@andy.bu.edu>

	* gnus-sum.el (gnus-summary-delete-article): If delete fails don't
	change the registry.

2010-11-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnir.el (nnir-run-gmane): Use mm-delete-duplicates instead of
	delete-dups that is not available in XEmacs 21.4.

	* mm-util.el (mm-delete-duplicates): Add comment.

2010-11-28  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (nnir-ignored-newsgroups): New variable.
	(nnir-get-active): Use it.

2010-11-28  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* proto-stream.el (proto-stream-open-network): Add some comments.

	* nntp.el (nntp-open-connection): Provide a :success condition.

	* nnimap.el (nnimap-open-connection-1): Ditto.

	* proto-stream.el (proto-stream-open-network): See what the response to
	the STARTTLS command is.

	* nnimap.el (nnimap-open-connection-1): Always upgrade to STARTTLS (for
	backwards compatibility).
	(nnimap-open-connection-1): Really respect nnimap-server-port.

	* proto-stream.el (proto-stream-open-network): When doing opportunistic
	TLS upgrades we don't really care about the identity of the peer.
	(proto-stream-open-network): Force starttls.el to use gnutls-cli, since
	that what we've checked for.
	(proto-stream-always-use-starttls): Only default to t if
	open-gnutls-stream exists.
	(proto-stream-open-network): If STARTTLS failed, then just open a
	normal connection.
	(proto-stream-open-network): Wait until the greeting before doing
	STARTTLS.

	* nntp.el (nntp-open-connection): Report what the connection error is.

	* proto-stream.el (open-protocol-stream): Rename from
	open-proto-stream.

2010-11-27  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-stream): Change default to `undecided'.
	(nnimap-open-connection): If `nnimap-stream' is `undecided', try ssl
	first, and then network.
	(nnimap-open-connection-1): Respect nnimap-server-port.
	(nnimap-open-connection): Be more backwards-compatible.

	* proto-stream.el (proto-stream-always-use-starttls): New variable.
	(proto-stream-open-starttls): De-duplicate the STARTTLS code.
	(proto-stream-open-starttls): Folded back into the main function.
	(proto-stream-open-network): Fix typo in the GnuTLS path.
	(proto-stream-command): Refactor out.

	* nntp.el (nntp-open-connection): Fix the STARTTLS command syntax.

	* proto-stream.el (proto-stream-open-starttls): Actually implement the
	starttls.el STARTTLS.

	* color.el (color-lab->srgb): Fix function call name.

	* proto-stream.el (proto-stream-open-tls): Delete output from openssl
	if we're using tls.el.
	(proto-stream-open-network): If we don't have gnutls-cli or GnuTLS
	built in, then don't try to establish a STARTTLS connection.

	* nntp.el (nntp-open-connection): Switch on STARTTLS on supported
	servers.

	* proto-stream.el (open-proto-stream): Use network, not stream.
	(open-proto-stream): Add a way to specify what the end of a command is.

	* nntp.el (nntp-open-connection): Use proto-streams for the relevant
	connections types.
	(nntp-open-network-stream): Remove.
	(nntp-open-ssl-stream): Remove.
	(nntp-open-tls-stream): Remove.
	(nntp-ssl-program): Remove.

	* nnimap.el (nnimap-open-connection): Check for "OK" from the greeting.

2010-11-27  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el: Fix typos.
	(nnir-retrieve-headers-override-function): Rename variable to reflect
	new semantics.
	(nnir-article-group, nnir-article-number, nnir-article-rsv): New helper
	macros.
	(nnir-request-article, nnir-request-move-article): Use them.
	(nnir-categorize): New function.
	(nnir-run-query): Use it.
	(nnir-retrieve-headers): Rewrite to batch header retrieval.
	(nnir-run-gmane): nnir-retrieve-headers now returns the headers already
	sorted.
	(nnir-group-full-name): Use gnus-group-full-name instead.
	(nnir-artlist-artitem-group, nnir-artlist-artitem-number)
	(nnir-artlist-artitem-rsv, nnir-sort-groups-by-server): Obsolete.

2010-11-27  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-open-connection): Fix typo in STARTTLS command.

	* proto-stream.el: New library to provide protocol-specific
	TLS/STARTTLS connections for IMAP, NNTP, SMTP, POP3 and similar
	protocols.
	(open-proto-stream): Complete the documentation.
	(proto-stream-open-network): Fix some typos.

	* nnimap.el (nnimap-open-connection): Use it.

2010-11-27  Yuri Karaban  <tech@askold.net>  (tiny change)

	* pop3.el (pop3-open-server): Read server greeting before starting TLS
	negotiation.

2010-11-26  Julien Danjou  <julien@danjou.info>

	* color.el: Rename various rgb functions to srgb.

2010-11-26  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-get-groups): Allow non-quoted strings as mailbox
	names.

2010-11-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* shr.el (shr-insert): Revert last change.
	(shr-find-fill-point): Never leave point being at bol;
	relax the kinsoku limitation when rendering tables.

2010-11-26  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnmail.el (nnmail-expiry-target-group): Protect against degenerate
	results from -accept-article.

	* shr-color.el: Require cl when compiling.

	* nnheader.el (nnheader-update-marks-actions): Fix typo in last
	checkin.

	* gnus-art.el (gnus-url-mailto): Unfold URLs before using them.

	* nnimap.el (nnimap-request-set-mark): Add is "+", not "-".

	* gnus-sum.el (gnus-summary-push-marks-to-backend): Use 'set instead of
	'add and 'delete to set backend marks.

	* nnmaildir.el (nnmaildir-request-set-mark): Be explicit about 'set.

	* nnheader.el (nnheader-update-marks-actions): Refactor out.

	* nntp.el (nntp-request-set-mark): Use it.

	* nnfolder.el (nnfolder-request-set-mark): Ditto.

	* nnml.el (nnml-request-set-mark): Ditto.

	* nnimap.el (nnimap-last-response-string): Remove the unfolding -- it
	introduces regressions in article selection.
	(nnimap-find-uid-response): New function.
	(nnimap-request-accept-article): Use the UID returned, if any.
	(nnimap-request-move-article): Use the UID returned, if any.
	(nnimap-get-groups): Reimplement to work with folded lines.
	(nnimap-find-uid-response): The UID is the last element in the list.
	(nnimap-request-set-mark): Extend syntax with 'set.

	* nnml.el (nnml-request-set-mark): Ditto.

	* nnfolder.el (nnfolder-request-set-mark): Ditto.

	* nntp.el (nntp-request-set-mark): Ditto.

2010-11-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-called-interactively-p): A temporary macro.
	(message-goto-body): Use it temporarily.

2010-11-25  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-unfold-quoted-lines): Refactor out.
	(nnimap-last-response-string): Unfold quoted lines, if they exist.
	(nnimap-last-response-string): Fix last unfolding fix.

2010-11-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* shr.el (shr-insert): Fix the way to fold lines.

2010-11-25  Julien Danjou  <julien@danjou.info>

	* shr-color.el (shr-color->hexadecimal): Use color-rgb->hex

	* color.el: Rename from color-lab.el
	(color-rgb->hex): Add.
	(color-complement): Add.
	(color-complement-hex): Add.

	* gnus-sum.el (gnus-summary-widget-forward): Add, and bind to [tab].

2010-11-25  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr-color.el (shr-color-visible): Don't bug out if the color names
	don't exist.

2010-11-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mml.el (mml-preview): Make sure to bind gnus-displaying-mime to nil,
	assuming that article displaying or another mml-preview may be
	interrupted for an error or for the like.

	* shr.el (shr-get-background): Fix argument name.

2010-11-24  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-cache.el (gnus-summary-insert-cached-articles): Use it.

	* gnus-sum.el (gnus-summary-include-articles): New function.

	* message.el (message-goto-body): called-interactively-p needs a
	parameter, so use `any'.

	* nnimap.el (nnimap-request-move-article): It's no longer necessary to
	clear marks before moving, since they're synced from the Gnus side
	first.

	* gnus-sum.el (gnus-summary-push-marks-to-backend): New function.
	(gnus-summary-move-article): Copy over all marks before moving, so that
	IMAP doesn't think a new article has arrived.

2010-11-24  Julien Danjou  <julien@danjou.info>

	* shr.el (shr-insert-background-overlay): Fix typo.
	(shr-render-td): Copy the background before rendering.

	* shr-color.el (shr-color-visible): Fix docstring.

	* shr.el (shr-tag-table): Add bgcolor support.
	(shr-render-td): Add bgcolor support.
	(shr-get-background): Add.
	(shr-insert-foreground-overlay): Use shr-get-background.

	* message.el (message-goto-body): Use called-interactively-p.
	(message-in-body-p): message-goto-body returns point.

2010-11-24  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mm-util.el (mm-enable-multibyte): Use `to' instead of t.  This fixes
	Fixes something or other in Emacs 23, and is backwards compatible.

	* message.el (message-goto-body): Remove the <#secure special-casing,
	which is too special.

	* shr.el (shr-parse-style): Drop !important from styles.

2010-11-24  Daniel Schoepe  <daniel.schoepe@googlemail.com>  (tiny change)

	* gnus-sum.el (gnus-summary-articles-in-thread): Fix a bug that causes
	this function to return incorrect results when calling it with an
	explicit article argument different from
	(gnus-summary-article-number).

2010-11-24  Julien Danjou  <julien@danjou.info>

	* shr.el (shr-insert-color-overlay): Replace deprecated syntax.
	(shr-tag-body): Add background support.
	(shr-descend): Add background support.
	(shr-tag-title): Add.

	* shr-color.el (shr-color-visible): Really return original background
	if fixed.

2010-11-24  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-color-check): Protect against non-existent color names.

2010-11-24  Julien Danjou  <julien@danjou.info>

	* color-lab.el: Require 'cl when compiling.

	* shr.el (shr-insert-color-overlay): Remove specific rgb() check.

	* shr-color.el (shr-color->hexadecimal): Only return the hexadecimal
	matched part.

	* color-lab.el: Fix all expt calls to use float type.

2010-11-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* shr.el (shr-insert-color-overlay): Pass rgb(rrr, ggg, bbb) type color
	expression to shr-color-check as is.

	* shr-color.el (shr-color->hexadecimal): Ignore case of color names.

	* color-lab.el: Add coding cookie.
	(float-pi): Use eval-and-compile.

2010-11-23  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-insert-color-overlay): Split stuff like
	"#444444 !important" to find the real color.
	(shr-tag-font): Resurrect shr-tag-font again, since it's needed to
	parse <font color="red"> entries.

2010-11-23  Andrew Cohen  <cohen@andy.bu.edu>

	* nnheader.el (nnheader-parse-head): Bug fix.  Properly position
	point when parsing headers.

	* nnspool.el (nnspool-insert-nov-head): Bug fix.  Make sure point
	is positioned properly when parsing headers.

2010-11-23  Julien Danjou  <julien@danjou.info>

	* color-lab.el (boundp): Bind float-pi for Emacs < 23.3.

	* shr-color.el (shr-color->hexadecimal): Add support for color names.

	* shr.el (shr-parse-style): Replace \n with space in style parsing.

	* shr-color.el (shr-color-hsl-to-rgb-fractions):
	Use shr-color-hue-to-rgb.
	(shr-color->hexadecimal): Call shr-color-hsl-to-rgb-fractions.

2010-11-23  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-color->hexadecimal): Autoload.
	(shr-descend): Add color to all tags.

2010-11-22  Julien Danjou  <julien@danjou.info>

	* shr.el (shr-tag-color-check): Convert colors to hexadecimal with
	shr-color->hexadecimal.

	* shr-color.el (shr-color->hexadecimal): Add converting functions for
	RGB() or HSL() color representation.

	* shr.el (shr-tag-font): Add.
	(shr-tag-color-check): New function to get better colors.
	(shr-tag-insert-color-overlay): Factorize code between tag-font and
	tag-span.

	* shr-color.el: New file.

	* color-lab.el: New file.

	* gnus-art.el (gnus-url-mailto): Do not downcase args.

2010-11-21  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el: Fix typo in comments.
	(nnir-run-imap): Simplify code.  No need to reverse artlist.
	(nnir-run-gmane): Use nnir-tmp-buffer for web results.

2010-11-21  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-srvr.el (gnus-server-show-server): New command and keystroke.

	* nnimap.el (nnimap-get-capabilities): Refactor out.
	(nnimap-open-connection): Re-request capabilities after STARTTLS.

2010-11-21  Ralf Angeli  <angeli@caeruleus.net>

	* mm-uu.el (mm-uu-type-alist): Prevent spurious empty line from
	appearing when `mm-uu-hide-markers' is nil.

2010-11-21  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-unselect-group): Make into its own function.
	(nnimap-request-rename-group): Unselect group before renaming.
	This had gotten lost somewhere.
	(nnimap-request-accept-article): Keep track of examined groups, and
	unselect the group before APPENDing to read-only groups.
	(nnimap-request-move-article): Clear flags before moving so that they
	can be re-set later.

2010-11-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-gravatar.el (gnus-gravatar-transform-address): Decode name again.
	(gnus-gravatar-insert): Put avatar always in the beginning of the field.

2010-11-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-mime-display-single):
	* gnus-html.el (gnus-html-wash-images, gnus-html-prefetch-images):
	* mm-decode.el (mm-shr): Assume that gnus-inhibit-images may be a group
	parameter.

2010-11-18  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-table-horizontal-line): Rename from shr-table-line.
	(shr-table-vertical-line): New variable.
	(shr-insert-table): Use it.

2010-11-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-html.el (gnus-html-wash-images): Don't display images if
	gnus-inhibit-images is non-nil; register displayer for cid images.
	(gnus-html-display-image): Work for cid image.
	(gnus-html-insert-image): Allow arguments.
	(gnus-html-put-image): Inhibit read-only.
	(gnus-html-prefetch-images): Don't prefetch images if
	gnus-inhibit-images is non-nil.

2010-11-17  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-put-image): Break lines when inserting big pictures.

2010-11-17  Daniel Dehennin  <daniel.dehennin@baby-gnu.org>

	* mml2015.el (mml2015-epg-encrypt): Fix two cons with missing
	sender, thanks Katsumi Yamaoka.

2010-11-17  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (nnir-run-imap): Reverse the article list for each group
	rather than the whole list.

2010-11-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* shr.el (shr-image-displayer): Protect function against non-existent
	image source.

	* gnus-art.el (gnus-inhibit-images): New user option.
	(gnus-mime-display-single): Don't display image if it is non-nil.

	* mm-decode.el (mm-shr): Bind shr-inhibit-images to the value of
	gnus-inhibit-images.

	* shr.el (shr-image-displayer): New function.
	(shr-tag-img): Use it.

2010-11-16  Daniel Dehennin  <daniel.dehennin@baby-gnu.org>

	* mml2015.el (mml2015-epg-sign): Use From header.

2010-11-15  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-html.el (gnus-html-wash-images): Register a displayer.

	* gnus-util.el (gnus-find-text-property-region): Return markers.

	* shr.el (shr-tag-img): Put a displayer in the text property.

	* gnus-util.el (gnus-find-text-property-region): New utility function.

	* gnus-html.el (gnus-html-display-image): Make the alt optional.
	(gnus-html-show-images): Remove.

	* gnus-art.el (gnus-article-show-images): New, more general function.

	* gnus-html.el: Use image-url instead of gnus-image-url to unify the
	image url text properties.

	* shr.el: Ditto.

	* gnus-agent.el (gnus-agentize): Only do the auto-agentizing if
	gnus-agent-auto-agentize-methods is set.  Which it isn't.

2010-11-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-summary-move-article): Fix `while' loop to make it
	work for two or more articles.

2010-11-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (article-treat-non-ascii): Keep text properties not to
	divide an image that's in an html article to two or more when washing
	non-ASCII characters in alt text of it.

2010-11-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-decode.el (mm-dissect-buffer): Pass sender's mail address to
	smime-decrypt-region using function argument.
	(mm-possibly-verify-or-decrypt, mm-dissect-multipart): Relay it.

	* mm-view.el (mm-view-pkcs7, mm-view-pkcs7-decrypt): Relay it.

	* smime.el (smime-decrypt-region): Catch it.

2010-11-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* smime.el (smime-mode-map): Move initialization into declaration.
	(gnus-run-mode-hooks): Don't autoload.
	(smime-mode): Use define-derived-mode.

2010-11-11  Glenn Morris  <rgm@gnu.org>

	* smime.el (from): Restrict declaration to XEmacs.

	* nnir.el (gnus-group-topic-name): Autoload.

2010-11-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* shr.el (shr-insert): Don't break long line if it is because of
	kinsoku-bol characters in the line end.

2010-11-11  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (nnir-request-move-article): Fix to provide original group
	and subject.
	(nnir-warp-to-article): Don't fail on articles whose headers haven't
	been retrieved.

	* gnus-sum.el (gnus-summary-move-article): Use original group and
	subject for virtual articles such as those in an nnir summary buffer.

2010-11-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (article-treat-non-ascii): Make it work for XEmacs (at
	least 21.5).

	* smime.el (from): Declare it again for XEmacs.

2010-11-10  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-resend): Don't disable encoding unless it's
	already encoded.

	* nnimap.el (nnimap-update-info): Fix problem with `g' chopping of
	low-numbered articles.

2010-11-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2047.el (rfc2047-syntax-table): Simplify.

	* gnus-art.el (article-treat-non-ascii): Use put-char-table instead of
	set-char-table-range for XEmacs.

2010-11-10  Glenn Morris  <rgm@gnu.org>

	* smime.el (from): Remove unused declaration.

	* gnus-util.el (with-no-warnings): Remove compat stub, now unused.
	(gnus-float-time): On Emacs, always an alias.

	* ecomplete.el (with-no-warnings): Remove compat stub, now unused.
	(ecomplete-add-item): Use float-time on Emacs, else gnus-float-time.

2010-11-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (org-entities): Declare it to silence the byte compiler.

2010-11-09  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (browse-url-mailto): Autoload.

	* gnus-art.el (article-treat-non-ascii): New command and keystroke.

	* message.el (message-subject-trailing-was-ask-regexp): A ] in a []
	regexp doesn't need quoting.

2010-11-09  Sven Joachim  <svenjoac@gmx.de>

	* message.el (message-subject-trailing-was-ask-regexp)
	(message-subject-trailing-was-regexp): Match was: in addition to was.

2010-11-09  Glenn Morris  <rgm@gnu.org>

	* nnbabyl.el (nnbabyl-request-move-article, nnbabyl-delete-mail)
	(nnbabyl-check-mbox): Use point-at-bol.

2010-11-08  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-browse-url): Call browse-url-mailto for mailto: links.

	* message.el (message-mailto): New function.
	(message-mailto): Should accept other parameters.
	(message-mailto): Remove since it duplicates browse-url-mailto
	functionality.

2010-11-07  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-start.el (gnus-get-unread-articles): Ignore totally non-existent
	methods.
	(gnus-read-active-file): Ditto.

	* gnus-group.el (gnus-group-read-ephemeral-group): Remove superfluous
	": " from the prompt.
	(gnus-group-make-group): Ditto.

2010-11-07  Glenn Morris  <rgm@gnu.org>

	* gnus-bookmark.el (gnus-bookmark-bmenu-show-infos)
	(gnus-bookmark-kill-line): Use point-at-eol.

2010-11-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-gravatar.el (gnus-gravatar-transform-address): No need to skip
	asterisks in From header.

2010-11-06  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-ems.el (gnus-put-image): Use a blank text as the insertion
	string to avoid making the From headers syntactically invalid.

	* message.el (message-send-mail): Don't insert courtesy messages if the
	message already has List-Post and List-ID messages.

2010-11-06  Glenn Morris  <rgm@gnu.org>

	* gnus-art.el (gnus-treat-article): Give dynamic local variables
	`condition', `type', `length' a prefix.
	(gnus-treat-predicate): Update for above name changes.

2010-11-06  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (gnus-summary-nnir-goto-thread): Remove function and
	binding.  Handled by `gnus-summary-refer-thread' instead.
	(nnir-warp-to-article): New backend function.

	* nnimap.el (nnimap-request-thread): Force dependency updating.

	* gnus-sum.el (gnus-fetch-headers): Allow more arguments.
	(gnus-summary-refer-thread): Rework to improve thread-referral.

	* gnus-int.el (gnus-warp-to-article): New function.

	* gnus-sum.el (gnus-summary-article-map): Bind it.

2010-11-04  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (gnus-summary-nnir-goto-thread): Limit work done by
	gnus-summary-refer-thread.

	* gnus-sum.el (gnus-build-all-threads): Force updating of dependency
	headers.
	(gnus-summary-limit-include-thread): Prevent articles in thread from
	being cut in gnus-cut-threads.
	(gnus-summary-refer-thread): Limit retrieved headers to those in
	thread.

2010-11-04  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-send-mail): Use the value of
	message-courtesy-message from the message buffer.

	* gnus-html.el (gnus-html-browse-url): Implement mailto: URLs.

	* shr.el (shr-browse-url): Implement mailto: URLs.

	* gnus-sum.el (gnus-summary-show-article): Take `t' as the arg to mean
	"raw".

	* nnimap.el (nnimap-find-article-by-message-id): Don't EXAMINE a group
	if it's already selected.

	* mm-decode.el (mm-save-part): Put the entire path in the `M-n' slot.

2010-11-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* shr.el (shr-tag-img): Use string-width and truncate-string-to-width
	to measure the length and truncate alt text.

2010-11-03  Glenn Morris  <rgm@gnu.org>

	* nndiary.el (nndiary-generate-nov-databases-1)
	(nndiary-generate-active-info): Rename dynamic variable `files' to
	something less generic.

2010-11-03  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (nnir-request-move-article): Call the underlying backend to
	move articles from nnir.

2010-11-02  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-cite.el (gnus-article-natural-long-line-p): Remove.

2010-11-02  Julien Danjou  <julien@danjou.info>

	* nnir.el: Remove wais support.

2010-11-02  Glenn Morris  <rgm@gnu.org>

	* gnus-html.el: Reorder requirements to quieten compiler.

2010-11-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-cite.el (gnus-article-fill-cited-article): Make fill work
	properly for XEmacs as well.
	(gnus-article-fill-cited-article, gnus-article-foldable-buffer)
	(gnus-article-natural-long-line-p): Use window-width rather than
	frame-width.

2010-11-01  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (nnir-run-gmane): Inhibit demon.  Return nil if no messages.
	(nnir-read-parms): Don't modify query.
	(nnir-run-query): Add ability to search topic on current line.
	(nnir-get-active): Clean up.

2010-11-01  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-cite.el (gnus-article-foldable-buffer): Protect against
	degenerate articles.

	* gnus-sum.el (gnus-print-buffer): Rewrite to use with-temp-buffer.
	(gnus-print-buffer): Just print the buffer as is, without any copying
	to a buffer and then re-highlighting.

	* nnimap.el (nnimap-request-group): Store the new updated info.
	(nnimap-request-group): Select the group when we don't know whether it
	exists or not.

	* gnus-start.el (gnus-ask-server-for-new-groups): Return the new
	groups.

	* gnus-group.el (gnus-group-find-new-groups): Display all the new
	groups.

	* gnus-start.el (gnus-find-new-newsgroups): Return the list of new
	groups.

	* gnus-cite.el (gnus-article-fill-cited-article): Minimize the
	long-lines case by only filling the long lines.

	* nnimap.el (nnimap-parse-line): Don't bug out oddly formed replies
	(bug #7311).

2010-11-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* shr.el: No need to declare `declare-function' since shr.el is for
	only Emacsen that provide `libxml-parse-html-region'.

2010-11-01  Glenn Morris  <rgm@gnu.org>

	* mm-util.el (gnus-completing-read): Autoload.
	(mm-read-coding-system): Simplify Emacs definition.

	* nnmail.el (gnus-activate-group):
	* nnimap.el (gnutls-negotiate):
	* nntp.el (netrc-parse): Fix declarations.

2010-11-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-util.el (gnus-string-match-p): New function, that is an alias to
	string-match-p in Emacs >=23.

	* gnus-msg.el (gnus-configure-posting-styles):
	* nnir.el (nnir-run-gmane): Use gnus-string-match-p.

2010-11-01  Glenn Morris  <rgm@gnu.org>

	* nnir.el (declare-function): Add compat stub.
	(mm-url-insert, mm-url-encode-www-form-urlencoded): Declare.
	(nnir-run-gmane): Require 'mm-url.

	* mm-util.el (mm-string-to-multibyte): Simplify.

	* shr.el (declare-function): Add compat stub.
	(url-cache-create-filename): Declare.
	(mm-disable-multibyte, widget-convert-button): Autoload.

	* smime.el (ldap-search): Declare.
	(smime-cert-by-ldap-1): Require ldap on Emacs.

	* nnimap.el: Require nnmail, and gnus-sum when compiling.
	(nnimap-keepalive): Use gnus-float-time.

	* mail-source.el (nnheader-message, gnus-float-time): Autoload.
	(mail-source-delete-crash-box): Use gnus-float-time.

	* gnus-dired.el (gnus-completing-read): Autoload.

	* mm-view.el (gnus-rescale-image): Autoload.

	* mm-decode.el (gnus-completing-read, gnus-blocked-images): Autoload.

	* gnus.el (gnus-sloppily-equal-method-parameters): Move defn before use.

	* sieve-manage.el: Require 'cl when compiling.

	* gnus-util.el (iswitchb-read-buffer): Declare rather than autoload.
	(gnus-iswitchb-completing-read): Require iswitchb.
	(gnus-select-frame-set-input-focus): Silence compiler.

2010-10-31  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-subject-trailing-was-query): Change default to t,
	since I think that's what most people want.

	* nnimap.el (nnimap-request-accept-article): Erase buffer before
	appending for easier debugging.
	(nnimap-wait-for-connection): Take a regexp.
	(nnimap-request-accept-article): Wait for the continuation line before
	sending anything unless we're streaming.

	* gnus-art.el (gnus-treat-article): Only inhibit body washing, and
	leave the header washing to take place.

2010-10-31  Daniel Dehennin  <daniel.dehennin@baby-gnu.org>

	* gnus-msg.el (gnus-configure-posting-styles): Permit the use of
	regular expression match and replace in posting styles.

2010-10-31  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (gnus-group-make-nnir-group,nnir-run-query): Allow searching
	an entire server.
	(nnir-get-active): New function.
	(nnir-run-imap): Use it.
	(nnir-run-gmane): Who knew, gmane search returns an article score!

	* gnus-srvr.el (gnus-server-mode-map): Add binding "G" to search the
	server on the current line with nnir.

2010-10-31  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-cite.el (gnus-article-foldable-buffer): Refactor out.
	(gnus-article-foldable-buffer): Don't fold regions that have a ragged
	left edge.
	(gnus-article-foldable-buffer): Skip past the prefix when determining
	raggedness.

	* gnus-sum.el (gnus-summary-show-article): Add `C-u C-u g' for showing
	the raw article, and change `C-u g' to show the article without doing
	treatments.

	* gnus-art.el (gnus-mime-display-alternative): Actually pass the type
	on to `gnus-treat-article'.
	(gnus-inhibit-article-treatments): New variable.

	* gnus.el: Autoload gnus-article-fill-cited-long-lines.

	* gnus-art.el (gnus-treatment-function-alist): Have
	gnus-treat-fill-long-lines point to gnus-article-fill-cited-long-lines.
	(gnus-treat-fill-long-lines): Change default to fill all text/plain
	sections.

	* gnus-cite.el (gnus-article-fill-cited-article): Remove unused `force'
	parameter.
	(gnus-article-fill-cited-long-lines): New function.
	(gnus-article-fill-cited-article): Allow filling only long sections.

	* shr.el (shr-find-fill-point): Don't break lines between punctuation
	and non-punctuation (like after the apostrophe in "'We").

	* gnus-sum.el (gnus-summary-select-article): Make sure
	gnus-original-article-buffer is alive.

	* nndoc.el (nndoc-dissect-buffer): Reverse the order of the articles to
	reflect the order they are in the digest.

	* gnus.el (gnus-group-startup-message): Move point to the start of the
	buffer.

	* nnimap.el (nnimap-capability): New function.
	(nnimap-open-connection): Only send AUTHENTICATE PLAIN if LOGINDISABLED
	is set.

2010-10-31  David Engster  <dengste@eml.cc>

	* nnmairix.el (nnmairix-get-valid-servers): Return list of strings to
	conform with changes to gnus-completing-read.

2010-10-30  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-tag-img): Output "*" instead of "[img]".

2010-10-30  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el: Move defvar, defcustom around to keep file organized
	and keep byte-compiler quiet.
	(nnir-read-parms): Accept search-engine as arg.
	(nnir-run-query): Pass search-engine as arg.
	(nnir-search-engine): Remove.

2010-10-30  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-generic): The text nodes should be text, not :text.

	* nnir.el (nnir-search-engine): Ressurect variable, since it's used
	later in the file.

2010-10-30  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el: General clean up.  Allow searching with multiple engines.
	Allow separate extra-parameters for each engine.
	Batch queries when possible.
	(nnir-imap-default-search-key,nnir-method-default-engines):
	Add customize interface.
	(nnir-run-gmane): New engine.
	(nnir-engines): Use it.  Qualify all prompts with engine name.
	(nnir-search-engine): Remove global variable.
	(nnir-run-hyrex): Restore for now.
	(nnir-extra-parms,nnir-search-history): New variables.
	(gnus-group-make-nnir-group): Use them.
	(nnir-group-server): Remove in favor of gnus-group-server.
	(nnir-request-group): Avoid searching twice.
	(nnir-sort-groups-by-server): New function.

2010-10-30  Julien Danjou  <julien@danjou.info>

	* gnus-group.el: Remove gnus-group-fetch-control.

	* gnus-start.el (gnus-find-new-newsgroups):
	Remove gnus-check-first-time-used.

	* gnus.el: Remove gnus-backup-default-subscribed-newsgroups.

2010-10-30  Knut Anders Hatlen  <kahatlen@gmail.com>  (tiny change)

	* nnimap.el (nnimap-update-info): Allow 'ticked and other flags to be
	set on groups that don't have \* permanentflags.

2010-10-30  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-tag-span): Drop colorization of regions since we don't
	control the background color.
	(shr-tag-img): Ignore very small web bug type images.
	(shr-put-image): Add help-echo alt texts to the images.
	(shr-tag-video): Show the video poster image.

2010-10-29  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-table-depth): New variable.
	(shr-tag-table-1): Only insert the images after the top-level table.

	* nnimap.el (nnimap-split-incoming-mail): Fix typo.

	* gnus-util.el (gnus-list-memq-of-list): New function.

	* nnimap.el (nnimap-split-incoming-mail): Note that the INBOX has been
	selected.
	(nnimap-unsplittable-articles): New slot.
	(nnimap-new-articles): Use it.

2010-10-29  Stephen Berman  <stephen.berman@gmx.net>  (tiny change)

	* gnus-group.el (gnus-group-get-new-news-this-group): Don't have point
	move to the previous line on `M-g'.

2010-10-29  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-msg.el (gnus-inews-do-gcc): Don't have the backends do the slow
	*-request-group, which seems unnecessary.

	* nnimap.el (nnimap-quote-specials): Function copied over from
	imap.el.
	(nnimap-open-connection): Use AUTHENTICATE PLAIN on servers that say
	they support that.  Suggested by Tom Regner.

2010-10-29  Julien Danjou  <julien@danjou.info>

	* gnus-sum.el (gnus-summary-delete-marked-as-read): Remove obsolete
	defalias.
	(gnus-summary-delete-marked-with): Remove obsolete defalias.

	* gnus.el: Remove `gnus-nntp-service' variable.
	(gnus-secondary-servers): Make obsolete.
	(gnus-nntp-server): Make obsolete.

	* gnus-start.el (gnus-1): Remove x-splash calls.

	* gnus-ems.el (gnus-x-splash): Remove.

	* gnus.el (gnus-group-startup-message): Simplify/update code.

	* gnus-group.el (gnus-group-make-tool-bar): Check for display graphic
	capability before doing anything.
	(gnus-group-insert-group-line): Remove useless
	gnus-group-remove-excess-properties.

2010-10-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-goto-part): Work for article narrowed by ^L.

2010-10-28  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-summary-rescan-group): Try to restore the window
	config after reselecting.

2010-10-28  Julien Danjou  <julien@danjou.info>

	* shr.el (shr-put-image): Use point even if only inserting text.
	(shr-put-image): Save excursion when inserting alt text on non-graphic
	display, so the behavior is the same when we are on a graphic display.

	* nnir.el (nnir-run-swish-e): Remove hyrex support.

2010-10-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-jump-to-part): Error on no part; fix prompt.
	(gnus-mime-copy-part): Check coding system, not charset.
	(gnus-mime-view-part-externally): Never remove part.
	(gnus-mime-view-part-internally): Don't remove part here.
	(gnus-article-part-wrapper): Make sure MIME tag is visible.
	(gnus-article-goto-part): Go to displayed or preferred subpart if it is
	multipart/alternative.

	* mm-decode.el (mm-display-part): Take optional arg `force'.

2010-10-26  Julien Danjou  <julien@danjou.info>

	* gnus-group.el (gnus-group-default-list-level): Add this function to
	compute the default list level.
	(gnus-group-default-list-level): Add possibility to use a function.

2010-10-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-decode.el (mm-shr): Add undisplayer to MIME handle.

	* gnus-group.el (gnus-group-completing-read)
	(gnus-read-ephemeral-bug-group): Replace replace-regexp-in-string with
	gnus-replace-in-string.

2010-10-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* shr.el (shr-tag-div): Add.

2010-10-25  Julien Danjou  <julien@danjou.info>

	* gnus-util.el: Remove `gnus-with-local-quit'.

	* gnus-demon.el (gnus-demon-init): Use run-with-idle-timer function.

2010-10-25  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-summary-select-article): Fix type error in checking
	the original article buffer.

2010-10-24  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-request-head): New function.
	(nnimap-request-move-article): Try to be slightly faster by not
	requesting the entire message when moving.
	(nnimap-transform-headers): Don't bug out on bodiless articles.
	(nnimap-send-command): Have no outstanding messages if the IMAP server
	doesn't support streaming.
	(nnimap-transform-headers): Fold {quoted} strings more sloppily.

2010-10-24  Julien Danjou  <julien@danjou.info>

	* message.el (message-default-headers): Fix type.

2010-10-24  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-html.el (gnus-html-prefetch-images): Decode entities before
	prefetching images.

	* gnus-sum.el (gnus-group-make-articles-read): Propagate marks to the
	backend for unknown groups.  This is mainly useful for nnimap groups.

	* gnus-agent.el (gnus-agent-fetch-group): Don't download stuff if the
	group isn't covered by the agent.

2010-10-22  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (nnir-method-default-engines): New variable.
	(nnir-run-query): Use it.
	(nnir-group-mode-hook): Remove key binding and move to gnus-group.el.
	(gnus-summary-nnir-goto-thread): Change group if needed.

	* gnus-group.el (gnus-group-group-map): Add key binding for
	gnus-group-make-nnir-group.

2010-10-24  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-tag-object): Add.

	* gnus-sum.el (gnus-summary-select-article): Make sure we have the
	original article buffer live.
	(gnus-summary-select-article-buffer):
	Mention gnus-widen-article-buffer.

2010-10-23  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-tag-strong): Add.

2010-10-22  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-group.el (gnus-group-completing-read): Remove all newlines from
	group names.  They mess up the group buffer badly.

	* shr.el (shr-tag-img): Don't bug out on images that don't have a SRC.

	* gnus-group.el (gnus-group-mark-group): Use gnus-group-position-point
	instead of the summary one.

2010-10-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mml.el (mml-preview): Work properly when editing article.

	* gnus-start.el (gnus-read-active-file-1): Don't add method to
	gnus-have-read-active-file if it's already been in.

2010-10-22  Tom Tromey  <tromey@redhat.com>

	* gnus-group.el (gnus-group-unsubscribe-group): Fix args passed to
	gnus-group-completing-read.

2010-10-21  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-mode-map): Don't bind M-; to comment region, to
	allow the global comment-dwim to work.

2010-10-21  Julien Danjou  <julien@danjou.info>

	* message.el (message-setup-1): Allow message-default-headers to be a
	function.

2010-10-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* shr.el (shr-tag-table): Simplify.

2010-10-21  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-html.el (gnus-html-prefetch-images): Only prefetch http images
	to avoid trying to snarf invalid stuff.

	* gnus-sum.el (gnus-summary-edit-article-done): Bind free variable.

	* gnus.el (gnus-message-archive-group): Quote value.
	(gnus-message-archive-group): Mark as changed.

	* shr.el (shr-add-font): Don't put the font properties on the newline
	or the indentation.

	* message.el (message-fix-before-sending): Change options when sending
	non-printable characters.

	* gnus.el (gnus-message-archive-method): Change the default to
	monthly outgoing groups.

	* gnus-sum.el (gnus-summary-edit-article-done): Try to replace articles
	that have gotten new numbers.

	* nnimap.el (nnimap-request-replace-article): New function.

2010-10-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnrss.el (nnrss-wash-html-in-text-plain-parts): Remove.
	(nnrss-request-article): Don't use special html washing code.

2010-10-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* shr.el (shr-tag-table): Remove useless nconc.

2010-10-20  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-art.el (article-wash-html): Simplify and remove the charset
	stuff.  Use the normal html rendering code instead of the special html
	washing code.

	* mm-view.el (mm-text-html-renderer-alist): Add the `shr' and
	`gnus-w3m' symbols.
	(mm-text-html-washer-alist): Remove.

	* mm-decode.el (mm-inline-text-html-renderer): Remove.
	(mm-inline-media-tests): Remove use.
	(mm-text-html-renderer): Change default to the `shr' symbol.

	* mm-view.el (mm-inline-text-html): Remove use.

	* gnus-art.el (gnus-blocked-images): New function.  Allow the
	`gnus-blocked-images' to be a function.
	(gnus-article-wash-function): Remove.

2010-10-20  Julien Danjou  <julien@danjou.info>

	* spam.el (spam-list-of-processors): Mark as obsolete.

	* nnimap.el (nnimap-request-article): Fix BODYSTRUCTURE retrieval.
	(nnimap-insert-partial-structure): Fix boundary detection.

2010-10-20  Andreas Seltenreich  <seltenreich@gmx.de>

	* gnus-draft.el (gnus-draft-check-draft-articles): Don't unnecessarily
	run file-truename on remote files.  This can be expensive and even
	prevent one from editing drafts if some unrelated buffer has a stale
	connection.

2010-10-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* shr.el (shr-find-fill-point): Shorten line if the preceding char is
	kinsoku-eol regardless of shr-kinsoku-shorten.
	(shr-tag-table-1): Rename from shr-tag-table; make it a subroutine.
	(shr-tag-table): Support caption, thead, and tfoot.

2010-10-19  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-find-fill-point): Don't leave blanks at the start of some
	lines.
	(shr-save-contents): New command and keystroke.

	* nndoc.el (nndoc-type-alist): Add git support.
	(nndoc-git-type-p): New function.
	(nndoc-transform-git-article): Ditto.
	(nndoc-transform-git-headers): Ditto.
	(nndoc-transform-git-headers): Generate Subject headers.

	* shr.el (shr-parse-style): New function.
	(shr-tag-span): Ditto.

	* nnmairix.el (nnmairix-summary-mode-hook): Move nnmairix's `$' command
	to `G G' to avoid collisions.

2010-10-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* shr.el: Load kinsoku if necessary.
	(shr-kinsoku-shorten): New internal variable.
	(shr-find-fill-point): Make kinsoku shorten text line if
	shr-kinsoku-shorten is bound to non-nil.
	(shr-tag-table): Bild shr-kinsoku-shorten to t; refer to
	shr-indentation too when testing if table is wider than frame width.
	(shr-insert-table): Use `string-width' instead of `length' to measure
	text width.
	(shr-insert-table-ruler): Make sure indentation is done at bol.

2010-10-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* nnimap.el (nnimap-request-move-article, nnimap-parse-line)
	(nnimap-process-expiry-targets): Use unibyte for buffers that hold
	undecoded network data.

2010-10-18  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-agent.el (gnus-agent-toggle-plugged): Use the right minor mode
	name in the mode line spec so that the mode line menu works
	(bug #2431).

	* message.el (message-get-reply-headers): If we're fed `to-address',
	then always use that.

	* gnus-art.el (gnus-article-make-menu-bar): The article/group menus
	aren't so wide as to need to switch off the edit menu.

	* gnus-delay.el (gnus-delay-article): Remove superfluous `group'
	binding.  Suggested by Leo <sdl.web@gmail.com> (bug #6613).

	* nnimap.el (nnimap-request-group): Don't SELECT the group twice on
	`M-g'.
	(nnimap-update-info): Update flags/read marks even if \* isn't part of
	the permanent marks.

2010-10-18  Andrew Cohen  <cohen@andy.bu.edu>

	* gnus-registry.el (gnus-registry-split-fancy-with-parent):
	Splitting according to references/in-reply-to obeys the ignore-groups
	variable, while splitting by sender and subject do not.

2010-10-18  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-art.el (gnus-article-dumbquotes-map): Make into a char/string
	alist, so that we can look for non-Unicode chars.
	(article-translate-strings): Allow both character and string maps.

2010-10-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* shr.el (shr-insert): Don't insert space behind a wide character
	categorized as kinsoku-bol, or between characters both categorized as
	nospace.

2010-10-16  Andrew Cohen  <cohen@andy.bu.edu>

	* gnus-sum.el (gnus-summary-refer-thread): Bug fix.  Add the thread
	headers to gnus-newsgroup-headers.

2010-10-16  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-tag-img): Don't align images -- since we're not
	rescaling, this often leads to ugly displays.

2010-10-15  Andrew Cohen  <cohen@andy.bu.edu>

	* gnus-sum.el (gnus-summary-refer-thread): Unconditionally ignore
	duplicates.

2010-10-15  Kan-Ru Chen  <kanru@kanru.info>  (tiny change)

	* gnus-diary.el (gnus-diary-check-message): Fix gnus-completing-read
	call.

2010-10-15  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus.el: Autoload gnus-html-show-images.

	* nnimap.el: Use nnheader-message throughout.

	* shr.el (shr-tag-img): Ignore images with no data.

2010-10-15  Julien Danjou  <julien@danjou.info>

	* mml.el (mml-generate-mime-1): Add `mml-enable-flowed' variable to add
	a possibility to disable format=flow encoding when using hard newlines.

2010-10-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* shr.el (shr-insert): Remove space inserted before or after a
	breakable character or at the beginning or the end of a line.
	(shr-find-fill-point): Do kinsoku; find the second best point or give
	it up if there's no breakable point.

2010-10-14  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-open-connection): Message when opening connection
	for debugging purposes.

	* gnus-art.el (gnus-article-setup-buffer): Set article mode truncation
	on every setup buffer call to allow this to change from article to
	article.

	* shr.el (shr-tag-table): Experimental feature: Truncate lines in
	buffers where we have a wide table.

2010-10-14  Andrew Cohen  <cohen@andy.bu.edu>

	* gnus-sum.el (gnus-summary-refer-thread): Implement a version that
	uses *-request-thread.

2010-10-14  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-open-connection): Remove %s from openssl
	incantation, which is no longer valid.

2010-10-14  Julien Danjou  <julien@danjou.info>

	* shr.el: Fix defcustom type (char -> character).

2010-10-14  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-open-connection): tls-program should be a list of
	programs.

2010-10-14  Julien Danjou  <julien@danjou.info>

	* shr.el (shr-tag-a): Use url-link as widget type.

	* gnus-group.el (gnus-group-insert-group-line): Fix group argument to
	`gnus-group-get-icon'.

2010-10-13  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-close-server): Forget the nnimap data on close.
	This should make server editing work better.

	* shr.el (shr-find-fill-point): Don't inloop on indented text.

	* nnimap.el (nnimap-open-connection): Fix open-tls-stream call.
	(nnimap-parse-flags): Fix regexp.

	* shr.el (shr-find-fill-point): Use a filling algorithm that should
	probably work for CJVK text, too.

	* nnimap.el (nnimap-extend-tls-programs): Remove.
	(nnimap-open-connection): Bind STARTTLS to openssl explicitly.

2010-10-13  Julien Danjou  <julien@danjou.info>

	* nnimap.el (nnimap-parse-flags): Be more strict when looking for FETCH
	responses.

2010-10-13  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mm-decode.el (mm-shr): Allow use from non-Gnus users.

	* gnus-spec.el (gnus-parse-simple-format): princ doesn't really insert
	anything in Emacs.

	* shr.el (shr-current-column): Remove buggy and unnecessary function.

2010-10-13  Julien Danjou  <julien@danjou.info>

	* shr.el (shr-width): Make shr-width a defcustom with default to
	fill-column.
	(shr-tag-img): Use shr-width rather than fill-column.

2010-10-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-dired.el (gnus-dired-attach): Silence XEmacs 21.5 when compiling.

	* gnus-gravatar.el (gnus-gravatar-transform-address): Adjust avatars'
	position when (X-)Faces exist.
	(gnus-treat-from-gravatar, gnus-treat-mail-gravatar): Force displaying
	avatars when called interactively.

2010-10-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-gravatar.el (gnus-gravatar-too-ugly): Don't test if
	gnus-article-x-face-too-ugly is bound.

2010-10-12  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* rfc2231.el (rfc2231-parse-string): Ignore repeated parts.

	* nnimap.el (nnimap-request-rename-group): Unselect by selecting a
	mailbox that doesn't exist.

2010-10-12  Julien Danjou  <julien@danjou.info>

	* shr.el (shr-tag-img): Encode URL properly when retrieving.
	(shr-get-image-data): Encode URL properly when fetching from cache.
	(shr-tag-img): Use aligned-to spaces to align correctly images.

	* gnus-gravatar.el (gnus-gravatar-insert): Check if buffer is alive
	before inserting the Gravatar.

	* shr.el (shr-tag-img): Add align attribute support for <img>.

2010-10-12  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-gravatar.el (gnus-art): Require.

	* gnus-sum.el (gnus-summary-mark-as-unread-forward)
	(gnus-summary-mark-as-unread-backward, gnus-summary-mark-as-unread):
	Remove long obsoleted functions.

2010-10-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnimap.el (gnutls-negotiate): Silence the byte compiler.

	* gnus-art.el, gnus-cache.el, gnus-fun.el, gnus-group.el:
	* gnus-picon.el, gnus-spec.el, gnus-sum.el, gnus-util.el, gnus.el:
	* mail-source.el, message.el, mm-bodies.el, mm-decode.el, mm-extern.el:
	* mm-util.el, mm-view.el, mml-smime.el, mml.el, mml1991.el, mml2015.el:
	* nnfolder.el, nnheader.el, nnmail.el, nnmaildir.el, nnrss.el, nntp.el:
	* rfc1843.el, sieve-manage.el, smime.el, spam.el:
	Fix comment for declare-function.

2010-10-11  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-request-rename-group): Select group read-only
	before renaming it.

	* shr.el (shr-insert): Fix up the white space only regexp.

	* nnimap.el (nnimap-transform-split-mail): Not all articles have
	bodies.  Protect against this.  Reported by Michael Welsh Duggan.

	* shr.el (shr-current-column): New function.
	(shr-find-fill-point): New function.

2010-10-11  Michael Welsh Duggan  <md5i@md5i.com>  (tiny change)

	* sieve-manage.el (sieve-manage-open): Allow port names as well as port
	numbers.

2010-10-11  Julien Danjou  <julien@danjou.info>

	* shr.el (shr-hr-line): Add.
	(shr-tag-hr): Use shr-hr-line to specify which character to use to
	display hr lines.
	(shr-max-columns): Do not change state to nil if we just inserting
	spaces.

2010-10-11  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-topic.el (gnus-topic-read-group): If after the last group,
	select the last group.

2010-10-11  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-int.el (gnus-run-hook-with-args): Autoload from gnus-util.el.

2010-10-10  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-update-qresync-info): \Flagged messages are read
	for Gnus.
	(nnimap-retrieve-group-data-early): utf7-encode the group parameters.
	(nnimap-update-qresync-info): Mark \Seen articles as read.

	* gnus-sum.el (gnus-summary-set-local-parameters): Ignore the `active'
	non-variable, too.

	* nnimap.el (nnimap-open-connection): Use GnuTLS STARTTLS, if
	available.
	(nnimap-update-info): Rely more on the current active than the param
	active to avoid marking articles as read too much.

	* auth-source.el (auth-source-create): Use (user-login-name) for the
	user name default.

	* nnimap.el (nnimap-update-info): If the server doesn't return any
	useful info, just use the previous info.
	(nnimap-update-info): Prefer old info over start-article.
	(nnimap-update-qresync-info): Finish implementing QRESYNC.

2010-10-10  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (autoload): Clean up autoloads.
	(nnir-imap-default-search-key): Rename from nnir-imap-search-field.
	Use key rather than value.
	(nnir-imap-search-other): New variable.
	(nnir-read-parm): Use it.
	(nnir-imap-expr-to-imap): Use %S rather than imap-quote-specials.
	(gnus-summary-nnir-goto-thread): Modify to work with imap.

2010-10-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* nnimap.el (nnimap-wait-for-response): If the user hits `C-g', kill
	the process, too.

2010-10-09  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* spam.el (gnus-summary-mode-map): Bind to "$".
	Suggested by Russ Allbery.

	* shr.el: Rework the way things are indented by <li> slightly.

	* gnus.el (gnus-group-set-parameter): Fix typo.

	* nnimap.el: Start implementing QRESYNC support.

2010-10-09  Julien Danjou  <julien@danjou.info>

	* nnir.el (nnir-engines): Fix too many arguments.

2010-10-09  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnmail.el (nnmail-expiry-target-group): Say that every expiry target
	group is the "last", so that the backends like nnfolder actually save
	their folders.

	* nnimap.el (nnimap-open-connection): If we have GnuTLS loaded, then
	try to use that for the TLS stream.
	(nnimap-retrieve-group-data-early): Rework the marks code to heed
	UIDVALIDITY and find out which groups are read-only and not.
	(nnimap-get-flags): Use the same marks parsing code as the rest of
	nnimap.

2010-10-09  Julien Danjou  <julien@danjou.info>

	* nnir.el (nnir-read-parm): Fix call to gnus-completing-read.

	* gnus-gravatar.el (gnus-gravatar-transform-address): Error errors when
	retrieving gravatars.

	* shr.el (shr-table-corner): Add.
	(shr-table-line): Add.
	(shr-insert-table-ruler): Use the above defcustoms to insert tables.

2010-10-08  Julien Danjou  <julien@danjou.info>

	* mm-decode.el (mm-text-html-renderer): Add mm-shr in choice list.

2010-10-08  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-util.el (gnus-alist-pull): Rename `gnus-pull'.

	* gnus-sum.el (gnus-mark-article-as-unread)
	(gnus-summary-mark-article-as-unread, gnus-summary-remove-bookmark)
	(gnus-summary-set-bookmark): Use it.

	* gnus-msg.el (gnus-setup-message): Use it.

	* gnus-demon.el (gnus-demon-remove-handler): Use it.

	* gnus.el (gnus-group-remove-parameter): Use it.

	* gnus-group.el (gnus-group-make-web-group): Use it.

	* gnus-demon.el (gnus-demon-remove-handler): Use it.

	* nnregistry.el: Update docs to mention manual.

	* gnus-registry.el: Update docs to mention nnregistry.el.
	(gnus-registry-initialize): Don't install nnregistry refer method
	automatically.
	(gnus-registry-install-nnregistry): Remove it.

2010-10-08  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-insert): Don't insert double spaces.

2010-10-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-gravatar.el (gnus-treat-from-gravatar)
	(gnus-treat-mail-gravatar): Bind gnus-gravatar-too-ugly to nil when
	called interactively.

	* gnus-art.el (gnus-mime-view-part-externally)
	(gnus-mime-view-part-internally): Make predicate function passed to
	gnus-mime-view-part-as-type assume argument is a mime type, not a list
	of a mime type.

	* shr.el (shr-table-widths): Don't use cl function `reduce'.

2010-10-07  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (require): Require cl when compiling.
	(shr-tag-hr): New function.

	* nnimap.el (nnimap-update-info): Remove double setting of high.
	(nnimap-update-info): Don't ignore groups that have no UIDNEXT.
	This makes nnimap work properly on Courier again.

	* gnus.el (gnus-carpal): The carpal mode has been removed, but define
	the variable for backwards compatibility.

	* mm-decode.el (mm-save-part): If given a non-directory result, expand
	the file name before using to avoid setting mm-default-directory to
	nil.

	* gnus-start.el (gnus-get-unread-articles): Require gnus-agent before
	bidning gnus-agent variables.

	* shr.el (shr-render-td): Use a cache for the table rendering function
	to avoid getting an exponential rendering behavior in nested tables.
	(shr-insert): Rework the line-breaking algorithm.
	(shr-insert): Don't leave trailing spaces.
	(shr-insert-table): Also insert empty TDs.
	(shr-tag-blockquote): Ensure paragraphs after </ul>.

2010-10-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* gnus-sum.el (gnus-number): Rename from `number'.
	(gnus-article-marked-p, gnus-summary-limit-to-display-predicate)
	(gnus-summary-limit-children): Update uses correspondingly.

2010-10-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-gravatar.el (gnus-gravatar-too-ugly): New user option.
	(gnus-gravatar-transform-address): Don't show avatars of people of
	which mail addresses match gnus-gravatar-too-ugly.

2010-10-07  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-table-widths): Expand TD elements to fill available
	space.

2010-10-07  Julien Danjou  <julien@danjou.info>

	* nnimap.el (nnimap-request-rename-group): Add this method.

2010-10-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-html.el (gnus-html-schedule-image-fetching): Remove function
	name from XEmacs' function-arglist.

	* gnus-gravatar.el (gnus-gravatar-insert): Don't add properties to
	gravatar under XEmacs.

2010-10-07  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el: Update docs with TODO items.

	* gnus-sync.el: Update docs to explain state and plans.

	* gnus-int.el (gnus-after-set-mark-hook, gnus-before-update-mark-hook):
	Hooks for mark updates.
	(gnus-request-set-mark, gnus-request-update-mark): Use them.

	* gnus-util.el (gnus-run-hooks-with-args): Convenience function to run
	hooks with arguments, which is needed for mark update hooks.

2010-10-06  Julien Danjou  <julien@danjou.info>

	* gnus.el (gnus-expand-group-parameter): Only return and act on what
	was matched.

	* sieve-manage.el: Update example in `Commentary'.

	* sieve.el (sieve-open-server): Use sieve-manage-authenticate.

	* sieve-manage.el (sieve-manage-open): Use sieve-manage-default-port,
	not 2000.
	(sieve-manage-authenticate): Re-add function.

2010-10-06  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-insert): Get 'space transition right.
	(shr-render-td): Only delete space at the end of the TD.

	* nnimap.el (nnimap-open-connection): Prepare to support
	open-gnutls-stream.

	* shr.el: Rearrange function order to be more logical.

2010-10-06  Julien Danjou  <julien@danjou.info>

	* nnrss.el (nnrss-check-group): Remove 404 URL in comment.
	(nnrss-discover-feed): Remove 404 URL in docstring.

	* nnir.el: Fix Swish-E URL.
	Fix Namazu URL.

	* message.el (message-change-subject): Remove 404 URL in a comment.

2010-10-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-mime-view-part-as-type): Make it work when being
	called interactively.

	* gnus-util.el (gnus-remove-if): Allow hash table.
	(gnus-remove-if-not): New function.

	* gnus-art.el (gnus-mime-view-part-as-type):
	* gnus-score.el (gnus-summary-score-effect):
	* gnus-sum.el (gnus-read-move-group-name):
	Replace remove-if-not with gnus-remove-if-not.

	* gnus-group.el (gnus-group-completing-read):
	Regard collection as a hash table if it is not a list.

2010-10-05  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-render-td): Allow blank/missing <TD>s.

	* shr.el: Document the table-rendering algorithm.

	* gnus-html.el (gnus-html-schedule-image-fetching): Protect against
	invalid URLs.

	* shr.el (shr-tag-img): Shorten ALT texts and allow them to be
	line-broken.
	(shr-tag-img): Ignore image fetching errors.
	(shr-overlays-in-region): Compute overlay positions correctly.

	* mm-decode.el (mm-shr): Require shr.

	* gnus-art.el (gnus-blocked-images): Move variable here.

	* shr.el (shr-insert-table): Bind free variable.

	* mm-decode.el (mm-shr): Bind shr-content-function.

	* shr.el (shr-content-function): New variable.

	* gnus-sum.el (gnus-article-sort-by-most-recent-date): New function,
	added for symmetry.

	* nnir.el (nnir-retrieve-headers): Don't bug out on invalid data.

	* gnus-group.el (gnus-group-make-group): Doc fix.

	* nnimap.el (nnimap-request-newgroups): Return success.

	* shr.el (shr-find-elements): New function.
	(shr-tag-table): Put all the images after the table.
	(shr-tag-table): Really inhibit images inside the table.
	(shr-collect-overlays): Copy over overlays from the TD elements to the
	main document.

	* mm-decode.el (mm-shr): Bind shr-blocked-images to
	gnus-blocked-images.

2010-10-05  Julien Danjou  <julien@danjou.info>

	* sieve-manage.el (sieve-sasl-auth): Use auth-source to authenticate.

	* gnus-html.el (gnus-html-wash-images): Rescale image from cid too.
	(gnus-html-maximum-image-size): Add this function.
	(gnus-html-put-image): Use gnus-html-maximum-image-size.

	* sieve-manage.el (sieve-manage-capability): Do not bug out when the
	server-value of the capability is nil.

2010-10-05  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-tag-em): Add <EM> tag.

2010-10-05  Florian Ragwitz  <rafl@debian.org>  (tiny change)

	* sieve-manage.el (sieve-manage-default-stream): Make default stream
	customizable.

	* gnus-html.el (gnus-html-wash-tags): Decode URL entities to avoid
	handing broken links to browse-url.

2010-10-05  Julien Danjou  <julien@danjou.info>

	* gnus-util.el (gnus-emacs-completing-read)
	(gnus-iswitchb-completing-read): Use autoload rather than require.

2010-10-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-util.el (gnus-completing-read-function): Exclude
	gnus-icompleting-read and gnus-ido-completing-read from candidates for
	XEmacs since iswitchb.el is very old and ido.el is unavailable in
	XEmacs.

	* gnus-registry.el (gnus-registry-install-nnregistry): Rewrite so as
	not to use `delete-dups' that is unavailable in XEmacs 21.4.

	* gnus-html.el: Don't require help-fns under XEmacs.
	(gnus-html-schedule-image-fetching): Work for XEmacs.

	* mm-decode.el (mm-shr): Decode contents by charset.

2010-10-04  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-open-connection): Give an error if nnimap-stream is
	unknown.

	* shr.el (shr-tag-blockquote): Ensure paragraph after quote, too.
	(shr-get-image-data): Ensure against the cache file missing.

	* nnimap.el (nnimap-finish-retrieve-group-infos): Message while waiting
	for data.

	* spam-report.el (spam-report-url-ping-plain): Don't query about
	killing the process.

	* shr.el (shr-render-td): Protect against too-wide text.

2010-10-04  Julien Danjou  <julien@danjou.info>

	* mml-smime.el (mml-smime-openssl-encrypt-query): Fix choices.
	(mml-smime-openssl-sign-query): Fix gnus-completing-read call.

	* gravatar.el (gravatar-retrieved): Kill buffer when gravatar has been
	retrieved.

2010-10-04  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (browse-url): Require.
	(shr-ensure-paragraph): Don't insert a new newline after empty-ish
	lines.
	(shr-show-alt-text, shr-browse-image): New commands.
	(shr-browse-url, shr-copy-url): New commands.

	* gnus-sum.el (gnus-widen-article-window): New variable.
	(gnus-summary-select-article-buffer): Use it.

	* message.el (message-idna-to-ascii-rhs-1): Don't bug out on addresses
	without @ signs.

2010-10-04  Michael Welsh Duggan  <md5i@md5i.com>  (tiny change)

	* nnir.el (nnir-run-imap): Remove spurious space in search string.

2010-10-04  Julien Danjou  <julien@danjou.info>

	* gnus-util.el (gnus-emacs-completing-read): Mapcar collection to list,
	for XEmacs.

2010-10-04  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-salt.el: Remove all gnus-carpal stuff -- it's not useful.

	* nnimap.el (nnimap-open-connection): Allow tls as a synonym for ssl.
	(nnimap-close-server): Implement.

	* shr.el (shr-ensure-paragraph): Fix the non-empty line case.
	(shr-insert): Tweak line breaking.
	(shr-insert): Handle <pre> better.
	(shr-tag-li): Get <li> indentation right.
	(shr-tag-li): Get <li> indentation even righter.
	(shr-tag-blockquote): Ensure paragraph start.
	(shr-make-table): Tweak table generation.
	(shr-make-table): Fix typo.

	* shr.el: Implement table rendering.

2010-10-04  Julien Danjou  <julien@danjou.info>

	* gnus-html.el (gnus-html-put-image): Fix resize image code.

2010-10-04  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-insert): Use string anchors instead of line anchors.

2010-10-03  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el: Add headings.
	(shr-ensure-paragraph): Actually work.
	(shr-tag-li): Make <ul> prettier.
	(shr-insert): Get white space at the beginning/end of elements right.
	(shr-tag-p): Collapse subsequent <p>s.
	(shr-ensure-paragraph): Don't insert double line feeds after blank
	lines.
	(shr-insert): \t is also space.
	(shr-tag-s): Fix "s" tag name function.
	(shr-tag-s): Fix face prop name.

2010-10-03  Julien Danjou  <julien@danjou.info>

	* gnus-html.el (gnus-html-put-image): Use gnus-rescale-image.

	* mm-view.el (gnus-window-inside-pixel-edges): Add autoload for
	gnus-window-inside-pixel-edges.

	* gnus-ems.el (gnus-window-inside-pixel-edges): Move from gnus-html to
	gnus-ems.

	* mm-view.el (mm-inline-image-emacs): Support image resizing.

	* gnus-util.el (gnus-rescale-image): Add generic gnus-rescale-image
	function.

	* mm-decode.el (mm-inline-large-images): Enhance defcustom and add
	resize choice.

2010-10-03  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-tag-p): Don't insert newlines on empty tags at the
	beginning of the buffer.

	* gnus-sum.el (gnus-summary-select-article-buffer): Really select the
	article buffer again.

	* shr.el (shr-tag-p): Don't insert newlines at the start of the buffer.

	* mm-decode.el (mm-shr): Narrow before inserting, so that shr can know
	when it's at the start of the buffer.

	* shr.el (shr-tag-blockquote): Convert name.
	(shr-rescale-image): Use the right image-size variant.

	* gnus-sum.el (gnus-summary-select-article-buffer): If the article
	buffer isn't shown, then select the current article first instead of
	bugging out.
	(gnus-summary-select-article-buffer): Show both the article and summary
	buffers again.

	* shr.el (shr-fontize-cont): Protect against regions with no text.
	Rename tag functions to shr-tag-* for enhanced security.
	(shr-tag-ul, shr-tag-ol, shr-tag-li, shr-tag-br): New functions.

2010-10-03  Chong Yidong  <cyd@stupidchicken.com>

	* shr.el (shr-insert):
	* pop3.el (pop3-movemail):
	* gnus-html.el (gnus-html-wash-tags): Don't use plusp, as cl may not be
	loaded.

2010-10-03  Glenn Morris  <rgm@gnu.org>

	* nnmairix.el (nnmairix-replace-illegal-chars): Drop Emacs 20 code.

	* smime.el (smime-cert-by-ldap-1): Drop Emacs 21 code.

	* gnus-art.el (gnus-next-page-map): Drop Emacs 20 compat cruft.

	* gmm-utils.el (gmm-write-region): Drop Emacs 20 compat cruft.

	* gnus-util.el (gnus-make-local-hook): Simplify.

2010-10-02  Julien Danjou  <julien@danjou.info>

	* gnus-util.el (gnus-iswitchb-completing-read): New function.
	(gnus-ido-completing-read): New function.
	(gnus-emacs-completing-read): New function.
	(gnus-completing-read): Use gnus-completing-read-function.
	Add gnus-completing-read-function.

2010-10-02  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el (shr-insert-document): Autoload.
	(shr-img): Be silent.
	(shr-insert): Add a newline after every picture before text.
	(shr-add-font): Use overlays for combining faces.
	(shr-insert): Pass upwards the text start point.

	* mm-decode.el (mm-text-html-renderer): Default to shr.el rendering, if
	possible.
	(mm-shr): New function.

2010-10-02  Julien Danjou  <julien@danjou.info>

	* gnus-gravatar.el (gnus-gravatar-insert): Adjust character where we
	should go backward.

2010-10-02  Juanma Barranquero  <lekktu@gmail.com>

	* shr.el (shr): Fix typo in provide call.

2010-10-02  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* shr.el: New file.

	* gnus-html.el (gnus-html-schedule-image-fetching): Be silent.

	* gnus-topic.el (gnus-topic-move-group): Fix the syntax of the
	completing read.

2010-10-01  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-start.el (gnus-check-bogus-newsgroups): Say how many groups
	we're being queried about.  Suggested by Dan Jacobson.

	* nndoc.el (nndoc-type-alist): Do babyl before mime-parts.
	Suggested by Jason Eisner.

	* gnus-async.el (gnus-async-delete-prefetched-entry): Remove from hash
	table, too.  Suggested by Stefan Wiens.
	(gnus-async-prefetched-article-entry): Use intern-soft to avoid growing
	the table unnecessary.  Suggested by Stefan Wiens.

	* gnus-sum.el (gnus-summary-clear-local-variables): This is probably no
	longer needed, and probably doesn't work either, as pointed out by
	Stefan Wiens.
	(gnus-summary-exit): Remove call to the clearing function.
	(gnus-summary-exit-no-update): Ditto.

	* gnus-art.el (gnus-summary-save-in-file): Use with-current-buffer
	instead of gnus-eval-in-buffer-window to avoid popping up frames.
	Reported by Stefan Monnier.
	(gnus-summary-save-in-rmail): Ditto.

	* gnus-sum.el (gnus-summary-select-article-buffer): Show only the
	article buffer, instead of both the article buffer and the summary
	buffer.  Sort of suggested by Dan Jacobson.

	* gnus-win.el (gnus-buffer-configuration): Add an only-article spec.

	* nnmbox.el (nnmbox-read-mbox): Mark buffer for deletion on Gnus exit.
	Suggested by Dan Jacobson.

	* mm-encode.el (mm-content-transfer-encoding-defaults): Try to make the
	documentation clearer.

	* message.el (message-shorten-references): Comment on the number "21".
	Suggested by Stefan Monnier.

	* gnus-sum.el (gnus-summary-scroll-up): Add more documentation.
	Suggested by Dan Jacobson.

	* gnus.el (gnus-large-newsgroup):
	Mention gnus-large-ephemeral-newsgroup.  Suggested by Dan Jacobson.

	* gnus-msg.el (gnus-summary-resend-message): When resending, don't
	externalize attachments.  Bug reported by Steve Wen.

	* gnus.el (gnus-continuum-version): Make inactive, since it doesn't
	really message anything to the user.

	* nnmail.el (nnmail-article-group): Allow using the fancy split method
	directly.

	* nnimap.el (nnimap-request-group): Low higher than high to signal no
	messages in empty groups.

2010-10-01  Ted Zlatanov  <tzz@lifelogs.com>

	* nnimap.el (nnimap-request-group): Don't bug out when there's an empty
	non-UIDNEXT group.

2010-10-01  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-group.el (gnus-group-completing-read): Return the symbol name,
	not the value from the collection.

	* nnimap.el (nnimap-update-info): Ignore groups that have no UIDNEXT
	values.  This sometimes happens on some groups that have no info.
	(nnimap-request-newgroups): New function.

2010-10-01  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-install-nnregistry): Move the feature
	check into `gnus-registry-initialize'.
	(gnus-registry-initialize): Ditto.
	Fix and extend header docs.

2010-10-01  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-html.el (gnus-html-prefetch-images): Adjust regexp to avoid
	regexp backtrace overflows.

	* nnimap.el (nnimap-extend-tls-programs): Only extend those programs
	for starttls that tls.el implements; i.e. openssl.

2010-10-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gravatar.el: Don't load image.el that XEmacs doesn't provide.
	(gravatar-create-image): New function that's an alias to
	gnus-xmas-create-image, gnus-create-image, or create-image.
	(gravatar-data->image): Use it.

2010-09-30  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-install-nnregistry): New function to
	install the nnregistry refer method.
	(gnus-registry-install-hooks): Use it.
	(gnus-registry-unfollowed-groups): Add nnmairix to the default
	unfollowed groups.

2010-09-30  Jose A. Ortega Ruiz  <jao@gnu.org>  (tiny change)

	* gnus-sum.el (gnus-summary-show-thread): Skip past invisible text when
	expanding threads.

2010-09-30  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnir.el: Use the server names without suffixes (bug #7009).

	* nnimap.el (nnimap-open-connection): Reinstate the auto-upgrade from
	unencrypted to STARTTLS, if possible.

2010-09-30  Teemu Likonen  <tlikonen@iki.fi>  (tiny change)

	* message.el (message-ignored-supersedes-headers): Strip Injection-*
	headers before superseding.

2010-09-30  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnrss.el (nnrss-use-local): Add documentation.

	* nnimap.el (nnimap-extend-tls-programs): New function.
	(nnimap-open-connection): Use tls.el exclusively, and not starttls.el.
	(nnimap-wait-for-connection): Accept the greeting from the stupid
	output from openssl s_client -starttls, too.

	* nnimap.el (nnimap-find-article-by-message-id): Really return the
	article number.
	(nnimap-split-fancy): New variable.
	(nnimap-split-incoming-mail): Use it.

	* nntp.el (nntp-server-list-active-group): Document.

	* nnimap.el (nnimap-find-article-by-message-id): Use EXAMINE instead of
	SELECT to get the message-id.

	* mail-source.el (mail-sources): Remove webmail support.
	(defvar): Ditto.
	(mail-source-fetcher-alist): Ditto.
	(mail-source-fetch-webmail): Remove.

	* webmail.el: Remove -- doesn't seem relevant any more.

	* gnus.el: Fix up make-obsolete-variable declarations throughout.

	* nnimap.el (nnimap-request-accept-article): Get the Message-ID without
	the \r.

2010-09-30  Julien Danjou  <julien@danjou.info>

	* gnus-agent.el (gnus-agent-add-group): Fix call to
	gnus-completing-read.

2010-09-29  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nndoc.el (nndoc-retrieve-groups): New function.

	* nnimap.el (nnimap-split-incoming-mail): If nnimap-split-methods is
	`default', use nnmail-split-methods.
	(nnimap-request-article): Downcase the NILs so that they are nil.

	* gnus-sum.el (gnus-valid-move-group-p): Make sure that `group' is a
	symbol.

	* nnimap.el (nnimap-open-connection): Revert the auto-network->starttls
	code, since if the user has requested network, that's what they ought
	to get.
	(nnimap-request-set-mark): Erase the buffer before issuing commands.
	(nnimap-split-rule): Mark as obsolete.

	* pop3.el (pop3-send-streaming-command, pop3-stream-length):
	New variable.

	* nnimap.el (nnimap-insert-partial-structure): Get the type from the
	correct slot, too.

2010-09-29  Julien Danjou  <julien@danjou.info>

	* gnus.el (gnus-local-domain): Declare variable obsolete.

	* gnus-util.el (gnus-icompleting-read): Require iswitchb.
	Fix history computing.
	(gnus-ido-completing-read): Require ido.

2010-09-29  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-registry.el: Don't prompt on load, which makes it impossible to
	build Gnus.

	* nnimap.el (nnimap-insert-partial-structure): Be way more permissive
	when interpreting the structures.
	(nnimap-request-accept-article): Add \r\n to the lines to make this
	work with Cyrus.

	* nndraft.el (nndraft-request-expire-articles): Use the group name
	instead if "nndraft".  Fix found by Nils Ackermann.

2010-09-29  Ludovic Courtes  <ludo@gnu.org>

	* nnregistry.el: Add.

2010-09-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* nnmail.el (group, group-art-list, group-art):
	Remove unneeded directives.

2010-09-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-util.el (mm-codepage-iso-8859-list, mm-charset-eval-alist)
	(mm-mime-charset):
	* rfc2047.el (rfc2047-syntax-table):
	* utf7.el (utf7-utf-16-coding-system): Comment fix.

	* nnrss.el (nnrss-read-server-data, nnrss-read-group-data): Use `load'
	rather than `insert-file-contents' and `eval-region'.

2010-09-29  Julien Danjou  <julien@danjou.info>

	* gnus-gravatar.el (gnus-gravatar-properties): Add this properties in
	replacement of `gnus-gravatar-relief' to mimic
	`gnus-faces-properties-alist'.
	Add :version property.

2010-09-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mail-source.el (mail-source-report-new-mail):
	* message.el (message-default-mail-headers):
	* mm-decode.el (mm-valid-image-format-p): Comment fix.

	* mml2015.el (mml2015-use): Don't bind recursive-load-depth-limit.

2010-09-28  Julien Danjou  <julien@danjou.info>

	* gnus-gravatar.el (gnus-gravatar-insert): Fix search in case
	mail-address contains the same string as real-name.

	* gnus-ems.el (gnus-put-image): Revert Lars, change and insert
	non-blank in header, otherwise it'll get stripped.

	* gnus-gravatar.el (gnus-gravatar-insert): Search backward for
	real-name, and then for mail address rather than doing : or , search.

2010-09-27  Julien Danjou  <julien@danjou.info>

	* gnus-util.el (gnus-completing-read): Use gnus-use-ido to apply the
	right completing-read function.
	(gnus-use-ido): New variable
	(gnus-completing-read-with-default): Remove.
	* gnus-agent.el (gnus-agent-read-group): Remove prompt computing.
	(gnus-agent-add-group):
	* gnus-srvr.el (gnus-server-add-server, gnus-server-goto-server):
	* mm-view.el (mm-view-pkcs7-decrypt):
	* mm-util.el (mm-codepage-setup):
	* smime.el (smime-sign-buffer, smime-decrypt-buffer):
	* mml-smime.el (mml-smime-openssl-sign-query):
	* mml.el (mml-minibuffer-read-type, mml-minibuffer-read-disposition)
	(mml-insert-multipart):
	* gnus-msg.el (gnus-summary-yank-message):
	* gnus-int.el (gnus-start-news-server):
	* mm-decode.el (mm-interactively-view-part):
	* gnus-dired.el (gnus-dired-attach):
	* gnus.el (gnus-read-method):
	* gnus-bookmark.el (gnus-bookmark-jump):
	* gnus-art.el (gnus-mime-view-part-as-type)
	(gnus-mime-action-on-part, gnus-article-encrypt-body):
	* gnus-topic.el (gnus-topic-jump-to-topic, gnus-topic-move-matching)
	(gnus-topic-copy-matching, gnus-topic-sort-topics, gnus-topic-move):
	* nnmairix.el (nnmairix-create-server-and-default-group)
	(nnmairix-update-groups, nnmairix-get-server)
	(nnmairix-backend-to-server, nnmairix-goto-original-article)
	(nnmairix-get-group-from-file-path):
	* nnrss.el (nnrss-find-rss-via-syndic8):
	* gnus-group.el (gnus-group-completing-read, gnus-group-make-web-group)
	(gnus-group-make-useful-group, gnus-group-add-to-virtual)
	(gnus-group-browse-foreign-server):
	* gnus-sum.el (gnus-summary-goto-article, gnus-summary-limit-to-extra)
	(gnus-summary-execute-command, gnus-summary-respool-article)
	(gnus-read-move-group-name):
	* gnus-score.el (gnus-summary-increase-score)
	(gnus-summary-score-effect):
	* gnus-registry.el (gnus-registry-read-mark): Use gnus-completing-read.

2010-09-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnimap.el (auth-source-forget-user-or-password)
	(auth-source-user-or-password): Autoload.

	* message.el (message-from-style, message-interactive)
	(message-signature): Remove comment.
	(message-cite-prefix-regexp): Default to mail-citation-prefix-regexp
	always.
	(message-sendmail-envelope-from): Comment fix.
	(message-yank-prefix): Default to mail-yank-prefix always.
	(message-indentation-spaces):
	Default to mail-indentation-spaces always.
	(message-signature-file): Default to mail-signature-file always.

2010-09-27  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-summary-read-group-1): Set gnus-newsgroup-highest.
	(gnus-summary-insert-new-articles): Use gnus-newsgroup-highest to get
	new articles.

	* nnimap.el (nnimap-request-article): Don't partial-fetch single-part
	parts.
	(nnimap-request-article): Work with the t setting, too.

	* gnus-sum.el (gnus-summary-exit): Kill the article buffer later, so
	that you don't get flashes of other buffers.
	(gnus-summary-show-complete-article): Intern before setting.

2010-09-27  David Engster  <dengste@eml.cc>

	* nnmairix.el (nnmairix-replace-group-and-numbers): Deal with NOV as
	well as HEADERS.
	(nnmairix-retrieve-headers): Provide new argument for the above.

2010-09-27  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-summary-move-article): Don't alter
	gnus-newsgroup-active.  This makes `/ N' work after copying to the same
	group.

	* nnimap.el (nnimap-update-info): Don't destructively alter active.

	* message.el (message-cite-prefix-regexp): Revert my last edit.

	* gnus-sum.el (gnus-summary-show-complete-article): Bind the server
	variable instead of the Gnus variable.

	* nnimap.el (nnimap-find-wanted-parts-1): Use it.

	* gnus-art.el (gnus-fetch-partial-articles): Move back to nnimap again.

	* nnimap.el (nnimap-request-accept-article): Remove the "." at the end,
	since some servers don't like it.
	(nnimap-open-connection): Forget credentials if the server says the
	password was wrong.
	(nnimap-parse-line): Protect against invalid data.

	* gnus-sum.el (gnus-summary-move-article): Add comment.
	(gnus-summary-insert-new-articles): Copy the old-high watermark so that
	nothing alters it while scanning for new messages.

	* nnimap.el (nnimap-request-accept-article): Send a "." at the end,
	which may or may not help.
	(nnimap-open-connection): If we're doing a stream connection, and then
	discover we're on a STARTTLS-capable server, then open a STARTTLS
	connection instead.

2010-09-27  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (utf7): Require.

	* message.el (message-cite-prefix-regexp): Remove "}" from citation
	prefix.

2010-09-27  Juanma Barranquero  <lekktu@gmail.com>

	* nnmail.el (nnmail-fancy-expiry-targets): Fix typo in docstring.

2010-09-27  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-request-accept-article): Message the error on
	error.

2010-09-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-mime-delete-part): Fix Lisp type of byte(s).

2010-09-26  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nndoc.el (nndoc-request-list): Return success always.

	* gnus-agent.el (gnus-agent-retrieve-headers): Don't propagate
	`fetch-old' -- we only want to fetch the articles we've requested.
	The rest are in the agent, probably.
	(gnus-agent-read-servers-validate): Change the level for the "Ignoring
	disappeared server" to something low.  It's not important.

	* nnimap.el (nnimap-get-whole-article): Remove the data that may have
	arrived before the FETCH data.

	* nnmh.el (nnmh-request-expire-articles): Don't try to fetch the expiry
	target here, because we don't know the Gnus name of the group.

	* nndraft.el (nndraft-request-expire-articles): Fetch the expiry target
	for the correct group.

	* gnus-ems.el (gnus-create-image): Ignore all image-creation errors.

	* gnus.el (gnus): Give a final warning after startup.

	* gnus-util.el (gnus-action-message-log): New variable.
	(gnus-message): Use it.
	(gnus-final-warning): New function.

	* nnimap.el (nnimap-open-connection): Record the greeting.
	(nnimap): Add greeting.

2010-09-26  Julien Danjou  <julien@danjou.info>

	* gnus-html.el (gnus-html-show-images): Fix gnus-html-display-image
	arguments.
	(gnus-html-wash-images): Fix spec computing to include start/end.

	* gnus-art.el (gnus-article-treat-body-boundary): Fix length computing.

2010-09-26  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-request-expire-articles): Compress ranges before
	deletion.
	(nnimap-retrieve-headers): Don't select the group, because that's
	already done by nnimap-possibly-change-group.

	* gnus-picon.el (gnus-picon-inhibit-top-level-domains): New variable.
	(gnus-picon-transform-address): Use it.

	* mail-source.el (mail-source-value): Revert previous patch.

	* nnimap.el (nnimap-credentials): Allow inhibiting the password query
	on failure.
	(nnimap-open-connection): Look up both virtual and physical server name
	credentials.

	* gnus-win.el: Revert previous patch, since it made Gnus backtrace.

2009-02-08  Dave Love  <fx@gnu.org>

	* gnus-win.el (gnus-window-to-buffer-helper)
	(gnus-all-windows-visible-p): Function needn't be a symbol.

	* mail-source.el (mail-source-value): Function needn't be a symbol.

2010-09-26  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-cite-prefix-regexp): Remove } from the cite
	prefix.

	* gnus-art.el (gnus-treatment-function-alist): Do picons before
	highlight again, so that the highlight is correct.

	* gnus-picon.el (gnus-picon): Remove again.
	(gnus-picon-create-glyph): Set the background XPM color explicitly.

	* gnus-art.el (gnus-treatment-function-alist): Insert picons after
	doing the header highlightling, so that the background color of the
	picon is correct.

	* gnus-picon.el (gnus-picon-xbm): Remove obsolete face.
	(gnus-picon): Ditto.
	(gnus-picon): Reinstate.  The background color for picons is white.
	(gnus-picon-insert-glyph): Make the background white.

	* nnml.el (nnml-open-nov): Don't return dead buffers.

	* auth-source.el (auth-source-create): Query the user for whether to
	store the credentials.

	* auth-source.el (auth-source-user-or-password): Use the existing auth
	sources, if any, for creation.

	* gnus.el (gnus-group-fast-parameter): Return the last matching
	parameter instead of the first matching parameter.

2010-09-26  Julien Danjou  <julien@danjou.info>

	* gnus-sum.el (gnus-auto-center-group): Transform into a defcustom.

2010-09-26  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mml2015.el (mml2015-use): Remove gpg support.

	* mml1991.el (mml1991-function-alist): Remove gpg function.
	(mml1991-gpg-sign): Remove.

2010-09-26  Andreas Seltenreich  <seltenreich@gmx.de>

	* gnus-srvr.el (gnus-browse-subscribe-newsgroup-method): New variable.
	(gnus-browse-unsubscribe-current-group): Document it.
	(gnus-browse-unsubscribe-group): Use it.

2010-09-26  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-group.el (gnus-read-ephemeral-bug-group): Add the bug email
	address to the To list for easier response.

	* gnus.el (gnus-play-startup-jingle): Remove.
	(gnus-splash): Don't play jingle.
	(gnus): Silence gnus-load message.

	* gnus-art.el (gnus-treat-play-sounds): Remove.

	* gnus.el (gnus-play-jingle): Remove audio support.

	* gnus-cus.el (gnus-score-customize): Remove audio reference.

	* earcon.el: Remove -- no users.

	* gnus-audio.el: Remove -- no users of this package.

	* gnus-sum.el (gnus-summary-limit-children): Remove nocem support.

	* gnus-start.el (gnus-setup-news): Remove nocem support.

	* gnus-group.el (gnus-group-get-new-news): Remove nocem call.

	* gnus.el (gnus-use-nocem): Remove.

	* gnus-demon.el (gnus-demon-add-nocem, gnus-demon-scan-nocem):
	Remove.

	* gnus-nocem.el (gnus-nocem-issuers): Remove file.  Apparently nobody
	uses NoCeM any more.

	* gnus-art.el (gnus-ctan-url): Seems not very useful -- removed.
	(gnus-button-ctan-handler): Ditto.
	(gnus-button-handle-ctan-bogus-regexp): Ditto.
	(gnus-button-ctan-directory-regexp): Ditto.
	(gnus-button-handle-ctan): Ditto.
	(gnus-button-tex-level): Ditto.
	(gnus-button-alist): Remove CTAN stuff.

2010-09-25  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-wait-for-response): Reverse logic in the
	nnimap-streaming test.

	* gnus-start.el (gnus-get-unread-articles): Don't try to open failed
	servers twice.

	* nnimap.el (nnimap-open-connection): Add more error reporting when
	nnimap fails early.

	* nnheader.el (nnheader-get-report-string): New function.
	(nnheader-get-report): Use it.

	* gnus-int.el (gnus-check-server): Say what the error was when opening
	failed.

	* nnimap.el (nnimap-wait-for-response): Search further when we're not
	using streaming.

2010-09-25  Julien Danjou  <julien@danjou.info>

	* gnus-html.el (gnus-html-rescale-image): Use our defalias
	gnus-window-inside-pixel-edges.

2010-09-25  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-srvr.el (gnus-server-copy-server): Add documentation.

	* mm-decode.el (mm-save-part): Allow saving to other directories the
	normal Emacs way.

	* nndoc.el (nndoc-type-alist): Move mime-parts after mbox.
	Suggested by Jay Berkenbilt.

	* gnus-art.el (gnus-mime-delete-part): Fix plural for "byte" when
	there isn't a single byte.

	* gnus-int.el (gnus-open-server): Don't query whether to go offline --
	just do it.  It doesn't really seem to matter what the user responds
	here, I think, so it's just a confusing question.

	* nnimap.el (nnimap-retrieve-group-data-early): Fix typo in the
	non-streaming case.

	* gnus-art.el (gnus-flush-original-article-buffer): Separate out.
	(gnus-article-encrypt-body): Use it.

	* gnus-sum.el (gnus-summary-show-complete-article): New command and
	keystroke.

	* nnimap.el (nnimap-find-wanted-parts-1):
	Use gnus-fetch-partial-articles.

	* gnus-art.el (gnus-fetch-partial-articles): New variable.

	* nnimap.el (nnimap-insert-partial-structure): New function.
	(nnimap-get-partial-article): New function.
	(nnimap-request-article): Use it.
	(nnimap-wait-for-response): Return whether the wait was successful.
	(nnimap-finish-retrieve-group-infos): Don't do anything if the
	retrieval wasn't successful.
	(nnimap-retrieve-group-data-early): Allow throttling servers.
	(nnimap-streaming): New variable.
	(nnimap-fetch-partial-articles): Remove.

	* mm-decode.el (mm-with-part): Protect against killed buffers.

	* nndraft.el (nndraft-retrieve-headers): Insert Lines and Chars headers
	for prettier summary display.

2010-09-25  Andrew Cohen  <cohen@andy.bu.edu>  (tiny change)

	* nnir.el (nnir-run-imap): Allow sending IMAP search patterns directly.

2010-09-25  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus.el (gnus-local-domain): Put gnus-local-domain back again, since
	apparently third-party libraries depend on it.

	* nnimap.el (nnimap-open-connection): Wait for the response to STARTTLS
	before starting negotiation.

	* gnus-art.el (gnus-treat-from-gravatar): Change default to nil for
	privacy reasons.
	(gnus-treat-mail-gravatar): Ditto.

	* gnus-ems.el (gnus-put-image): Don't put any non-blank text into the
	buffer when inserting images.  Inserting text into the headers, for
	instance, can make them invalid.

2010-09-25  Julien Danjou  <julien@danjou.info>

	* rfc1843.el: Remove useless rfc1843-old-gnus-decode-header-function
	variables.

	* nnheader.el: Remove useless variables news-reply-yank-from and
	news-reply-yank-message-id.

	* mml2015.el: Remove useless mc-default-scheme and mc-schemes
	variables.

	* mml1991.el: Remove useless mml1991-verbose.

	* gnus.el: Remove useless variable gnus-use-generic-from.
	Remove obsolete variable gnus-topic-indentation.

	* gnus-uu.el: Remove useless gnus-uu-shar-file-name.

	* gnus-sum.el: Remove useless gnus-newsgroup-none-id.

	* gnus-picon.el: Remove useless gnus-picon-setup-p variable.

	* gnus-group.el: Remove useless gnus-group-icon-cache.
	Remove useless gnus-ephemeral-group-server.

	* gnus-bookmark.el: Remove useless gnus-bookmark-after-jump-hook.

	* mml2015.el: Remove useless mml2015-verbose.

	* mml-smime.el: Remove useless mml-smime-verbose.

	* gnus.el: Remove useless gnus-local-domain.

	* gnus-gravatar.el (gnus-gravatar-transform-address):
	Use gnus-gravatar-size.

	* gnus-art.el: Remove useless gnus-treat-translate.

2010-09-24  Julien Danjou  <julien@danjou.info>

	* gnus-sum.el: Add support for Gravatars.

	* gnus-art.el: Add support for Gravatars.

	* gnus-gravatar.el: Add this file.

	* gravatar.el: Add this file.

2010-09-24  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-summary-fetch-faq): Remove.

	* gnus-group.el (gnus-group-fetch-faq): Remove.

	* gnus.el (gnus-group-faq-directory): Remove.

	* gnus-group.el (gnus-group-fetch-charter): Remove.

	* gnus.el (gnus-group-charter-alist): Remove.

	* gnus-group.el (gnus-group-archive-directory): Remove.
	(gnus-group-recent-archive-directory): Ditto.
	(gnus-group-make-archive-group): Remove.

	* nnimap.el (nnimap-update-info): Protect against nil uidnexts.

	* gnus-cache.el (gnus-cache-braid-heads): When braiding heads, don't
	use the same article number for all the cached articles.

	* nnimap.el (nnimap-command): Register the last command time so
	that we can use it for idling NOOPs.
	(nnimap-open-connection): Start the keeplive timer.
	(nnimap-make-process-buffer): Store all the process buffers.
	(nnimap-keepalive): New function.

	* starttls.el (starttls-open-stream): Add autoload cookie.

2010-09-24  Michael Welsh Duggan  <md5i@md5i.com>  (tiny change)

	* nnimap.el (nnimap-split-incoming-mail): Fix paren typo in the 'junk
	handling.

2010-09-24  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnrss.el (nnrss-retrieve-groups): Change to the group before checking
	its data structures.

	* gnus.el (gnus-sloppily-equal-method-parameters): Use copy-sequence
	instead of the cl.el copy-list.
	(gnus-sloppily-equal-method-parameters): Use equal instead of the cl
	equalp.

2010-09-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gmm-utils.el (gmm-tool-bar-from-list): Always use tool-bar-local-item
	and tool-bar-local-item-from-menu.

	* gnus-agent.el (gnus-agent-make-mode-line-string): Always use
	mode-line-highlight face for Emacs.

	* gnus-art.el (toplevel): Don't bind recursive-load-depth-limit while
	loading gnus-sum.elc; fix comment for canlock-verify.
	(gnus-article-jump-to-part): Use read-number.
	(gnus-insert-mime-button, gnus-insert-mime-security-button):
	Remove Emacs pre-21 compatible code for help-echo.
	(gnus-article-next-page-1): No need to adjust the number of lines.
	(gnus-article-describe-bindings): Always use help-buffer.

	* gnus-audio.el (gnus-audio-inline-sound):
	* gnus-cus.el (gnus-custom-mode):
	* gnus-group.el (gnus-group-update-tool-bar): Comment fix.

	* gnus-sum.el (gnus-remove-overlays): Doc fix.

	* gnus-util.el (gnus-select-frame-set-input-focus): Remove Emacs 21
	compatible code.

2010-09-24  Glenn Morris  <rgm@gnu.org>

	* message.el (message-output): Use gnus-output-to-rmail if a buffer is
	visiting the fcc file in rmail-mode.

2010-09-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnir.el: Silence the byte compiler.

	* gnus-html.el (gnus-html-encode-url-chars): New function, that's an
	alias to browse-url-url-encode-chars if any.
	(gnus-html-encode-url): Use it.

2010-09-23  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-start.el (gnus-use-backend-marks): New variable.
	(gnus-get-unread-articles-in-group): Use it.

	* gnus-sum.el (gnus-summary-local-variables): Prepare for list/range
	makeover.

2010-09-23  Andrew Cohen  <cohen@andy.bu.edu>

	* nnimap.el (nnimap-retrieve-headers): Return 'headers.

2010-09-23  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-start.el (gnus-fixup-nnimap-unread-after-getting-new-news):
	Remove.
	(gnus-setup-news-hook):
	Remove gnus-fixup-nnimap-unread-after-getting-new-news.

	* gnus-int.el (gnus-request-update-info): Protect against backends not
	having the function.

	* nnimap.el (nnimap-stream): Mention STARTTLS.
	(nnimap-open-connection): Add STARTTLS support.

2010-09-23  Andrew Cohen  <cohen@andy.bu.edu>

	* nnir.el (nnir-run-imap): Fix up nnir to work with the new nnimap.

2010-09-23  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-transform-headers): Don't bug out on invalid
	BODYSTRUCTUREs.
	(nnimap-transform-headers): Unfold quoted {42} headers.

	* gnus-start.el (gnus-get-unread-articles): Allow backends to update
	the info.
	(gnus-get-unread-articles): Only call updatep on backends that support
	it.

	* nnweb.el (nnweb-request-update-info): NOOP.

	* nnmaildir.el (nnmaildir-request-marks): Rename from -update-info.

	* nnfolder.el (nnfolder-request-marks): Rename from -update-info,
	since it only deals with marks.

	* gnus-int.el (gnus-request-marks): Rename gnus-request-update-info to
	gnus-request-marks, and make a new gnus-request-update-info.

	* nnimap.el (nnimap-update-info): When UIDNEXT is present, use that for
	the active instead of the high number, which is usually too low.

2010-09-23  Teodor Zlatanov  <tzz@lifelogs.com>

	* encrypt.el: Remove.

2010-09-23  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-update-info): Sync non-standard flags from the
	server in symbolic form.

	* gnus-html.el (gnus-max-image-proportion): Increase proportion to 0.9.

2010-09-22  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-parse-flags): Parse the data in any order.
	(nnimap-update-info): Fix up code slightly.

	* gnus-int.el (gnus-open-server): Add tracing for performance
	debugging.

	* gnus-group.el (gnus-group-highlight-line): Typo fix: beg, not start.
	(gnus-group-insert-group-line): Pass the real group name so that it
	gets the right data.

	* gnus-start.el (gnus-get-unread-articles): Don't have
	`gnus-get-unread-articles-in-group' update info, since that can be
	really slow and doesn't seem to be needed?

2010-09-22  Julien Danjou  <julien@danjou.info>

	* gnus-group.el (gnus-group-insert-group-line):
	Call gnus-group-highlight-line.
	(gnus-group-update-hook): Remove gnus-group-highlight-line from the
	default hook list.
	(gnus-group-update-eval-form): Add new function.
	(gnus-group-highlight-line): Use gnus-group-update-eval-form.
	(gnus-group-get-icon): Use gnus-group-update-eval-form.

2010-09-22  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-request-expire-articles): If nnmail-expiry-wait is
	immediate, then expire all articles.
	(nnimap-update-info): Fix off-by-one errors.
	(nnimap-flags-to-marks): Would return no marks lists for group with no
	flags.  Instead return the other data.

2010-09-22  Julien Danjou  <julien@danjou.info>

	* gnus-group.el (gnus-group-get-icon): Rename gnus-group-add-icon that
	Only return an icon.
	(gnus-group-insert-group-line): Compute icon to return.

	* gnus-html.el (gnus-html-image-automatic-caching): Add custom var.
	(gnus-html-image-fetched): Only cache if
	gnus-html-image-automatic-caching is set.
	(gnus-html-image-fetched): Check for errors.

2010-09-22  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-start.el (gnus-read-active-for-groups): Only run -request-scan
	once per method on `g'.  This ensures that backends like nnfolder don't
	open all their folders.

	* nnimap.el (nnimap-split-incoming-mail): Delete 'junk.
	(nnimap-request-list): Nix out group in the correct buffer.
	(nnimap-parse-flags): Implement by using `read' instead of
	hand-parsing.
	(nnimap-flags-to-marks): Pass on permanent-flags.
	(nnimap-make-process-buffer): Record the server name.
	(nnimap-parse-flags): Fix typo.
	(nnimap-request-scan): Run split on the server in general, not just a
	single group.

	* nnmail.el (nnmail-split-incoming): Take an optional junk-func
	parameter, and propagate this downwards.

	* nnimap.el (nnimap-request-list): Set the current nnimap group to nil,
	since EXAMINE changes it on the server.

	* gnus-int.el (gnus-request-expire-articles): Inhibit the daemon, since
	this command might take a while.

2010-09-22  Julien Danjou  <julien@danjou.info>

	* gnus-html.el (gnus-html-put-image): Stop using markers.  They are
	harmful if you have 2 images side-by-side, they can't be properly
	update on text deletion.  Using text-property is safer here.
	(gnus-html-image-fetched): Search also for \r\n\r\n to get the start of
	data.

2010-09-22  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-expunge-inbox): Remove.
	(nnimap-mark-and-expunge-incoming): Use nnimap-expunge instead.
	(nnimap-expunge): Flip default to t.

	* gnus.el (gnus-method-to-server): Don't push things to the cache
	unless it's unique.
	(gnus-server-to-method): Ditto.

2010-09-22  Teodor Zlatanov  <tzz@lifelogs.com>

	* nnimap.el (nnimap-delete-article): Tell user if expunge won't happen.

2010-09-22  Julien Danjou  <julien@danjou.info>

	* gnus-html.el (gnus-html-get-image-data): Search also for \r\n\r\n to
	get the start of data.
	(gnus-html-encode-url): Add this function to encode special chars in
	URL.
	(gnus-html-wash-images): Use gnus-html-encode-url to encode URL.
	(gnus-html-prefetch-images): Use gnus-html-encode-url to encode URL.

	* gnus-group.el (gnus-group-update-hook): Call gnus-group-add-icon by
	default.
	(gnus-group-add-icon): Move to gnus-group.el, and rewrite so it works.

	* gnus-html.el (gnus-html-wash-images): Use xml-substitute-special on
	images alt-text.
	(gnus-html-put-image): Put alt-text as help-echo.

2010-09-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mailcap.el (mailcap-parse-mailcap, mailcap-parse-mimetypes):
	* mm-util.el (mm-decompress-buffer):
	* nnir.el (nnir-run-find-grep):
	* pop3.el (pop3-list): Use 3rd arg of split-string.

2010-09-21  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-update-marks): Add sanity check to not delete marks
	outside the active range.  Suggested by Dan Christensen.

	* gnus-start.el (gnus-get-unread-articles): Get the extended method
	slightly later to avoid double-getting it.

	* nnml.el (nnml-generate-nov-file): Fix variable name clobbering from
	previous patch.

	* gnus-sum.el (gnus-adjust-marked-articles): Fix another typo.

2010-09-21  Adam Sjøgren  <asjo@koldfront.dk>

	* gnus-sum.el (gnus-adjust-marked-articles): Fix typo.

2010-09-21  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-int.el (gnus-open-server): Give a better error message in the
	"go offline" case.

	* gnus-sum.el (gnus-adjust-marked-articles): Hack to avoid adjusting
	marks for nnimap, which is seldom the right thing to do.

	* gnus.el (gnus-sloppily-equal-method-parameters): Refactor out.
	(gnus-same-method-different-name): New function.

	* nnimap.el (parse-time): Require.

	* gnus-start.el (gnus-get-unread-articles): Fix the prefixed select
	method in the presence of many similar methods.

	* nnmail.el (nnmail-expired-article-p): Fix typo: time-subtract.

	* nnimap.el (nnimap-find-expired-articles): Don't refer to
	nnml-inhibit-expiry.

	* gnus-sum.el (gnus-summary-move-article): Use gnus-server-equal to
	find out whether methods are equal.

	* nnimap.el (nnimap-find-expired-articles): New function.
	(nnimap-process-expiry-targets): New function.
	(nnimap-request-move-article): Request the article before looking at
	what the Message-ID is.  Fix found by Andrew Cohen.
	(nnimap-mark-and-expunge-incoming): Wait for the last sequence.

	* nnmail.el (nnmail-expired-article-p): Allow returning the cutoff time
	for oldness in addition to being a predicate.

	* nnimap.el (nnimap-request-group): When we have zero articles, return
	the right data to Gnus.
	(nnimap-request-expire-articles): Only delete articles immediately if
	the target is 'delete.

	* gnus-sum.el (gnus-summary-move-article): When respooling to the same
	method, this would bug out.

	* gnus-group.el (gnus-group-expunge-group): Rename from
	gnus-group-nnimap-expunge, and implemented as a normal interface
	function.

	* gnus-int.el (gnus-request-expunge-group): New function.

	* nnimap.el (nnimap-request-create-group): Implement.
	(nnimap-request-expunge-group): New function.

2010-09-21  Julien Danjou  <julien@danjou.info>

	* gnus-html.el (gnus-html-image-cache-ttl): Add new variable.
	(gnus-html-cache-expired): Add new function.
	(gnus-html-wash-images): Use `gnus-html-cache-expired' to check
	wethever we should display image for fetch it.
	Compute alt-text earlier to pass it to the fetching function too.
	(gnus-html-schedule-image-fetching): Change function argument to only
	get one image at a time, not a list.
	(gnus-html-image-fetched): Use `url-store-in-cache' to store image in
	cache.
	(gnus-html-get-image-data): New function to retrieve image data from
	cache.
	(gnus-html-put-image): Change buffer argument to use image data rather
	than file, and place image above region rather than inserting a new
	one.  Do not take alt-text as argument, since it's useless now: we place
	the image above alt-text.
	(gnus-html-prune-cache): Remove.
	(gnus-html-show-images): Start to fetch image when we find one, do not
	push into a temporary list.
	(gnus-html-prefetch-images): Only fetch image if they have expired.
	(gnus-html-browse-image): Fix, use 'gnus-image-url.
	(gnus-html-image-map): Add "v" to browse-url on undisplayed image.

2010-09-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2047.el (rfc2047-encode-parameter): Doc fix.

2010-09-20  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-group.el (gnus-group-line-format-alist): Have the ?U (unseen)
	spec inser "*" if the group isn't active instead of 0.

	* nnimap.el (nnimap-request-group): Don't select the imap buffer before
	opening the server.
	(nnimap-request-delete-group): Implement group deletion.
	(nnimap-transform-headers): Return the size of the entire message in
	the Bytes header, not just the size of the first part.
	(nnimap-request-move-article): When moving an article from nnimap,
	request the article first so the accepting form has an article to
	accept.  Reported by Dan Christensen.
	(nnimap-command): Make sure that the error message doesn't error out.

2010-09-20  David Edmondson  <dme@dme.org>  (tiny change)

	* nnimap.el (nnimap-request-set-mark): Don't wait for a response when
	we haven't requested anything.

2010-09-20  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-fetch-inbox): Use "[]" as the parameter instead of
	"".  Fix found by Andrew Cohen.

	* mail-parse.el (mail-header-encode-parameter): Use -encode-parameter
	instead of -encode-string.

2010-09-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-html.el (gnus-html-image-fetched): Pass arg to kill-buffer.

	* gnus-sum.el (gnus-summary-update-mark): Replace subst-char-in-string
	by mm-subst-char-in-string.

2010-09-19  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-wait-for-connection): Avoid a race condition while
	waiting for the connection string.

	* gnus-html.el (gnus-html-image-fetched): Protect against the data not
	arriving.

	* gnus-start.el (gnus-ignored-newsgroups): Remove [] from the list of
	bogus characters.  This allows selecting certain Gmail groups.

	* nnimap.el (nnimap-find-wanted-parts-1): New function.
	(nnimap-fetch-partial-articles): New variable.
	(nnimap-open-connection): When looking for credentials, also use the
	nnimap-server-port.
	(nnimap-request-article): Return the group/article number, so that Gnus
	`^' works as expected.
	(nnimap-find-wanted-parts-1): Return the MIME parts as IMAP wants them.

	* gnus.el (gnus-similar-server-opened): Refactor a bit and add
	comments.
	(gnus-methods-sloppily-equal): New function.
	(gnus): When using the development version of Gnus, load the gnus-load
	file.

	* gnus-start.el (gnus-get-unread-articles): Make sure that we call
	`gnus-open-server' on each method before trying to scan them etc.
	This ensures that all the backend parameters are set correctly.

	* nnimap.el (nnimap-authenticator): New variable.
	(nnimap-open-connection): Allow anonymous login.
	(nnimap-transform-headers): The chars header is called Chars not Bytes.
	(nnimap-wait-for-response): Don't infloop if the IMAP connection drops.

	* gnus-art.el (gnus-article-describe-briefly): Fix up typo in last
	patch, found by Knut Anders Hatlen.

2010-09-19  Andreas Schwab  <schwab@linux-m68k.org>

	* gnus-agent.el (gnus-agent-batch-confirmation)
	(gnus-agent-expire-group, gnus-agent-expire): Pass proper format string
	to gnus-message.
	* gnus-art.el (gnus-article-describe-briefly): Likewise.
	* gnus-group.el (gnus-group-list-groups, gnus-group-describe-group)
	(gnus-group-edit-global-kill, gnus-group-describe-briefly): Likewise.
	* gnus-int.el (gnus-open-server): Likewise.
	* gnus-score.el (gnus-score-edit-current-scores, gnus-score-edit-file)
	(gnus-score-check-syntax): Likewise.
	* gnus-srvr.el (gnus-browse-describe-briefly): Likewise.
	* gnus-start.el (gnus-read-active-file-1, gnus-read-active-file-1):
	Likewise.
	* gnus-sum.el (gnus-summary-describe-briefly): Likewise.

2010-09-19  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-html.el (gnus-html-prefetch-images): Fix up the url-retrieve
	calling conventions so that prefetch doesn't bug out.

2010-09-19  Julien Danjou  <julien@danjou.info>

	* gnus-sum.el (gnus-summary-update-mark): Use `subst-char-in-string'
	rather than `subst-char-in-region' in order to be able to replace ASCII
	char by UTF-8 ones.

	* gnus-html.el (gnus-html-prefetch-images): Use `url-retrieve' rather
	than curl.
	(gnus-html-image-fetched): Fix `gnus-html-put-image' call not setting
	the right URL and ALT text on images.
	(gnus-html-wash-tags): Fix tag case.
	Add support for `s' and `ins' tags.  Use gnus-emphasis-* faces.
	(gnus-article-html): Add -o display_ins_del=2 option.
	(gnus-html-wash-tags): Add better support for <ul> tags symbols.

2010-09-19  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnheader.el (nnheader-insert-nov): Protect against junk appearing in
	the extra mail headers, which sometimes seem to happen for unknown
	reasons.

	* mail-parse.el (mail-header-encode-parameter): Define as
	rfc2045-encode-string instead of as rfc2231-encode-string, since some
	(or most, perhaps?) mail readers don't understand the latter, but do
	understand the former.

	* gnus-agent.el (gnus-agent-auto-agentize-methods): Switch the default
	to nil, so that no methods are automatically agentized.  I think this
	is probably what most users want.

	* gnus-html.el (gnus-html-schedule-image-fetching): Ignore all errors
	from url-retrieve, for instance about invalid URLs.

	* nnimap.el (nnimap-finish-retrieve-group-infos): Protect against
	groups that have no articles.
	(nnimap-request-article): Check that we really got an article when we
	requested one.

	* gnus-agent.el (gnus-agent-load-alist): Nix out the alist if the file
	doesn't exist.

	* nnimap.el (nnimap-finish-retrieve-group-infos): Return data in the
	nntp buffer so the agent can save it.
	(nnimap-open-shell-stream): Bind `process-connection-type' to nil, so
	that CRLF doesn't get translated to \n.
	(nnimap-open-connection): Don't make 'shell commands only send \n.

2010-09-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* nnml.el (nnml-files): Add prefix to dynamic var `files'.
	(nnml-generate-nov-databases-directory, nnml-generate-active-info):
	Update var name.
	(nnml-generate-nov-file): Use dolist.
	(nnml-directory-articles, nnml-current-group-article-to-file-alist):
	Use with-current-buffer.

2010-09-18  Julien Danjou  <julien@danjou.info>

	* gnus-html.el (gnus-html-schedule-image-fetching): Fetch all images in
	parallel.

2010-09-18  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-update-info): When doing partial marks update, get
	the range update right.
	(nnimap-request-group): Don't make `M-g' bug out on group with no
	marks.
	(nnoo): Require, so that other packages can require nnimap.
	(nnimap-wait-for-response): Be a bit more lax in finding the end of the
	command we're looking for.  This helps when the server sends more
	responses after we've gotten everything we expected.
	(nnimap): Add a `newlinep' field to keep track of end-of-line
	conventions.
	Don't send CRLF to things that don't want it.
	(nnimap-request-accept-article): Ditto.

2010-09-18  Julien Danjou  <julien@danjou.info>

	* gnus-html.el (gnus-html-schedule-image-fetching): Use `url' rather
	than curl to retrieve images.

2010-09-18  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-update-info): Extend the info so that we can set
	the marks.
	(nnimap-open-connection): Fix typo -- should be 'shell, not 'stream.
	(nnimap-wait-for-connection): New function.
	(nnimap-open-connection): If we have PREAUTH, don't query for login
	credentials.
	(nnimap-update-info): Fix off-by-one error when concatenating ranges
	when doing a partial update.

2010-09-18  Julien Danjou  <julien@danjou.info>

	* gnus-html.el (gnus-html-wash-tags): Add support for i, b and u HTML
	tags.

2010-09-18  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-credentials): New function.
	(nnimap-open-connection): Use the new function to look for credentials
	also on the numeric equivalents of "imap" and "imaps".

	* gnus-start.el (gnus-activate-group): Send the info to
	gnus-request-group.

	* nnimap.el (nnimap-request-group): Have the "check" version of the
	function parse flags and update the info, so that a `M-g' get a total
	resync of all flags from the group.

	* gnus-int.el (gnus-request-group): Take an optional `info' parameter
	to allow backends to alter the info on group selection.  Also alter all
	the backend -request-group functions to take the parameter.

	* nnimap.el (nnimap-store-info): New function.
	(nnimap-update-info): Store the info for later usage.
	(nnimap-request-group): Use the stored info for the dont-check case, so
	that we don't retrieve all marks when we enter a group.

	* nnimap.el: Use deffoo instead of defun for interface functions.

	* gnus-start.el (gnus-get-unread-articles): Allow the backends to
	update the group info.  This makes the nndraft groups, for instance, go
	back to their old behavior.

	* gnus-sum.el (gnus-select-newsgroup): Indent.

	* nnimap.el (nnimap-possibly-change-group): Return nil if we can't log
	in.
	(nnimap-finish-retrieve-group-infos): Make sure we're not waiting for
	nothing.

	* gnus-start.el (gnus-get-unread-articles): Don't try to scan groups
	from methods that are denied.

	* gnus-int.el (gnus-method-denied-p): New function.

	* nnimap.el (nnimap-open-connection): Use auth-sources to query and
	store the password instead of netrc.
	(nnimap-open-connection): Don't error out when we can't make a
	connections.

	* auth-source.el (auth-source-create): In the password prompt, say what
	we're querying for.  Also prompt for user name if that hasn't been
	given.

	* nnimap.el (nnimap-with-process-buffer): Remove.

2010-09-17  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-start.el (gnus-read-active-for-groups): Don't use the "finish"
	method when we're reading from the agent.

	* nnagent.el (nnagent-retrieve-group-data-early): New dummy method.

	* auth-source.el (auth-sources): Add ~/.authinfo to the default, since
	that's probably most useful for users.

	* gnus-int.el (gnus-check-server): Save result so that it doesn't say
	"failed" all the time.

	* gnus.el: Throughout all files, replace (save-excursion (set-buffer
	...)) with (with-current-buffer ...).

	* nntp.el (nntp-open-server): Return whether the open was successful or
	not.

	* gnus-sum.el (gnus-summary-first-subject): Have `unseen-or-unread'
	select an unread unseen article first.

	* nnimap.el (nnimap-open-connection): If the user doesn't have a
	/etc/services, supply some sensible port defaults.

2010-09-17  Julien Danjou  <julien@danjou.info>

	* mm-decode.el (mm-text-html-renderer): Document gnus-article-html.

2010-09-17  Knut Anders Hatlen  <kahatlen@gmail.com>  (tiny change)

	* nnimap.el (nnimap-get-groups): Don't bug out if the LIST command
	doesn't have any parameters.

2010-09-17  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnimap.el (nnimap-open-connection): Upcase all capabilities, and use
	only upcased checks.

	* nnmail.el (nnmail-article-group): Fix typo in "bogus" section.

	* nnimap.el (nnimap-open-shell-stream): New function.
	(nnimap-open-connection): Use it.
	(nnimap-transform-headers): Get the number of lines in each message.
	(nnimap-retrieve-headers): Query for BODYSTRUCTURE so that we get the
	number of lines.
	(nnimap-request-list): Not all servers return UIDNEXT.  Work past this
	problem.

	* utf7.el (utf7-encode): Autoload.

	* nnmail.el (nnmail-inhibit-default-split-group): New internal variable
	to allow the mail splitting to not return a default group.  This is
	useful for nnimap, which will leave unmatched mail in the inbox.

	* nnimap.el: Rewritten.

	* gnus.el (gnus-article-special-mark-lists): Add uid/active tuples, for
	nnimap usage.

	* gnus-sum.el (gnus-summary-move-article): Pass the move-to group name
	if the move is internal, so that nnimap can do fast internal moves.

	* gnus-start.el (gnus-get-unread-articles): Support early retrieval of
	data.
	(gnus-read-active-for-groups): Support finishing the early retrieval of
	data.

	* gnus-range.el (gnus-range-nconcat): New function.

	* gnus-int.el (gnus-finish-retrieve-group-infos)
	(gnus-retrieve-group-data-early): New functions.

2010-09-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* nnrss.el (nnrss-retrieve-headers, nnrss-request-list-newsgroups)
	(nnrss-retrieve-groups):
	* pop3.el (pop3-open-server, pop3-read-response, pop3-list, pop3-retr)
	(pop3-quit): Use with-current-buffer.

2010-09-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* pop3.el (pop3-wait-for-messages): Use pop3-accept-process-output
	instead of nnheader-accept-process-output.

	* gnus-html.el (gnus-html-schedule-image-fetching)
	(gnus-html-prefetch-images): Replace process-kill-without-query by
	gnus-set-process-query-on-exit-flag.

2010-09-16  Romain Francoise  <romain@orebokech.com>

	* gnus-html.el: Require gnus-art for `gnus-with-article-buffer'.

2010-09-14  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-registry.el (gnus-registry-install-shortcuts): The second
	parameter to unintern is mandatory-ish in Emacs 24.

	* gnus-html.el (gnus-html-schedule-image-fetching)
	(gnus-html-prefetch-images): Check for curl before using it.

	* mm-decode.el (mm-text-html-renderer): Don't have gnus-article-html
	depend on curl, which isn't essential.

	* imap.el: Revert back to version
	cb950ed8ff3e0f40dac437a51b269166f9ffb60d, since some of the changes
	seem problematic.

2010-09-14  Juanma Barranquero  <lekktu@gmail.com>

	* gnus-registry.el (gnus-registry-install-shortcuts):
	Explicitly pass `obarray' to `unintern' to avoid a warning.

2010-09-14  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-start.el (gnus-read-active-for-groups): Revert the previous
	change.

	* nnrss.el (nnrss-request-list): Remove this function and related
	functions, including the moreover stuff.

2010-09-14  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnrss.el (nnrss-retrieve-groups): New function.

2010-09-14  Juanma Barranquero  <lekktu@gmail.com>

	* .dir-locals.el: Add no-byte-compile cookie.

2010-09-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-start.el (gnus-read-active-for-groups): Run gnus-activate-group
	for back end that doesn't support request-scan.

2010-09-10  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-start.el (gnus-read-active-file-1): If gnus-agent isn't set,
	then do request scans from the backends.

	* gnus-sum.el (gnus-summary-update-hook): Change default to nil, to
	avoid running a hook per line, since this takes a lot of time,
	profiling shows.
	(gnus-summary-prepare-threads): Call `gnus-summary-highlight-line'
	directly if gnus-visual-p is true.

2010-09-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-start.el (gnus-read-active-for-groups): Check only subscribed
	groups; replace mapcar with dolist which is a bit faster; pass groups
	info to gnus-read-active-file-1.
	(gnus-read-active-file-1): Scan only specified groups if the new
	optional arg `infos' is given.

2010-09-09  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mail-source.el (mail-source-fetch-pop): Use pop3-movemail again.

	* pop3.el (pop3-movemail): Remove.
	(pop3-streaming-movemail): Rename to pop3-movemail.

	* gnus-html.el (gnus-html-wash-tags): Refactor out the image bit, and
	don't restrict end-tag searches to the end of the line.

2010-09-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-start.el (gnus-get-unread-articles): Set the number of unread
	articles of every unchecked group to t, which means unknown since the
	server has never been opened.

2010-09-08  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-html.el (gnus-html-show-alt-text): New command.
	(gnus-html-browse-image): Ditto.
	(gnus-html-wash-tags): Add the data to allow showing the ALT text and
	to browse the image directly.
	(gnus-html-wash-tags): Search for images first, so that <a><img> works
	better.

	* gnus-async.el (gnus-async-article-callback):
	Call `gnus-html-prefetch-images' unconditionally.

	* gnus-html.el (gnus-html-schedule-image-fetching): Decode entities
	before feeding URLs to curl.

2010-09-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-html.el (gnus-html-wash-tags, gnus-html-put-image): Mark cid and
	internal images as deletable by `W D D'.

	* gnus-async.el (gnus-html-prefetch-images): Autoload it when compiling.
	(gnus-async-article-callback): Fix typo.

2010-09-06  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-html.el (gnus-html-wash-tags): Limit end-tag matching to the
	current line to work around bugs in the output from w3m.

	* gnus-async.el (gnus-async-article-callback): Always prefetch images
	for groups that want that.

	* nntp.el (nntp-wait-for-string): Supply a timeout for
	accept-process-output to ensure progress.

	* gnus-start.el (gnus-get-unread-articles): If being given an explicit
	level to get unread articles from, then use that for foreign groups,
	too.

	* gnus-html.el (gnus-html-wash-tags): Remove <a name...> tags, which
	confuses the rest of the function.

	* gnus-start.el (gnus-read-active-for-groups): Do a `gnus-request-scan'
	for the methods that support -retrieve-groups, too.

	* nnml.el (nnml-save-nov): Remove some debugging-related messages.

2010-09-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* pop3.el: Require cl when compiling.
	(pop3-number-of-responses): Search for "+OK", not "+OK ".

2010-09-05  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-start.el (gnus-get-unread-articles): Don't bother with groups
	that aren't going to be activated.
	(gnus-get-unread-articles): Fix up the last commit.

	* gnus-html.el (gnus-article-html): Allow calling without specifying
	the handle.  In that case, dissect the buffer first.

	* gnus-sum.el (gnus-set-mode-line): Don't pad the mode line string.

	* nnimap.el (nnimap-open-connection): Revert the change that would look
	into authinfo for imaps instead of imap.

	* gnus-start.el (gnus-activate-group): Take an optional parameter to
	say that you don't want to call gnus-request-group with don-check, but
	do check the response.  This is for virtual groups only.
	(gnus-get-unread-articles): Count the archive groups as secondary, so
	that they're activated the same way as before.

	* nnimap.el (nnimap-request-list): Servers may return \NoSelect
	case-insensitively.
	(nnimap-debug): Remove.

	* mail-source.el (mail-source-fetch): Don't message if we're fetching
	mail from a file, and the file doesn't exist.

	* pop3.el (pop3-streaming-movemail): Return t for success.

	* nnimap.el (nnimap-open-connection): Look for the "imaps" entry in the
	.authinfo if we're using ssl connection.

	* nnvirtual.el (nnvirtual-create-mapping): Use the active info we
	already have if we're in a main Gnus `g' run.

	* gnus-start.el (gnus-method-rank): Get info for virtual groups last.

2010-09-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-start.el (gnus-method-rank): Replace equalp with equal.

	* nnmh.el (nnmh-request-list-1): Bind `file'.

	* pop3.el (pop3-set-process-query-on-exit-flag): New function that's an
	alias to set-process-query-on-exit-flag or process-kill-without-query.
	(pop3-open-server): Use it.

2010-09-04  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mail-source.el (mail-source-delete-crash-box): Always move the crash
	box to the Incoming file.  Fixes mistake in previous checkin.

	* pop3.el (pop3-send-streaming-command): Off-by-one error on the
	request loop (for debugging purposes) removed.

	* nnml.el (nnml-save-nov): Message around nnml-save-nov so that the
	culprit is more visible.
	(nnml-save-incremental-nov, nnml-open-incremental-nov)
	(nnml-add-incremental-nov): New functions to do "incremental" nov
	updates, where we just append to the end of the existing nov files
	without reading/writing them in full.

	* mail-source.el (mail-source-delete-crash-box): Really only check the
	incoming files once in a while.

	* pop3.el (pop3-streaming-movemail): Always close the pop3 connection.

	* mail-source.el (mail-source-delete-crash-box): Only check the
	incoming files for deletion once per day to save a lot of file
	accesses.

	* pop3.el (pop3-logon): Fix up unbound variable typo.

	* mail-source.el (pop3-streaming-movemail): Autoload.

	* pop3.el (pop3-streaming-movemail):
	Respect pop3-leave-mail-on-server.

	* mail-source.el (mail-source-fetch-pop): Use streaming pop3
	retrieval.

	* pop3.el (pop3-process-filter): Remove unused function.
	(pop3-streaming-movemail, pop3-send-streaming-command)
	(pop3-wait-for-messages, pop3-write-to-file)
	(pop3-number-of-responses): New functions for streaming pop3
	retrieval.

	* gnus-start.el (gnus-get-unread-articles): Protect against groups that
	come from no known methods.
	(gnus-make-hashtable-from-newsrc-alist): Remove duplicates from .newsrc
	list.

	* pop3.el (pop3-display-message-size-flag): Remove -- everybody wants
	message sizes.
	(pop3-movemail): Use erase-buffer instead of looping and deleting
	regions, which seems rather odd.

	* gnus-agent.el (gnus-agent-load-local): Only read the agent.lib/local
	file once per `g' run.

	* nnmh.el (nnmh-request-list-1): Output active lines also for empty
	directories.  This makes the draft queue directory work.

	* gnus-start.el (gnus-get-unread-articles): Rewrite the way we request
	data from the backends, so that we only request the list of groups from
	each method once.  This should speed things up considerably.

	* nnvirtual.el (nnvirtual-request-list): Remove function so that we can
	detect that it's not implemented.

	* nnmh.el (nnmh-request-list-1): Fix up the recursion behavior so that
	we actually do recurse down into the tree, but don't stat all leaf
	nodes.

	* gnus-html.el (gnus-html-show-images): If there are no images to show,
	then say so instead of bugging out.

	* gnus-agent.el (gnus-agent-load-alist): Check whether the agentview
	files exist before trying to read them.

	* gnus-html.el (gnus-html-wash-tags): Remove even more white space
	around <pre_int>.

	* gnus-art.el (gnus-article-copy-string): Say what data we copied.

	* nnmh.el (nnmh-request-list-1): Optimize for speed.

2010-09-03  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mm-util.el (mm-image-load-path): Just return the image directories,
	not all directories in the path in addition to the image directories.
	(mm-image-load-path): Maintain a cache of the image directories so that
	the `g' command in Gnus doesn't have to stat dozens of directories each
	time.

	* gnus-html.el (gnus-html-put-image): Allow images to be removed.
	(gnus-html-wash-tags): Add a new `i' command to insert images.
	(gnus-html-insert-image): New command and keystroke.
	(gnus-html-redisplay-with-images): New command and keystroke.
	(gnus-html-show-images): Rename command.
	(gnus-html-wash-tags): Remove more white space before <pre_int> image
	spacers.
	(gnus-html-wash-tags): Decode entities at the end, so that entities
	inside the tags don't mess up the rest of the "parsing".

	* gnus-agent.el (gnus-agent-auto-agentize-methods): Change the default
	so that nnimap methods aren't agentized by default.  There's apparently
	many problems related to agent/imap behavior.

	* gnus-art.el (gnus-article-copy-string): New command and key binding.

	* gnus-html.el: Doc fix.

2010-09-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-html.el (gnus-html-put-image): Use gnus-graphic-display-p,
	glyph-width and glyph-height instead of display-graphic-p and
	image-size; make avoidance of displaying small images work for XEmacs.

	* gnus-util.el (gnus-graphic-display-p): Use device-on-window-system-p
	for XEmacs.

	* gnus-ems.el (gnus-set-process-plist, gnus-process-plist): Change name
	of symbol that holds plist data.
	(gnus-process-plist): Remove plist of process after getting it.

2010-09-02  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-generate-hashcash): Change default to
	'opportunistic if hashcash is installed.

	* gnus-html.el (gnus-html-rescale-image): Fix up typo in rescaling.
	(gnus-html-put-image): Only call image-size once, since it's somewhat
	time-consuming on remote X servers.

2010-09-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-html.el (gnus-article-html): Make work buffer multibyte for
	decoded contents.
	(gnus-html-put-image, gnus-html-rescale-image): Pass `file' argument.

2010-09-02  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-group.el (gnus-group-line-format): Remove %O (moderated) from
	group line format, since it isn't very interesting.

	* gnus-agent.el (gnus-agent-short-article),
	(gnus-agent-long-article): Increase values for these two variables,
	since most people are likely to have more network connection and
	storage than before.

	* gnus.el (gnus-refer-article-method): Change default to 'current.
	When referring an article, the common behavior is to refer it from the
	current select method, not the native select method.  The chances of
	the native select method having the message in question is rather slim
	these days.

	* gnus-sum.el (gnus-auto-select-subject): Change default to
	`unseen-or-unread'.  I think it's likely that most people want to
	select an unseen article over a previously seen, but unread one.

	* gnus.el (gnus-mode-non-string-length): Change default to 30.  nil
	means that in the article buffer none of the minor mode elements will
	be shown, usually, and this is not desirable in most cases.

	* gnus-sum.el (gnus-summary-goto-unread): Change default to nil, so
	that commands like `d' (and the like) go to the next line in the
	buffer, instead of the next unread article.  I think this is the
	behavior that is most natural for most users.
	(gnus-single-article-buffer): Change default to nil, so that people can
	have as many article buffers open as they have summary buffer.  I think
	this is the most natural way for the groups to behave.

	* message.el (message-generate-new-buffers): Change default to
	`unsent', so that all new message buffers start their names with the
	string "*unsent", and it's easier to find the buffers if you move from
	them.

2010-09-01  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-html.el (gnus-html-wash-tags): Don't show images that are really
	small.  They're probably tracking images.
	(gnus-html-wash-tags): Remove all <pre_int> place holders.
	(gnus-html-rescale-image): Yet another try at getting the image sizing
	right.

	* nntp.el (nntp-request-set-mark): Refuse to do marks if
	nntp-marks-file-name is nil.

2010-09-01  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-html.el (gnus-html-wash-tags)
	(gnus-html-schedule-image-fetching, gnus-html-image-url-blocked-p):
	Better logging.

2010-09-01  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nndoc.el (nndoc-type-alist): Add a new type for Google digests.

	* gnus-html.el (gnus-html-wash-tags): Check the value of
	gnus-blocked-images in the summary buffer.

2010-09-01  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-html.el (gnus-html-image-url-blocked-p): Doc fix.

2010-09-01  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-html.el (gnus-html-wash-tags): "A" is also used for links, just
	like "a", it seems like.
	(gnus-html-image-url-blocked-p): Take a parameter for blocked-images
	since it needs to be picked from the correct buffer.

	* nnwfm.el: Remove.

	* nnlistserv.el: Remove.

2010-09-01  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-html.el (gnus-html-image-url-blocked-p): New function.
	(gnus-html-prefetch-images, gnus-html-wash-tags): Use it.

2010-09-01  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnkiboze.el: Remove.

	* nndb.el: Remove.

	* gnus-html.el (gnus-html-put-image): Use the deleted text as the image
	alt text.
	(gnus-html-rescale-image): Try to get the rescaling logic right for
	images that are just wide and not tall.

	* gnus.el (gnus-string-or): Fix the syntax to not use eval or
	overshadow variable bindings.

2010-09-01  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-html.el (gnus-html-wash-tags)
	(gnus-html-schedule-image-fetching, gnus-html-prefetch-images):
	Add extra logging.

2010-09-01  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-html.el (gnus-html-wash-tags): Delete the IMG_ALT region.
	(gnus-max-image-proportion): New variable.
	(gnus-html-rescale-image): New function.
	(gnus-html-put-image): Rescale images.

2010-09-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	Fix up some byte-compiler warnings.
	* gnus.el (gnus-group-find-parameter, gnus-kill-save-kill-buffer):
	* gnus-cite.el (gnus-article-highlight-citation, gnus-dissect-cited-text)
	(gnus-article-fill-cited-article, gnus-article-hide-citation)
	(gnus-article-hide-citation-in-followups, gnus-cite-toggle):
	* gnus-group.el (gnus-group-set-mode-line, gnus-group-quit)
	(gnus-group-set-info, gnus-add-mark): Use with-current-buffer.
	(gnus-group-update-group): Use save-excursion and with-current-buffer.

2010-09-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-html.el (gnus-article-html): Decode contents by charset.

2010-09-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-html.el (gnus-html-cache-directory, gnus-html-cache-size)
	(gnus-html-frame-width, gnus-blocked-images):
	* message.el (message-prune-recipient-rules): Add custom version.
	* gnus-sum.el (gnus-auto-expirable-marks): Bump custom version.

	* gnus-ems.el (gnus-process-get, gnus-process-put): New compatibility
	functions.

	* gnus-html.el (gnus-html-curl-sentinel): Replace process-get with
	gnus-process-get.

2010-08-31  Julien Danjou  <julien@danjou.info>  (tiny change)

	* nnimap.el (nnimap-request-newgroups): Use nnimap-request-list-method
	instead of lsub directly.

2010-08-31  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnwarchive.el: Remove.

	* gnus-soup.el: Remove.

	* nnsoup.el: Remove.

	* nnultimate.el: Remove.

	* gnus-html.el (gnus-blocked-images): New variable.

	* message.el (message-prune-recipients): New function.
	(message-prune-recipient-rules): New variable.

	* gnus-cite.el (gnus-article-natural-long-line-p): New function to
	guess whether a long line is natural text or not.

	* gnus-html.el (gnus-html-schedule-image-fetching):
	Use gnus-process-plist and friends for compatibility.

2010-08-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	* gnus-html.el: Require packages that define macros used in this file.
	(gnus-article-mouse-face): Declare to silence byte-compiler.
	(gnus-html-curl-sentinel): Use with-current-buffer, inhibit-read-only, and
	process-get.
	(gnus-html-put-image): Use plist-get to avoid getf.
	(gnus-html-prefetch-images): Use with-current-buffer.

2010-08-31  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-ems.el: Provide compatibility functions for
	gnus-set-process-plist.

	* gnus-sum.el (gnus-summary-stop-at-end-of-message):
	* gnus.el (gnus-valid-select-methods):
	* message.el (message-send-mail-partially-limit):
	* mm-decode.el (mm-text-html-renderer):
	* mml.el (mml-insert-mime-headers-always):
	* smiley.el (smiley-regexp-alist): Bump custom version.

2010-08-31  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-html.el: require mm-url.
	(gnus-html-wash-tags): Clarify the code a bit by renaming the variable
	with the url to `url'.
	(gnus-html-wash-tags): Support cid: URLs/images.

2010-08-30  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el: As per discussion 3 years, 8 weeks, 3 days, 9 hours, 57
	minutes, 56 seconds ago on the ding list, remove the `w' and `i'
	bindings, as they aren't useful at all.  `w' is moved to `W w'.

	* gnus-move.el: Remove file, since it doesn't really work.

	* gnus-html.el (gnus-article-html): Tell w3m that the input is
	UTF-8.  This seems to fix problems with some German web feeds.

	* gnus.el (gnus-group-startup-message): Put the xpm version of the logo
	at the top so that the proper colors are applied.

	* gnus-art.el (gnus-article-view-part): Doc fix.

	* gnus-html.el (gnus-html-put-image): Use gnus-create-image to be
	XEmacs-compatible.
	(gnus-html-put-image): Don't do images on non-graphic displays.

	* nnslashdot.el: Remove this unused backend.

	* gnus-undo.el (gnus-undo-register-1): Limit the undo actions to 100
	actions.
	(gnus-undo-register-1): Revert last change.

	* gnus-group.el (gnus-group-completing-read): Protect against not
	having completion-styles bound.

	* mml.el (mml-insert-mime-headers-always): Change the default to t, to
	make broken recipients happier.

	* gnus-html.el (gnus-html-put-image): Use gnus-put-image.

	* gnus-ems.el (gnus-put-image): Have gnus-put-image take an optional
	point parameter.

	* gnus-group.el (gnus-group-completing-read): Add 'substring to
	completion-styles for group selection.

2009-02-04  Andreas Schwab  <schwab@suse.de>

	* gnus-score.el (gnus-score-string): Fix regex for matching extra
	headers and regexp-quote the match if necessary.

2009-03-24  Miles Bader  <miles@gnu.org>

	* smiley.el (smiley-regexp-alist): Don't delete the semicolon before
	the blinking smiley.

2009-03-24  Simon Josefsson  <simon@josefsson.org>

	* smiley.el (smiley-regexp-alist): Disallow ;;) from being treated as a
	blink smiley.

2010-08-29  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-start.el (gnus-dribble-read-file): Ensure that the directory
	where the dribbel file lives exists.

	* message.el (message-send-mail-partially-limit): Change the default to
	nil, since most people don't want this.

	* mm-url.el (mm-url-decode-entities): Also decode entities like
	&#x3212.

2009-07-16  Kevin Ryde  <user42@zip.com.au>  (tiny change)

	* gnus-sum.el (gnus-summary-idna-message):
	* nnrss.el (nnrss-normalize-date, nnrss-discover-feed):
	Hyperlink urls in docstrings with URL `...'.

2010-08-29  Adam Sjøgren  <asjo@koldfront.dk>

	* gnus-html.el (gnus-html-put-image): Use XEmacs-compatible image
	functions.

2010-08-29  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-art.el (gnus-article-add-button): Take an optional parameter to
	say what the mouseover text should be.

	* gnus-html.el (gnus-html-prefetch-images): Use the summary-local
	version of the mm-w3m-safe-url-regexp variable to only download images
	in the groups where we want that to happen.

	* gnus-sum.el (gnus-summary-stop-at-end-of-message): New variable.

	* gnus-art.el (gnus-article-beginning-of-window): Make into defun for
	easier debugging.
	(gnus-article-beginning-of-window): Add kludge to allow spacing past
	big pictures in the article buffer.

	* mm-decode.el (mm-text-html-renderer): Default the html renderer to
	gnus-article-html.
	(mm-text-html-renderer): gnus-article-html needs curl in addition to
	w3m.

	* gnus-html.el: Start a new super-simple HTML renderer based on w3m.

2010-08-28  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus.el (gnus-valid-select-methods): Remove reference to nngoogle,
	which doesn't exist.

	* message.el (message-inhibit-ecomplete): New variable to allow some
	function to inhibit ecomplete address storage.
	(message-resend): Disable ecomplete message storage when resending
	messages.

	* nntp.el (nntp-async-kluge): Remove the Emacs 20.3-related kluge.

2010-08-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-summary-move-article, gnus-summary-delete-article):
	Save excursion while copying, moving, and deleting articles in order to
	prevent the cursor from jumping to unforeseen place.

2010-08-17  Glenn Morris  <rgm@gnu.org>

	* gnus-sync.el: Require gnus components whose functions are used.

	* gnus-art.el (bookmark-make-record-function):
	* gnus-sum.el (bookmark-yank-point, bookmark-current-bookmark):
	Declare for compiler.

	* mm-url.el (mml-compute-boundary): Autoload.

2010-08-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-start.el (gnus-start-draft-setup): Move doc string forward.

2010-08-14  Teodor Zlatanov  <tzz@lifelogs.com>

	Typo fix "hoo4a" -> "hook".

	* gnus-sync.el (gnus-sync-install-hooks): Typo fix.

2010-08-14  Glenn Morris  <rgm@gnu.org>

	* gnus-sync.el (gnus-sync): Fix defgroup version.

2010-08-13  Teodor Zlatanov  <tzz@lifelogs.com>

	Doc fixes and keep unknown groups (ammended for nunion bug fix).

	* gnus-sync.el: Fix docs.
	(gnus-sync-save): Keep unknown groups in `gnus-sync-newsrc-loader'.
	(gnus-sync-read): Don't wipe `gnus-sync-newsrc-loader' after reading.

2010-08-12  Teodor Zlatanov  <tzz@lifelogs.com>

	Optimizations for gnus-sync.el.

	* gnus-sync.el: Add docs about gnus-sync-backend
	possibilities.
	(gnus-sync-save): Remove unnecessary message.
	(gnus-sync-read): Optimize and show what groups were skipped.

2010-08-12  Teodor Zlatanov  <tzz@lifelogs.com>

	Minor bug fixes for gnus-sync.el.

	* gnus-sync.el (gnus-sync-unload-hook, gnus-sync-install-hooks):
	Don't read the sync on get-new-news.

	* gnus-sync.el (gnus-sync-save): Define `variable' so the compiler is
	quiet.

	* gnus-sync.el (gnus-sync-read): Use `gnus-sync-newsrc-offsets'
	(fix typo).

2010-07-30  Lawrence Mitchell  <wence@gmx.li>

	Make saving and restoring of hidden threads work with overlays.
	Patch applied by Ted Zlatanov.

	* gnus-sum.el (gnus-hidden-threads-configuration)
	(gnus-restore-hidden-threads-configuration): Update to deal with text
	properties, rather than searching for a magic character.

2010-08-12  Teodor Zlatanov  <tzz@lifelogs.com>

	New gnus-sync.el library for synchronization of marks.

	* gnus-sync.el: New library for synchronization of marks.

	* gnus-util.el (gnus-grep-in-list): Move from gnus-registry.el and
	renamed from `gnus-registry-grep-in-list'.

	* gnus-registry.el (gnus-registry-follow-group-p):
	Use `gnus-grep-in-list'.

	* gnus-start.el (gnus-start-draft-setup): Make it interactive.

2010-08-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2047.el (rfc2047-encode): Use utf-8 as a last resort if
	determining charset of text fails.

2010-08-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnmail.el (nnmail-get-new-mail-1): Revert.

	* nnml.el (nnml-active-number): Make sure names of newly created groups
	in nnml-group-alist are encoded.

2010-07-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnmail.el (nnmail-get-new-mail-1): Encode group names possibly
	containing non-ASCII characters in active file for nnml back end.

2010-07-24  David Engster  <dengste@eml.cc>

	* mml-smime.el (mml-smime-epg-verify): Also accept the older
	x-pkcs7-signature MIME type as signature (RFC 2311, C.1).

2010-07-21  Daiki Ueno  <ueno@unixuser.org>

	* mml.el (mml-parse-1): Collect "certfile" attributes in "<#secure>"
	tag (Bug#6654).

2010-07-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-summary-bookmark-make-record): Bookmark position in
	the article buffer, not the summary buffer.

2010-07-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-summary-bookmark-make-record): Make it work for
	Emacs 23 as well.

2010-07-13  Thierry Volpiatto  <thierry.volpiatto@gmail.com>

	Allow C-w when setting a bookmark in a Gnus Article buffer (Bug#5975).
	Patch applied by Karl Fogel.

	* gnus-sum.el (gnus-summary-bookmark-make-record):
	Set `bookmark-yank-point' and `bookmark-current-buffer' to allow C-w.

2010-07-13  Thierry Volpiatto  <thierry.volpiatto@gmail.com>

	Allow bookmarks to be set from Gnus Article buffers (Bug #5975).
	Patch applied (with minor tweaks) by Karl Fogel.  Note this leaves
	C-w still not working correctly from Article buffers; Thierry's
	patch to fix that will be applied after this.

	* gnus-art.el (bookmark-make-record-function): New local variable.

	* gnus-sum.el (gnus-summary-bookmark-make-record): Allow setting from
	article buffer.
	(gnus-summary-bookmark-jump): Maybe jump to article buffer.

2010-07-13  Karl Fogel  <kfogel@red-bean.com>

	* gnus-sum.el (bookmark-make-record-default): Adjust declaration, based
	on changes in bookmark.el.

2010-06-22  Mark A. Hershberger  <mah@everybody.org>

	* mm-url.el (mm-url-encode-multipart-form-data): New function to handle
	the *other* type of HTML form submission.

2010-06-15  Michael Albinus  <michael.albinus@gmx.de>

	* auth-source.el (auth-source-pick): If choice does not contain a
	questioned keyword, set the check to t.

2010-06-12  Romain Francoise  <romain@orebokech.com>

	* gnus-util.el (gnus-date-get-time): Move up before first use.

2010-06-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-mime-buttonized-part-id): New internal variable.
	(gnus-article-edit-part): Bind it to make last part that is substituted
	or deleted visible.
	(gnus-mime-display-single): Buttonize part of which id equals to
	gnus-mime-buttonized-part-id.

2010-06-10  Dan Christensen  <jdc@uwo.ca>

	* gnus-util.el (gnus-user-date): Use gnus-date-get-time.
	(gnus-dd-mmm): Use gnus-date-get-time.
	* gnus-sum.el (gnus-thread-latest-date): Use gnus-date-get-time and
	simplify logic.
	(gnus-summary-limit-to-age): Use gnus-date-get-time.
	(gnus-sort-threads): Emit message if gnus-sort-threads-loop used.

2010-06-08  Michael Albinus  <michael.albinus@gmx.de>

	* auth-source.el (top): Autoload `secrets-list-collections',
	`secrets-create-item', `secrets-delete-item'.
	(auth-sources): Fix tag string.
	(auth-get-source, auth-source-retrieve, auth-source-create)
	(auth-source-delete): New defuns.
	(auth-source-pick): Rewrite in order to avoid 2 passes.
	(auth-source-forget-user-or-password): New parameter USERNAME.
	(auth-source-user-or-password): New parameters CREATE-MISSING and
	DELETE-EXISTING.  Retrieve password interactively, if needed.

2010-06-07  Teemu Likonen  <tlikonen@iki.fi>  (tiny change)

	* gnus-agent.el (gnus-agent-expire-unagentized-dirs): Don't ask about
	deleting unused directories when gnus-expert-user is t.

2010-06-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-browse-delete-temp-files): Don't make query
	for each temp file when gnus-article-browse-delete-temp is ask.

2010-05-20  Kevin Ryde  <user42@zip.com.au>

	* gnus-start.el (gnus-level-unsubscribed): Doc fix.  (Bug#6206)

2010-05-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-summary-save-article): Don't bother to re-fetch
	article unless decoding article to be saved.

2010-05-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mml1991.el (mml1991-mailcrypt-encrypt, mml1991-gpg-encrypt):
	* mml2015.el (mml2015-gpg-encrypt): Disable multibyte in buffers
	generated within the mm-with-unibyte-current-buffer macro.

2010-05-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-bind-safe-url-regexp): Bind mm-w3m-safe-url-regexp
	to nil when we're in a mml-preview buffer and no group is selected.

2010-05-12  Andreas Seltenreich  <seltenreich@gmx.de>

	* gnus-sum.el (gnus-summary-read-group-1): Don't jump to next group
	when catching the `C-g'.  Reported by "Leo".

2010-05-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-forward-make-body-plain)
	(message-forward-make-body-mml): Use mm-multibyte-string-p instead of
	multibyte-string-p.

2010-05-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-forward-make-body-mml): Assume original message
	is multibyte string; error on unibyte.
	(message-forward-make-body-plain): Ditto; don't add excessive newline
	in body end.

2010-05-11  Andreas Seltenreich  <seltenreich@gmx.de>

	* gnus-sum.el (gnus-summary-kill-thread): Use gnus-summary-mark-article
	instead of g-s-m-a-as-unread to set the expirable mark.  (Bug#5284)

2010-05-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-extern.el (mm-extern-url): Don't use
	mm-with-unibyte-current-buffer.
	(mm-extern-cache-contents): Use with-current-buffer instead of
	save-excursion + set-buffer.

2010-05-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-util.el (mm-emacs-mule): Remove.

2010-05-10  Andreas Seltenreich  <seltenreich@gmx.de>

	* gnus-sum.el (gnus-summary-mode): Don't make minor-mode-alist
	buffer-local as it's incompatible with Stefan Monnier's 2010-05-03
	change.

2010-05-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-util.el (mm-with-unibyte-current-buffer): Redefine it so as not to
	bind the default value of enable-multibyte-characters to nil.

2010-05-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-forward-make-body-plain)
	(message-forward-make-body-mml):
	Don't use mm-with-unibyte-current-buffer.

2010-05-07  Christian von Roques  <roques@mti.ag>  (tiny change)

	* mml2015.el (mml2015-epg-find-usable-key): Skip disabled key
	(Bug#5592).

2010-05-07  Julien Danjou  <julien@danjou.info>

	* gnus-art.el (gnus-mime-pipe-part): Add optional argument `cmd'; pass
	it to mm-pipe-part.

	* mm-decode.el (mm-pipe-part): Add optional argument `cmd'; use it if
	it is given.

2010-05-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnweb.el (nnweb-gmane-search):
	* yenc.el (yenc-decode-region): Don't run set-buffer-multibyte for
	XEmacs.

	* gnus-art.el (gnus-article-browse-html-parts):
	* gnus-group.el (gnus-read-ephemeral-gmane-group)
	(gnus-read-ephemeral-bug-grou): Use mm-make-temp-file instead of
	make-temp-file.

	* gnus-dired.el (gnus-dired-mode): Bind gnus-dired-mode-hook,
	gnus-dired-mode-on-hook and gnus-dired-mode-off-hook for XEmacs when
	compiling.

	* gnus-ml.el (gnus-mailing-list-mode): Bind gnus-mailing-list-mode-hook,
	gnus-mailing-list-mode-on-hook and gnus-mailing-list-mode-off-hook for
	XEmacs when compiling.

	* gnus-salt.el (gnus-pick-mode): Bind gnus-pick-mode-on-hook and
	gnus-pick-mode-off-hook for XEmacs when compiling.
	(gnus-binary-mode): Bind gnus-binary-mode-on-hook and
	gnus-binary-mode-off-hook for XEmacs when compiling.

	* gnus-sum.el (gnus-summary-limit-strange-charsets-predicate):
	Return nil if char-charset is not available.

	* sieve-manage.el (sieve-manage-disable-multibyte): Redefine it as a
	macro.

	* mm-url.el (mm-url-form-encode-xwfu): Use mm-encode-coding-string
	instead of encode-coding-string.

	* mm-util.el (mm-enable-multibyte, mm-disable-multibyte): Use (featurep
	'xemacs) instead of mm-emacs-mule to switch function definitions.
	(mm-with-unibyte-current-buffer): Make it a progn macro for XEmacs.

2010-05-06  Tommi Vainikainen  <thv@iki.fi>  (tiny change)

	* mml-sec.el (mml-secure-message-sign): Fix cut and paste error.

2010-05-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-dired.el, gnus-draft.el, gnus-ml.el, gnus-salt.el, gnus-sum.el,
	gnus-undo.el, mml.el: Require easy-mmode for XEmacs when compiling.

2010-05-03  Juanma Barranquero  <lekktu@gmail.com>

	* mm-util.el (mm-decompress-buffer): Use `delete-file';
	alias `jka-compr-delete-temp-file' no longer exists.

2010-05-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	Use define-minor-mode in Gnus where applicable.
	* mml.el (mml-mode): Use define-minor-mode.
	* gnus-undo.el (gnus-undo-mode-map): Initialize in declaration.
	(gnus-undo-mode): Use define-minor-mode.
	* gnus-sum.el (gnus-dead-summary-mode-map): Initialize in declaration.
	(gnus-dead-summary-mode): Use define-minor-mode.
	* gnus-salt.el (gnus-pick-mode-map, gnus-binary-mode-map):
	Initialize in declaration.
	(gnus-pick-mode, gnus-binary-mode): Use define-minor-mode.
	* gnus-ml.el (gnus-mailing-list-mode-map): Initialize in declaration.
	(gnus-mailing-list-mode): Use define-minor-mode.
	* gnus-draft.el (gnus-draft-mode-map): Initialize in declaration.
	(gnus-draft-mode): Use define-minor-mode.
	* gnus-dired.el (gnus-dired-mode-map): Initialize in declaration.
	(gnus-dired-mode): Use define-minor-mode.

2010-05-01  Andreas Seltenreich  <seltenreich@gmx.de>

	* mml.el (mml-generate-mime-1,mml-compute-boundary-1): Update 'mml
	handles on recursive mml-to-mime translation and check them for
	boundary delimiter collisions.  Reported by Greg Troxel.

2010-04-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-util.el: Don't load tm and apel XEmacs packages when compiling.

2010-04-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mm-util.el (mm-find-buffer-file-coding-system):
	* yenc.el (yenc-decode-region): Don't let-bind a read-only variable.

2010-04-22  Andreas Seltenreich  <seltenreich@gmx.de>

	* message.el (message-generate-headers): Record insertion of optional
	headers as well.  Otherwise the check to prevent repeated insertion of
	optional headers is a no-op.

2010-04-17  Teodor Zlatanov  <tzz@lifelogs.com>

	* smime.el: Don't mention CVS.

	* nnrss.el (nnrss-fetch): Don't mention CVS.

	* nnir.el: Don't mention CVS.

2010-04-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* gnus-sum.el (gnus-summary-bookmark-make-record):
	Add `location' field.

2010-04-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* gnus-sum.el: Add bookmark declarations to silence the compiler.
	(gnus-mark-xrefs-as-read, gnus-summary-limit-to-bodies):
	Use with-current-buffer to silence the byte-compiler.
	(gnus-summary-bookmark-make-record): Use derived-mode-p and don't
	bother to require `gnus'.
	(gnus-summary-bookmark-jump): Don't forget to autoload.  Simplify.

2010-04-12  Thierry Volpiatto  <thierry.volpiatto@gmail.com>

	* gnus-sum.el (gnus-summary-bookmark-make-record)
	(gnus-summary-bookmark-jump): New functions.
	(gnus-summary-mode): Setup bookmark support.

2010-04-01  Andreas Schwab  <schwab@linux-m68k.org>

	* mm-uu.el (mm-uu-pgp-signed-extract-1): Use buffer-file-coding-system
	if set.

2010-03-31  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-browse-html-save-cid-content): Rename from
	gnus-article-browse-html-save-cid-image; make it work recursively for
	forwarded messages as well.
	(gnus-article-browse-html-parts): Work when prefix arg is given.
	(gnus-article-browse-html-article): Doc fix.

2010-03-30  Chong Yidong  <cyd@stupidchicken.com>

	* message.el (message-default-mail-headers):
	(message-default-headers): Carry the value mail-default-headers over
	into message-default-mail-headers, rather than message-default-headers.

2010-03-30  Martin Stjernholm  <mast@lysator.liu.se>

	* mm-decode.el (mm-add-meta-html-tag): Add option to override the
	charset.

	* gnus-art.el (gnus-article-browse-html-parts): Force the correct
	charset into the <meta> tag when the article is encoded to utf-8.

2010-03-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-browse-delete-temp-files):
	Delete directories as well.
	(gnus-article-browse-html-parts): Work for images that do not specify
	file names; delete temp directory when quitting; insert header at the
	right place; use file: scheme for image files.

2010-03-30  Eric Schulte  <schulte.eric@gmail.com>

	* gnus-art.el (gnus-article-browse-html-save-cid-image): New function.
	(gnus-article-browse-html-parts): Use it to make temporary cid image
	files in addition to html file so that browser may display them.

2010-03-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-decode.el (mm-add-meta-html-tag): Fix regexp matching meta tag.

2010-03-29  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el (auth-source-pick): Fix for non-secrets specifier.

2010-03-27  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el (auth-sources): Change default to be simpler.
	Explain about Secret Service API sources.  Improve Customize options.
	(auth-source-pick): Change to accept any number of search parameters.
	Implement fallbacks iteratively, not recursively.  Add scoring on the
	second pass and sort by score.  Call Secret Service API when needed.
	(auth-source-user-or-password): Use it.  Call Secret Service API
	directly when needed to get the user name and the password.

2010-03-24  Juanma Barranquero  <lekktu@gmail.com>

	* message.el (message-interactive): Doc fix.
	(message-qmail-inject-args): Reflow.
	(message-kill-to-signature): Fix typo in docstring.

	* smiley.el (smiley-buffer): Fix typo in docstring.

2010-03-24  Glenn Morris  <rgm@gnu.org>

	* mail-source.el (gnus-message): Declare.
	(mail-source-delete-old-incoming): Require gnus-util.

2010-03-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (canlock-verify): Autoload it for Emacs 21.

	* message.el (ecomplete-setup): Autoload it for Emacs <23.

	* mml-sec.el (mml-secure-cache-passphrase): Default to t that is
	password-cache's default if it is not bound.
	(mml-secure-passphrase-cache-expiry): Default to 16 that is
	password-cache-expiry's default if it is not bound.

	* pop3.el (pop3-list): Don't use 3rd arg of `split-string' which is not
	available in Emacs 21.

2010-03-23  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el (auth-sources): Fix up definition so extra parameters
	are always inline.

2010-03-22  Martin Stjernholm  <mast@lysator.liu.se>

	* nnimap.el (nnimap-verify-uidvalidity): Fix bug where uidvalidity
	wasn't updated after mismatch.  Clear cached mailbox info correctly
	when uidvalidity changes.
	(nnimap-group-prefixed-name): New function to avoid some code
	duplication.
	(nnimap-verify-uidvalidity, nnimap-group-overview-filename)
	(nnimap-request-group): Use it.
	(nnimap-retrieve-groups, nnimap-verify-uidvalidity)
	(nnimap-update-unseen): Significantly improved speed of Gnus startup
	with many imap folders.  This is done by caching the group status from
	the imap server persistently in a group parameter `imap-status'.  (This
	was cached before too if `nnimap-retrieve-groups-asynchronous' was set,
	but not persistently, so every Gnus startup was still very slow.)

2010-03-20  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el: Set up autoloads.  Bump to 23.2 because of the
	secrets.el dependency.
	(auth-sources): Add optional user name.  Add secrets.el configuration
	choice (unused right now).

2010-03-20  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-sum.el (gnus-summary-make-menu-bar):
	Let `gnus-registry-install-shortcuts' fill in the functions.

	* gnus-registry.el (gnus-summary-misc-menu): Declare to avoid
	warnings.
	(gnus-registry-misc-menus): Variable to hold registry mark menus.
	(gnus-registry-install-shortcuts): Populate and use it in a
	`gnus-summary-menu-hook' lambda, under "Gnus"->"Registry Marks".

2010-03-20  Martin Stjernholm  <mast@lysator.liu.se>

	* nnimap.el (nnimap-decode-group-name, nnimap-encode-group-name):
	In-place substitutions for the group name encoding/decoding.
	(nnimap-find-minmax-uid, nnimap-possibly-change-group)
	(nnimap-retrieve-headers-progress, nnimap-possibly-change-group)
	(nnimap-retrieve-headers-progress, nnimap-request-article-part)
	(nnimap-update-unseen, nnimap-request-list)
	(nnimap-retrieve-groups, nnimap-request-update-info-internal)
	(nnimap-request-set-mark, nnimap-split-to-groups)
	(nnimap-split-articles, nnimap-request-newgroups)
	(nnimap-request-create-group, nnimap-request-accept-article)
	(nnimap-request-delete-group, nnimap-request-rename-group)
	(nnimap-acl-get, nnimap-acl-edit): Use them.  Replace `mbx' with
	`encoded-mbx' for consistency.
	(nnimap-close-group): Call `imap-current-mailbox' instead of using the
	variable `imap-current-mailbox'.

	* gnus-agent.el (gnus-agent-fetch-articles, gnus-agent-fetch-headers)
	(gnus-agent-regenerate-group): Use `gnus-agent-decoded-group-name'.

2010-03-20  Bojan Petrovic  <bpetrovi@f.bg.ac.rs>

	* pop3.el (pop3-display-message-size-flag): Display message size byte
	counts during POP3 download.
	(pop3-movemail): Use it.
	(pop3-list): Implement listing of available messages.

2010-03-20  Mark Triggs  <mst@dishevelled.net>  (tiny change)

	* nnir.el (nnir-get-article-nov-override-function): New function to
	override the normal NOV retrieval.
	(nnir-retrieve-headers): Use it.

2010-03-19  Michael Albinus  <michael.albinus@gmx.de>

	* auth-source.el (netrc-machine-user-or-password): Autoload.

2010-03-19  Glenn Morris  <rgm@gnu.org>

	Stop message.el from loading about 40 libraries it doesn't always need.
	The general approach is to autoload rather than require, and to
	require in the specific functions rather than the file.  (Bug#5642)

	* gmm-utils.el: Don't require wid-edit.
	(widget-create-child-value, widget-convert, widget-default-get):
	Autoload.

	* gnus-util.el: Don't require time-date, netrc.
	(message-fetch-field, gnus-group-name-decode): Declare rather than
	autoloading.
	(gnus-fetch-field): Require message.
	(gnus-decode-newsgroups): Require gnus-group.

	* ietf-drums.el: Don't require time-date.

	* message.el: Don't require hashcash, canlock, ecomplete.
	Do require mail-utils.  Require nnheader only when compiling.
	(smtpmail-default-smtp-server): Remove declaration.
	(message-send-mail-function): Check smtpmail-default-smtp-server
	is bound rather than requiring smtpmail.
	(message-auto-save-directory, message-insert-signature):
	Use expand-file-name rather than nnheader-concat.
	(nnheader-insert-file-contents): Autoload.
	(hashcash-wait-async): Declare.
	(message-send-mail): Only call gnus-setup-posting-charset if
	gnus-group-posting-charset-alist is bound.  Require hashcash if needed.
	(message-send-mail-with-sendmail): Require sendmail.
	(canlock-password, canlock-password-for-verify): Declare.
	(message-canlock-password): Require canlock.
	(nnheader-get-report): Autoload.
	(gnus-setup-posting-charset): Declare.
	(message-send-news): Require gnus-msg.
	(message-make-references, message-make-in-reply-to): Use mail-header-id
	rather than the alias mail-header-message-id.
	(ecomplete-add-item, ecomplete-save): Declare.
	(message-put-addresses-in-ecomplete): Require ecomplete.
	(ecomplete-display-matches): Autoload.

	* mm-decode.el: Don't require mailcap, gnus-util.
	(gnus-map-function, gnus-replace-in-string, gnus-read-shell-command)
	(message-fetch-field, mailcap-parse-mailcaps, mailcap-mime-info):
	Autoload.
	(mailcap-mime-extensions): Declare.

	* mm-encode.el: Don't require mailcap.
	(mailcap-extension-to-mime): Autoload.

	* mml-sec.el: Don't require password-cache.

	* mml.el (gnus-setup-posting-charset): Declare rather than autoload.
	(mailcap-parse-mimetypes, mailcap-mime-types): Declare.
	(mml-minibuffer-read-type): Require mailcap.
	(mml-preview): Require gnus-msg.

	* mml1991.el: Require password-cache.
	(password-cache-expiry): Remove declaration.

	* mml2015.el: Require password-cache.
	(password-cache-expiry): Remove declaration.

	* nneething.el (mailcap): Require mailcap.

	* nnheader.el (declare-function): Add compatibility stub.
	(message-remove-header): Declare rather than autoload.
	(nnheader-replace-header): Require message.

	* nnimap.el (declare-function): Add compatibility stub.
	(netrc-parse, netrc-machine-user-or-password): Declare.
	(nnimap-open-connection): Require netrc.

	* nntp.el (declare-function): Add compatibility stub.
	(netrc-parse, netrc-machine, netrc-get): Declare.
	(nntp-send-authinfo): Require netrc.

	* rfc2047.el: Don't require qp.
	(quoted-printable-encode-region, quoted-printable-decode-string):
	Autoload.

	* sieve-mode.el: Don't require easymenu.
	(easy-menu-add-item): Autoload it.

	* spam-stat.el (time-to-number-of-days): Autoload it.

2010-03-17  Kevin Ryde  <user42@zip.com.au>

	* mml.el (mml-read-tag): Unquote values with `read' to reverse
	prin1 in mml-insert-tag (just stripping the quotes gave wrong
	value if any backslash escapes).

2010-03-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-util.el (mm-charset-to-coding-system): Use coding-system-from-name
	if it is available.  (bug#5647)

2010-02-26  Glenn Morris  <rgm@gnu.org>

	* message.el (message-send-mail-function): Change the default, so that
	it inherits from a customized send-mail-function.  (Bug#5643)

2010-02-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* gnus-art.el (gnus-treat-display-x-face): Don't burp if
	shell-command-to-string signals an error (bug#5299).

2010-02-24  Glenn Morris  <rgm@gnu.org>

	* message.el (message-smtpmail-send-it)
	(message-send-mail-with-mailclient): Doc fixes.

2010-02-16  Glenn Morris  <rgm@gnu.org>

	* message.el (message-default-mail-headers): Change the default value
	to ease the transition from mail-mode to message-mode.  (Bug#5555)

2010-01-17  Chong Yidong  <cyd@stupidchicken.com>

	* message.el (message-mail): Just pass yank-action on to message-setup.
	(message-setup): Handle (FUN . ARGS) form of yank-action.
	(message-with-reply-buffer, message-widen-reply)
	(message-yank-original): Handle non-buffer values of
	message-reply-buffer (Bug#4080).
	(message-setup-1): Prefer to save message-reply-buffer as a buffer.

2010-01-17  Juanma Barranquero  <lekktu@gmail.com>

	* nnmairix.el (nnmairix-group-delete-recreate-this-group):
	Fix typo in docstring.

2010-01-08  Jason Rumney  <jasonr@gnu.org>

	* sieve-manage.el (sieve-manage-parse-capability-1): Loosely match OK
	response.

2010-01-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-describe-bindings): Work for prefix keys.

	* message.el (message-check-news-header-syntax): Protect against a
	string that `rfc822-addresses' returns when parsing fails.

2010-01-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-util.el (gnus-invisible-p, gnus-next-char-property-change)
	(gnus-previous-char-property-change): New functions.

	* gnus-sum.el (gnus-forward-line-ignore-invisible): Use them.

2010-01-05  Andreas Schwab  <schwab@linux-m68k.org>

	* gnus-sum.el (gnus-forward-line-ignore-invisible): New function.
	(gnus-summary-recenter): Use it instead of forward-line.  (Bug#5257)

2010-01-02  Chong Yidong  <cyd@stupidchicken.com>

	* message.el (message-exchange-point-and-mark): Rework last change to
	avoid using optional arg of exchange-point-and-mark, for backward
	compatibility.

2010-01-01  Chong Yidong  <cyd@stupidchicken.com>

	* message.el (message-exchange-point-and-mark):
	Call exchange-point-and-mark with an argument rather than setting
	mark-active by hand (Bug#5175).

2009-12-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nntp.el (nntp-service-to-port): Work for service expressed with
	numeric string; replace [:digit:] with [0-9] for XEmacs.

2009-12-17  Glenn Morris  <rgm@gnu.org>

	* gnus-group.el (gnus-bug-group-download-format-alist):
	Change emacs entry to debbugs.gnu.org.  Bump :version.

2009-12-13  Reiner Steib  <Reiner.Steib@gmx.de>

	* mm-encode.el (mm-sign-option, mm-encrypt-option): Add :version tag.

2009-12-12  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-info): Explain why we use `Info-goto-node'.

2009-12-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* message.el (message-completion-in-region): New compatibility function.
	(message-expand-group): Use it.

2009-12-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-group.el (gnus-group-prepare-flat): Check also whether groups
	with no unread article should be listed if the 2nd arg `predicate' is
	given.

2009-11-29  Juri Linkov  <juri@jurta.org>

	* gnus-sum.el (gnus-recenter): Use `recenter-top-bottom'
	when it is fboundp in GNU Emacs 23.1.  Put `isearch-scroll' property
	on `gnus-recenter'.  (Bug#4698, Bug#4981)

2009-11-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-from-style, message-interactive)
	(message-signature): Always set default values from the corresponding
	mail-* variables.
	(message-cite-prefix-regexp, message-sendmail-envelope-from)
	(message-yank-prefix, message-indentation-spaces)
	(message-signature-file, message-default-headers): Use boundp rather
	than (featurep 'xemacs) to check if the corresponding mail-* variables
	exist.

2009-11-20  Chong Yidong  <cyd@stupidchicken.com>

	* message.el (message-send-mail-with-sendmail): Revert last change.

2009-11-19  Chong Yidong  <cyd@stupidchicken.com>

	* message.el (message-from-style, message-interactive)
	(message-cite-prefix-regexp, message-sendmail-envelope-from)
	(message-yank-prefix, message-indentation-spaces, message-signature)
	(message-signature-file, message-default-headers): For GNU Emacs, set
	default values from the corresponding mail-* variables.
	(message-send-mail-with-sendmail): Use envelope-from only if
	mail-specify-envelope-from is non-nil.

2009-11-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2047.el (rfc2047-decode-region): Don't quote decoded words
	containing tspecial characters if they have been already quoted.

2009-10-24  Glenn Morris  <rgm@gnu.org>

	* gnus-art.el (help-xref-stack-item): Define for compiler.

2009-10-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-remove-overlays): eval-and-compile.

2009-10-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-summary-show-thread): Remove useless goto-char.
	(gnus-summary-show-thread, gnus-summary-hide-thread): Indent.

2009-10-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus.el (gnus-overlay-get): New alias to overlay-get.
	(gnus-overlays-in): New alias to overlays-in.

	* gnus-sum.el (gnus-remove-overlays): Use gnus-overlays-in,
	gnus-overlay-get, and gnus-delete-overlay.
	(gnus-summary-show-thread): Make it work as well for systems in which
	next-single-char-property-change is not available.
	(gnus-summary-hide-thread): Use gnus-make-overlay and gnus-overlay-put.

2009-10-14  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-sum.el (gnus-remove-overlays): Add doc string and alias.

2009-10-14  Dan Nicolaescu  <dann@ics.uci.edu>

	* gnus-sum.el (gnus-remove-overlays): Compatibility code for Emacs 21
	and XEmacs that don't have `remove-overlays'.

2009-10-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* gnus-sum.el (gnus-summary-mode, gnus-summary-show-all-threads)
	(gnus-summary-show-thread, gnus-summary-hide-thread): Get rid of
	selective display.  Use overlays instead.

2009-10-04  Juanma Barranquero  <lekktu@gmail.com>

	* spam-stat.el (spam-stat-strip-xref): Fix typo in docstring.

2009-09-29  Juanma Barranquero  <lekktu@gmail.com>

	* spam-stat.el (spam-stat-load): Fix typo in message.

2009-09-23  Juanma Barranquero  <lekktu@gmail.com>

	* gnus-art.el (gnus-article-encrypt-body):
	* message.el (message-check-recipients):
	* mm-util.el (mm-codepage-setup):
	* nnir.el (gnus-summary-nnir-goto-thread, nnir-run-waissearch)
	(nnir-run-swish++, nnir-run-swish-e): Fix typos in error messages.

2009-09-22  Daiki Ueno  <ueno@unixuser.org>

	* mm-encode.el (mm-sign-option, mm-encrypt-option): New user option.
	* mml2015.el (mml2015-epg-sign, mml2015-epg-encrypt): Let users select
	keys from the menu if mm-{sign,encrypt}-option is 'guided.
	* mml-smime.el (mml-smime-epg-sign, mml-smime-epg-encrypt): Ditto.
	* mml1991.el (mml1991-epg-sign, mml1991-epg-encrypt): Ditto.

2009-09-18  Glenn Morris  <rgm@gnu.org>

	* gnus-diary.el (gnus-diary-check-message):
	* message.el (message-insert-formatted-citation-line):
	* nnbabyl.el (top-level):
	* nndiary.el (nndiary-schedule):
	Fix typos in condition-case handlers.

2009-09-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-edit-part): Work for the buffer
	configuration that provides the sole article window in a frame;
	position point correctly after deleting a part.

2009-09-14  Adam Sjøgren  <asjo@koldfront.dk>

	* spam.el (spam-unregister-on-reregister): Add boolean variable.
	(spam-resolve-registrations-routine): Use it to unregister articles
	that change status.

2009-09-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnrss.el (nnrss-request-article): Remove binding of
	default-enable-multibyte-characters that has gotten needless by
	the 2007-07-13 change in rfc2047-encode-message-header.

	* mml.el (mml-insert-multipart): Error on the message header.
	(mml-insert-part): Error on the message header; position point at
	the end of a MIME tag.

2009-09-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-util.el (with-no-warnings): Define it for old Emacsen.
	(gnus-float-time): Alias to float-time if it exists.

	* ecomplete.el (with-no-warnings): Define it for old Emacsen.
	(ecomplete-add-item): Don't use (featurep 'xemacs) to check if
	float-time is available; suppress compile warning for time-to-seconds.

2009-09-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-encode.el (mm-encode-buffer): Don't force 7bit encoding since MTA
	may break data.  Suggested by Dmitri Paduchikh <dpaduch@k66.ru>.
	Add the optional argument `encoding' that overrides the default.

	* mml.el (mml-generate-mime-1): Pass encoding defined by a user to
	mm-encode-buffer.

2009-09-04  Glenn Morris  <rgm@gnu.org>

	* qp.el (quoted-printable-encode-string): Use mm-enable-multibyte, or
	mm-disable-multibyte, rather than default-enable-multibyte-characters.
	* utf7.el (utf7-encode, utf7-decode): Use mm-with-multibyte-buffer, or
	mm-with-unibyte-buffer, rather than default-enable-multibyte-characters.
	* mm-util.el (mm-with-unibyte-current-buffer)
	(mm-find-buffer-file-coding-system):
	* yenc.el (yenc-decode-region): Use default-value rather than
	default-enable-multibyte-characters.

2009-09-03  Glenn Morris  <rgm@gnu.org>

	* mm-util.el (mm-emacs-mule, mm-default-multibyte-p):
	* rfc2047.el (rfc2047-encode-message-header): Use default-value rather
	than default-enable-multibyte-characters.

2009-09-02  Karl Kleinpaste  <karl@kleinpaste.org>

	* gnus-art.el (gnus-article-read-summary-keys):
	Fix gnus-buffer-configuration's value temporarily used.

2009-09-02  Glenn Morris  <rgm@gnu.org>

	* gnus-util.el (gnus-float-time): New function.
	* gnus-delay.el (gnus-delay-article):
	* gnus-sum.el (gnus-thread-latest-date):
	* gnus-util.el (gnus-user-date): Use gnus-float-time.
	* nnspool.el (nnspool-request-newgroups):
	Use gnus-float-time rather than time-to-seconds.
	* ecomplete.el (ecomplete-add-item): In Emacs, use float-time.

	* gnus-art.el (gnus-signature-face, gnus-header-from-face)
	(gnus-header-subject-face, gnus-header-newsgroups-face)
	(gnus-header-name-face, gnus-header-content-face):
	* gnus-cite.el (gnus-cite-attribution-face, gnus-cite-face-1)
	(gnus-cite-face-2, gnus-cite-face-3, gnus-cite-face-4)
	(gnus-cite-face-5, gnus-cite-face-6, gnus-cite-face-7)
	(gnus-cite-face-8, gnus-cite-face-9, gnus-cite-face-10)
	(gnus-cite-face-11):
	* gnus-picon.el (gnus-picon-xbm-face, gnus-picon-face):
	* gnus-srvr.el (gnus-server-agent-face, gnus-server-opened-face)
	(gnus-server-closed-face, gnus-server-denied-face)
	(gnus-server-offline-face):
	* gnus.el (gnus-group-news-1-face, gnus-group-news-1-empty-face)
	(gnus-group-news-2-face, gnus-group-news-2-empty-face)
	(gnus-group-news-3-face, gnus-group-news-3-empty-face)
	(gnus-group-news-4-face, gnus-group-news-4-empty-face)
	(gnus-group-news-5-face, gnus-group-news-5-empty-face)
	(gnus-group-news-6-face, gnus-group-news-6-empty-face)
	(gnus-group-news-low-face, gnus-group-news-low-empty-face)
	(gnus-group-mail-1-face, gnus-group-mail-1-empty-face)
	(gnus-group-mail-2-face, gnus-group-mail-2-empty-face)
	(gnus-group-mail-3-face, gnus-group-mail-3-empty-face)
	(gnus-group-mail-low-face, gnus-group-mail-low-empty-face)
	(gnus-summary-selected-face, gnus-summary-cancelled-face)
	(gnus-summary-high-ticked-face, gnus-summary-low-ticked-face)
	(gnus-summary-normal-ticked-face, gnus-summary-high-ancient-face)
	(gnus-summary-low-ancient-face, gnus-summary-normal-ancient-face)
	(gnus-summary-high-undownloaded-face)
	(gnus-summary-low-undownloaded-face)
	(gnus-summary-normal-undownloaded-face)
	(gnus-summary-high-unread-face, gnus-summary-low-unread-face)
	(gnus-summary-normal-unread-face, gnus-summary-high-read-face)
	(gnus-summary-low-read-face, gnus-summary-normal-read-face)
	(gnus-splash-face):
	* message.el (message-header-to-face, message-header-cc-face)
	(message-header-subject-face, message-header-newsgroups-face)
	(message-header-other-face, message-header-name-face)
	(message-header-xheader-face, message-separator-face)
	(message-cited-text-face, message-mml-face):
	* sieve-mode.el (sieve-control-commands-face)
	(sieve-action-commands-face, sieve-test-commands-face)
	(sieve-tagged-arguments-face):
	* spam.el (spam-face):
	Mark face aliases with "-face" in the name as obsolete.

2009-09-01  Glenn Morris  <rgm@gnu.org>

	* gnus-salt.el (gnus-pick-mouse-pick-region): Use forward-line rather
	than goto-line.

2009-08-31  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mml.el (mml-attach-file, mml-attach-buffer, mml-attach-external):
	Don't move point if the command is invoked inside the message header.

2009-08-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* spam.el (spam-ifile-path, spam-bogofilter-path, spam-sa-learn-path)
	(spam-ifile-database-path, spam-bsfilter-path, spam-spamassassin-path):
	* nnmail.el (nnmail-spool-file, nnmail-fix-eudora-headers):
	* nnir.el (nnir-swish-e-index-file):
	* gnus-sum.el (gnus-summary-delete-marked-as-read)
	(gnus-summary-delete-marked-with, gnus-summary-mark-as-unread-forward)
	(gnus-summary-mark-as-unread-backward, gnus-summary-mark-as-unread):
	* gnus-msg.el (gnus-inews-mark-gcc-as-read):
	* gnus-art.el (gnus-article-hide-pgp-hook, gnus-treat-strip-pgp)
	(gnus-treat-display-xface): Add Emacs version of obsolescence.

2009-08-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mml.el (mml-attach-file, mml-attach-buffer, mml-attach-external):
	Don't save excursion.

2009-08-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* nnheader.el (nnheader-find-file-noselect):
	* mm-util.el (mm-insert-file-contents):
	Use (default-value 'major-mode) instead of default-major-mode.

2009-08-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* nnrss.el (nnrss-request-article): Avoid default-fill-column.

2009-08-25  Glenn Morris  <rgm@gnu.org>

	* nnir.el (top-level): Don't require cl at run-time.
	(nnir-run-waissearch, nnir-run-swish-e, nnir-run-hyrex):
	Replace cl-function substitute with gnus-replace-in-string.
	(nnir-run-waissearch, nnir-run-swish++, nnir-run-swish-e)
	(nnir-run-hyrex, nnir-run-namazu): Replace cl-function sort* with sort.
	(nnir-run-find-grep): Replace cl-functions find-if and subseq with
	simplified expansions.

2009-08-22  Glenn Morris  <rgm@gnu.org>

	* gnus-art.el (gnus-button-patch): Use forward-line rather than
	goto-line.

2009-08-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-group.el (gnus-safe-html-newsgroups): New user option.

	* gnus-art.el (gnus-bind-safe-url-regexp): New macro.
	(gnus-mime-view-all-parts, gnus-mime-view-part-internally)
	(gnus-mm-display-part, gnus-mime-display-single)
	(gnus-mime-display-alternative): Use gnus-bind-safe-url-regexp to
	override mm-w3m-safe-url-regexp according to gnus-safe-html-newsgroups.

	* gnus-sum.el
	(gnus-mark-copied-or-moved-articles-as-expirable): New user option.
	(gnus-summary-move-article): Add expirable mark to articles copied or
	moved to group that has auto-expire turned on if the option is non-nil.

2009-07-24  Glenn Morris  <rgm@gnu.org>

	* gnus-demon.el (gnus-demon-add-nntp-close-connection):
	Fix typo.  (Bug#3903)

2009-07-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-mode-map): Bind the "e" key to
	gnus-article-read-summary-keys rather than gnus-summary-edit-article
	that should not be used for draft articles.
	(gnus-article-read-summary-keys): Use key-binding instead of lookup-key
	that has no concern in minor mode keys.
	(gnus-article-summary-command, gnus-article-summary-command-nosave):
	Abolish.

2009-07-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnrss.el (nnrss-request-article): Allow mml-to-mime to generate MIME
	article without making inquiry to a user for unknown encoding.

	* nnmaildir.el (nnmaildir--group-maxnum, nnmaildir--new-number)
	(nnmaildir--scan): Assume i-node and device number that file-attributes
	returns might be cons-cell.

2009-07-16  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el: Remove docs now in auth.texi.  Don't use
	`gnus-message' for logging.  Add new variables `auth-source-debug' and
	`auth-source-hide-passwords' and use them.

2009-07-15  Glenn Morris  <rgm@gnu.org>

	* gnus-spec.el (gnus-make-format-preserve-properties): Doc fix.

2009-07-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-group.el (gnus-group-make-rss-group): Strip newlines and
	excessive whitespace from the default values of title and description.

2009-06-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-decode.el (mm-dissect-buffer): Use message-fetch-field instead of
	mail-fetch-field to fetch Content-Description header in order to
	exclude newlines.

2009-06-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-mime-delete-part): Specify gnus-decoded as charset
	to deleted part.

2009-05-30  David Engster  <dengste@eml.cc>

	* nnmairix.el: Remove old documentation in the commentary block.
	(nnmairix-request-group): Do not update active file for nnml back ends.
	(nnmairix-retrieve-headers): Set gnus-nov-is-evil to t for nnimap back
	end so that overview files are ignored.
	(nnmairix-update-groups): Make updating the groups more robust by using
	marks.
	(nnmairix-determine-original-group-from-path): Circumvent mairix bug
	with dollar characters in message-id.

2009-04-28  Reiner Steib  <Reiner.Steib@gmx.de>

	* spam.el: Use dns-query instead of query-dns.  Was renamed on
	2008-12-25 in dns.el.

2009-04-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* rfc2047.el (rfc2047-decode-region): Don't skip past `start', which
	could happen if the text is only composed of spaces and/or tabs.

2009-03-03  Brian Sniffen  <bts@evenmere.org>  (tiny change)

	* gnus-draft.el (gnus-draft-send): Bind gnus-message-setup-hook to nil
	when sending a queued message to avoid extra mml tags.

2009-03-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mml.el (mml-insert-mime): Don't break parts that mm-uu dissected.

2009-02-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-dired.el: Remove autoload for gnus-setup-message.
	(gnus-dired-attach): Fake this-command value to prevent Gnus from
	displaying Gnus logo; always use compose-mail.

2009-02-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-dired.el: Tell autoload that gnus-setup-message is a macro.

2009-02-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-nocem.el (gnus-nocem-groups): Remove invalid NoCeM groups.
	(gnus-nocem-issuers): List currently active issuers; fix custom type.
	(gnus-nocem-verifyer): Default to gnus-nocem-epg-verify if EasyPG is
	available.
	(gnus-nocem-epg-verify): New function.

2009-02-15  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (gnus-button-alist): Recognize Konqueror info links.

2009-02-15  Glenn Morris  <rgm@gnu.org>

	* gnus-util.el (rmail-insert-rmail-file-header)
	(rmail-count-new-messages, rmail-show-message): Remove unnecessary
	autoloads.
	(rmail-default-rmail-file): Remove unnecessary declaration.
	(gnus-output-to-rmail): Handle mbox Rmail as well as Babyl Rmail.

2009-02-14  Glenn Morris  <rgm@gnu.org>

	* gnus.el (rmail-default-rmail-file): Remove declaration of deleted
	variable (only used in gnus-util, which declares it anyway).
	(rmail-output-to-rmail-file): Remove autoload of deleted function,
	which was only needed by gnus-art (changed to not use it any more).
	(rmail-insert-rmail-file-header): Remove autoload of deleted function,
	only used in gnus-util, which autoloads it itself.
	(rmail-update-summary): Fix autoload.

	* gnus-art.el (gnus-summary-save-in-mail): Use gnus-output-to-rmail
	rather than rmail-output-to-rmail-file.

2009-02-07  Glenn Morris  <rgm@gnu.org>

	* message.el (rmail-msg-restore-non-pruned-header): Remove unneeded
	autoload of function that no longer exists.
	(rmail-toggle-header): Declare.
	(message-forward-rmail-make-body): Handle mbox Rmail.

2009-01-31  Glenn Morris  <rgm@gnu.org>

	* gnus-sum.el (gnus-summary-next-article): XEmacs-friendly version of
	2009-01-09 change.

2009-01-26  Teodor Zlatanov  <tzlatanov@jumptrading.com>

	* auth-source.el (auth-source-forget-user-or-password): Clarify docs.
	(auth-source-forget-all-cached): New convenience function.
	(auth-source-user-or-password): Accept list of modes or a single mode.

	* mail-source.el (mail-source-bind, mail-source-set-1): Use list of
	auth-source modes.

	* nnimap.el (nnimap-open-connection): Use list of
	auth-source modes.

	* nntp.el (nntp-send-authinfo): Use list of
	auth-source modes.

2009-01-16  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el: Update docs to reflect epa-file-enable is to be used
	now.

2009-01-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnmail.el (nnmail-pathname-coding-system): Default to the `file-name'
	coding system in XEmacs; add a workaround for XEmacs.

2009-01-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-util.el (mm-coding-system-priorities): Protect against nil value
	of current-language-environment.

2009-01-13  Reiner Steib  <Reiner.Steib@gmx.de>

	* nnfolder.el (nnfolder-read-folder): Check if most-positive-fixnum is
	available at runtime.

2009-01-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (article-date-ut): Fix end point of narrowing.

2009-01-11  Aidan Kehoe  <kehoea@parhasard.net>

	* nnfolder.el (nnfolder-read-folder): The (lsh -1 -1) trick to generate
	the greatest positive fixnum value doesn't work under an XEmacs with
	bignum support; use the most-positive-fixnum constant instead,
	available since Emacs 21.1 with cl and XEmacs 21.1.

2009-01-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-summary-next-article): Revert last change by which
	XEmacs gets not to work.

2009-01-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-util.el (mm-coding-system-priorities): Allow the value like
	"Japanese (UTF-8)" of current-language-environment.

2009-01-09  Glenn Morris  <rgm@gnu.org>

	* gnus-sum.el (gnus-summary-next-article): Replace last-command-char
	with last-command-event.

2009-01-08  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-fix-before-sending): Amend comment.

2009-01-07  David Engster  <dengste@eml.cc>

	* gnus-msg.el (gnus-inews-do-gcc): Fix last patch to deal with
	simplified server definitions by converting it via
	gnus-server-to-method.

2009-01-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-summary-set-local-parameters): Always evaluate
	parameter's operands.

2009-01-06  David Engster  <dengste@eml.cc>

	* gnus-msg.el (gnus-inews-do-gcc): Reduce to short group name when on
	primary select method (for gnus-group-mark-article-as-read).

2009-01-06  Tassilo Horn  <tassilo@member.fsf.org>

	* gnus-art.el (gnus-treat-display-face): Fix docstring link to point to
	`(gnus)Face', not `(gnus)X-Face'.

2009-01-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-util.el (mm-ucs-to-char): New function.

	* mm-url.el (mm-url-decode-entities): Use it.

2009-01-03  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-fix-before-sending): Add `eight-bit' to
	illegible-text check.

2009-01-03  Michael Olson  <mwolson@gnu.org>

	* nnimap.el (nnimap-retrieve-headers-progress): Handle edge case where
	`headers' is nil.  This can occur if the IMAP server does not have
	permissions to read messages from a folder, but can write new messages
	to the folder.
	(nnimap-request-article-part): Do not insert `data' if it is nil.

2009-01-01  Dave Love  <fx@gnu.org>

	* nnimap.el (nnimap-find-minmax-uid): Use imap-fetch-safe.

	* nnimap.el: Fix author email.
	(nnimap-split-rule): Add FIXME comment.
	(nnimap-debug): Fix doc string.

2008-12-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-summary-set-article-display-arrow): Make
	overlay-arrow-position and overlay-arrow-string buffer-local; no need
	to check if those variables exist (first appeared in Emacs 18.50).

2008-12-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-util.el (mm-line-number-at-pos): New function.

	* spam-report.el (spam-report-process-queue): Use it.

2008-12-24  David Engster  <dengste@eml.cc>

	* gnus-sum.el (gnus-summary-set-local-parameters): Don't bind
	parameters that haven't existed as variables as buffer-local variables.

2008-12-23  Dave Love  <fx@gnu.org>

	* legacy-gnus-agent.el (gnus-agent-unlist-expire-days): Don't use
	cadar.

	* sieve-manage.el (sieve-manage-starttls-p): Rename from
	imap-starttls-p.
	(sieve-manage-starttls-open): Rename from imap-starttls-open.

2008-12-22  Reiner Steib  <Reiner.Steib@gmx.de>

	* spam-report.el (spam-report-gmane-max-requests): New constant.
	(spam-report-gmane-wait): New variable.
	(spam-report-gmane-ham, spam-report-gmane-spam)
	(spam-report-url-ping-plain, spam-report-process-queue): Wait only if
	spam-report-gmane-wait is non-nil should be sufficient to avoid DOS-ing
	the server.

	* nnheader.el (nnheader-read-timeout, nnheader-accept-process-output):
	Add explanations.

	* pop3.el (pop3-accept-process-output, pop3-read-timeout): Use
	nnheader-accept-process-output and nnheader-read-timeout if available.
	(pop3-movemail): Use it.

	* message.el (message-check-news-body-syntax): Fix signature check if
	there's an attachment.

2008-12-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-util.el: Add comments to the mm- emulating functions.

2008-12-21  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-start.el (gnus-before-startup-hook): Fix doc string.
	Reported by Stephen Berman <stephen.berman@gmx.net>.

2008-12-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-util.el (mm-substring-no-properties): New function.
	(mm-read-charset, mm-subst-char-in-string, mm-replace-in-string)
	(mm-special-display-p): Enable those lambda forms to be byte compiled.
	(mm-string-to-multibyte): Doc fix.

	* mml.el (mml-attach-file): Use mm-substring-no-properties.

2008-12-18  Reiner Steib  <Reiner.Steib@gmx.de>

	* mml.el (mml-attach-file): Strip text properties from file name.
	(Bug#1574)

2008-12-16  Glenn Morris  <rgm@gnu.org>

	* mm-util.el (mm-charset-override-alist): Declare for compiler.

2008-12-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mml.el (mml-generate-mime-1): Prefer the MIME charset that Emacs
	knows since the charset specified might be a bogus alias that
	mm-charset-synonym-alist provides.

2008-12-15  Reiner Steib  <Reiner.Steib@gmx.de>

	* mm-util.el (mm-charset-synonym-alist): Add bogus names "UTF8" and
	"ISO_8859-1".

	* gnus-start.el (gnus-backup-startup-file): Improve doc string.

2008-12-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-util.el (mm-charset-eval-alist):
	Define it before mm-charset-to-coding-system.
	(mm-charset-to-coding-system): Add optional argument `silent';
	define it before mm-charset-override-alist.
	(mm-charset-override-alist): Add `(gb2312 . gbk)' to the
	default value if it can be used in Emacs currently running;
	silence mm-charset-to-coding-system.

2008-12-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2047.el (rfc2047-charset-to-coding-system): Add new argument
	`allow-override' which says whether to use `mm-charset-override-alist'.
	(rfc2047-decode-encoded-words): Use it.

	* mm-util.el (mm-charset-override-alist): Fix custom type;
	add `(gb2312 . gbk)' to choices.

2008-12-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-view.el (mm-inline-text-html-render-with-w3m): Make it simple and
	fast.

	* gnus-art.el (gnus-article-wash-html-with-w3m): Ditto.

2008-12-04  Naohiro Aota  <nao.aota@gmail.com>

	* mm-view.el (mm-inline-text-html-render-with-w3m): Put special keymap
	on links.

	* gnus-art.el (gnus-article-wash-html-with-w3m): Ditto.

2008-12-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-idna-to-ascii-rhs-1): Protect against local
	users' addresses that don't have domain parts.
	(message-idna-to-ascii-rhs): Use message-narrow-to-headers-or-head
	rather than message-narrow-to-head since there will be the message
	header separator.

2008-12-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* nnimap.el (nnimap-retrieve-headers-progress): Don't use nnimap-demule
	since the result is inserted in a unibyte buffer anyway.
	(nnimap-demule-use-string-to-multibyte): Remove.
	(nnimap-demule): Alias it to mm-string-to-multibyte.

2008-11-29  Reiner Steib  <Reiner.Steib@gmx.de>

	* nnimap.el (nnimap-demule-use-string-to-multibyte): New temporary
	variable for debugging bug#464 and bug#1174.
	(nnimap-demule): Use it.

2008-11-24  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-score.el (gnus-score-find-trace): Handle default score in total
	score calculation correctly.

2008-11-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* message.el (message-send-mail): Just set the buffer to unibyte
	rather than use mm-with-unibyte-current-buffer which does a lot more.
	(message-send-mail-partially): Don't bother with
	mm-with-unibyte-current-buffer since it's already been made unibyte by
	message-send-mail.

2008-11-11  Teodor Zlatanov  <tzz@lifelogs.com>

	* nnrss.el (nnrss-make-hash-index): Debug message of full item.

2008-11-10  Teodor Zlatanov  <tzz@lifelogs.com>

	* netrc.el (netrc-parse): If a list is passed in as FILE, return it.

2008-11-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* starttls.el (starttls-any-program-available): Rewritten so it doesn't
	require itself and to remove `with-no-warnings'.

2008-11-03  Teodor Zlatanov  <tzz@lifelogs.com>

	* starttls.el (starttls-any-program-available): Get the name of the
	available TLS layer program.
	(starttls-open-steam-gnutls, starttls-open-stream): Put port number as
	well as the host name in the "opening" message.

	* auth-source.el (auth-source-cache, auth-source-do-cache)
	(auth-source-user-or-password): Cache passwords and logins by default,
	allow override with `auth-source-do-cache'.
	(auth-source-forget-user-or-password): Allow users to remove cache
	entries if needed.

2008-10-31  Teodor Zlatanov  <tzz@lifelogs.com>

	* ietf-drums.el (ietf-drums-remove-comments): Localize second
	condition-case to only the forward-sexp call.

2008-10-31  Teodor Zlatanov  <tzz@lifelogs.com>

	* ietf-drums.el (ietf-drums-remove-comments): Fix bug with single
	quotes contained.  Make it more robust regardless by an extra
	condition-case wrapper.

2008-10-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnml.el (nnml-request-expire-articles): Check if the function set to
	`nnmail-expiry-target' returns the symbol `delete'.

	* nnfolder.el (nnfolder-request-expire-articles): Ditto.

	* nnmail.el (nnmail-expiry-target): Fix custom type.

2008-10-02  Glenn Morris  <rgm@gnu.org>

	* mm-util.el (mm-codepage-setup): Tweak codepage error.
	Silence compiler warning.

2008-09-30  Chong Yidong  <cyd@stupidchicken.com>

	* mml.el (mml-menu): Don't assume mml2015 is bound.

2008-09-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-read-summary-keys): Check if summary window
	exists.

2008-09-27  Glenn Morris  <rgm@gnu.org>

	* gnus-util.el (mail-header-remove-comments): Autoload it.

2008-09-27  Andreas Schwab  <schwab@suse.de>

	* gnus-util.el (gnus-split-references): Strip comments.
	(gnus-parent-id): Likewise.

2008-09-26  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-confirm-send): Fix version.

2008-09-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-idna-to-ascii-rhs-1): Use
	mail-extract-address-components rather than mail-header-parse-addresses
	that is an alias by default to ietf-drums-parse-addresses that does not
	support non-ASCII names in headers' contents.

2008-09-25  Teodor Zlatanov  <tzz@lifelogs.com>

	* message.el (message-confirm-send): Fix variable documentation to
	avoid the "y/n" wording.

2008-09-25  Francis Litterio  <flitterio@gmail.com>  (tiny change)

	* message.el (message-set-auto-save-file-name): Save to a different
	filename so multiple messages (especially drafts) can be recovered.

2008-09-24  Teodor Zlatanov  <tzz@lifelogs.com>

	* message.el (message-confirm-send): Add appropriate version.

2008-09-22  Teodor Zlatanov  <tzz@lifelogs.com>

	* mm-view.el (mm-pkcs7-enveloped-magic): Fix extra parenthesis in
	defvar.

2008-09-22  Daiki Ueno  <ueno@unixuser.org>

	* mm-view.el (mm-pkcs7-signed-magic): Use literals.
	(mm-pkcs7-enveloped-magic): Ditto.

2008-09-17  Simon Josefsson  <simon@josefsson.org>

	* sieve-manage.el (sieve-manage-is-string): Accept literals too.
	Reported by Arnt Gulbrandsen <arnt@oryx.com>.

2008-09-16  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-use-long-group-names): Make t the
	default, it's better.

2008-09-11  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-sum.el (gnus-summary-insert-line): Trap errors on setting the
	summary line gnus-number property and ignore them (with a warning
	message).

2008-09-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-group.el (gnus-group-make-useful-group): Don't use the compiler
	macro caddr in the interactive form since it won't be expanded.

2008-09-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-mime-set-charset-parameters): Add new argument
	`charset'; fix name of function called recursively.
	(gnus-mime-view-part-as-charset): Don't bind gnus-newsgroup-charset.

2008-09-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-mime-strip-charset-parameters): Remove.
	(gnus-mime-set-charset-parameters): New function.
	(gnus-mime-view-part-as-charset): Use it to correctly display part
	specifying wrong charset.

2008-09-08  David Engster  <dengste@eml.cc>

	* nnmairix.el (nnmairix-create-server-and-default-group): Require match
	in completing-read for back end server.

2008-09-03  Teodor Zlatanov  <tzz@lifelogs.com>

	* message.el (message-confirm-send): New variable to confirm sending a
	message.
	(message-send): Use it.

2008-08-30  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-spec.el (gnus-parse-simple-format): Revert last patch.

2008-08-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-spec.el (gnus-parse-simple-format): Remove trailing whitespace.

2008-08-21  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-max-track-groups): New variable to
	prevent tracking too many groups.
	(gnus-registry-split-fancy-with-parent, gnus-registry-fetch-groups):
	Use it.

2008-08-11  Ralf Angeli  <angeli@caeruleus.net>

	* gnus-art.el (gnus-article-next-page): Respect `scroll-margin' when
	moving point to the bottom of the window in order to avoid recentering.

2008-08-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-next-page, gnus-article-prev-page)
	(gnus-article-next-page-1): Use compiler directive (featurep 'xemacs).
	(gnus-article-beginning-of-window): Fix calculation.

2008-08-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-msg.el (gnus-summary-supersede-article)
	(gnus-summary-resend-message-edit): Bind mail-parse-charset to the
	value of gnus-newsgroup-charset to decode non-MIME encoded text in
	message header.

2008-07-31  Dan Nicolaescu  <dann@ics.uci.edu>

	* message.el:
	* gnus-start.el:
	* gnus-registry.el: Remove VMS support.

2008-07-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2104.el (rfc2104-string-make-unibyte): Define it as a compiler
	macro.
	(rfc2104-hash): Use it.

2008-07-30  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-sum.el (gnus-summary-sort-by-most-recent-number)
	(gnus-summary-sort-by-most-recent-date): New commands.
	(gnus-summary-mode-map, gnus-summary-make-menu-bar): Add key bindings
	and menu entries.

2008-07-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-summary-save-in-pipe): Generate work buffer always;
	don't redisplay article for raw contents; remove plural articles stuff.

	* gnus-sum.el (gnus-summary-pipe-output): Pipe raw articles by symbolic
	prefix `r'; use gnus-summary-save-in-pipe directly instead of relying
	on gnus-summary-save-article; display results properly.

2008-07-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-summary-save-in-pipe): Add optional argument `raw'.

2008-07-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-summary-save-in-pipe):
	Consider gnus-save-all-headers.

2008-07-21  Dan Nicolaescu  <dann@ics.uci.edu>

	* gnus-util.el (ns-focus-frame): Remove declaration.
	(gnus-select-frame-set-input-focus): Undo previous change.  Treat ns
	like x.

2008-07-21  Thien-Thi Nguyen  <ttn@gnuvola.org>

	* rfc2104.el (rfc2104-zero): Delete defconst.
	(rfc2104-hex-alist): Likewise.
	(rfc2104-hex-to-int): Delete func.
	(rfc2104-hexstring-to-bitstring): Likewise.
	(rfc2104-nybbles): New defconst.
	(rfc2104-hash): Rewrite for speed.

2008-07-16  Glenn Morris  <rgm@gnu.org>

	* gnus-util.el (ns-focus-frame): Declare for compiler.

2008-07-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-save): Ignore gnus-visible-headers that is
	set as a group parameter.
	(gnus-summary-save-in-pipe): Work when it is called independently.
	(gnus-summary-pipe-to-muttprint): Don't modify
	gnus-summary-pipe-output-default-command.

2008-07-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* message.el (message-send-mail-with-sendmail):
	Display the error message.

2008-07-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-default-article-saver):
	Add gnus-summary-save-in-pipe to choices.
	(gnus-summary-save-in-pipe): Add :decode and :headers properties; use
	gnus-summary-pipe-output-default-command as the default command.
	(gnus-summary-pipe-to-muttprint): Update gnus-summary-muttprint-program
	instead of gnus-last-shell-command.

	* gnus-sum.el (gnus-summary-pipe-output-default-command):
	New user option.
	(gnus-summary-muttprint-program): Mention the value will be changed.
	(gnus-summary-save-article): Force showing of all headers.
	(gnus-summary-pipe-output): Work with the 2nd argument HEADERS.

2008-07-01  Rupert Swarbrick  <rswarbrick@googlemail.com>  (tiny change)

	* gnus-score.el (gnus-score-find-trace): Add "Total score" line.

2008-07-02  Juanma Barranquero  <lekktu@gmail.com>

	* nnimap.el (nnimap-id):
	* sieve-manage.el (sieve-manage-open): Doc fixes.

2008-07-02  Francesc Rocher  <rocher@member.fsf.org>

	* gnus.el (gnus-group-startup-message): Prefer SVG or PNG image,
	if available.

2008-06-25  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mm-util.el (mm-with-multibyte, mm-with-unibyte): Remove.

	* nnkiboze.el (nnkiboze-generate-group):
	Use explicit mm-disable-multibyte rather than mm-with-unibyte.

	* nnmairix.el: Require CL.

2008-06-15  David Engster  <dengste@eml.cc>

	* nnimap.el (nnimap-request-delete-group): Unselect group if necessary.

2008-06-14  Aidan Kehoe  <kehoea@parhasard.net>

	* gnus-util.el (gnus-put-display-table, gnus-get-display-table):
	New macros that expand to an `aset'/`aref' call under Emacs, and to a
	runtime choice under XEmacs.

	* gnus-sum.el (gnus-summary-set-display-table):
	Use `gnus-put-display-table', `gnus-get-display-table',
	`gnus-set-display-table' for the display table, instead of `aset'.

2008-06-14  Reiner Steib  <Reiner.Steib@gmx.de>

	* nnmairix.el: Add autoloads.

2008-06-14  Reiner Steib  <Reiner.Steib@gmx.de>

	* nnmairix.el (nnmairix-delete-recreate-group)
	(nnmairix-update-and-clear-marks): Fix error messages.

2008-06-14  David Engster  <dengste@eml.cc>

	* nnmairix.el: Upgrade to version 0.6.
	(nnmairix-group-toggle-propmarks-this-group)
	(nnmairix-group-toggle-readmarks-this-group)
	(nnmairix-group-delete-recreate-this-group)
	(nnmairix-group-toggle-allowfast-this-group, nnmairix-propagate-marks)
	(nnmairix-remove-tick-mark-original-article): New commands.
	(nnmairix-mairix-search-options, nnmairix-propagate-marks-upon-close)
	(nnmairix-propagate-marks-to-nnmairix-groups)
	(nnmairix-only-use-registry, nnmairix-allowfast-default)
	(nnmairix-marks-cache, nnmairix-version-output): New variables.
	(nnmairix-request-set-mark, nnmairix-request-update-info): New back end
	functions needed for marks propagation and manipulation of read marks.
	(nnmairix-update-groups): New function.
	(nnmairix-get-groups-from-server, nnmairix-delete-recreate-group)
	(nnmairix-determine-original-group-from-registry)
	(nnmairix-determine-original-group-from-path)
	(nnmairix-get-group-from-file-path, nnmairix-map-range)
	(nnmairix-check-mairix-version, nnmairix-group-toggle-parameter):
	New helper functions.
	(nnmairix-group-mode-hook, nnmairix-summary-mode-hook): Insert new
	keystrokes for new commands.
	(nnmairix-delete-and-create-on-change): Doc string cleanup.
	(nnmairix-request-group): Check allow-fast group parameter.
	(nnmairix-request-create-group): Set allow-fast group parameter if
	nnmairix-allowfast-default is set.
	(nnmairix-close-group): Propagate marks upon closing if needed.
	(nnmairix-group-toggle-threads-this-group): Use new.
	nnmairix-group-toggle-parameter helper function.
	(nnmairix-search): Better check for empty search result.
	(nnmairix-goto-original-article): Use new helper functions for
	determining original article.
	(nnmairix-show-original-article): Make sure message-id is in brackets.
	(nnmairix-call-mairix-binary): Change variable name.
	(nnmairix-update-and-clear-marks): Use nnmairix-delete-recreate-group
	helper function.
	(nnmairix-widget-toggle-activate): Fix doc string.

2008-06-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnir.el: Require edmacro when compiling with XEmacs.
	(nnir-run-find-grep): Don't use 3rd arg of `split-string' which is not
	available in Emacs 21.

2008-06-11  Glenn Morris  <rgm@gnu.org>

	* gnus-util.el (x-focus-frame):
	* gnus.el (image-size):
	* mm-decode.el (image-size): Declare.

	* gnus-picon.el (declare-function): Add compat definition.
	(image-size): Declare.

	* gnus-group.el (tool-bar-map):
	* gnus-sum.el (tool-bar-map): Define for compiler.

	* gnus-ems.el (gnus-x-splash): Check tool-bar-mode is bound.

	* nnfolder.el (gnus-intersection): Remove unnecessary autoload.

	* gnus-agent.el, gnus-cache.el, gnus-ems.el, gnus-group.el:
	* gnus-logic.el, gnus-msg.el, gnus-util.el, gnus.el, mail-source.el:
	* message.el, mm-decode.el, mm-encode.el, mm-view.el, mml.el:
	* mml1991.el, mml2015.el, nnfolder.el, nnheader.el, nnimap.el:
	* nnmail.el, nnml.el, nnrss.el, nntp.el, nnvirtual.el:
	* sieve-manage.el, spam-report.el, spam.el:
	Remove unnecessary eval-and-compile of autoloads.

2008-06-08  Michael Albinus  <michael.albinus@gmx.de>

	* auth-source.el: Precise Tramp doc.

2008-06-07  Glenn Morris  <rgm@gnu.org>

	* nnmairix.el: Remove unnecessary eval-when-compile.

2008-06-06  Kai Großjohann  <grossjohann@ls6.cs.uni-dortmund.de>

	* nnir.el: New file.

2008-06-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	* gnus-util.el (gnus-read-shell-command): New function.
	* mm-decode.el (mm-pipe-part):
	* gnus-art.el (gnus-summary-save-in-pipe): Use it.

2008-06-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-disassociate-draft): Revert 2008-03-18 change.

2008-06-03  Glenn Morris  <rgm@gnu.org>

	* pop3.el (nnheader-accept-process-output): Autoload it.

2008-05-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2231.el (rfc2231-decode-encoded-string): Don't decode things that
	are not 2-digit hexadecimal characters that follow `%'s.

2008-05-29  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-bogus-recipient-p): Fix type in doc string.
	Reported by Stephen Eglen <S.J.Eglen@damtp.cam.ac.uk>.
	(message-bogus-addresses): Rename from message-bogus-address-regexp.
	Improve custom options.
	(message-bogus-recipient-p): Adjust accordingly.

2008-05-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnmairix.el: Require edmacro when compiling with XEmacs.

2008-05-24  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-sum.el (gnus-summary-initial-limit): Use unless instead of if.
	(gnus-fetch-old-headers): Warn about setting it to t for Gmane groups.

2008-05-20  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el: Add more docs.

2008-05-19  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnheader.el (nnheader-read-timeout): Change the default timeout from
	0.1 seconds to 0.01 seconds.  This will make nntp and pop3 article
	retrieval faster in some cases, but might make CPU usage larger.
	If this has any bad side effects, we might revert this change.

	* pop3.el (pop3-movemail): Change the sit-for from 0.1 to 0.01, which
	seems to make mail retrieval much, much faster.
	(pop3-movemail): Use nnheader-accept-process-output instead of sleeping
	unconditionally.

	* gnus-draft.el (gnus-group-send-queue):
	Bind message-send-mail-partially-limit to nil to avoid being prompted.

2008-05-16  Reiner Steib  <Reiner.Steib@gmx.de>

	* mml.el (mml-attach-buffer): Prompt for `disposition'.

	* message.el (message-bogus-address-regexp): Fix and improve custom
	type.
	(message-setup-hook): Add message-check-recipients as custom option.

2008-05-15  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-cite-function): Remove bogus autoload which crept
	in during merge from v5-10.

2008-05-14  Teodor Zlatanov  <tzz@lifelogs.com>

	* nnimap.el (nnimap-open-connection): Fix login/password bug.

	* nnrss.el (nnrss-normalize-date): Accept Unix-style epoch timestamps.

	* auth-source.el: Preliminary Tramp docs.
	(auth-sources): Change the default auth-sources to use
	EPA .gpg files.

2008-05-09  Teodor Zlatanov  <tzz@lifelogs.com>

	* nntp.el: Autoload `auth-source-user-or-password'.
	(nntp-send-authinfo): Use it.

	* nnimap.el: Autoload `auth-source-user-or-password'.
	(nnimap-open-connection): Use it.

	* auth-source.el: Add docs on using with url-auth.  Import gnus-util
	for the gnus-message function.
	(auth-source-user-or-password): Use it.

2008-05-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* rfc2104.el (rfc2104-hexstring-to-bitstring): Rename it back from
	rfc2104-hexstring-to-byte-list.  Return a unibyte string.
	(rfc2104-hash): Use it.

2008-05-08  Juanma Barranquero  <lekktu@gmail.com>

	* gnus-art.el (gnus-article-toggle-truncate-lines):
	Don't use `iff' in docstring.

2008-05-07  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el: Adjusted copyright dates and added a keyword.

	* gnus-util.el (gnus-extract-address-component-name)
	(gnus-extract-address-component-email): Convenience functions around
	`gnus-extract-address-components'.

	* gnus-registry.el (gnus-registry-split-fancy-with-parent):
	Use `gnus-extract-address-component-email' to fix bug of comparing full
	sender name to `user-mail-address'.

2008-05-05  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-grep-in-list): Fix logic, use
	catch/throw to optimize.
	(gnus-registry-find-keywords): Just use member to find a keyword.

2008-05-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* gnus-srvr.el (gnus-enter-server-buffer): Make sure the server-buffer
	is current before calling gnus-server-prepare.
	(gnus-server-setup-buffer, gnus-server-update-server)
	(gnus-server-read-server, gnus-browse-exit): Use with-current-buffer.

2008-05-04  Juri Linkov  <juri@jurta.org>

	* mailcap.el (mailcap-replace-in-string): New compatibility alias.
	(mailcap-file-default-commands): Use mailcap-replace-in-string
	instead of replace-regexp-in-string, and mailcap-delete-duplicates
	instead of delete-dups.  Use [ \t\n]* for whitespace in regexp.

2008-05-03  Reiner Steib  <reiner.steib@gmx.de>

	* gnus-sum.el (gnus-propagate-marks): Fix custom version.

2008-05-01  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-summary-save-parts): Inhibit even more treatment
	hooks.
	(gnus-update-read-articles): Speed up non-marks-using users.
	(gnus-use-marks): Define gnus-use-marks.
	(gnus-propagate-marks): Rename variable to something more sensible.

2008-05-02  Juanma Barranquero  <lekktu@gmail.com>

	* gmm-utils.el (gmm, gmm-verbose, gmm-lazy, gmm-customize-mode)
	(gmm-image-load-path-for-library): Fix typos in docstrings.
	(gmm-message): Reflow docstring.

2008-04-28  Teodor Zlatanov  <tzz@lifelogs.com>

	* mail-source.el (mail-source-set-1, mail-source-bind):
	Move auth-source code out of the macro to clean it up and fix bugs.

2008-04-26  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-split-fancy-with-parent): Don't split
	by sender if it's equal to user-mail-address, it's likely to be
	useless.

	* mail-source.el (mail-source-bind): Don't use user or password if they
	are not bound.  Unintern them if they are nil.  Don't use server unless
	it's bound, and default it to empty string otherwise.

2008-04-25  Teodor Zlatanov  <tzz@lifelogs.com>

	* mail-source.el: Load auth-source.el.
	(mail-source-bind): Add comments.  Call auth-source-user-or-password to
	get user name or password, if auth-sources is set up.

	* gnus-registry.el (gnus-registry-split-strategy): New variable for
	strategy of splitting with parent.
	(gnus-registry-split-fancy-with-parent)
	(gnus-registry-post-process-groups): Use it and fix prior
	bug (returning a list as the split result).

	* auth-source.el (auth-sources): Remove server parameter.
	(auth-source-pick, auth-source-user-or-password)
	(auth-source-user-or-password-imap)
	(auth-source-user-or-password-pop3, auth-source-user-or-password-ssh)
	(auth-source-user-or-password-sftp)
	(auth-source-user-or-password-smtp): Remove server parameter.

2008-04-25  Juanma Barranquero  <lekktu@gmail.com>

	* smime.el (smime-sign-region, smime-encrypt-region)
	(smime-decrypt-region):
	Remove redundant calls to `generate-new-buffer-name'.

2008-04-24  Luca Capello  <luca@pca.it>  (tiny change)

	* mm-encode.el (mm-safer-encoding): Add optional argument `type'.
	Don't use QP for message/rfc822.
	(mm-content-transfer-encoding): Pass `type' to mm-safer-encoding.

2008-04-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* sieve-manage.el (sieve-string-bytes): Remove.
	(sieve-manage-putscript): Use length instead: `string-bytes' gives the
	correct byte-length only if the process's coding-system is the same as
	the one used internally by Emacs to represent strings.

2008-04-22  Juri Linkov  <juri@jurta.org>

	* mailcap.el (mailcap-file-default-commands): New function.

2008-04-13  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-signature-separator, message-cite-function):
	Change custom version.

2008-04-13  Reiner Steib  <Reiner.Steib@gmx.de>

	* mm-decode.el (mm-display-external): Make temp file read-only.

2008-04-12  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-diary.el (gnus-article-edit-mode-map, message-mode-map): Remove
	binding for `gnus-diary-version'.  Bind `gnus-diary-check-message' to
	`C-c C-f d'.

2008-04-12  Adrian Aichner  <adrian@xemacs.org>

	* gnus-sum.el (gnus-summary-goto-subject): Typo fix.

2008-04-09  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el: Add docs.
	(auth-sources): Modify format to support server.
	(auth-source-pick, auth-source-user-or-password)
	(auth-source-user-or-password-imap)
	(auth-source-user-or-password-pop3, auth-source-user-or-password-ssh)
	(auth-source-user-or-password-sftp)
	(auth-source-user-or-password-smtp): Add server parameter.

2008-04-08  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el: Initialize the registry when gnus-registry-install
	is t.

2008-04-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* compface.el (uncompface): Make buffer unibyte.

2008-04-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mail-source.el (mail-source-value):
	Prefer fboundp to functionp so it works with macros as well.

2008-04-05  Glenn Morris  <rgm@gnu.org>

	* gnus-ems.el (mm-disable-multibyte): Autoload it.

2008-04-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mm-util.el (mm-with-unibyte-buffer, mm-with-multibyte-buffer):
	Prefer mm-(en|dis)able-multibyte to default-enable-multibyte-characters.

	* nnheader.el (nnheader-init-server-buffer): Change buffer's
	multibyteness after rather than before erasing it.

	* gnus-art.el (gnus-mime-replace-part): Remove unnecessary use of
	mm-with-multibyte.
	(gnus-request-article-this-buffer): Make sure the proper decoding is
	used if gnus-original-article-buffer happens to be unibyte.

	* gnus-ems.el (gnus-x-splash): Prefer mm-disable-multibyte to
	default-enable-multibyte-characters.

	* gnus-fun.el (gnus-display-x-face-in-from): Remove unnecessary use of
	default-enable-multibyte-characters.

	* mm-decode.el (mm-inline-media-tests): Add entry for x-diff.

	* nnweb.el (nnweb-init): Avoid nn-with-unibyte.

2008-04-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* gnus-win.el (gnus-configure-frame, gnus-all-windows-visible-p):
	Fix last change in case the element is not even a symbol.

2008-04-02  Simon Josefsson  <simon@josefsson.org>

	* nnimap.el (nnimap-enable-minmax-bug-workaround): Remove, replaced by
	imap-enable-exchange-bug-workaround.
	(nnimap-find-minmax-uid): Use imap-enable-exchange-bug-workaround.

2008-04-01  Simon Josefsson  <simon@josefsson.org>

	* nnimap.el (nnimap-find-minmax-uid): Revert last fix, the "fix" turns
	a 100 byte status-checks into a 2-3MB transfer for each group.
	(nnimap-enable-minmax-bug-workaround): New variable to toggle whether
	to enable bug workaround or not.
	(nnimap-find-minmax-uid): Only enable workaround conditionally.

2008-03-31  Glenn Morris  <rgm@gnu.org>

	* message.el (mml2015-use): Declare for compiler.
	(message-info): Require mml2015 when appropriate.

2008-03-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* nntp.el (nntp-netcat-command): Rename from nntp-via-netcat-command.
	(nntp-netcat-switches): Rename from nntp-via-netcat-switches.
	(nntp-open-telnet, nntp-open-rlogin): Use with-current-buffer.
	(nntp-service-to-port): New function.
	(nntp-open-via-rlogin-and-netcat, nntp-open-via-telnet-and-telnet)
	(nntp-open-telnet-stream, nntp-open-via-rlogin-and-telnet): Use it.
	(nntp-open-netcat-stream): New function.
	(nntp-open-via-rlogin-and-netcat): Don't use a pty.

2008-03-29  Sven Joachim  <svenjoac@gmx.de>

	* gnus-sum.el (gnus-summary-make-menu-bar): Add missing dots.

2008-03-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* message.el (message-make-in-reply-to): Use mm-with-multibyte-buffer.

2008-03-28  Michael Harnois  <mdharnois@gmail.com>  (tiny change)

	* nnimap.el (nnimap-find-minmax-uid): Fix Exchange 2007 IMAP problem.

2008-03-24  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-signature-separator): Change default.
	Improve custom type.
	(message-cite-function): Change default to
	message-cite-original-without-signature.

	* gnus-sum.el (gnus-summary-make-menu-bar): Add message-cite-function
	toggle.

	* message.el (message-check-news-body-syntax): Fix signature check.
	(message-setup-1): Mark buffer as unmodified _after_ running
	message-setup-hook and handling message-alternative-emails.
	(message-shorten-references): Be more strict when building list of
	valid references to comply with GNKSA.

	* gnus-group.el (gnus-read-ephemeral-bug-group)
	(gnus-read-ephemeral-debian-bug-group)
	(gnus-read-ephemeral-emacs-bug-group): Use the correct variable.

	* message.el (message-info): Don't use booleanp which isn't supported
	in Emacs 21 and XEmacs.

2008-03-22  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-group.el (gnus-gmane-group-download-format): Rename from
	gnus-group-gmane-group-download-format.
	(gnus-group-read-ephemeral-gmane-group): Rename from
	gnus-group-read-ephemeral-gmane-group.
	(gnus-read-ephemeral-gmane-group-url): Rename from
	gnus-group-read-ephemeral-gmane-group-url.
	(gnus-bug-group-download-format-alist): New variable.
	(gnus-read-ephemeral-bug-group, gnus-read-ephemeral-debian-bug-group)
	(gnus-read-ephemeral-emacs-bug-group): New commands.

2008-03-21  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (gnus-article-browse-html-article): Fix documentation.
	(gnus-visible-headers): Improve custom type.

2008-03-20  Reiner Steib  <Reiner.Steib@gmx.de>

	* mml.el (mml-menu): Add workarounds for XEmacs.

	* gnus-art.el (gnus-article-browse-html-article): Inhibit display of
	X-Boundary header.

	* message.el (message-simplify-recipients): Fix previous commit.

2008-03-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mm-util.el (mm-set-buffer-multibyte): New function.
	* mm-decode.el (mm-copy-to-buffer): Use it.

	* gnus-win.el (gnus-configure-frame, gnus-all-windows-visible-p):
	Prefer fboundp to functionp so it works with macros as well.

2008-03-19  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-alter-recipients-discard-bogus-full-name):
	New function.
	(message-alter-recipients-function): New variable.
	(message-get-reply-headers): Use it.
	(message-replace-header): New helper function.
	(message-recipients-without-full-name): New variable.
	(message-simplify-recipients): New command.

	* mml.el (mml-menu): Add toggle for gnus-gcc-externalize-attachments.

	* message.el (message-info): Handle EasyPG manual.

	* mml.el (mml-menu): Add entry for EasyPG.

2008-03-18  Nils Ackermann  <nils@ackermath.info>  (tiny change)

	* nnmh.el (nnmh-request-expire-articles): Prefer expiry-target group
	parameter.

	* message.el (message-disassociate-draft): Specify drafts group name
	fully.

2008-03-17  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-split-fancy-with-parent):
	Eliminate unnecessary duplicates from the match list.

2008-03-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-button-handle-info-keystrokes): Don't use optional
	args of `how-many' of which the XEmacs version doesn't take; declare
	Info-index-next as function.

2008-03-16  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-score.el (gnus-score-headers): Fix handling of
	gnus-inhibit-slow-scoring.

	* gnus-art.el (gnus-article-browse-html-article): Fix type in doc
	string.
	(gnus-button-url-regexp): Improve handling of parenthesis.
	(gnus-button-alist): Extend gnus-button-handle-info-keystrokes entry.
	(gnus-button-handle-info-keystrokes): Handle index entries.

2008-03-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mail-source.el (mail-source-delete-old-incoming) Fix regexp to find
	Incoming* files.

2008-03-13  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el (auth-sources): Rename from auth-source-choices.
	(auth-source-pick): Use it.

2008-03-12  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el (auth-source-protocols)
	(auth-source-protocols-customize, auth-source-choices): Add and
	modified variable customizations and defaults.
	(auth-source-pick, auth-source-user-or-password)
	(auth-source-protocol-defaults, auth-source-user-or-password-imap)
	(auth-source-user-or-password-pop3, auth-source-user-or-password-ssh)
	(auth-source-user-or-password-sftp)
	(auth-source-user-or-password-smtp): Use new variables and provide an
	interface to netrc.el.

2008-03-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nntp.el (nntp-open-telnet-stream, nntp-open-via-rlogin-and-telnet)
	(nntp-open-via-rlogin-and-netcat, nntp-open-via-telnet-and-telnet):
	Make sure the nntp port to specify is a string.

2008-03-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* nntp.el: Use with-current-buffer.
	(nntp-send-buffer): Just set the buffer to unibyte rather than use the
	dubious mm-with-unibyte-current-buffer.
	(nntp-with-open-group-function): New function extracted from
	nntp-with-open-group macro.
	(nntp-with-open-group): Use the function, so it's easier to debug.
	Add indentation and debugging info.
	(nntp-open-telnet-stream, nntp-open-via-rlogin-and-telnet):
	Recommend the use of the netcat alternatives.

	* rfc2047.el (rfc2047-decode-string): Don't use `m'.
	Avoid mm-string-as-multibyte as well.

	* nnweb.el (nnweb-insert-html):
	Remove use of nnheader-string-as-multibyte.

	* nnheader.el (nnheader-init-server-buffer): Use with-current-buffer.
	(nnheader-string-as-multibyte): Remove.

	* mm-view.el: Use inhibit-read-only.
	(mm-inline-text-html-render-with-w3, mm-inline-message): Use dolist.
	(mm-pkcs7-signed-magic, mm-pkcs7-enveloped-magic): Use just string
	or unibyte-string.

	* mm-uu.el (mm-uu-copy-to-buffer): Preserve (uni/multi)byteness.
	(mm-uu-yenc-extract): Use with-current-buffer.

	* gnus-soup.el (gnus-soup-send-packet): Don't use
	mm-with-unibyte-current-buffer since the buffer is unibyte anyway.

	* nnmh.el: Use with-current-buffer.
	(nnmh-request-list-1): Use mm-string-to-multibyte rather than
	mm-string-as-multibyte on the output of mm-encode-coding-string.

	* nnimap.el (nnimap-retrieve-headers-progress): Use a unibyte buffer.
	(nnimap-request-move-article): Use with-current-buffer.

	* mm-decode.el (mm-with-part): Set the buffer to unibyte before
	inserting the handle-buffer's text, so the implicit multibyte->unibyte
	conversion uses string-make-unibyte rather than string-as-unibyte.

	* gnus-msg.el: Use with-current-buffer.

	* message.el (message-ignored-resent-headers): Add "Delivered-To".

2008-03-10  Daiki Ueno  <ueno@unixuser.org>

	* mml2015.el (mml2015-epg-passphrase-callback): Type cast KEY-ID to a
	string for caching if it is 'PIN.

2008-03-08  Reiner Steib  <Reiner.Steib@gmx.de>

	* mail-source.el (mail-source-delete-old-incoming-confirm):
	Change default to nil.
	(mail-source-delete-old-incoming): Make confirmation prompt more clear.

2008-03-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-narrow-to-page): Position point properly.
	(gnus-article-goto-prev-page): Work for articles having ^L's.

	* gnus-sum.el (gnus-summary-end-of-article): Remove needless narrowing.

	* mm-view.el (mm-w3m-standalone-supports-m17n-p): Fix typo.

2008-03-07  Karl Fogel  <kfogel@red-bean.com>

	* gnus-bookmark.el: Adjust for renames in bookmark.el.
	(gnus-bookmark-make-record): Was `gnus-bookmark-make-cell'.
	(gnus-bookmark-jump): Adjust some variable names.

2008-03-06  Teodor Zlatanov  <tzz@lifelogs.com>

	* auth-source.el: New package.
	(auth-source-choices): Add customization entry point variable.

	* gnus-registry.el (gnus-registry-user-format-function-M): Fix concat
	bug.

2008-03-05  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-install): Allow 'ask as an option.
	(gnus-registry-initialize, gnus-registry-install-p): Use it.
	(gnus-registry-install-shortcuts): Rename from
	gnus-registry-install-shortcuts-and-menus.  Installs the shortcuts in
	the `gnus-registry-mark-map' keymap dynamically from
	`gnus-registry-marks'.  The generated functions update the summary line
	when a registry mark is added or deleted, and will call
	`gnus-registry-install-p' (see the comments in the code).
	(gnus-registry-user-format-function-M): Use concat intelligently.

	* gnus-sum.el (gnus-summary-make-menu-bar): Add menu entries for all
	the registry mark functions.

2008-03-05  Glenn Morris  <rgm@gnu.org>

	* gnus-art.el (gnus-article-mode-line-format-alist): Move to gnus-sum.
	* gnus-sum.el (gnus-article-mode-line-format-alist): Move here from
	gnus-art.
	(top-level): No need to load own source when compiling.

2008-03-04  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-sum.el (gnus-print-buffer): Honor ps-print-color-p.
	Suggested by <chris.anderton@zetnet.co.uk>.

2008-03-04  Glenn Morris  <rgm@gnu.org>

	* gnus-sum.el (top-level): No need to require gnus when compiling,
	since unconditionally required near start of file.
	(gnus-summary-display-while-building): Move definition before use.

2008-03-04  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-user-format-function-M):
	Add formatting function.

2008-03-03  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-marks): Change format to be nicer
	with plists.
	(gnus-registry-do-marks, gnus-registry-install-shortcuts-and-menus):
	Use new format.

2008-03-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-describe-bindings): Work for the version of
	`where-is-internal' that returns a range of key sequences.

2008-03-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mm-bodies.el (mm-decode-content-transfer-encoding): Simplify.

	* gnus-sum.el: Use inhibit-read-only and with-current-buffer.
	(gnus-summary-jump-to-group): Consider windows on other displayed
	frames as well.  Similar changes might be needed elsewhere, but that's
	the one I've bumped into during my use.

	* nndoc.el (nndoc-oe-dbx-type-p):
	* gnus-msg.el (gnus-debug):
	* gnus-group.el (gnus-update-group-mark-positions):
	Use mm-string-to-multibyte.

2008-03-02  Reiner Steib  <Reiner.Steib@gmx.de>

	* mml2015.el (mml2015-extract-cleartext-signature): Explain that it
	doesn't handle NotDashEscaped.

	* mml.el (mml-menu): Improve help entries.  Move Sign/Encrypt Part.
	(mml-dnd-attach-options): Fix typo in custom choice.

	* gnus-group.el (gnus-group-read-ephemeral-gmane-group):
	Change nndoc-article-type to mbox.
	(gnus-group-read-ephemeral-gmane-group-url): Support permalink.

	* mm-decode.el (mm-text-html-renderer): Prefer w3m over w3.  Fall back
	to nil, instead of html2text.

	* imap.el (imap-debug): Add `imap-ping-server'.

	* gnus-bookmark.el: Add FIXMEs.

	* message.el (message-form-letter-separator)
	(message-send-form-letter-delay): New variables.
	(message-send-form-letter): Use them.  New command to send form
	letters.  Requested by Uwe Siart.
	(message-send-mail-function): Doc fix.  Add "Other" custom option.

2008-02-29  Andreas Seltenreich  <andreas@gate450.dyndns.org>

	* nnweb.el (nnweb-google-parse-1): Fix date parsing on articles with
	empty author.

2008-02-29  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-marks): Add variable for
	customization of marks and their appearance.
	(gnus-registry-read-mark): Use it.
	(gnus-registry-do-marks): Add utility function to loop through
	`gnus-registry-marks'.
	(gnus-registry-install-shortcuts-and-menus): Add function to install
	shortcuts and menus.
	(gnus-registry-initialize): Use it.
	(gnus-registry-default-mark): Clarify documentation.

2008-02-29  Glenn Morris  <rgm@gnu.org>

	* gnus-art.el, gnus-bookmark.el, gnus-dired.el, gnus-draft.el:
	* gnus-group.el, gnus-msg.el, gnus-score.el, gnus-sum.el, gnus-util.el:
	* gnus.el, mail-source.el, message.el, mm-decode.el, mm-uu.el, mml.el:
	* nnmail.el, pop3.el, smiley.el, smime.el, spam-report.el:
	Change defcustom :version from 23.0 to 23.1.

2008-02-28  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-follow-group-p)
	(gnus-registry-post-process-groups): Add functions to aid registry
	splitting and improve logging.  Clarify behavior in function
	documentation.
	(gnus-registry-split-fancy-with-parent): Use them.

2008-02-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* gnus-art.el: Use with-current-buffer.

2008-02-27  David Engster  <dengste@eml.cc>

	* nnmairix.el (nnmairix-request-group-with-article-number-correction):
	Express real group name in the response.

2008-02-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnmairix.el (nnmairix-group-regexp, nnmairix-valid-backends)
	(nnmairix-last-server, nnmairix-current-server): Defvar them.
	(nnmairix-goto-original-article): Defvar gnus-registry-install and
	autoload gnus-registry-fetch-group when compiling.
	(nnmairix-request-group-with-article-number-correction):
	Remove unreferenced argument passed to nnmairix-call-backend.

2008-02-27  Reiner Steib  <Reiner.Steib@gmx.de>

	* mm-uu.el (mm-uu-type-alist): Fix message-marks non-hide arguments.
	(mm-uu-extract): Improve face for low color ttys.
	Reported by Sascha Wilde.

2008-02-27  Glenn Morris  <rgm@gnu.org>

	* nnmairix.el: Change defcustom :version from 23.0 to 23.1.
	(nnmairix-group-regexp, nnmairix-valid-backends): Convert from free
	variables to defconsts.  Convert comments to doc-strings.
	(nnmairix-last-server, nnmairix-current-server): Convert from free
	variables to defvars.  Convert comments to doc-strings.
	(gnus-registry-fetch-group): Autoload.
	(nnmairix-replace-group-and-numbers): Use mapc rather than mapcar.
	(nnmairix-widget-get-values, nnmairix-widget-make-query-from-widgets)
	(nnmairix-widget-build-editable-fields): Use car cddr rather than
	caddr.
	(nnmairix-request-group): Bind nnmairix-fast and nnmairix-group around
	nnmairix-request-group-with-article-number-correction call.
	(nnmairix-fast, nnmairix-group): New, less general names, for free
	variables passed from nnmairix-request-group to
	nnmairix-request-group-with-article-number-correction.  Declare.
	(nnmairix-request-group-with-article-number-correction):
	Use nnmairix-fast, nnmairix-group rather than fast, group.

2008-02-26  David Engster  <dengste@eml.cc>

	* nnmairix.el: New file.  Mairix back end for Gnus.  Initial import of
	version 0.5.

2008-02-26  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-register-message-ids): Use `id'
	instead of making an extra function call.  Don't add the current group
	to articles only when they have the group.  Use
	`gnus-registry-fetch-groups' instead of `gnus-registry-fetch-group'.
	Reported by David <de_bb@arcor.de>.

2008-02-24  Miles Bader  <miles@gnu.org>

	* mm-util.el (mm-hack-charsets, mm-iso-8859-15-compatible)
	(mm-iso-8859-x-to-15-table, mm-iso-8859-x-to-15-region)
	(mm-find-mime-charset-region):
	* mm-bodies.el (mm-encode-body):
	* mml.el (mml-parse-1): Revert removal of `mm-hack-charsets'.

2008-02-16  Reiner Steib  <Reiner.Steib@gmx.de>

	* mail-source.el (mail-source-delete-incoming): Change default.
	Supplement doc string.

	* gnus-util.el (gnus-y-or-n-p, gnus-y-or-n-p): Update comments.

2008-02-14  Reiner Steib  <Reiner.Steib@gmx.de>

	* nnmail.el (nnmail-message-id-cache-file): Derive from
	`gnus-home-directory'.

2008-02-11  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-topic.el (gnus-topic-select-group, gnus-topic-read-group):
	Document negative prefix.

	* gnus-group.el (gnus-group-read-group): Document negative prefix.

2008-02-10  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-unsent-separator): Add the Exim bounce
	separator.

2008-02-10  Daiki Ueno  <ueno@unixuser.org>

	* mml2015.el (mml2015-epg-sign): Remove skipped signers from the signer
	list.
	(mml2015-epg-encrypt): Remove skipped recipients/signers from the
	recipient/signer list.

2008-02-10  Reiner Steib  <Reiner.Steib@gmx.de>

	* mm-util.el (mm-codepage-setup): If cp-supported-codepages isn't
	fbound (Emacs 23 unicode), signal an error.

2008-02-08  Glenn Morris  <rgm@gnu.org>

	* gnus-art.el (pgg-display-output-buffer): Declare as function.

2008-02-07  Tassilo Horn  <tassilo@member.fsf.org>

	* nnimap.el (nnimap-open-connection): Add "143" and "993" as default
	ports to the calls to `netrc-machine-user-or-password' in addition to
	"imap" and "imaps".

2008-02-03  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus.el (gnus-group-startup-message): Add `find-image' call before
	image-load-path is let-bound.  Reported by Harald Hanche-Olsen
	<hanche@math.ntnu.no>.

2008-02-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-describe-bindings): Work for draft group.

2008-02-01  Zhang Wei  <id.brep@gmail.com>

	* rfc2047.el (rfc2047-charset-encoding-alist): Add gbk and GB18030.

	* mm-util.el (mm-mime-mule-charset-alist): Add gbk and GB18030.

2008-02-01  Miles Bader  <miles@gnu.org>

	* mml.el (mml-parse-1): Remove apparently vestigial use of
	`mm-hack-charsets'.
	* mm-bodies.el (mm-encode-body): Likewise.

2008-02-01  Kenichi Handa  <handa@m17n.org>

	* rfc2104.el (rfc2104-hexstring-to-byte-list): Rename from
	rfc2104-hexstring-to-bitstring and changed to return a byte list.
	(rfc2104-hash): Convert the result of concat to unibyte string.

2008-02-01  Dave Love  <fx@gnu.org>

	* gnus-start.el (gnus-read-newsrc-el-file): Don't bind
	coding-system-for-read.
	(gnus-gnus-to-quick-newsrc-format): Insert coding cookie.

	* mm-util.el (mm-hack-charsets, mm-iso-8859-15-compatible)
	(mm-iso-8859-x-to-15-table, mm-iso-8859-x-to-15-region): Delete.
	(mm-find-mime-charset-region): Remove hack-charsets stuff.

2008-01-24  Michael Sperber  <sperber@deinprogramm.de>

	* mail-source.el (mail-sources): Add `group' choice.

	* nnmail.el (nnmail-get-new-mail-1): Abstract this out to add another
	parameter `in-group' to control into which group the articles go.
	Add treatment of `group' mail-source.

2008-01-24  Dan Nicolaescu  <dann@ics.uci.edu>

	* sieve.el (sieve-make-overlay, sieve-overlay-put, sieve-overlays-at):
	* message.el (message-beginning-of-line): Use featurep instead of bound
	tests in order to resolve conditionals at compile time.

2008-01-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-insert-mime-button): Don't decode description.

	* mm-decode.el (mm-dissect-buffer): Decode description.

	* mml.el (mml-to-mime): Encode message header first.

2008-01-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-describe-bindings): Make it possible to use
	xrefs, i.e. [back] and [forward] buttons, in *Help* buffer.

2008-01-18  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-trim): Use append, not concat.

2008-01-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-read-summary-keys): Work for some `A'
	prefix keys.
	(gnus-article-read-summary-send-keys): Use gnus-character-to-event.
	(gnus-article-describe-bindings): Simplify; move XEmacs stuff to
	gnus-xmas.el.

2008-01-16  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-marks, gnus-registry-default-mark):
	Add new variables for article mark management.
	(gnus-registry-extra-entries-precious, gnus-registry-trim): Define a
	list of extra data entries which, when present, will indicate that the
	article ID should not be trimmed from the registry.
	(gnus-registry-mark-article, gnus-registry-article-marks): Remove these
	functions.
	(gnus-registry-read-mark): New function to read a mark name from the
	user.
	(gnus-registry-set-article-mark, gnus-registry-remove-article-mark)
	(gnus-registry-set-article-mark-internal): New functions to add and
	remove marks.
	(gnus-registry-get-article-marks): New function to show the marks for
	an article, or retrieve them for further use.

2008-01-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-describe-bindings): Show all `S' prefix
	keys when no argument is given.

2008-01-12  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-sum.el (gnus-article-sort-by-random)
	(gnus-thread-sort-by-random): Fix doc strings.
	Reported by jidanni@jidanni.org.

2008-01-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-describe-bindings): New function.
	(gnus-article-read-summary-keys): Use it.
	(gnus-article-mode-map): Bind `C-h b' to it.

2008-01-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-read-summary-keys): Work for `C-h' on
	XEmacs.
	(gnus-article-describe-key, gnus-article-describe-key-briefly):
	Protect against non-character events.

2008-01-09  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-group.el (gnus-group-read-ephemeral-gmane-group-url):
	New command.
	(gnus-group-read-ephemeral-gmane-group): Use optional argument RANGE
	instead of END.  Change name of the temp file.
	(gnus-group-gmane-group-download-format): Add doc string.  Make it
	customizable.

2008-01-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-send-map): New keymap for `S' prefix keys;
	bind `S W' to gnus-article-wide-reply-with-original; set default
	binding to gnus-article-read-summary-send-keys.
	(gnus-article-read-summary-keys): Fix the order of keys; display
	continuation keys correctly in the echo area; describe bindings
	correctly when keys end with `C-h'.
	(gnus-article-read-summary-send-keys): New function.
	(gnus-article-describe-key, gnus-article-describe-key-briefly):
	Work for gnus-article-read-summary-send-keys; display continuation keys
	correctly in the echo area.
	(gnus-article-reply-with-original): Ignore prefix argument.
	(gnus-article-wide-reply-with-original): New function.

2008-01-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-bookmark.el (gnus-bookmark-mouse-available-p): Don't test for
	display-color-p.  Reported by Reiner Steib <Reiner.Steib@gmx.de>.

2008-01-06  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-group.el (gnus-group-gmane-group-download-format): New variable.
	(gnus-group-read-ephemeral-gmane-group): New command.

2008-01-06  Dan Nicolaescu  <dann@ics.uci.edu>

	* gnus.el (gnus-use-long-file-name): Remove reference to xenix.

2007-12-28  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-send-mail-function): Increase custom version.

	* mml-sec.el, sieve-manage.el, smime.el: Simplify loading of
	password-cache or password.  Suggested by Glenn Morris <rgm@gnu.org>.

2007-12-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-browse-html-parts): Work for two or more
	html parts correctly; support forwarded messages.
	(gnus-article-browse-html-article): Remove work buffers.

	* netrc.el: Bind encrypt-file-alist for Emacs 21 and XEmacs when
	compiling.
	(netrc-bound-and-true-p): New macro.
	(netrc-parse): Use it instead of bound-and-true-p that is not available
	in XEmacs 21.4.

2007-12-19  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-mark-article)
	(gnus-registry-article-marks): Add functionality to mark articles
	through the Gnus registry.

	* netrc.el: Autoload encrypt when encrypt-file-alist is set.
	(netrc-parse): Use encrypt-file-alist to determine if
	encrypt-find-model or encrypt-insert-file-contents should be used.

2007-12-19  Glenn Morris  <rgm@gnu.org>

	* mml.el (message-options-set, message-narrow-to-head)
	(message-in-body-p, message-mail-p, message-encode-message-body):
	Autoload.
	(message-remove-header, message-narrow-to-headers-or-head)
	(message-subscribed-p, message-make-mail-followup-to)
	(message-position-on-field, message-news-p)
	(message-options-set-recipient, message-generate-headers)
	(message-sort-headers): Declare as functions.

2007-12-18  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-draft.el (gnus-draft-send-message): Mention process/prefix
	convention in doc string.

2007-12-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-browse-html-parts): Add message header and
	title to html parts.
	(gnus-article-browse-html-article): Pass message header to it.

	* mm-decode.el (mm-display-external): Use mm-add-meta-html-tag.

2007-12-16  Reiner Steib  <Reiner.Steib@gmx.de>

	* mml-sec.el, sieve-manage.el, smime.el: Make loading of password-cache
	or password compatible with XEmacs.

2007-12-15  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (article-verify-x-pgp-sig): Add reference to X-PGP-Sig
	format document.
	(gnus-mime-delete-part): Don't write description line if empty.
	(gnus-article-encrypt-body): Add confirmation for gnus-novice-user.

2007-12-14  Johan Bockgård  <bojohan@gnu.org>

	* gnus-sum.el (gnus-summary-mark-unread-as-read)
	(gnus-summary-mark-read-and-unread-as-read)
	(gnus-summary-mark-current-read-and-unread-as-read)
	(gnus-summary-mark-unread-as-ticked): Doc fix.
	`gnus-mark-article-hook', not `gnus-summary-mark-article-hook'.

2007-12-14  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-sum.el (gnus-summary-prev-article): Fix doc string.
	Reported by Christoph Conrad <christoph.conrad@gmx.de>.

2007-12-14  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-util.el (gnus-y-or-n-p, gnus-yes-or-no-p): Alias to y-or-n-p and
	yes-or-no-p.

2007-12-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-decode.el (mm-add-meta-html-tag): New function.
	(mm-save-part-to-file, mm-pipe-part): Use it.

	* gnus-art.el (gnus-article-browse-delete-temp-files):
	Use gnus-y-or-n-p instead of y-or-n-p.
	(gnus-article-browse-html-parts): Work with message/external-body; use
	mm-add-meta-html-tag.

2007-12-11  Glenn Morris  <rgm@gnu.org>

	* gnus-cache.el: Require gnus-sum not just when compiling.

	* gnus-fun.el (gnus-display-x-face-in-from): Require gnus-art.

	* gnus-int.el (gnus-server-opened, gnus-status-message):
	Move definitions before use.

	* mm-decode.el: Require gnus-util.
	(mm-remove-part): Only call delete-annotation on XEmacs.

	* mm-uu.el (gnus-original-article-buffer): Define for compiler.

	* nnmail.el: Require gnus-int.

	* spam.el: Move `require's before `eval-when-compile's.

	* gnus-ems.el (gnus-alive-p):
	* gnus-fun.el (message-goto-eoh):
	* gnus-util.el (gnus-group-name-decode):
	* mail-source.el (gnus-compress-sequence):
	* message.el (Info-goto-node, format-spec):
	* mm-bodies.el (message-options-get):
	* mm-decode.el (mm-view-pkcs7):
	* mm-util.el (gmm-write-region):
	* mml-smime.el (mml-compute-boundary)
	(gnus-completing-read-with-default):
	* mml.el (widget-button-press, gnus-make-hashtable):
	* mml1991.el (mm-decode-content-transfer-encoding)
	(mm-encode-content-transfer-encoding)
	(message-options-get, message-options-set):
	* mml2015.el (gnus-buffer-live-p, gnus-get-buffer-create):
	* nnfolder.el (gnus-request-group):
	* nnheader.el (ietf-drums-unfold-fws):
	* rfc1843.el (mail-header-parse-content-type, message-narrow-to-head):
	* smime.el (gnus-run-mode-hooks):
	* spam-stat.el (gnus-message): Autoload.

	* gnus-cache.el, gnus-fun.el, gnus-group.el, gnus.el, mail-source.el:
	* mm-bodies.el, mm-decode.el, mm-extern.el, mm-util.el:
	* mml-smime.el, mml.el, mml1991.el, mml2015.el, nndb.el, nnfolder.el:
	* nnmail.el, nnmaildir.el, nnrss.el, rfc1843.el, spam.el:
	Add declare-function compatibility definition.

	* gnus-cache.el (nnvirtual-find-group-art):
	* gnus-fun.el (article-narrow-to-head, gnus-article-goto-header)
	(gnus-add-image, gnus-add-wash-type):
	* gnus-group.el (nnkiboze-score-file):
	* gnus-sum.el (turn-on-gnus-mailing-list-mode)
	(gnus-cache-write-active, mm-uu-dissect, idna-to-unicode):
	* gnus-util.el (gnus-find-method-for-group, gnus-group-name-charset)
	(message-tokenize-header, gnus-get-buffer-create)
	(mm-enable-multibyte, gnus-put-text-property, gnus-overlay-put)
	(gnus-make-overlay, mm-disable-multibyte, gnus-add-text-properties):
	* gnus.el (gnus-group-decoded-name):
	* mail-source.el (imap-capability):
	* mm-bodies.el (message-options-set):
	* mm-decode.el (gnus-configure-windows):
	* mm-extern.el (message-goto-body):
	* mm-util.el (mm-delete-duplicates, mm-detect-coding-region):
	* mml-smime.el (epg-key-sub-key-list, epg-sub-key-capability)
	(epg-sub-key-validity, message-options-set):
	* mml.el (widget-event-point, gnus-configure-windows):
	* mml1991.el (mc-encrypt-generic, gpg-sign-encrypt, gpg-encrypt):
	* mml2015.el (epg-check-configuration, epg-configuration)
	(message-options-set):
	* nndb.el (nndb-request-article):
	* nnfolder.el (gnus-request-create-group):
	* nnmail.el (gnus-activate-group, gnus-group-mark-article-read):
	* nnmaildir.el (gnus-group-mark-article-read):
	* nnrss.el (w3-parse-buffer, gnus-group-make-rss-group):
	* rfc1843.el (message-fetch-field):
	* spam.el (gnus-extract-address-components):
	Declare as functions.

2007-12-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-browse-html-parts): Decode CTE.

2007-12-09  Glenn Morris  <rgm@gnu.org>

	* gnus-uu.el (gnus-uu-yenc-article): Use insert-buffer-substring.

	* gnus-art.el, gnus-spec.el, gnus-sum.el, gnus-util.el:
	* message.el, mm-view.el, sieve-manage.el, smime.el:
	Add declare-function compatibility definition.

	* gnus-art.el (w3-region, w3m-region, Info-menu):
	* gnus-spec.el (gnus-summary-from-or-to-or-newsgroups):
	* gnus-sum.el (gnus-get-predicate):
	* gnus-util.el (mm-append-to-file, w32-focus-frame):
	* message.el (mail-abbrev-in-expansion-header-p):
	* mm-view.el (w3-do-setup, w3-region, w3-prepare-buffer)
	(w3m-detect-meta-charset, w3m-region):
	* sieve-manage.el (password-read, password-cache-add)
	(password-cache-remove):
	* smime.el (password-read-and-add): Declare as functions.

2007-12-08  David Kastrup  <dak@gnu.org>

	* gnus-sum.el (gnus-summary-simplify-subject-query):
	* ecomplete.el (ecomplete-display-matches): Fix buggy call to
	`message'.

2007-12-07  Glenn Morris  <rgm@gnu.org>

	* gnus-art.el (article-make-date-line): Revert previous change.

2007-12-06  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-start.el (gnus-load): Rename local variable to avoid confusion.

2007-12-06  Christian Plate  <cplate@web.de>  (tiny change)

	* nnmaildir.el (nnmaildir-request-update-info): Improve performance.
	Call gnus-add-to-range ranges only once with a prepared article-list.

2007-12-06  Paul Jarc  <prj@po.cwru.edu>

	* nnmaildir.el (nnmaildir-request-list, nnmaildir-retrieve-groups)
	(nnmaildir-request-group, nnmaildir-retrieve-headers): Escape spaces in
	group names with backslashes.
	Reported by Tassilo Horn <tassilo@member.fsf.org>.

2007-12-06  Deepak Goel  <deego3@gmail.com>

	* gnus-art.el (article-make-date-line):
	* gnus-start.el (gnus-load):
	* pop3.el (pop3-read-response): Fix buggy call to `error'.

2007-12-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-use-idna):
	* gnus-start.el (gnus-site-init-file):
	* message.el (message-use-idna):
	* mm-uu.el (mm-uu-hide-markers):
	* smiley.el (smiley-style): Revert changes that suppress warnings.

2007-12-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-browse-html-parts): Add meta html tag to
	specify charset to html source.
	Reported by Christoph Conrad <christoph.conrad@gmx.de>.

2007-12-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-use-idna): Don't directly refer to the value of
	idna-program in order to suppress byte compile warning issued by XEmacs
	that came to byte compile the default value section of defcustom forms
	recently.

	* gnus-start.el (gnus-site-init-file): Don't directly refer to the
	value of installation-directory.

	* message.el (message-use-idna): Don't directly refer to the value of
	idna-program.

	* mm-uu.el (mm-uu-hide-markers): Don't directly call defined-colors.

	* smiley.el (smiley-style): Don't directly call face-attribute.

2007-12-04  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-group.el (gnus-group-highlight-line): Add FIXME.

	* gnus-dired.el: Reduce Gnus dependencies.
	(gnus-ems, gnus-msg, gnus-util, message, mm-decode, mml):
	Don't require.  Use autoloads instead.
	(mml-attach-file, mm-default-file-encoding, mailcap-extension-to-mime)
	(mailcap-mime-info, mm-mailcap-command, ps-print-preprint)
	(message-buffers, gnus-setup-message, gnus-print-buffer): Autoload.
	(gnus-dired-mode): Adjust doc string.
	(gnus-dired-mail-mode): New variable.
	(gnus-dired-mode-map): Avoid using `gnus-define-keys'.
	(gnus-dired-mode): Avoid using `gnus-run-hooks'.
	(gnus-dired-mail-buffers): New function.  Return mail or message
	composition buffers.
	(gnus-dired-attach): Use it.
	(gnus-dired-find-file-mailcap): Call `mailcap-mime-info' with
	NO-DECODE.
	(gnus-dired-print): Use `gnus-print-buffer' depending on
	`gnus-dired-mail-mode'.

2007-12-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2047.el (rfc2047-encoded-word-regexp)
	(rfc2047-encoded-word-regexp-loose): Move forward; add comments
	explaining what regexp patterns are for.

2007-12-04  Glenn Morris  <rgm@gnu.org>

	* password.el: Move to ../password-cache.el.

	* mml1991.el (password-read, password-cache-add, password-cache-remove):
	* mml2015.el (password-read, password-cache-add, password-cache-remove):
	* mml-smime.el (password-read, password-cache-add)
	(password-cache-remove):
	No need to autoload, since mml-sec requires password.

	* gnus.el (gnus-spam-resend-to, gnus-ham-resend-to):
	* message.el (gnus-extract-address-components):
	* mml-smime.el (gnus-extract-address-components): Define for compiler.

	* mml-sec.el, sieve-manage.el, smime.el: Require password-cache or
	password.

2007-12-03  Reiner Steib  <Reiner.Steib@gmx.de>

	* mailcap.el: Reduce dependencies.
	(mail-header-parse-content-type): Autoload.
	(mailcap-delete-duplicates): New alias.
	(mailcap-mime-info): Add optional argument NO-DECODE.
	(mailcap-mime-types): Use mailcap-delete-duplicates.

	* message.el (message-ignored-supersedes-headers): Add "X-ID".

2007-12-03  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-uu-extract-map): Add a command for the yenc
	function.

	* gnus-uu.el (gnus-uu-decode-yenc): New command.
	(gnus-uu-yenc-article): New function.

	* yenc.el (yenc-first-part-p, yenc-last-part-p): New functions.

	* mm-uu.el (mm-uu-yenc-extract): Get the data from the original buffer.

2007-12-02  Glenn Morris  <rgm@gnu.org>

	* sasl-cram.el, sasl-digest.el, sasl-ntlm.el, sasl.el:
	Move to ../net.

	* binhex.el, uudecode.el: Move to ../mail.

	* encrypt.el: Remove file.

2007-12-01  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-cite-prefix-regexp): Remove `-' and `+' to avoid
	matches on patches.

	* gnus-art.el (gnus-article-browse-html-article):
	Mention `mm-text-html-renderer' in the doc string.

	* rfc2047.el (rfc2047-encode-max-chars): Refer to RFC 2047 in doc
	string.  Add comments.

	* message.el (message-idna-to-ascii-rhs-1): Don't call `idna-to-ascii'
	if rhs is ASCII.

2007-12-01  Glenn Morris  <rgm@gnu.org>

	* dig.el, dns.el: Move to ../net.
	* format-spec.el, hex-util.el, sha1.el: Move to ../.

	* mail-source.el (top-level): Require format-spec before
	eval-when-compile.

2007-11-30  Glenn Morris  <rgm@gnu.org>

	* encrypt.el: Require password, rather than autoloading password-read.

2007-11-28  Elias Oltmanns  <eo@nebensachen.de>

	* gnus.el (gnus-method-to-server): Add an optional parameter so the
	caller can indicate whether the cache should be disregarded for this
	call.  This way the result of the call is reproducible at all times and
	can be considered a canonical server name for the supplied method.
	(gnus-agent-method-p): Canonicalize server names by pushing their
	method through `gnus-method-to-server' using the no-cache argument.

	* gnus-srvr.el (gnus-server-insert-server-line):
	Call `gnus-method-to-server' with `no-cache' argument.

	* gnus-agent.el (gnus-agent-toggle-plugged): Don't call
	gnus-agent-possibly-synchronize-flags as this should be called when the
	server is actually being opened.
	(gnus-agent-possibly-synchronize-flags)
	(gnus-agent-possibly-synchronize-flags-server): Move check for the
	flags file of an agentized server to the latter function.

	* gnus-int.el (gnus-agent-possibly-synchronize-flags-server): Autoload.
	(gnus-open-server): Call gnus-agent-possibly-synchronize-flags-server
	after a connection has been established successfully.

2007-11-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (article-display-face): Force to display face if called
	interactively; check if gnus-article-x-face-too-ugly matches author.
	(article-display-x-face): Display face even if From header is missing
	as article-display-face does.

2007-11-28  Richard Stallman  <rms@gnu.org>

	* md4.el: Move to ../.
	* hmac-def.el, hmac-md5.el, ntlm.el: Move to ../net.

2007-11-27  Reiner Steib  <Reiner.Steib@gmx.de>

	* mail-source.el (mail-sources): Default to fetch from file for
	compatibility with default of nnmail-spool-file.

2007-11-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2047.el (rfc2047-allow-irregular-q-encoded-words): New variable.
	(rfc2047-encodable-p): Use rfc2047-encoded-word-regexp instead of "=?"
	to look for encoded word that should be encoded again.
	(rfc2047-encoded-word-regexp): Make B encoding pattern strict.
	(rfc2047-encoded-word-regexp-loose): New constant that has loose Q
	encoding pattern.
	(rfc2047-decode-region): Switch strict regexp and loose one according
	to rfc2047-allow-irregular-q-encoded-words.

2007-11-26  Simon Josefsson  <simon@josefsson.org>

	* imap.el: Move to ../net directory.

2007-11-25  Romain Francoise  <romain@orebokech.com>

	* gnus-msg.el (gnus-summary-reply): Delete extra paren.

2007-11-24  Reiner Steib  <Reiner.Steib@gmx.de>

	* nnmail.el (nnmail-spool-file): Remove obsolete variable.
	(nnmail-get-new-mail): Remove code using `nnmail-spool-file'.

	* gnus-start.el (defvar, gnus-get-unread-articles): Remove code using
	`nnmail-spool-file'.

	* nnkiboze.el (nnkiboze-generate-groups): Don't bind obsolete
	`nnmail-spool-file'.

	* gnus-move.el (gnus-change-server): Ditto.

	* gnus-kill.el (gnus-batch-score): Ditto.

	* gnus-cache.el (gnus-jog-cache): Ditto.

	* gnus-msg.el (gnus-summary-reply):
	Ignore gnus-confirm-mail-reply-to-news for wide and very wide replies.

2007-11-24  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-cache.el (gnus-cache-generate-nov-databases):
	Use nnml-generate-nov-databases-directory instead of
	nnml-generate-nov-databases-1.

2007-11-24  Glenn Morris  <rgm@gnu.org>

	* message.el (message-tool-bar-retro): Update for rename
	mail_send.xpm->mail-send.xpm.

2007-11-22  Reiner Steib  <Reiner.Steib@gmx.de>

	* smime.el (smime-cert-by-ldap-1): Use `ldap-search' instead of
	`smime-ldap-search' for Emacs 22 and up.

2007-11-22  Reiner Steib  <Reiner.Steib@gmx.de>

	* hashcash.el: Move to ../mail directory.

	* smime-ldap.el: Remove.  Not used in Emacs 22 and up.

	* smime.el (smime-cert-by-ldap-1): Use `ldap-search' instead of
	`smime-ldap-search' for Emacs 22 and up.

2007-11-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* gnus-art.el (gnus-article-truncate-lines): Use `truncate-lines'.

	* message.el (message-send-mail-function): Fix error convention.
	(message-mailer-swallows-blank-line, message-send-mail-with-sendmail)
	(message-widen-reply, message-send-mail, message-talkative-question)
	(message-with-reply-buffer, message-generate-new-buffer-clone-locals)
	(message-clone-locals, message-send-news): Use with-current-buffer.
	(message-insert-or-toggle-importance): Remove unused var `valid'.
	(message-make-references): Remove unused var `new-references'.
	(message-make-mail-followup-to): Remove unused var `subscribed-lists'.

2007-11-22  Juanma Barranquero  <lekktu@gmail.com>

	* spam.el (spam-find-spam, spam-enter-list): Doc fixes.
	(spam-split-symbolic-return-positive): Reflow docstring.
	(spam-backends, spam-summary-exit-behavior)
	(spam-mark-ham-unread-before-move-from-spam-group)
	(spam-summary-score-preferred-header, spam-sa-learn-spam-switch)
	(spam-sa-learn-ham-switch, spam-sa-learn-unregister-switch)
	(spam-clear-cache, spam-backend-check, spam-install-backend)
	(spam-install-statistical-backend, spam-list-of-processors)
	(spam-group-processor-p, spam-split, spam-bogofilter-score)
	(spam-bsfilter-score, spam-check-bsfilter, spam-crm114-score)
	(spam-check-crm114, spam-initialize, spam-unload-hook):
	Fix typos in docstrings.

2007-11-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-start.el (gnus-get-unread-articles): Mark groups as having never
	been checked if they have never been read and those group levels are
	higher than the one that a user specified.

2007-11-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-start.el (gnus-get-unread-articles): Don't prevent from checking
	foreign groups unless a group level is specified by a user.
	Reported by Dan Nicolaescu <dann@ics.uci.edu>.

2007-11-21  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-send-mail-function): Require sendmail.

2007-11-20  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-send-mail-function): Check for smtpmail too.

	* utf7.el (utf7-encode, utf7-decode): Use coding system
	`utf-7'/`utf-7-imap' from utf-7.el' if available.

	* message.el (message-send-mail-function): New function.
	(message-send-mail-function): Set default using
	message-send-mail-function.  Adjust doc string.
	(message-send-mail-with-mailclient): New function.

2007-11-17  Richard Stallman  <rms@gnu.org>

	* assistant.el: Remove file.

2007-11-16  Dan Nicolaescu  <dann@ics.uci.edu>

	* smime.el (from):
	* rfc2047.el (message-posting-charset):
	* qp.el (mm-use-ultra-safe-encoding):
	* pop3.el (parse-time-months):
	* nnrss.el (mm-text-html-renderer, mm-text-html-washer-alist):
	* nnml.el (files):
	* nnheader.el (gnus-newsgroup-name, nnheader-file-coding-system)
	(jka-compr-compression-info-list, ange-ftp-path-format)
	(efs-path-regexp):
	* nndiary.el (files):
	* mml2015.el (mc-default-scheme, mc-schemes, pgg-default-user-id)
	(pgg-errors-buffer, pgg-output-buffer, epg-user-id-alist)
	(epg-digest-algorithm-alist, inhibit-redisplay)
	(password-cache-expiry):
	* mml1991.el (pgg-default-user-id, pgg-errors-buffer)
	(pgg-output-buffer, password-cache-expiry):
	* mml.el (mml-dnd-protocol-alist, ange-ftp-name-format)
	(efs-path-regexp):
	* mml-smime.el (epg-user-id-alist, epg-digest-algorithm-alist)
	(inhibit-redisplay):
	* mm-uu.el (file-name, start-point, end-point, entry)
	(gnus-newsgroup-name, gnus-newsgroup-charset):
	* mm-util.el (mm-mime-mule-charset-alist, latin-unity-coding-systems)
	(latin-unity-ucs-list):
	* mm-bodies.el (mm-uu-yenc-decode-function, mm-uu-decode-function)
	(mm-uu-binhex-decode-function):
	* message.el (gnus-message-group-art, gnus-list-identifiers)
	(rmail-enable-mime-composing, gnus-local-organization)
	(gnus-post-method, gnus-select-method, gnus-active-hashtb)
	(gnus-read-active-file, facemenu-add-face-function)
	(facemenu-remove-face-function, gnus-article-decoded-p)
	(tool-bar-mode):
	* mail-source.el (display-time-mail-function):
	* gnus-util.el (nnmail-pathname-coding-system)
	(nnmail-active-file-coding-system, gnus-emphasize-whitespace-regexp)
	(gnus-original-article-buffer, gnus-user-agent)
	(rmail-default-rmail-file, mm-text-coding-system, tool-bar-mode)
	(xemacs-codename, sxemacs-codename, emacs-program-version):
	* gnus-sum.el (tool-bar-mode, gnus-tmp-header, number):
	* gnus-start.el (gnus-agent-covered-methods)
	(gnus-agent-file-loading-local, gnus-agent-file-loading-cache)
	(gnus-current-headers, gnus-thread-indent-array, gnus-newsgroup-name)
	(gnus-newsgroup-headers, gnus-group-list-mode)
	(gnus-group-mark-positions, gnus-newsgroup-data)
	(gnus-newsgroup-unreads, nnoo-state-alist)
	(gnus-current-select-method, mail-sources)
	(nnmail-scan-directory-mail-source-once, nnmail-split-history)
	(nnmail-spool-file, gnus-cache-active-hashtb):
	* gnus-mh.el (mh-lib-progs):
	* gnus-ems.el (gnus-tmp-unread, gnus-tmp-replied)
	(gnus-tmp-score-char, gnus-tmp-indentation, gnus-tmp-opening-bracket)
	(gnus-tmp-lines, gnus-tmp-name, gnus-tmp-closing-bracket)
	(gnus-tmp-subject-or-nil, gnus-check-before-posting, gnus-mouse-face)
	(gnus-group-buffer):
	* gnus-cite.el (font-lock-defaults-computed, font-lock-keywords)
	(font-lock-set-defaults):
	* gnus-art.el (tool-bar-map, w3m-minor-mode-map)
	(gnus-face-properties-alist, charset, gnus-summary-article-menu)
	(gnus-summary-post-menu, total-parts, type, condition, length):
	* gnus-agent.el (gnus-agent-read-agentview):
	* flow-fill.el (show-trailing-whitespace):
	* gnus-group.el (tool-bar-mode, nnrss-group-alist): Remove unnecessary
	eval-and-compile wrappers for byte compiler pacifiers.

	* mm-view.el (mm-inline-image-xemacs): Only do something for XEmacs.
	(mm-display-inline-fontify): Check for featurep 'xemacs not
	extent-list.

	* mm-decode.el (mm-display-external): Check for featurep 'xemacs not
	itimer-list.
	(mm-create-image-xemacs): Only do something for XEmacs.
	(mm-image-fit-p): Check for featurep 'xemacs not glyph-width.

	* mm-util.el (mm-find-buffer-file-coding-system): Add check for XEmacs.

	* gnus-registry.el (gnus-adaptive-word-syntax-table):
	* gnus-fun.el (gnus-face-properties-alist): Pacify byte compiler.

2007-11-15  Juanma Barranquero  <lekktu@gmail.com>

	* nnimap.el (nnimap-split-download-body):
	* gnus-demon.el (gnus-demon):
	* gnus-uu.el (gnus-uu-default-view-rules): Fix typos in docstrings.

2007-11-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nntp.el (nntp-insert-buffer-substring, nntp-copy-to-buffer):
	New macros.
	(nntp-wait-for, nntp-retrieve-articles, nntp-async-trigger)
	(nntp-retrieve-headers-with-xover): Use nntp-insert-buffer-substring to
	copy data from unibyte buffer to multibyte current buffer.
	(nntp-retrieve-headers, nntp-retrieve-groups): Use nntp-copy-to-buffer
	to copy data from unibyte current buffer to multibyte buffer.
	(nntp-make-process-buffer): Make process buffer unibyte.

	* pop3.el (pop3-open-server): Fix typo in Lisp code.

2007-11-14  Denys Duchier  <denys.duchier@univ-orleans.fr>  (tiny change)

	* pop3.el (pop3-open-server): Accept and process data more robustly at
	connection start to avoid spurious "POP SSL connection failed" errors.

2007-11-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-start.el (gnus-active-to-gnus-format): Use unibyte buffer to
	read group names.

2007-11-12  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-msg.el (gnus-confirm-mail-reply-to-news): Adjust :version.

2007-11-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnmail.el (nnmail-parse-active): Make group names unibyte.
	(nnmail-save-active): Use a unibyte buffer when saving active file,
	which may contain non-ASCII group names.

	* nnml.el (nnml-request-group): Decode group names in messages.

2007-11-05  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-citation-line-function)
	(message-insert-formatted-citation-line): Fix spelling of
	`message-insert-formated-citation-line'.

2007-11-03  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-sum.el (gnus-summary-highlight): Mark as risky local variable.

2007-11-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnml.el (nnml-request-rename-group): Bind file-name-coding-system to
	nnmail-pathname-coding-system.

	* gnus-group.el (gnus-group-rename-group): Encode non-ASCII group name
	that a user enters; decode group names in messages.

	* gnus-msg.el (gnus-inews-do-gcc): Encode non-ASCII group names.

2007-11-01  Reiner Steib  <Reiner.Steib@gmx.de>

	* mm-util.el (mm-charset-eval-alist): Mark as risky local variable.

	* gnus.el (gnus-group-charter-alist): Mark as risky local variable.

	* gnus-art.el (gnus-button-alist, gnus-header-button-alist): Mark as
	risky local variable.

	* gnus-group.el (gnus-group-icon-list): Mark as risky local variable.

2007-11-01  Teodor Zlatanov  <tzz@lifelogs.com>

	* encrypt.el: Improve documentation to fix function name typo.
	Reported by Daiki Ueno <ueno@unixuser.org>.

2007-11-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-next-page): Honor gnus-article-over-scroll
	even if the point is not in the last page of an article.
	(gnus-article-prev-page): Honor gnus-article-over-scroll when moving
	back to the previous page.

2007-10-30  Reiner Steib  <Reiner.Steib@gmx.de>

	* qp.el (quoted-printable-decode-string): Fix typo in doc string.

2007-10-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-ems.el (gnus-x-splash): Work even if there's no scroll bar.

2007-10-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* message.el (message-check-news-body-syntax):
	Avoid mm-string-as-multibyte.
	(message-hide-headers): Don't assume (point-min)==1.

2007-10-28  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-remove-blank-cited-lines): Fix if remove is
	given.
	(message-bogus-address-regexp): New variable.
	(message-bogus-recipient-p): New function.
	(message-check-recipients): New command.
	(message-syntax-checks): Add `bogus-recipient'.
	(message-fix-before-sending): Add `bogus-recipient'.

	* gnus-art.el (gnus-button-mid-or-mail-heuristic-alist): Add "alpine".
	(gnus-treat-body-boundary): Don't test window-system.

2007-10-28  Leo Liu  <sdl.web@gmail.com>  (tiny change)

	* gnus-art.el (gnus-treat-emphasize): Don't test window-system.

2007-10-28  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus.el: Bump version to Gnus v5.13.

2007-10-28  Miles Bader  <miles@gnu.org>

	* nnheader.el (nnheader-uniquify-message-id): Make sure this is defined
	at compile-time too.

2007-10-27  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-msg.el (gnus-message-setup-hook):
	Add `message-remove-blank-cited-lines' to options.

2007-10-26  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-remove-blank-cited-lines): New function.
	Suggested by Karl Plästerer.

2007-10-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* hashcash.el (mail-add-payment): Replace mapcar called for effect with
	mapc.

	* imap.el (imap-open): Replace mapcar called for effect with mapc.
	(top-level): Use mapc to set functions to be traced for debugging.

	* legacy-gnus-agent.el (gnus-agent-convert-agentview): Replace mapcar
	called for effect with while loop.

	* message.el (message-talkative-question): Replace mapcar called for
	effect with mapc.

	* mm-util.el: Use mapc instead of mapcar to make compatible functions.
	(mm-find-mime-charset-region, mm-find-charset-region): Replace mapcar
	called for effect with dolist.

	* mml.el (mml-insert-mime): Replace mapcar called for effect with mapc.

	* nndiary.el: Use dolist instead of mapcar to add diary headers to
	gnus-extra-headers and nnmail-extra-headers.

	* nnimap.el (nnimap-request-update-info-internal): Replace mapcar
	called for effect with dolist.
	(top-level): Use mapc to set functions to be traced for debugging.

	* nnmail.el (nnmail-read-incoming-hook): Doc fix.
	(nnmail-split-fancy-with-parent): Replace mapcar called for effect with
	dolist.

	* nnmaildir.el (nnmaildir--delete-dir-files, nnmaildir-request-close):
	Replace mapcar called for effect with mapc.
	(nnmaildir--scan, nnmaildir-request-scan, nnmaildir-retrieve-groups)
	(nnmaildir-request-update-info, nnmaildir-request-delete-group)
	(nnmaildir-retrieve-headers, nnmaildir-request-set-mark)
	(nnmaildir-close-group): Replace mapcar called for effect with dolist.

	* nnrss.el (nnrss-make-hash-index): Use gnus-remove-if instead of
	remove-if that's a cl function.

	* webmail.el (webmail-debug): Replace mapcar called for effect with
	dolist.

2007-10-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-agent.el (gnus-agent-read-agentview, gnus-agent-save-alist)
	(gnus-agent-expire-unagentized-dirs): Replace mapcar called for effect
	with while loop.

	* gnus-art.el: Use mapc instead of mapcar to make gnus-article-*
	functions from article-* functions.
	(gnus-multi-decode-header): Replace mapcar called for effect with
	dolist.

	* gnus-bookmark.el (gnus-bookmark-bmenu-list)
	(gnus-bookmark-show-details): Replace mapcar called for effect with
	while loop.

	* gnus-diary.el (gnus-diary-update-group-parameters): Replace mapcar
	called for effect with while loop.

	* gnus-group.el (gnus-group-suspend): Replace mapcar called for effect
	with dolist.

	* gnus-registry.el (gnus-registry-split-fancy-with-parent):
	Replace mapcar called for effect with dolist.

	* gnus-spec.el (gnus-correct-length): Make it simple and fast.

	* gnus-sum.el (gnus-multi-decode-encoded-word-string)
	(gnus-build-sparse-threads, gnus-summary-limit-include-expunged):
	Replace mapcar called for effect with dolist.
	(gnus-simplify-buffer-fuzzy): Replace mapcar called for effect with
	mapc.

	* gnus-topic.el (gnus-topic-find-groups, gnus-topic-move-group):
	Replace mapcar called for effect with dolist.
	(gnus-topic-list): Replace mapcar called for effect with mapc.

	* gnus.el: Use mapc instead of mapcar to add autoloads.

2007-10-23  Richard Stallman  <rms@gnu.org>

	* gnus-group.el (gnus-group-highlight): Mark as risky.

2007-10-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus.el (gnus-server-to-method): Return method found first in
	gnus-newsrc-alist.

	* gnus-art.el (gnus-article-highlight-signature)
	(gnus-insert-prev-page-button, gnus-insert-next-page-button): Make a
	button overlay without the front stickiness.

2007-10-22  Kevin Greiner  <kevin.greiner@compsol.cc>

	* gnus-agent.el (gnus-agent-expire-group-1): The check for an unsorted
	overview buffer needed a catch to receive its throw.
	(gnus-agent-flush-cache): Declare as interactive to make this function
	easier to use.

2007-10-20  Reiner Steib  <Reiner.Steib@gmx.de>

	* html2text.el (html2text-fix-paragraph): Use `forward-line' instead of
	`next-line'.

2007-10-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnmail.el (nnmail-fancy-expiry-target): Use rmail-dont-reply-to to
	exclude address matching message-dont-reply-to-names.

2007-10-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-util.el (gnus-string<): New function.

	* gnus-sum.el (gnus-article-sort-by-author)
	(gnus-article-sort-by-recipient, gnus-article-sort-by-subject): Use it.

2007-10-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-win.el (gnus-configure-windows): Focus on the frame for which
	the frame-focus tag is set in gnus-buffer-configuration.

2007-10-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-add-button): Make a button overlay without
	the front stickiness.

2007-10-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-button-alist): Exclude newline in RFC2396-compliant
	url pattern; remove duplicate one.
	(gnus-article-extend-url-button): New function.
	(gnus-article-add-buttons): Use it.
	(gnus-button-push): Use concatenated url that it makes.

2007-10-04  Juanma Barranquero  <lekktu@gmail.com>

	* sieve-manage.el (sieve-manage-interactive-login): Doc fix.
	(sieve-manage-open): Use `mapc' instead of `mapcar'.

2007-10-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* gnus-uu.el (gnus-uu-reginize-string, gnus-uu-expand-numbers):
	Don't hardcode point-min==1.

2007-09-30  David Kastrup  <dak@gnu.org>

	* gnus-art.el (gnus-article-reply-with-original)
	(gnus-article-followup-with-original): When `transient-mark-mode' is
	off, refrain from active-region behavior for followups.

2007-10-08  Reiner Steib  <Reiner.Steib@gmx.de>

	* mm-util.el (mm-charset-synonym-alist): Alias gbk to cp936.
	Fix comment about "iso8859-1".

2007-10-08  Daiki Ueno  <ueno@unixuser.org>

	* mm-decode.el (mm-possibly-verify-or-decrypt): Replace PARTS with the
	ones returned from the verify-function.

	* mm-uu.el (mm-uu-pgp-signed-extract-1):
	Call mml2015-extract-cleartext-signature if extraction failed.

2007-10-07  Daiki Ueno  <ueno@unixuser.org>

	* mm-uu.el (mm-uu-pgp-signed-extract-1): Delete the first line
	beginning with "-----BEGIN PGP SIGNED MESSAGE-----" if extraction
	failed.

2007-10-04  Reiner Steib  <Reiner.Steib@gmx.de>

	* Relicense "GPLv2 or later" files to "GPLv3 or later".

2007-09-27  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-sum.el (gnus-summary-kill-thread): Allow universal prefix zero
	to mark a thread as expirable.  Add variable `hide' to handle hiding of
	thread for both the null and zero (kill/expire thread) universal prefix
	cases.
	(gnus-summary-expire-thread): Add new function to expire a thread,
	using gnus-summary-kill-thread.
	(gnus-summary-mode-map, gnus-summary-thread-map): Add 'M-C-e' and 'T e'
	shortcuts for gnus-summary-expire-thread.
	(gnus-summary-mode-map, gnus-summary-thread-map): Remove `M-C-e' and `T
	e' bindings for gnus-summary-expire-thread.  Add `T E' binding.

2007-09-25  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-store-extra-entry): Allow for nil
	extras value, so an extras entry can be deleted.
	(gnus-registry-delete-extra-entry): Use it.
	(gnus-registry-fetch-extra-flags, gnus-registry-has-extra-flag)
	(gnus-registry-store-extra-flags, gnus-registry-delete-extra-flags)
	(gnus-registry-delete-all-extra-flags): Allow for arbitrary flag symbol
	storage through the gnus-registry, and provide an appropriate API for
	it.

2007-09-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-newsgroup-maximum-articles): Move from gnus.el.
	Suggested by Leo <sdl.web@gmail.com>.

	* gnus.el: Do.

2007-09-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus.el (gnus-newsgroup-maximum-articles): Rename from
	gnus-maximum-newsgroup.  Suggested by Leo <sdl.web@gmail.com>.

	* gnus-agent.el (gnus-agent-fetch-headers): Do.

	* gnus-sum.el (gnus-articles-to-read, gnus-list-of-unread-articles)
	(gnus-list-of-read-articles, gnus-sequence-of-unread-articles): Do.

2007-09-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnmbox.el (nnmbox-request-article): Don't assume delim regexp matches
	newline.
	(nnmbox-request-accept-article): Don't change article in source buffer;
	narrow to header to use message-fetch-field rather than
	nnmail-fetch-field; use with-current-buffer instead of save-excursion.
	(nnmbox-request-replace-article): Quote lines that'll be misidentified
	as delimiters; make sure article ends with newline.
	(nnmbox-delete-mail): Correct last position of article to be deleted;
	ignore X-Gnus-Newsgroup header in article body.
	(nnmbox-save-mail): Quote lines looking like delimiters at the right
	positions; make sure article ends with newline.

	* message.el (message-display-abbrev): Don't infloop when a user
	inserts SPC in the beginning of header.

2007-09-12  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-unfollowed-groups): Add INBOX to the
	list of groups not followed by default.  Fix type to be regexp.
	(gnus-registry-grep-in-list): Fix inverted parameters to string-match.

2007-09-06  Tassilo Horn  <tassilo@member.fsf.org>

	* hmac-def.el (define-hmac-function): Switch from old-style to
	new-style backquotes.

	* md4.el (md4-make-step): Likewise.

2007-09-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-start.el (gnus-gnus-to-newsrc-format): Use a unibyte buffer and
	raw-text coding system when saving .newsrc file, which may contain
	non-ASCII group names.

2007-09-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-cus.el (gnus-score-extra): New widget.
	(gnus-score-extra-convert): New function.
	(gnus-score-customize): Use it for Extra.

2007-08-31  Daiki Ueno  <ueno@unixuser.org>

	* mml2015.el (mml2015-extract-cleartext-signature): New function.
	(mml2015-mailcrypt-clear-verify): Use it.
	(mml2015-gpg-clear-verify): Use it.
	(mml2015-pgg-clear-verify): Use it.
	(mml2015-epg-clear-verify): Replace the current part with the output
	from GnuPG; don't extract the plaintext by itself.

	* mm-uu.el (mm-uu-pgp-beginning-signature): Abolish.
	(mm-uu-pgp-signed-extract-1): Bind coding-system-for-read when calling
	mml2015-clear-verify-function; don't touch the armor headers or
	dash-escaped text here.

2007-08-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-edit-part): Don't jump to nonexistent part.
	(gnus-mime-view-part-as-type-internal): Default to text/plain for text
	parts, or application/octet-stream as a last resort.
	(gnus-mime-view-part-as-type): Don't toggle display.
	(gnus-mime-view-part-as-charset): Don't turn off display before
	querying charset.

	* mm-view.el (mm-inline-text-html-render-with-w3): Don't add XEmacs
	stuff to undisplayer function in Emacs.
	(mm-inline-text-html-render-with-w3m): Remove Emacs/W3 stuff.

	* mml.el (mml-generate-mime-1): Prefer utf-8 when encoding
	text/calendar parts.

2007-08-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-mime-display-single): Use utf-8 by default for
	decoding text/calendar parts.

	* message.el (message-forward-make-body-mime): Always mark body as
	having no illegible text; remove signed-or-encrypted argument.
	(message-forward-make-body): Don't pass signed-or-encrypted arg to it.

	* mml.el (mml-generate-mime): Make sure it uses multibyte temp buffer.
	(mml-generate-mime-1): Don't encode body if it is specified to be in
	raw form; don't make buffer be unibyte when inserting multibyte string.

2007-08-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* sha1.el: Fix up comment style.
	(sha1-F0, sha1-F1, sha1-F2, sha1-F3, sha1-S1, sha1-S5, sha1-S30)
	(sha1-OP, sha1-add-to-H): Use new-style backquotes.

	* hex-util.el: Fix up comment style.
	(hex-char-to-num, num-to-hex-char): Use new-style backquotes.

	* gnus-salt.el: Use with-current-buffer.
	(gnus-pick-setup-message): Fix long-standing typo.

2007-08-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* imap.el (imap-logout-timeout): New variable.
	(imap-logout, imap-logout-wait): New functions.
	(imap-kerberos4-open, imap-gssapi-open, imap-close): Use them.

	* nnimap.el (nnimap-logout-timeout): New server variable.
	(nnimap-open-server, nnimap-close-server): Bind imap-logout-timeout to
	nnimap-logout-timeout.

	* gnus-art.el (gnus-article-summary-command-nosave)
	(gnus-article-read-summary-keys): Don't use 3rd arg of pop-to-buffer.

2007-08-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus.el (gnus-maximum-newsgroup): New variable.

	* gnus-agent.el (gnus-agent-fetch-headers): Limit the range of articles
	according to gnus-maximum-newsgroup.

	* gnus-sum.el (gnus-articles-to-read, gnus-list-of-unread-articles)
	(gnus-list-of-read-articles, gnus-sequence-of-unread-articles):
	Limit the range of articles according to gnus-maximum-newsgroup.

2007-08-14  Tassilo Horn  <tassilo@member.fsf.org>

	* gnus-art.el (gnus-sticky-article): Fix problems described in
	<b4mps1qitio.fsf@jpl.org> on ding.  Thanks to Katsumi.
	Don't perform gnus-configure-windows here; reuse existing sticky
	article buffer.

	* gnus-sum.el (gnus-summary-display-article): Setup article buffer if
	it doesn't exist in gnus-article-mode.

2007-08-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-agent.el (gnus-agent-decoded-group-names): New variable.
	(gnus-agent-decoded-group-name): New function.
	(gnus-agent-group-path, gnus-agent-group-pathname): Use it.
	(gnus-agent-expire-group-1): Use it; decode group name in messages.

2007-08-12  Tassilo Horn  <tassilo@member.fsf.org>

	* gnus-sum.el (gnus-summary-article-map, gnus-summary-make-menu-bar):
	Add binding for gnus-sticky-article.
	(gnus-summary-exit): Don't kill sticky article buffers.

	* gnus-art.el (gnus-sticky-article-mode): New mode to generate a sticky
	article buffer.
	(gnus-sticky-article, gnus-kill-sticky-article-buffer)
	(gnus-kill-sticky-article-buffers): New commands.

2007-08-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nntp.el (nntp-xref-number-is-evil): New server variable.
	(nntp-find-group-and-number): If it is non-nil, don't trust article
	numbers in the Xref header.

2007-08-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-agent.el (gnus-agent-read-group): New function.
	(gnus-agent-flush-group, gnus-agent-expire-group)
	(gnus-agent-regenerate-group): Use it.
	(gnus-agent-expire-unagentized-dirs): Bind file-name-coding-system to
	nnmail-pathname-coding-system.

2007-08-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-ems.el (gnus-x-splash): Bind inhibit-read-only to t.

	* gnus-sum.el (gnus-summary-insert-articles): Mark inserted articles
	that are unread as unread, and also as selected so that information of
	marks having been changed by a user may be updated when exiting group.

2007-08-04  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (article-hide-headers): Bind inhibit-read-only to t.

2007-08-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-mime-display-single): Pass part number that is
	calculated ignoring signature parts to gnus-treat-article.

2007-08-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-mime-security-verify-or-decrypt): Don't narrow to
	a point here in order to keep the window start.
	(gnus-insert-mime-security-button): Make a button overlay without the
	front stickiness.
	(gnus-mime-display-security): Goto the end of a button.

	* gnus-group.el (gnus-group-name-at-point): Fix regexps.

2007-08-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-group.el (gnus-group-name-at-point): Rewrite; rename from
	group-name-at-point.
	(gnus-group-completing-read): New function that offers decoded
	non-ASCII group names for completion.
	(gnus-fetch-group, gnus-group-read-ephemeral-group)
	(gnus-group-jump-to-group, gnus-group-make-group-simple)
	(gnus-group-unsubscribe-group, gnus-group-fetch-charter)
	(gnus-group-fetch-control): Use it.
	(gnus-fetch-group): Use group-name-at-point for the initial value
	rather than the default value; use gnus-alive-p.

	* gnus-msg.el (gnus-group-mail, gnus-group-news, gnus-group-post-news)
	(gnus-summary-mail-other-window, gnus-summary-news-other-window)
	(gnus-summary-post-news): Use gnus-group-completing-read.

	* gnus-sum.el (gnus-select-newsgroup): Decode group name in error msg.
	(gnus-read-move-group-name): Decode group name for completion.

2007-07-31  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-srvr.el (gnus-server-close-all-servers): Close servers not only
	in gnus-inserted-opened-servers but also in gnus-server-alist (Katsumi
	Yamaoka slightly modified the code).

2007-07-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnmail.el (nnmail-group-names-not-encoded-p): New variable.
	(nnmail-split-incoming): Bind it.

	* nnml.el (nnml-group-name-charset): New function.
	(nnml-decoded-group-name): Use it; don't decode group name if
	nnmail-group-names-not-encoded-p is non-nil.
	(nnml-encoded-group-name): New function.
	(nnml-group-pathname): Inline nnml-decoded-group-name.
	(nnml-request-expire-articles): Decode group name in message.
	(nnml-request-delete-group): Ditto; bind file-name-coding-system to
	nnmail-pathname-coding-system.
	(nnml-save-mail, nnml-active-number): Work with decoded group names and
	not decoded ones according to nnmail-group-names-not-encoded-p.
	(nnml-generate-active-info): Use nnml-encoded-group-name.

2007-08-08  Glenn Morris  <rgm@gnu.org>

	* gmm-utils.el, gnus-async.el, gnus-msg.el, gnus-score.el
	* gnus-util.el, imap.el, mailcap.el, nnimap.el: Replace `iff' in
	doc-strings and comments.

2007-07-25  Glenn Morris  <rgm@gnu.org>

	* Relicense all FSF files to GPLv3 or later.

2007-07-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-summary-move-article):
	Make gnus-summary-respool-article work.

2007-07-21  Reiner Steib  <Reiner.Steib@gmx.de>

	* mm-uu.el (mm-uu-type-alist): Refer to mm-uu-configure-list in doc
	string.

2007-07-20  Michaël Cadilhac  <michael@cadilhac.name>

	* nnrss.el (nnrss-ignore-article-fields): New variable.  List of fields
	that should be ignored when comparing distant RSS articles with local
	ones.
	(nnrss-make-hash-index): New function.  Create a hash index according
	to the ignored fields.
	(nnrss-check-group): Use it.

2007-07-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-agent.el (gnus-agent-group-pathname): Take notice of the method.

	* gnus-art.el (article-decode-group-name): Decode Xref header too.

	* gnus-group.el (gnus-group-make-group): Encode group name here unless
	the new optional argument ENCODED is non-nil.
	(gnus-group-make-doc-group): Use gnus-group-name-charset to determine
	coding system for encoding group name.
	(gnus-group-make-rss-group): Pass un-encoded group name to
	gnus-group-make-group.
	(gnus-group-set-info): Tell gnus-group-make-group that group name is
	encoded.

	* gnus-sum.el (gnus-summary-move-article, gnus-read-move-group-name):
	Encode group name to which articles are moved or copied.
	(gnus-summary-edit-article): Use gnus-group-name-charset to determine
	coding system for encoding Newsgroup, Followup-To and Xref headers.

	* nnagent.el (nnagent-request-set-mark): Use unibyte buffer to compose
	marks; use nnheader-file-coding-system to write a file.
	(nnagent-retrieve-headers): Bind file-name-coding-system to
	nnmail-pathname-coding-system.

	* nnmail.el (nnmail-insert-xref): Don't break non-ASCII group name.

	* nnml.el (nnml-decoded-group-name, nnml-group-pathname): New functions.
	(nnml-request-article, nnml-request-create-group)
	(nnml-request-rename-group, nnml-find-id)
	(nnml-possibly-change-directory, nnml-possibly-create-directory)
	(nnml-save-mail, nnml-active-number, nnml-marks-changed-p)
	(nnml-save-marks): Use nnml-group-pathname instead of
	nnmail-group-pathname.

	(nnml-request-create-group, nnml-request-expire-articles)
	(nnml-request-move-article, nnml-request-delete-group)
	(nnml-deletable-article-p, nnml-possibly-create-directory)
	(nnml-get-nov-buffer, nnml-generate-nov-databases-directory)
	(nnml-open-marks): Bind file-name-coding-system to
	nnmail-pathname-coding-system.

	(nnml-request-article): Pass server argument to nnml-find-group-number.
	(nnml-request-create-group, nnml-active-number, nnml-save-marks):
	Pass server argument to nnml-possibly-create-directory.
	(nnml-request-accept-article): Pass server argument to
	nnml-active-number and nnml-save-mail.
	(nnml-find-group-number): Pass server argument to nnml-find-id.
	(nnml-request-update-info): Pass server argument to
	nnml-marks-changed-p.

	(nnml-find-id, nnml-find-group-number, nnml-possibly-create-directory)
	(nnml-save-mail, nnml-active-number): Add server argument.

	(nnml-request-delete-group): Warn if group is missing.
	(nnml-get-nov-buffer): Decode group name.
	(nnml-generate-active-info): Encode group name.
	(nnml-open-marks): Decode group name in messages.

2007-07-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-part-wrapper): Work with the nearest part
	if it is not specified.
	(gnus-article-pipe-part, gnus-article-save-part)
	(gnus-article-interactively-view-part, gnus-article-copy-part)
	(gnus-article-view-part-as-charset, gnus-article-view-part-externally)
	(gnus-article-inline-part, gnus-article-save-part-and-strip)
	(gnus-article-replace-part, gnus-article-delete-part)
	(gnus-article-view-part-as-type): Pass raw prefix argument to
	gnus-article-part-wrapper.

2007-07-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-agent.el (gnus-agent-save-active):
	Bind nnheader-file-coding-system to gnus-agent-file-coding-system.

	* gnus-cache.el (gnus-cache-save-buffers)
	(gnus-cache-possibly-enter-article, gnus-cache-request-article)
	(gnus-cache-retrieve-headers, gnus-cache-change-buffer)
	(gnus-cache-possibly-remove-article, gnus-cache-articles-in-group)
	(gnus-cache-braid-nov, gnus-cache-braid-heads)
	(gnus-cache-generate-active, gnus-cache-rename-group)
	(gnus-cache-delete-group, gnus-cache-update-file-total-fetched-for)
	(gnus-cache-update-overview-total-fetched-for):
	Bind file-name-coding-system to nnmail-pathname-coding-system.
	(gnus-cache-decoded-group-names, gnus-cache-unified-group-names):
	New variables.
	(gnus-cache-decoded-group-name): New function.
	(gnus-cache-file-name): Use it.
	(gnus-cache-generate-active): Use non-decoded group name for active.

	* gnus-util.el (gnus-write-buffer): Bind file-name-coding-system at the
	right place.
	(gnus-write-active-file): Don't break non-ASCII group names.

	* nntp.el (nntp-marks-changed-p): Bind file-name-coding-system to
	nnmail-pathname-coding-system.

	* gnus-uu.el (gnus-uu-decode-save): Typo.

2007-07-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-srvr.el (gnus-server-font-lock-keywords): Quote faces.

2007-07-14  David Kastrup  <dak@gnu.org>

	* gnus-art.el (gnus-mime-delete-part): Don't go through article-edit
	finishing actions if we did not edit the article.

2007-07-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-agent.el (gnus-agent-rename-group, gnus-agent-delete-group)
	(gnus-agent-fetch-articles, gnus-agent-unfetch-articles)
	(gnus-agent-crosspost, gnus-agent-backup-overview-buffer)
	(gnus-agent-flush-group, gnus-agent-flush-cache)
	(gnus-agent-fetch-headers, gnus-agent-load-alist)
	(gnus-agent-read-agentview, gnus-agent-expire-group-1)
	(gnus-agent-retrieve-headers, gnus-agent-request-article)
	(gnus-agent-regenerate-group)
	(gnus-agent-update-files-total-fetched-for)
	(gnus-agent-update-view-total-fetched-for):
	Bind file-name-coding-system to nnmail-pathname-coding-system.
	(gnus-agent-group-pathname): Don't encode file names by
	nnmail-pathname-coding-system.
	(gnus-agent-save-local): Bind file-name-coding-system correctly; bind
	coding-system-for-write instead of buffer-file-coding-system to
	gnus-agent-file-coding-system.

	* gnus-msg.el (gnus-inews-make-draft, gnus-inews-insert-archive-gcc):
	Decode group name.

	* gnus-srvr.el (gnus-browse-foreign-server): Make group names unibyte.

	* gnus-start.el (gnus-update-active-hashtb-from-killed)
	(gnus-read-newsrc-el-file): Make group names unibyte.

	* nnmail.el (nnmail-group-pathname): Don't encode file names by
	nnmail-pathname-coding-system.

	* nnrss.el (nnrss-file-coding-system): Doc fix; make it begin with *.
	(nnrss-request-delete-group): Bind file-name-coding-system to
	nnmail-pathname-coding-system.
	(nnrss-read-server-data, nnrss-read-group-data):
	Bind file-name-coding-system correctly.
	(nnrss-check-group): Pass nnrss-file-coding-system to md5.

	* nntp.el: Require gnus-group for the function gnus-group-name-charset.
	(nntp-server-to-method-cache): New variable.
	(nntp-group-pathname): New function that decodes non-ASCII group names.
	(nntp-possibly-create-directory, nntp-marks-changed-p)
	(nntp-save-marks, nntp-open-marks): Use it.
	(nntp-possibly-create-directory, nntp-open-marks):
	Bind file-name-coding-system to nnmail-pathname-coding-system.
	(nntp-open-marks): Decode group names when bootstrapping marks.

	* rfc2047.el (rfc2047-encode-message-header): Make XEmacs decode
	Newsgroups and Followup-To headers.

2007-07-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-srvr.el (gnus-server-agent-face, gnus-server-opened-face)
	(gnus-server-closed-face, gnus-server-denied-face)
	(gnus-server-offline-face): Remove variable.
	(gnus-server-font-lock-keywords): Use faces that are not aliases.

	* gnus-util.el (gnus-message-with-timestamp-1): Use log-message instead
	of modifying message-stack directly for XEmacs.

	* mm-util.el (mm-decode-coding-string, mm-encode-coding-string)
	(mm-decode-coding-region, mm-encode-coding-region): Don't modify string
	if the coding-system argument is nil for XEmacs.

	* nnrss.el (nnrss-compatible-encoding-alist): Inherit the value of
	mm-charset-override-alist.

	* rfc2047.el: Don't require base64; require rfc2045 for the function
	rfc2045-encode-string.
	(rfc2047-encode-parameter): Use rfc2045-encode-string to quote or not
	to quote the parameter value.

2007-07-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-group.el (gnus-group-name-charset): Allow a method of the short
	form in gnus-group-name-charset-method-alist.

	* gnus-eform.el (gnus-edit-form): Add optional argument layout which
	overrides the default layout edit-form.

	* gnus-win.el (gnus-buffer-configuration): Add edit-server.

	* gnus-srvr.el (gnus-server-edit-server): Use edit-server layout.

2007-07-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-summary-catchup): Don't recognize cached articles
	as unfetched articles.

2007-07-02  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-start.el (gnus-level-unsubscribed): Improve doc string.

2007-07-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnagent.el (nnagent-request-set-mark): Also set the marks for the
	original back end that keeps marks in the local system.

2007-06-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-summary-command-nosave): Don't set the 3rd
	arg of pop-to-buffer for XEmacs.
	(gnus-article-read-summary-keys): Ditto; don't restore window
	configuration if summary command ends up with neither article buffer
	nor summary buffer; describe bindings if summary keys end with C-h.

2007-06-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-fix-before-sending): Skip raw message part to be
	forwarded while checking illegible text.
	(message-forward-make-body-mime, message-forward-make-body):
	Mark signed or encrypted raw message as having no illegible text.

2007-06-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-util.el (gnus-add-timestamp-to-message): New user option.
	(gnus-message-with-timestamp-1): New macro.
	(gnus-message-with-timestamp): New function.
	(gnus-message): Use them.

	* nnheader.el (nnheader-message): Use them.

2007-06-16  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-start.el (gnus-gnus-to-quick-newsrc-format): Add newlines to
	.newsrc.eld file.

2007-06-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-agent.el (gnus-agent-fetch-headers)
	(gnus-agent-retrieve-headers):
	Bind gnus-decode-encoded-address-function to identity.

	* nntp.el (nntp-send-xover-command): Recognize an xover command is
	available also when the server returns simply a dot.

	* gnus-ems.el (gnus-x-splash): Redisplay window before measuring it.

2007-06-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-ems.el (gnus-x-splash): Fix calculation; error in tty.

2007-06-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-ems.el (gnus-x-splash): Make it work.

	* gnus-start.el (gnus-1): Relax restrictions that prevent gnus-x-splash
	from being used.

2007-06-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-insert-mime-button): Make a button overlay without
	the front stickiness.
	(gnus-article-summary-command-nosave): Correct the order of the
	arguments passed to pop-to-buffer.
	(gnus-article-read-summary-keys): Ditto; make it work properly when the
	summary command ends up with the article buffer.

	* mm-decode.el (mm-insert-part): Separate the extracted parts that have
	the same faces.

2007-06-07  Juanma Barranquero  <lekktu@gmail.com>

	* gnus-art.el (gnus-split-methods): Fix typo in docstring.

2007-06-06  Juanma Barranquero  <lekktu@gmail.com>

	* gnus-diary.el (gnus-diary-time-format, gnus-summary-sort-by-schedule):
	* gnus-sum.el (gnus-summary-highlight):
	* mail-source.el (mail-source-delete-old-incoming-confirm):
	* nndiary.el (nndiary-reminders): Fix typos in docstrings.

2007-06-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-mime-view-part-externally)
	(gnus-mime-view-part-internally): Fix predicate function passed to
	completing-read.

	* mm-decode.el (mm-image-fit-p): Return t if argument is not an image.

	* gnus.el (gnus-update-message-archive-method): Add :version.

2007-06-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus.el (gnus-update-message-archive-method): New variable.

	* gnus-start.el (gnus-setup-news): Update saved "archive" method
	according to gnus-message-archive-method if
	gnus-update-message-archive-method is non-nil.

2007-05-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-summary-limit-to-address): New function.
	Suggested by Loic Dachary <loic@dachary.org>.
	(gnus-summary-limit-map, gnus-summary-make-menu-bar): Add it.

2007-05-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-pop-to-buffer): Add switch-function argument.
	(message-mail): Pass switch-function argument to it.

2007-05-25  Reiner Steib  <Reiner.Steib@gmx.de>

	* mm-decode.el (mm-file-name-rewrite-functions): Make it customizable.
	Improve doc string.

2007-05-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-header-from, gnus-header-subject, gnus-header-name)
	(gnus-header-content):
	* gnus-cite.el (gnus-cite-10):
	* gnus-srvr.el (gnus-server-closed):
	* gnus.el (gnus-group-mail-1, gnus-group-mail-1-empty)
	(gnus-group-mail-2, gnus-group-mail-2-empty, gnus-group-mail-3)
	(gnus-group-mail-3-empty, gnus-group-mail-low)
	(gnus-group-mail-low-empty, gnus-splash):
	* message.el (message-header-to, message-header-cc)
	(message-header-subject, message-header-other, message-header-name)
	(message-header-xheader, message-separator, message-cited-text)
	(message-mml): Lighten colors of faces used for dark background.

2007-05-24  Simon Josefsson  <simon@josefsson.org>

	* nnimap.el (nnimap-need-unselect-to-notice-new-mail): Change default
	to t as an experiment.  Suggested by Greg Troxel <gdt@work.lexort.com>.

2007-05-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-narrow-to-headers-or-head):
	Ignore mail-header-separator in the body.

2007-05-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-decode.el (mm-image-fit-p): Return t if image size is just the
	same as window size.

2007-05-22  Kevin Ryde  <user42@zip.com.au>

	* message.el (message-font-lock-keywords): Use message-header-xheader
	face for "X-Foo", its apparent intended purpose.  Move "X-" pattern
	ahead of the anything pattern, to get it recognized.

2007-05-12  Michaël Cadilhac  <michael@cadilhac.name>

	* gnus-sum.el (gnus-articles-to-read)
	(gnus-summary-insert-old-articles): Don't truncate group name for
	`read-string'.

	* gnus-util.el (gnus-limit-string): Delete this function.

	* gnus-sum.el (gnus-simplify-subject-fully):
	Use `truncate-string-to-width' instead.

2007-05-11  Michaël Cadilhac  <michael@cadilhac.name>

	* gnus-sum.el (gnus-summary-next-group-on-exit): New variable.
	Tell if, on summary exit, the next group has to be selected.
	(gnus-summary-exit): Use it.

2007-05-10  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (gnus-article-mode): Fix comment about displaying
	non-break space.

2007-05-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnfolder.el (nnfolder-request-group, nnfolder-request-create-group):
	Check if group is not a directory.
	(nnfolder-request-expire-articles): Don't delete articles if the target
	group is not available.

	* nnml.el (nnml-request-create-group): Properly check if group is not a
	file.
	(nnml-request-expire-articles): Don't delete articles if the target
	group is not available.

	* rfc2047.el (rfc2047-quote-special-characters-in-quoted-strings):
	Don't quote characters that are within parentheses.

2007-05-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-auto-select-on-ephemeral-exit): New variable.
	(gnus-handle-ephemeral-exit): Select article according to it.

2007-05-08  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-insert-formated-citation-line): Remove newline.
	(message-citation-line-format): Add final \n here so that the user can
	avoid a blank line.

2007-05-03  Dan Christensen  <jdc@uwo.ca>

	* nndoc.el (nndoc-type-alist, nndoc-lanl-gov-announce-type-p)
	(nndoc-transform-lanl-gov-announce, nndoc-generate-lanl-gov-head):
	Update lanl/arXiv support.

2007-05-02  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus.el: Bump version number.

2007-05-01  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus.el (gnus-version-number): Bump version.

2007-05-01  Lars Magne Ingebrigtsen  <lars@ingebrigtsen.no>

	* gnus.el: No Gnus v0.6 is released.

2007-04-27  Didier Verna  <didier@xemacs.org>

	* gnus-util.el (gnus-orify-regexp): Move and rename to ...
	* gmm-utils.el (gmm-regexp-concat): ... here.
	* message.el: Don't require 'gnus-util.
	(message-dont-reply-to-names): Handle name change above.
	* gnus-sum.el (gnus-ignored-from-addresses): Ditto.

2007-04-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-util.el (mm-charset-synonym-alist): Don't make it a user option
	since the initial value varies according to the system.

2007-04-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-util.el (mm-charset-synonym-alist): Defcustom.

2007-04-25  NAKAJI Hiroyuki  <nakaji@jp.freebsd.org>  (tiny change)

	* mm-util.el (mm-charset-synonym-alist): Map iso8859-1 to iso-8859-1.

2007-04-24  Didier Verna  <didier@xemacs.org>

	Improve the type of gnus-ignored-from-addresses.
	* gnus-util.el (gnus-orify-regexp): New function.
	* message.el (gnus-util): Require it.
	* message.el (message-dont-reply-to-names): Use gnus-orify-regexp.
	* gnus-sum.el (gnus-ignored-from-addresses): New function.
	* gnus-sum.el (gnus-summary-from-or-to-or-newsgroups): Use it.

2007-04-24  Didier Verna  <didier@xemacs.org>

	* gnus-sum.el:
	* gnus-utils.el: Fix some trailing whitespaces.

2007-04-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-msg.el (gnus-summary-resend-message-edit): Add Gcc header.
	(gnus-summary-resend-bounced-mail): Ditto; search whole body for parent
	article's Message-ID; refer parent article in summary buffer.

	* message.el (message-bounce): Call mime-to-mml.

2007-04-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-msg.el (gnus-summary-supersede-article): Add Gcc header.

2007-04-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-mime-strip-charset-parameters): New function.
	(gnus-mime-view-part-as-charset): Use it; redisplay subpart currently
	displayed of multipart/alternative part if it is invoked from summary
	buffer.

	* mm-view.el (mm-inline-text-html-render-with-w3m)
	(mm-inline-text-html-render-with-w3m-standalone)
	(mm-inline-render-with-function): Use mail-parse-charset by default.

2007-04-18  Levin Du  <zslevin@gmail.com>  (tiny change)

	* parse-time.el (parse-time-string-chars): Check if CHAR
	is less than the length of parse-time-syntax.

2007-04-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-uu.el (gnus-uu-digest-mail-forward): Pull articles processed
	from gnus-newsgroup-processable.

2007-04-16  Didier Verna  <didier@xemacs.org>

	* gnus-msg.el (gnus-configure-posting-styles):
	Handle message-signature-directory properly with :file syntax.
	Reported by "Leo".

2007-04-11  Didier Verna  <didier@xemacs.org>

	New user option: message-signature-directory.
	* gnus-msg.el (gnus-configure-posting-styles): Support it.
	* message.el (message-insert-signature): Ditto.
	* message.el (message-signature-file): Doc update.
	* message.el (message-signature-directory): New.

2007-04-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-msg.el (gnus-inews-yank-articles):
	Use message-exchange-point-and-mark instead of exchange-point-and-mark.

2007-04-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-yank-original): Make sure cited text ends with
	newline; don't exchange point and mark.

2007-04-07  Chong Yidong  <cyd@stupidchicken.com>

	* tls.el (open-tls-stream): Properly handle case where there
	is no associated buffer.

2007-04-03  Thien-Thi Nguyen  <ttn@gnu.org>

	* gnus-msg.el (gnus-inews-yank-articles): Fix bug: After
	message-yank-original, make sure (< mark TEXT point).

2007-03-31  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-fill-column): New variable.
	(message-mode): Use it.  Add comment on a possible new hook.

	* nnmail.el (nnmail-spool-file): Mark as obsolete.
	(nnmail-get-new-mail): Reformat.

	* gnus-registry.el (gnus-registry-cache-save): Add FIXME comment.

	* gmm-utils.el: Fix Commentary.
	(gmm-tool-bar-from-list): Fix typo in doc string.

2007-03-27  Thien-Thi Nguyen  <ttn@gnu.org>

	* message.el (message-yank-original): Don't switch point and mark
	unnecessarily to put point and mark as documented.

2007-03-27  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-put-addresses-in-ecomplete): Only fetch headers
	from the message heads.

2007-03-25  Kevin Greiner  <kevin.greiner@compsol.cc>

	* gnus-art.el (gnus-article-set-window-start): Do nothing when the
	article buffer does not have a window.  This may not be the best
	solution but is certainly better than setting the start of the null,
	that is the current, window.

2007-03-24  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-draft.el (gnus-draft-setup-hook): New hook.
	(gnus-draft-setup): Run it.

	* gnus-score.el (gnus-inhibit-slow-scoring): New variable, renamed from
	gnus-score-fast-scoring.  Allow regexp.
	(gnus-score-headers): Use it.

	* gnus-util.el (gnus-emacs-version): Include "no MULE" in no-MULE
	XEmacs.

	* gnus-art.el (gnus-article-browse-html-article): Fix typo in doc
	string.
	(gnus-button-alist): Also catch `<f1> k ...'.
	(gnus-treat-display-x-face): Fix doc string.

2007-03-25  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* gnus-msg.el (gnus-setup-message, gnus-inews-add-send-actions): Move
	evaluation of gnus-extended-version to ensure correct generation of the
	User-Agent header when message-generate-headers-first is used.

2007-03-24  Simon Josefsson  <simon@josefsson.org>

	* hashcash.el (hashcash-generate-payment-async): Don't crash if
	hashcash-path is nil.  Don't call callback with incorrect number of
	parameters if val is 0.

2007-03-20  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* message.el (message-required-news-headers):
	* gnus-util.el (gnus-intern-safe): Fix typo in docstring.

2007-03-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-generate-new-buffers): Change the meaning of the
	nil value; add `standard' to the choices; treat t as `unique'; improve
	doc string.
	(gnus-select-frame-set-input-focus): Autoload.
	(message-buffer-name): Search for the existing message buffer if
	message-generate-new-buffers is nil or `standard'; treat the value t of
	message-generate-new-buffers as `unique'.
	(message-pop-to-buffer): Raise the frame already displaying the message
	buffer; clear the echo area after querying.
	(message-setup): Pass the `continue' argument to compose-mail.
	(message-mail): Prefer `switch-function' if it is given; search for the
	existing message buffer if the `continue' argument is non-nil; pass
	continue and switch-function arguments to compose-mail by way of
	message-setup.
	(message-mail-other-window): Adjust argument of message-setup.
	(message-mail-other-frame): Ditto.

2007-03-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-cite.el (font-lock-set-defaults): Autoload it for Emacs.
	(gnus-message-citation-mode): Require font-lock for XEmacs; make sure
	to turn font-lock on when turning gnus-message-citation-mode on.

2007-03-06  Daiki Ueno  <ueno@unixuser.org>

	* mml-smime.el (mml-smime-use): New variable; default to use openssl.
	(mml-smime-function-alist): New variable; add epg as the backend.
	* mml-sec.el (mml-smime-sign): Don't require mml-smime, autoload
	mml-smime- functions instead.
	* mm-view.el: Require smime.

2007-03-05  Didier Verna  <didier@xemacs.org>

	* gnus-topic.el (gnus-topic-hierarchical-parameters): Perform merging
	instead of just inheritance for posting styles.
	* gnus.el (gnus-group-fast-parameter): Fix typo in comment.

2007-02-24  John Paul Wallington  <jpw@pobox.com>

	* tls.el (tls-certtool-program): Fix custom type.

2007-02-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-cite.el (gnus-message-search-citation-line): Use point-at-bol
	and point-at-eol instead of line-(beginning|end)-position.

	* assistant.el (assistant-parse-buffer): Ditto.

2007-02-28  Daiki Ueno  <ueno@unixuser.org>

	* mml2015.el (mml2015-epg-find-usable-key): New function.
	(mml2015-epg-sign): Use it.
	(mml2015-epg-encrypt): Use it.

2007-02-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-make-in-reply-to): Quote name containing
	non-ASCII characters.  It will make the RFC2047 encoder cause an error
	if there are special characters.  Reported by NAKAJI Hiroyuki
	<nakaji@jp.freebsd.org>.

2007-02-27  Didier Verna  <didier@xemacs.org>

	Include the group parameters as well as the topic ones in the
	inheritance filter process.
	* gnus-topic.el (gnus-topic-hierarchical-parameters): New optional
	argument GROUP-PARAMS-LIST.
	* gnus-topic.el (gnus-group-topic-parameters): Use it.

2007-02-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nntp.el (nntp-never-echoes-commands)
	(nntp-open-connection-functions-never-echo-commands): New variables.
	(nntp-send-command): Use them.

2007-02-20  Daiki Ueno  <ueno@unixuser.org>

	* mml2015.el (mml2015-epg-verify): Simplify.

2007-02-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mml.el (mml-content-disposition-alist): New user option.
	(mml-content-disposition): New function.
	(mml-insert-mime-headers, mml-minibuffer-read-disposition): Use it.
	(mml-attach-file, mml-dnd-attach-file): Pass file name to it.

2007-02-19  Daiki Ueno  <ueno@unixuser.org>

	* mml2015.el (mml2015-epg-verify): Convert LF to CRLF before signature
	verification.

2007-02-15  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* nnweb.el (nnweb-google-parse-1): Fix date parsing to also match on
	articles posted in the last 24 hours.

2007-02-14  Chong Yidong  <cyd@stupidchicken.com>

	* smiley.el (smiley-regexp-alist): Add "dead" smiley.

2007-02-14  Michaël Cadilhac  <michael@cadilhac.name>

	* nntp.el (nntp-send-command): Don't wait for echoes when
	nntp-open-ssl-stream is used.

2007-02-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-cite.el (gnus-test-font-lock-add-keywords)
	(gnus-message-add-citation-keywords)
	(gnus-message-remove-citation-keywords): Remove.
	(gnus-message-citation-mode): Instead of modifying font-lock-keywords
	directly, make the variables in font-lock-defaults buffer-local, add
	gnus-message-citation-keywords to them and then update the value of
	font-lock-keywords.

2007-02-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-cite-original-1): Don't call
	gnus-article-highlight-citation.

	* gnus-cite.el (gnus-cite-parse): Work with two or more MS-type
	citations; fix line count.

2007-02-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-cite.el (gnus-test-font-lock-add-keywords): New function.
	(gnus-message-add-citation-keywords)
	(gnus-message-remove-citation-keywords): Use it; fix the emulating
	versions of font-lock-add-keywords and font-lock-remove-keywords to
	work with XEmacs correctly.

2007-02-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-cite.el (gnus-cite-face-list): Set the values of
	gnus-message-max-citation-depth and gnus-message-citation-keywords.
	(gnus-message-max-citation-depth): Use defvar rather than defconst.
	(gnus-message-cite-prefix-regexp): New variable.
	(gnus-message-search-citation-line): Use it; protect against long
	citation prefix; fill match data with nil rather than 0 for XEmacs; set
	the 0th match data for Emacs.
	(gnus-message-citation-keywords): Set LAXMATCH flag in every HIGHLIGHT.
	(gnus-message-add-citation-keywords): Append keywords rather than
	prepending; emulate font-lock-add-keywords if it is not available.
	(gnus-message-remove-citation-keywords):
	Emulate font-lock-remove-keywords if it is not available.

	* gnus-msg.el (gnus-message-highlight-citation): Default to t.

	* message.el (message-cite-prefix-regexp): Set the value of
	gnus-message-cite-prefix-regexp.

2007-02-01  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* nnweb.el (nnweb-google-parse-1): Update parser.

2007-01-29  Juanma Barranquero  <lekktu@gmail.com>

	* gnus-art.el (gnus-button-prefer-mid-or-mail): Fix typo in docstring.

2007-01-28  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* nnslashdot.el (nnslashdot-request-article): Update end-of-article
	regexp.

2007-01-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* uudecode.el (uudecode-string-to-multibyte): New function emulating
	string-to-multibyte.
	(uudecode-decode-region-internal): Use it.

2007-01-23  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-score.el (gnus-home-score-file, gnus-home-adapt-file):
	Fix custom choice.

	* gnus-art.el (gnus-signature-limit): Fix custom choice.

2007-01-22  Daiki Ueno  <ueno@unixuser.org>

	* mm-util.el (mm-inhibit-file-name-handlers): Add epa-file-handler.

	* mm-decode.el (mm-save-part-to-file): Use `mm-write-region' instead of
	`write-region' to respect `mm-inhibit-file-name-handlers'.

2007-01-19  Reiner Steib  <Reiner.Steib@gmx.de>

	* nnsoup.el (nnsoup-directory, nnsoup-packer, nnsoup-packet-directory):
	Use gnus-home-directory instead of "~/" or "$HOME".

2007-01-17  Teodor Zlatanov  <tzz@lifelogs.com>

	* encrypt.el (encrypt-insert-file-contents): Add better prompt
	to mention filename.
	Add comments at beginning regarding usage.
	(encrypt-write-file-contents): Change interactive so a string is
	acceptable.  If the file has no associated model, show an error instead
	of a nonsense prompt.

2007-01-16  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* spam.el (spam-bsfilter-ham-switch): Fix typo.
	Thanks to Yoshihiko Yamada for kind notification of this typo.

2007-01-12  Kenichi Handa  <handa@m17n.org>

	* uudecode.el (uudecode-decode-region-internal): Make it work in a
	multibyte buffer.

2007-01-14  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-score.el (gnus-score-fast-scoring): New variable.
	(gnus-score-headers): Use it.

	* gnus-sum.el (gnus-auto-select-first): Improve doc string.

	* message.el (message-cite-original-1):
	Call gnus-article-highlight-citation if requested.
	(message-make-from): Allow name and address as optional arguments.

	* gnus-cite.el (gnus-article-highlight-citation): Add SAME-BUFFER arg.

	* gnus-art.el (gnus-article-browse-html-article): Add warning about web
	bugs to doc string.
	(gnus-button-alist): Add mid\\|message-id.
	(gnus-button-fetch-group): Extend for use in
	`browse-url-browser-function'.
	(gnus-button-url-regexp): Try to catch paired parentheses like in
	Wikipedia URLs.

	* gnus-sum.el (gnus-summary-reparent-children): Another doc string fix.
	Suggested by Simon Krahnke <overlord@gmx.li>.

2007-01-13  Romain Francoise  <romain@orebokech.com>

	* nnml.el (nnml-use-compressed-files): Fix typo in docstring.
	Update copyright.

2007-01-13  Patric Mueller  <bhaak@bigfoot.com>  (tiny change)

	* gnus-sum.el (gnus-summary-reparent-children): Fix typo in doc string.

2007-01-09  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-unfollowed-groups)
	(gnus-registry-split-fancy-with-parent): Fix documentation.

2007-01-08  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* spam-report.el (spam-report-gmane-internal): Speed up spam reporting
	from nnweb groups.

2006-12-31  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* spam-report.el (spam-report-gmane-internal): Add necessary "/" to
	Xref urls.  Erase buffer before requesting head.

	* mm-decode.el (mm-display-external): Use itimer function for XEmacs.

2007-01-07  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-soup.el (gnus-soup): New custom group.  Make user variables
	customizable.

2007-01-05  Daiki Ueno  <ueno@unixuser.org>

	* mml2015.el (mml2015-epg-sign): Ask user whether to skip or abort if
	no signing key is found.
	(mml2015-epg-encrypt): Ask user whether to skip or abort if
	no encrypting and/or signing key is found.

2007-01-03  Reiner Steib  <Reiner.Steib@gmx.de>

	* spam-report.el (spam-report-gmane-spam): Remove redundant message.

2007-01-01  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* nnweb.el (nnweb-gmane-create-mapping): Put back code to merge the
	headers read from disk with the ones newly found in the current search.
	This should no longer cause problems, because the article numbers in
	Gmane's `nov.php' output are ignored since the previous change.

2007-01-02  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* gmm-utils.el (gmm-tool-bar-style): Fix custom type.

2007-01-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-decode.el (mm-display-external): Use itimer function for XEmacs.

2007-01-01  Romain Francoise  <romain@orebokech.com>

	* gnus-sum.el (gnus-summary-make-menu-bar): Fix typo.

2006-12-31  Steve Youngs  <steve@sxemacs.org>

	* gnus-cite.el: Load easy-mmode at compile time for (S)XEmacs to get
	`define-minor-mode' macro definition expanded properly.
	(gnus-message-citation-mode): This is now OK for (S)XEmacs so don't
	exclude it there.

	* gnus-msg.el (gnus-message-highlight-citation): Revert Reiner's patch
	of 2006-12-30.  The default is nil on (S)XEmacs already because of the
	`fboundp' test.
	(gnus-message-citation-mode): Revert Reiner's patch of 2006-12-30.
	This is OK to autoload in (S)XEmacs now.

2006-12-30  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-summary-limit-to-singletons): New command and
	keystroke.
	(gnus-summary-limit-to-singletons): Fix typo.

	* spam-report.el (spam-report-gmane-internal): Fall back on Xref if all
	else fails.

2006-12-30  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* gnus-cite.el (turn-off-gnus-message-citation-mode): Fix typo in
	docstring.

	* gnus-sum.el (gnus-summary-insert-ticked-articles): New command.
	(gnus-summary-make-menu-bar, gnus-summary-buffer-map): Bind it.
	(gnus-summary-insert-dormant-articles): Fix typo in message.

2006-12-30  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-msg.el (gnus-message-highlight-citation): Ensure default to be
	nil for XEmacs.
	(gnus-message-citation-mode): Don't autoload in XEmacs.

	* gnus-cite.el (gnus-message-citation-mode): Don't define in XEmacs.

2006-12-29  Jouni K. Seppänen  <jks@iki.fi>

	* nnimap.el (nnimap-expunge-search-string):
	Mention nnimap-search-uids-not-since-is-evil in docstring.

2006-12-28  Reiner Steib  <Reiner.Steib@gmx.de>

	* spam.el: Revert to make-obsolete-variable because
	define-obsolete-variable-alias is not supported in Emacs 21.

	* spam.el (spam-ifile-path, spam-ifile-database-path)
	(spam-bogofilter-path): Use define-obsolete-variable-alias instead of
	make-obsolete-variable.
	(spam-bsfilter-path, spam-bsfilter-program)
	(spam-spamassassin-path, spam-spamassassin-program)
	(spam-sa-learn-path, spam-sa-learn-program): Rename variables.
	Don't use "path" inappropriately.
	(spam-check-spamassassin, spam-spamassassin-register-with-sa-learn)
	(spam-check-bsfilter, spam-bsfilter-register-with-bsfilter): Use new
	variable names.

2006-12-28  Daiki Ueno  <ueno@unixuser.org>

	* gnus-sum.el (gnus-summary-next-article): Make sure we are in the
	summary buffer.

	* password.el (password-cache-remove): Use clear-string to burn
	password, if available.

2006-12-26  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-msg.el (gnus-message-citation-mode): Fix autoload.

	* gnus-cite.el (gnus-message-highlight-citation): Move to gnus-msg.el.

	* gnus-msg.el (gnus-setup-message): Add gnus-message-citation-mode.
	(gnus-message-highlight-citation): Move defcustom here from
	gnus-cite.el.
	(gnus-message-citation-mode): Autoload.

	* gnus-cite.el: Adjust Oliver's code to Gnus namespace.  Add some
	checks to make it compile with XEmacs.
	(gnus-message-citation-mode): New minor mode.
	(gnus-message-max-citation-depth, gnus-message-citation-keywords)
	(gnus-message-highlight-citation): New variables.
	(gnus-message-search-citation-line)
	(gnus-message-add-citation-keywords)
	(gnus-message-remove-citation-keywords)
	(turn-on-gnus-message-citation-mode)
	(turn-off-gnus-message-citation-mode): New functions.

2006-12-26  Oliver Scholz  <epameinondas@gmx.de>

	* gnus-cite.el: Enable highlighting of different citation levels in
	message-mode.

2006-12-26  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-make-fqdn): Fix comment.
	(message-bogus-system-names): Add ".local".

	* spam.el (spam-ifile-path, spam-ifile-program)
	(spam-ifile-database-path, spam-ifile-database)
	(spam-bogofilter-path, spam-bogofilter-program): Rename variables.
	Don't use "path" inappropriately.
	(spam-spamoracle-database, spam-get-ifile-database-parameter): Fix doc
	strings.
	(spam-check-ifile, spam-ifile-register-with-ifile)
	(spam-check-bogofilter, spam-bogofilter-register-with-bogofilter):
	Use new variable names.

	* gnus-art.el (gnus-treat-display-x-face, gnus-treat-display-face)
	(gnus-treat-display-smileys): Simplify using
	gnus-image-type-available-p.

	* gnus-ems.el (gnus-image-type-available-p): Use display-images-p if
	available.

2006-12-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnrss.el (nnrss-fetch): Replace buffer's contents with the decoded
	one after turning on the buffer's multibyteness instead of decoding
	them directly in the unibyte buffer that causes unexpected conversion
	in Emacs 23 (unicode).

2006-12-21  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* message.el (message-generate-hashcash): Fix custom type.

2006-12-20  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-sum.el (gnus-summary-recenter): Remove debug messages.

2006-12-20  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-group.el (gnus-group-tool-bar-gnome): Exchange connect and
	disconnect icons.  Add help text.

2006-12-20  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-extra-header-to-number): CRM114 spam score is
	negated to be consistent with the others we handle.

2006-12-19  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-art.el (gnus-article-setup-buffer): Actually set the local
	version of gnus-summary-buffer to something, so that we can use two
	article buffers at the same time.

2006-12-18  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-necessary-extra-headers): Make spam-use-regex-headers
	trigger all the extra headers.
	(spam-extra-header-to-number): Don't require spam-use-crm114 for header
	sorting.

2006-12-14  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* nnweb.el (nnweb-gmane-create-mapping): Keep the mapping stable for
	solid groups.

2006-12-13  Reiner Steib  <Reiner.Steib@gmx.de>

	* legacy-gnus-agent.el: Add Copyright notice.

2006-12-12  Chong Yidong  <cyd@stupidchicken.com>

	* gnus-sum.el (gnus-make-thread-indent-array): Fix last change.

2006-12-10  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnweb.el (nnweb-gmane-search): Placeholder TOPDOC setting.

	* gnus-sum.el (gnus-summary-recenter): Force setting the window start
	to make it work reliably in CVS Emacs.
	(gnus-summary-limit-strange-charsets-predicate)
	(gnus-summary-limit-to-predicate): New functions.

2006-12-08  Chong Yidong  <cyd@stupidchicken.com>

	* gnus-sum.el (gnus-make-thread-indent-array): New optional arg
	specifying array size.
	(gnus-summary-insert-line, gnus-summary-prepare-threads): Regrow indent
	array if it is too small.
	(gnus-sort-threads-recursive): Rename from gnus-sort-thread-1.
	(gnus-sort-threads-loop): New function.

2006-12-06  Chris Moore  <dooglus@gmail.com>

	* gnus-sum.el (gnus-sort-threads, gnus-summary-limit-children):
	Use `max' to avoid the value of `max-lisp-eval-depth' decreasing.

2006-12-04  Jouni K. Seppänen  <jks@iki.fi>

	* mm-url.el (mm-url-predefined-programs): Call curl with correct
	options.

2006-12-01  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* spam-report.el (spam-report-url-ping-plain): Wait for output to avoid
	DOS-ing the recipient.

	* nnweb.el (nnweb-gmane-create-mapping): Use the article number from
	the headers when creating the mapping to avoid mismappings.
	(nnweb-gmane-create-mapping): Always nix out old mapping.

2006-11-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-signed-or-encrypted-p): Bind mm-decrypt-option
	and mm-verify-option to never.

2006-11-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-signed-or-encrypted-p): New function.
	(message-forward-make-body): Use it.

	* mml2015.el (mml2015-pgg-clear-verify, mml2015-epg-clear-verify):
	Replace encode-coding-string with mm-encode-coding-string.

2006-11-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nneething.el (nneething-decode-file-name):
	Replace decode-coding-string with mm-decode-coding-string.

	* gnus-int.el (gnus-open-server): Say failed server's name.

2006-11-24  Juanma Barranquero  <lekktu@gmail.com>

	* gnus-agent.el (gnus-agent-expire-unagentized-dirs)
	(gnus-agent-regenerate-group): Fix space/tab mixup in messages.

	* gnus-art.el (gnus-article-x-face-command, gnus-numeric-save-name):
	* gnus-group.el (gnus-group-sort-function, gnus-group-line-format)
	(gnus-group-mode, gnus-group-read-group, gnus-group-delete-group)
	(gnus-group-make-directory-group, gnus-group-transpose-groups):
	* gnus-start.el (gnus-options-subscribe, gnus-options-not-subscribe)
	(gnus-subscribe-newsgroup, gnus-1):
	* gnus-sum.el (gnus-summary-make-false-root, gnus-make-threads):
	* gnus.el (gnus-nntp-server, gnus-use-cross-reference)
	(gnus-valid-select-methods, total-expire, gnus-summary-line-format)
	(gnus-group-read-only-p): Fix space/tab mixup in docstrings.

2006-11-24  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-sum.el (gnus-summary-limit-to-headers): New command and
	keystroke.
	(gnus-summary-limit-to-bodies): Implement headersp.

2006-11-23  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* dns.el (query-dns): Protect against "Process dns deleted" strings.

2006-11-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-util.el (mm-string-to-multibyte): Alias to identity in XEmacs.

2006-11-21  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-generate-hashcash): Expand range of values to
	include `opportunistic'.
	(message-send-mail): Use it.

2006-11-18  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* mm-uu.el (mm-uu-pgp-signed-extract-1): Make last fix more thorough
	and comment it.

	* nnslashdot.el (nnslashdot-retrieve-headers-1): Update regexp.

2006-11-15  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-util.el (gnus-extract-address-components): Improve comment.

2006-11-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-util.el (gnus-extract-address-components): Work with address in
	which the name portion contains @.

2006-11-14  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus.el (gnus-start): Move custom group up.
	(gnus-select-method): Don't autoload, but make it available for
	`customize-variable'.
	(gnus-getenv-nntpserver): Don't autoload.

2006-11-14  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el: Revert to 7.82 (removed changes since 2006-10-16).

2006-11-14  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-sendmail-extra-arguments): New variable.
	(message-send-mail-with-sendmail): Use it.

2006-11-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mml.el (mml-generate-mime-1): Use mm-string-as-unibyte instead of
	mm-with-unibyte-current-buffer to make string unibyte.

	* mm-decode.el (mm-insert-part): Use mm-string-to-multibyte instead of
	mm-string-as-multibyte.

2006-11-14  Daiki Ueno  <ueno@unixuser.org>

	* mml2015.el (mml2015-epg-sign): Prefix "pgp-" to a micalg value.
	Reported by Werner Koch <wk@gnupg.org>.

2006-11-14  Daiki Ueno  <ueno@p360>

	* mml2015.el: Autoload epa-select-keys when compiling.

2006-11-13  Daiki Ueno  <ueno@unixuser.org>

	* mml2015.el (mml2015-epg-sign): Save the signing keys in
	message-options.
	(mml2015-epg-encrypt): Save the recipient keys in message-options.

2006-11-13  Daiki Ueno  <ueno@unixuser.org>

	* mml2015.el (mml2015-epg-encrypt): Remove backward compatibility for
	EasyPG (< 0.0.6).
	(mml2015-always-trust): New user option.
	(mml2015-epg-passphrase-callback): Display key ID on the passphrase
	prompt.

2006-11-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nntp.el (nntp-authinfo-force): New variable.
	(nntp-send-authinfo): Use it.

2006-11-09  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-strip-subject-encoded-words): Allow _not_ to
	decode encoded words.  Improve prompt.  Add comment about forwarding.
	(message-replacement-char): Move up.

2006-11-08  Wolfgang Jenkner  <wjenkner@inode.at>  (tiny change)

	* gnus-sum.el (gnus-summary-catchup): Use gnus-sorted-intersection
	instead of gnus-intersection because arguments of gnus-sorted-nunion
	must be sorted.  This avoids corruption of gnus-newsgroup-unreads.

2006-11-07  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-strip-subject-encoded-words): Reformat prompt.
	(message-simplify-subject-functions):
	Enable message-strip-subject-encoded-words by default.

2006-11-06  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-strip-subject-encoded-words): New function.
	(message-simplify-subject-functions): New variable.
	(message-simplify-subject): Use it.  Fix typo in doc string.
	Support message-strip-subject-encoded-words.

2006-11-03  Juanma Barranquero  <lekktu@gmail.com>

	* gnus-diary.el (gnus-diary-delay-format-function):
	* nndiary.el (nndiary-reminders):
	* nnsoup.el (nnsoup-always-save): Use "non-nil" in docstrings.

2006-11-01  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (article-hide-boring-headers): Fetch date from
	gnus-original-article-buffer to avoid problems with localized date
	strings.

2006-10-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* html2text.el (html2text-format-tags): Avoid infloop on open tags.

2006-10-29  Reiner Steib  <Reiner.Steib@gmx.de>

	* mm-util.el (mm-codepage-iso-8859-list, mm-codepage-ibm-list):
	New variables.
	(mm-setup-codepage-iso-8859, mm-setup-codepage-ibm): New functions.
	(mm-charset-synonym-alist): Move some entries to
	mm-codepage-iso-8859-list.
	(mm-charset-synonym-alist, mm-charset-override-alist):
	Add iso-8859-8/windows-1255 and iso-8859-9/windows-1254.

2006-10-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-set-mode-line): Quote % in group name.

2006-10-28  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-agent.el (gnus-agent-make-mode-line-string): Make it compatible
	with Emacs 21 and XEmacs.

2006-10-27  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-parse-address): New function for better parsing,
	catching errors, etc.
	(spam-check-BBDB, spam-enter-ham-BBDB, spam-parse-list): Use it.

2006-10-26  Reiner Steib  <Reiner.Steib@gmx.de>

	* mm-view.el: Add interactive arg to html2text autoload.

2006-10-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-summary-move-article): Use no-encode for `B B'.

2006-10-24  Reiner Steib  <Reiner.Steib@gmx.de>

	* mm-util.el (mm-codepage-iso-8859-list, mm-codepage-ibm-list):
	New variables.
	(mm-setup-codepage-iso-8859, mm-setup-codepage-ibm): New functions.
	(mm-charset-synonym-alist): Move some entries to
	mm-codepage-iso-8859-list.

	* gnus.el (gnus-getenv-nntpserver, gnus-select-method): Autoload.

2006-10-23  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-citation-line-format)
	(message-insert-formated-citation-line): Fix implementation of %E, %N
	and %n according to the doc string.

2006-10-20  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-check-BBDB, spam-enter-ham-BBDB, spam-parse-list):
	Use car-safe to avoid bad parses.

2006-10-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-group.el (gnus-group-make-doc-group): Work for non-ASCII group
	names.

	* gnus-sum.el (gnus-select-newsgroup): Decode group name.

2006-10-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-draft.el (gnus-draft-edit-message): Make sure to remove Date
	header.

	* message.el (message-draft-headers): Add Date.
	(message-headers-to-generate): Fix typo in docstring.

	* nndraft.el (nndraft-required-headers): New variable.
	(nndraft-generate-headers): Use it.

	* gnus-registry.el (gnus-registry-wash-for-keywords): Bind `word'.

2006-10-16  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-wash-for-keywords)
	(gnus-registry-find-keywords): New functions to allow easy searching of
	articles that are in the registry.

2006-10-16  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-check-BBDB, spam-enter-ham-BBDB, spam-parse-list):
	Use ietf-drums-parse-address instead of gnus-extract-address-components.
	Reported by Damien Elmes <damien@repose.cx>.

2006-10-19  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus.el (gnus-mime): Remove unused custom group.

2006-10-13  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* mm-uu.el (mm-uu-pgp-signed-extract-1): Use RFC 2440 definition of
	"blank line" when searching for end of armor headers.

2006-10-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gmm-utils.el (gmm-write-region): Fix variable name.

2006-10-10  Reiner Steib  <Reiner.Steib@gmx.de>

	* gmm-utils.el (gmm-write-region): New function based on compatibility
	code from `mm-make-temp-file'.

	* mm-util.el (mm-make-temp-file): Use `gmm-write-region'.

	* nnmaildir.el (nnmaildir--update-nov)
	(nnmaildir-request-replace-article, nnmaildir-request-accept-article):
	Use `gmm-write-region'.

2006-10-04  Reiner Steib  <Reiner.Steib@gmx.de>

	* mm-util.el (mm-charset-synonym-alist, mm-charset-override-alist):
	Add iso-8859-8/windows-1255 and iso-8859-9/windows-1254.

	* nnheader.el (nnheader-find-file-noselect): Inhibit version-control.

	* message.el (message-replacement-char): New variable.
	(message-fix-before-sending): Use it.
	(message-simplify-subject): New function to remove duplicate code.
	(message-reply, message-followup): Use it.

	* gnus-sum.el (gnus-summary-make-menu-bar):
	Clarify gnus-summary-limit-to-articles.

2006-10-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-util.el (gnus-with-local-quit): New macro.

	* gnus-demon.el (gnus-demon): Replace with-local-quit with it.

2006-10-02  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-util.el (gnus-string-remove-all-properties): Another fix to
	ignore non-string data.

2006-09-29  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-util.el (gnus-string-remove-all-properties): Fix to ignore
	non-string data (needs to be done in the registry too).

2006-09-28  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-save, gnus-registry-cache-save)
	(gnus-registry-remove-alist-text-properties, gnus-registry-action)
	(gnus-registry-split-fancy-with-parent)
	(gnus-registry-fetch-simplified-message-subject-fast)
	(gnus-registry-fetch-sender-fast, gnus-registry-store-extra-entry):
	Remove text properties on ingress into the registry and when it's saved.
	(gnus-registry-clean-empty-function): Fix bug with cleaning the
	registry from entries with no groups.

2006-09-28  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-util.el (gnus-string-remove-all-properties): Add utility
	function to remove string properties.

2006-09-28  Reiner Steib  <Reiner.Steib@gmx.de>

	* gmm-utils.el (gmm): Adjust custom version.

	* mm-util.el (mm-charset-override-alist, mm-charset-eval-alist):
	Adjust custom version.

	* gnus-draft.el (gnus-draft-mode): Don't call `mml-mode'.

2006-09-27  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (gnus-insert-prev-page-button)
	(gnus-insert-next-page-button): Simplify.  Reformat.

2006-09-27  Maxime Edouard Robert Froumentin  <max@lapin-bleu.net>

	* gnus-art.el (gnus-insert-prev-page-button)
	(gnus-insert-next-page-button): Apply gnus-article-button-face.

2006-09-25  Chong Yidong  <cyd@stupidchicken.com>

	* gnus-demon.el (gnus-demon): Use with-local-quit to avoid hangs.

2006-09-20  Maxime Edouard Robert Froumentin  <max@lapin-bleu.net>

	* gnus-art.el (gnus-insert-mime-button)
	(gnus-insert-mime-security-button):
	Apply gnus-article-button-face to MIME and security buttons.

2006-09-20  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (gnus-button-url-regexp): Try to make the value more
	readable.

2006-09-20  Steve Youngs  <steve@sxemacs.org>

	* gnus-art.el (gnus-article-browse-html-parts): They're files, so use
	`browse-url-of-file' instead of `browse-url'.

2006-09-19  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* nnslashdot.el (nnslashdot-request-article): Update end-of-article
	regexp.  Articles containing quotation were cut prematurely.

2006-09-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-cite-original-1): Use nobody by default for the
	value of From header.
	(message-reply): Ditto.

2006-09-11  Daiki Ueno  <ueno@unixuser.org>

	* mml2015.el (mml2015-epg-clear-decrypt): Don't append verify results
	to the gnus-info.  This fixes a bug of inline-PGP message verification.
	Reported by Michael Piotrowski <mxp@dynalabs.de>.

2006-09-09  Reiner Steib  <Reiner.Steib@gmx.de>

	* pop3.el (pop3-leave-mail-on-server): Mention problem of duplicate
	mails in the doc string.  Add some URLs in comment.
	(pop3-movemail): Warn about pop3-leave-mail-on-server.

2006-09-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2047.el (rfc2047-quote-special-characters-in-quoted-strings): Fix
	backslashes handling and the way to find boundaries of quoted strings.

2006-09-07  Daiki Ueno  <ueno@unixuser.org>

	* mml1991.el (mml1991-epg-encrypt): Simply throw an error if
	mml1991-encrypt-to-self is set and mml1991-signers is not set.
	* mml2015.el (mml2015-epg-encrypt): Simply throw an error if
	mml2015-encrypt-to-self is set and mml2015-signers is not set.

2006-09-06  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (gnus-button-marker-list): Move up.  Convert comment into
	doc string.
	(gnus-button-regexp, gnus-button-last): Remove unused variables.

2006-09-06  Simon Josefsson  <jas@extundo.com>

	* mml2015.el (mml2015-use): Doc fix, mention epg.

2006-09-06  Daiki Ueno  <ueno@unixuser.org>

	* mml2015.el (mml2015-use): Default to epg, if available.

2006-09-06  Daiki Ueno  <ueno@unixuser.org>

	* mml1991.el (mml1991-epg-sign): Don't lookup a private key by
	message-sender.
	(mml1991-epg-encrypt): Ditto.
	* mml2015.el (mml2015-epg-sign): Don't lookup a private key by
	message-sender.
	(mml2015-epg-encrypt): Ditto.

2006-09-04  Chong Yidong  <cyd@stupidchicken.com>

	* message.el (message-send-mail-with-sendmail): Look for sendmail in
	several common directories.

2006-09-05  Daiki Ueno  <ueno@unixuser.org>

	* mml2015.el (mml2015-epg-encrypt): Expand group configuration.
	* mml1991.el (mml1991-epg-encrypt): Expand group configuration.

2006-09-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (article-decode-encoded-words): Make it fast.

2006-09-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (article-decode-encoded-words): Don't infloop in XEmacs.

	* rfc2047.el (rfc2047-strip-backslashes-in-quoted-strings): Decode `\\'
	in quoted string into `\'.

2006-09-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2047.el (rfc2047-quote-special-characters-in-quoted-strings):
	Use standard-syntax-table.

2006-09-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-decode-address-function): New variable.
	(article-decode-encoded-words): Use it to decode headers which are
	assumed to contain addresses.
	(gnus-mime-delete-part): Remove useless `or'.

	* gnus-sum.el (gnus-decode-encoded-address-function): New variable.
	(gnus-summary-from-or-to-or-newsgroups): Use it to decode To header.
	(gnus-nov-parse-line): Use it to decode From header.
	(gnus-get-newsgroup-headers): Ditto.
	(gnus-summary-enter-digest-group): Use it to decode `to-address'.

	* mail-parse.el (mail-decode-encoded-address-region): New alias.
	(mail-decode-encoded-address-string): New alias.

	* rfc2047.el (rfc2047-quote-special-characters-in-quoted-strings):
	New function.
	(rfc2047-encode-message-header, rfc2047-encode-region): Use it.
	(rfc2047-strip-backslashes-in-quoted-strings): New fnction.
	(rfc2047-decode-region): Use it; add optional argument `address-mime'.
	(rfc2047-decode-string): Ditto.
	(rfc2047-decode-address-region): New function.
	(rfc2047-decode-address-string): New function.

2006-08-31  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-caesar-buffer-body): Allow rotating headers.

	* gnus-sum.el (gnus-summary-caesar-message): Allow rotating headers.

	* message.el (message-insert-formated-citation-line): Fix %f.
	Reported by Torsten Bronger <bronger@physik.rwth-aachen.de> .

2006-08-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-bookmark.el (gnus-bookmark-file-coding-system): New variable.
	(gnus-bookmark-mouse-available-p): New macro.
	(gnus-bookmark-bmenu-list): Use it; use gnus-mouse-2.
	(gnus-bookmark-bmenu-show-infos): Use it.
	(gnus-bookmark-insert-details): Use it; use gnus-mouse-2.
	(gnus-bookmark-bmenu-hide-infos): Ditto.
	(gnus-bookmark-remove-properties): New function.
	(gnus-bookmark-set, gnus-bookmark-make-cell): Use it.
	(gnus-bookmark-set-bookmark-name): Don't use 2nd arg of split-string.
	(gnus-bookmark-write-file): Bind coding-system-for-write.
	(gnus-bookmark-insert-file-format-version-stamp): Add coding cookie.
	(gnus-bookmark-jump): Make completing-read work with XEmacs; activate
	group before selecting it.
	(gnus-bookmark-get-bookmark): Use assoc instead of assoc-string.
	(gnus-bookmark-bmenu-mode-map): Bind `q' to bury-buffer instead of
	quit-window if it is not available; use gnus-mouse-2 and bind it to
	gnus-bookmark-bmenu-select-by-mouse.
	(gnus-bookmark-show-details): Remove unused variable `details-list'.
	(gnus-bookmark-bmenu-select-by-mouse): New function.

2006-08-13  Romain Francoise  <romain@orebokech.com>

	* mm-extern.el (mm-extern-mail-server): End `y-or-n-p' prompt with a
	space.

2006-08-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* compface.el (uncompface): Use binary rather than raw-text-unix.

2006-08-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* compface.el (uncompface): Make sure the eol conversion doesn't take
	place when communicating with the external programs.
	Reported by ARISAWA Akihiro <ari@mbf.ocn.ne.jp>.

2006-07-31  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnheader.el (nnheader-insert-head): Fix typo in comment.

2006-07-31  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* nnweb.el (nnweb-google-parse-1): Update regexp for author and date.
	Make it more robust by parsing author and date independently.

2006-07-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnheader.el (nnheader-insert-head): Make it work with Mac as well.

2006-07-28  Daiki Ueno  <ueno@unixuser.org>

	* mml2015.el (mml2015-epg-sign): If mml2015-signers is not set, use the
	first matching secret key.
	(mml2015-epg-encrypt): Ditto.

	* mml1991.el (mml1991-epg-sign): If mml1991-signers is not set, use the
	first matching secret key.
	(mml1991-epg-encrypt): Ditto.

	* mml2015.el (mml2015-encrypt-to-self): New user option.
	(mml2015-epg-encrypt): Append mml2015-signers to recipients list if
	mml2015-epg-encrypt-to-self is set.

	* mml1991.el (mml1991-encrypt-to-self): New variable.
	(mml1991-epg-encrypt): Append mml1991-signers to recipients list if
	mml1991-epg-encrypt-to-self is set.

	* mml2015.el (mml2015-signers): New user option.
	(mml2015-epg-sign): Reflect the value of mml2015-signers.
	(mml2015-epg-encrypt): Allow to select signing keys.

	* mml1991.el (mml1991-signers): New variable.
	(mml1991-epg-sign): Reflect the value of mml1991-signers.
	(mml1991-epg-encrypt): Allow to select signing keys.

2006-07-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnheader.el (nnheader-insert-head): Make it work even if the file
	uses CRLF for the line-break code.

2006-07-25  Daiki Ueno  <ueno@unixuser.org>

	* mml2015.el: Require mml-sec instead of password.
	(mml2015-verbose): Inherit the default value from mml-secure-verbose.
	(mml2015-cache-passphrase): Inherit the default value from
	mml-secure-cache-passphrase.
	(mml2015-passphrase-cache-expiry): Inherit the default value from
	mml-secure-passphrase-cache-expiry.

	* mml1991.el: Require mml-sec instead of password.
	(mml1991-verbose): Inherit the default value from mml-secure-verbose.
	(mml1991-cache-passphrase): Inherit the default value from
	mml-secure-cache-passphrase.
	(mml1991-passphrase-cache-expiry): Inherit the default value from
	mml-secure-passphrase-cache-expiry.

	* mml-sec.el: Require password.
	(mml-secure-verbose): New user option.
	(mml-secure-cache-passphrase): New user option.
	(mml-secure-passphrase-cache-expiry): New user option.

2006-07-24  David Smith  <davidsmith@acm.org>  (tiny change)
	    Andreas Vögele  <andreas@altroot.de>   (tiny change)

	* pgg-def.el (pgg-truncate-key-identifier):
	Truncate the key ID to 8 letters from the end.

2006-07-19  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* mm-url.el (mm-url-insert-file-contents): Inhibit Connection: close
	workaround for the url package included with Emacs.

	* nnweb.el (nnweb-google-create-mapping): Update regexp.

2006-07-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-select-newsgroup): Setup the article buffer
	correctly.  This fixes a bug caused by the 2006-05-12 change.

2006-07-18  Karl Fogel  <kfogel@red-bean.com>

	* nnmail.el (nnmail-article-group): If splitting raises an error, give
	some information about the error when saying that the `bogus' mail
	group will be used.

2006-07-17  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-sum.el (gnus-summary-delete-article): Don't use TAB in doc
	string.

2006-07-16  NAKAJI Hiroyuki  <nakaji@heimat.jp>  (tiny change)

	* mm-util.el (mm-charset-synonym-alist): Map windows-31j to cp932.

2006-07-14  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* gnus-start.el (gnus-subscribe-options-newsgroup-method): Doc fix.

2006-07-10  Daiki Ueno  <ueno@unixuser.org>

	* mml1991.el (mml1991-function-alist): Add epg.
	(mml1991-epg-passphrase-callback, mml1991-epg-sign)
	(mml1991-epg-encrypt): New functions.

2006-07-10  Daiki Ueno  <ueno@unixuser.org>

	* mml2015.el (mml2015-verbose): New variable.
	(mml2015-cache-passphrase): Ditto.
	(mml2015-passphrase-cache-expiry): Ditto.
	(mml2015-function-alist): Add epg.
	(mml2015-epg-passphrase-callback, mml2015-epg-decrypt)
	(mml2015-epg-clear-decrypt, mml2015-epg-verify)
	(mml2015-epg-clear-verify, mml2015-epg-sign, mml2015-epg-encrypt):
	New functions.

2006-07-08  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* message.el (message-cite-original-1): Preserve region when removing
	quoted text due to X-No-Archive in order to avoid bogus attribution
	when citing multiple messages.

2006-06-27  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* gnus-group.el (gnus-group-sort-by-unread): Fix typo.
	Reported by Kenneth Jacker <khj@be.cs.appstate.edu>.

2006-06-26  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-diary.el (gnus-user-format-function-d)
	(gnus-user-format-function-D): Autoload.

	* imap.el (Commentary): Fix typo.

	* gnus-util.el (kill-empty-logs, gnus-byte-compile): Remove anonymous
	2006-04-22 contribution.

2006-06-26  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* gnus.el (gnus-valid-select-methods): Revert last change for nnweb.
	It didn't really fix the bogosity I'm seeing with solid web groups.

2006-06-26  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* gnus.el (gnus-valid-select-methods): Declare nnweb with 'address.
	Since revision 6.95 (2003-01-05) of gnus-group.el, solid web groups are
	created using server names.  If we use the feature without declaring
	it, Gnus does not properly manage server and group state.

	* nnweb.el (nnweb-google-search): Respect nnweb-max-hits as upper
	bound.

2006-06-25  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* gnus.el (gnus-find-method-for-group): On killed/unknown groups, try
	looking up the method using GROUP's prefix before inventing a new one.
	It is used on killed/unknown groups in various places where returning
	an all-new method isn't expected by the caller.

	* gnus-util.el (gnus-group-server): Fix for empty virtual server names
	and match semantics of gnus-group-real-prefix.

2006-06-22  Reiner Steib  <Reiner.Steib@gmx.de>

	* nnmail.el (nnmail-broken-references-mailers): New variable.
	(nnmail-ignore-broken-references): New function generalizing
	nnmail-fix-eudora-headers.
	(nnmail-fix-eudora-headers): Now obsolete.

	* gnus-art.el (gnus-button-handle-custom):
	Support `customize-apropos*'.

2006-06-21  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-art.el (article-hide-headers): Inhibit read-only stuff.

	* gnus-group.el (gnus-fetch-group): Document ARTICLES and select those
	articles.

2006-06-21  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-cite-reply-above): New variable.
	(message-yank-original): Use it.

2006-06-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2231.el (rfc2231-parse-string): Allow `*'s in parameter values.

2006-06-20  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-bookmark.el (gnus-bookmark-jump): Don't mark unrelated articles
	as read.

	* gnus-group.el (gnus-group-quick-select-group): Add GROUP argument.

2006-06-19  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-bookmark.el: Fix Copyright, keywords, whitespace, etc.
	(gnus-bookmark-default-file): Use gnus-directory.
	(gnus-bookmark-bmenu-file-column, gnus-bookmark-use-annotations):
	Remove "*" in doc string.
	(gnus-bookmark-write-file): Simplify.
	(gnus-bookmark-maybe-sort-alist): Use `when'.
	(gnus-bookmark-get-bookmark): Fix typo in doc string.
	(gnus-bookmark-set-bookmark-name, gnus-bookmark-get-bookmark):
	Add FIXME about Emacs 21 and XEmacs compatibility.
	(gnus-bookmark-set-bookmark-name): Use `gnus-replace-in-string' for
	compatibility.
	(gnus-bookmark-bmenu-mode): Use `gnus-run-mode-hooks' for
	compatibility.
	(gnus-bookmark-menu-heading): Fix version.

2006-06-19  Bastien Guerry  <bzg@altern.org>

	* gnus-bookmark.el: New file.

2006-06-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-syntax-checks): Doc fix.

2006-06-17  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* gnus-srvr.el (gnus-browse-unsubscribe-group): Don't subscribe
	unsubscribed groups as if they were killed ones.  It causes duplicate
	entries in gnus-newsrc-alist.

2006-06-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-syntax-checks): Doc fix.
	(message-send-mail): Add check for continuation headers.
	(message-check-news-header-syntax): Fix regexp used to check for
	continuation headers.

2006-06-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-display-mime): Make sure body ends with newline.

2006-06-11  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (gnus-article-toggle-truncate-lines): Fix code.

2006-06-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-truncate-lines): Default to the value of
	default-truncate-lines.

2006-06-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-util.el (mm-mime-mule-charset-alist): Use unicode-precedence-list
	to fill the utf-8 entry.

2006-06-01  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* nnweb.el (nnweb-google-parse-1): Update regexp for author and date.

2006-05-30  Kevin Greiner  <kevin.greiner@compsol.cc>

	* gnus-agent.el (directory-files-and-attributes): Move all the way
	forward (the third and final move).
	(gnus-agent-read-agentview): Trap reconstruction errors due to
	nonexistent directory.  Handle by returning nil.

2006-05-30  Didier Verna  <didier@xemacs.org>

	* message.el (message-dont-reply-to-names): Update the custom type.
	* message.el (message-dont-reply-to-names): New defsubst: potentially
	convert a list of regexps into a single one.
	* message.el (message-get-reply-headers): Use it.
	* nnmail.el (nnmail-fancy-expiry-target): Ditto.

2006-05-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-agent.el (directory-files-and-attributes): Move forward.

2006-05-29  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-ml.el (gnus-mailing-list-subscribe)
	(gnus-mailing-list-unsubscribe, gnus-mailing-list-owner)
	(gnus-mailing-list-message): Fix doc strings.

2006-05-29  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* gnus-ml.el (gnus-mailing-list-message): Use gnus-url-mailto instead
	of doing it manually.

2006-05-29  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (gnus-article-toggle-truncate-lines): Fix typo in
	comment.

2006-05-29  Kevin Greiner  <kevin.greiner@compsol.cc>

	* gnus-agent.el: Add gnus-agent-flush* to purge agent info.
	(gnus-agent-read-agentview): Fix handling of end-of-file error.
	(gnus-agent-read-local): All symbols allocated in my-obarray.
	(gnus-agent-set-local): Skip invalid entries (min and/or max is nil).
	(gnus-agent-regenerate-group): Check numeric names to see if they are
	messages or groups.
	(gnus-agent-total-fetched-for): Ignore 'dummy.group' (there should be a
	better way of do this...)

	* gnus-cache.el (gnus-agent-total-fetched-for):
	Ignore 'dummy.group' (there should be a better way of do this...)

2006-05-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-save-all-headers): Mention it might be overridden.
	(gnus-saved-headers): Ditto.
	(gnus-default-article-saver): Mention functions may have properties.
	(gnus-article-save): Override gnus-save-all-headers and
	gnus-saved-headers by :headers property which saver function may have.
	(gnus-summary-save-in-file): Add :headers property.
	(gnus-summary-write-to-file): Ditto.

	* gnus-sum.el (gnus-summary-save-article): Bind
	gnus-prompt-before-saving to t when saving many articles in a file;
	always show all headers.

2006-05-26  Reiner Steib  <Reiner.Steib@gmx.de>

	* deuglify.el (gnus-outlook-rearrange-article): Add missing citation
	marks.

	* message.el (message-indent-citation): Add optional arguments to allow
	using it outside of message buffers.

	* gnus-art.el (gnus-article-unfold-long-headers): New variable.
	(gnus-article-treat-unfold-headers): Use it.
	(gnus-article-truncate-lines): New variable.
	(gnus-article-mode): Use it.
	(gnus-article-toggle-truncate-lines): New function.

	* gnus-sum.el (gnus-summary-wash-map, gnus-summary-make-menu-bar):
	Add gnus-article-toggle-truncate-lines.

	* uudecode.el (uudecode-decode-region-external): nil isn't a valid
	coding system in XEmacs, use binary.

2006-05-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-util.el (mm-enrich-utf-8-by-mule-ucs): Don't edit
	after-load-alist.

	* gnus-art.el (gnus-summary-save-in-file): Use property to specify
	this function should save decoded articles.
	(gnus-summary-write-to-file): Use property to specify this function
	should save decoded articles and specify gnus-summary-save-in-file
	should be used to save articles other than the first one when saving
	many articles.
	(gnus-summary-save-body-in-file): Use property to specify this
	function should save decoded articles.
	(gnus-summary-write-body-to-file): Use property to specify this
	function should save decoded articles and specify
	gnus-summary-save-body-in-file should be used to save articles other
	than the first one when saving many articles.

	* gnus-sum.el (gnus-summary-save-article): Simplify.

2006-05-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-default-article-saver):
	Add gnus-summary-write-body-to-file.
	(gnus-article-save-coding-system): Don't use coding system object
	in XEmacs.
	(gnus-read-save-file-name): Add optional `dir-var' argument which
	specifies directory in which files are saved; work even if optional
	`variable' argument is not specified.
	(gnus-summary-write-to-file): Read file name.
	(gnus-summary-save-body-in-file): Add optional `overwrite' argument.
	(gnus-summary-write-body-to-file): New function.

	* gnus-sum.el (gnus-newsgroup-last-directory): New variable.
	(gnus-summary-local-variables): Add it.
	(gnus-summary-save-map): Add gnus-summary-write-article-body-file.
	(gnus-summary-save-article): Remove optional `decode' argument;
	determine whether to decode articles by the value of
	gnus-default-article-saver; when saving many files using
	gnus-summary-write-to-file or gnus-summary-write-body-to-file, use
	it first and use gnus-summary-save-in-file or
	gnus-summary-save-body-in-file thereafter unless
	gnus-prompt-before-saving is always; move point to article which
	will be saved.
	(gnus-summary-save-article-file): Revert.
	(gnus-summary-write-article-file): Revert.
	(gnus-summary-save-article-body-file): Revert.
	(gnus-summary-write-article-body-file): New function.

2006-05-26  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (gnus-article-browse-html-article): Remove comment.

2006-05-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-default-article-saver): Doc fix.
	(gnus-article-save-coding-system): Move from gnus-sum.el, rename
	from gnus-summary-save-article-coding-system, and default to a
	certain coding system.
	(gnus-output-to-file): Add coding cookie and encode text according
	to gnus-article-save-coding-system; don't use mm-append-to-file.

	* gnus-sum.el (gnus-summary-save-article-coding-system): Move to
	gnus-art.el and rename to gnus-article-save-coding-system.
	(gnus-summary-save-article): Require gnus-art; don't show all
	headers if it decodes articles; don't add coding cookie here;
	don't bind mm-text-coding-system-for-write.
	(gnus-summary-save-article-file): Save decoded articles.
	(gnus-summary-write-article-file): When saving many files, use
	gnus-summary-write-to-file first and gnus-summary-save-in-file
	thereafter unless gnus-prompt-before-saving is always.
	(gnus-summary-save-article-body-file): Save decoded articles.

2006-05-23  Reiner Steib  <Reiner.Steib@gmx.de>

	* nnrss.el (nnrss-check-group): Bind hash-index.

2006-05-23  Michaël Cadilhac  <michael.cadilhac@lrde.org>

	* nnrss.el (nnrss-check-group): Use the md5sum of the whole RSS item as
	its hash index.  Store this hash in `nnrss-group-data'.
	(nnrss-read-group-data): Update accordingly.

2006-05-23  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (gnus-button-alist): Improve gnus-button-handle-symbol
	entry.

	* gnus-sum.el (gnus-summary-make-menu-bar):
	Add gnus-article-browse-html-article.

2006-05-23  Hynek Schlawack  <hynek@ularx.de>

	* gnus-sum.el (gnus-summary-mime-map):
	Add gnus-article-browse-html-article.

2006-05-23  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-sum.el (gnus-summary-save-article-coding-system): Offer some
	suitable coding systems in customize.

2006-05-22  Reiner Steib  <Reiner.Steib@gmx.de>

	* mail-source.el (mail-sources): Fix custom type.

2006-05-18  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-sum.el (gnus-summary-save-article-mail): Clarify doc string.
	(gnus-summary-expire-articles-now): Shorten prompt.

	* gmm-utils.el (wid-edit): Require.
	(defun-gmm): Rename from `gmm-defun-compat'.
	(gmm-image-search-load-path): Use it.
	(gmm-image-load-path-for-library): Use it.  Sync with `mh-compat.el'.

2006-05-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-summary-save-article-coding-system):
	New variable.
	(gnus-summary-save-article): Add optional `decode' argument.
	If it is set and gnus-summary-save-article-coding-system is non-nil,
	save decoded article.
	(gnus-summary-write-article-file): Save decoded article if
	gnus-summary-save-article-coding-system is non-nil.

	* ecomplete.el (ecomplete-database-file-coding-system): Fix custom
	type.

2006-05-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (easy-menu-define): Use :active instead of :enable.

2006-05-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-setup-buffer): Go to summary buffer
	first to test gnus-single-article-buffer which may be buffer-local.

	* gnus-sum.el (gnus-summary-setup-buffer):
	Make gnus-single-article-buffer buffer-local and nil in ephemeral
	group; make gnus-article-buffer, gnus-article-current, and
	gnus-original-article-buffer always buffer-local.
	(gnus-summary-exit): Kill article buffer belonging to ephemeral
	group.
	(gnus-handle-ephemeral-exit): Don't move to next summary line.

2006-05-08  Reiner Steib  <Reiner.Steib@gmx.de>

	* nnml.el (nnml-request-compact-group): Compressed files might not
	have .gz extension.

2006-05-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mm-decode.el (mm-dissect-buffer): Remove spurious double assignment.
	(mm-copy-to-buffer): Use with-current-buffer.
	(mm-display-part): Simplify.
	(mm-inlinable-p): Add optional arg `type'.

2006-05-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* gnus-art.el (gnus-mime-view-part-as-type): Add optional PRED arg.
	(gnus-mime-view-part-externally, gnus-mime-view-part-internally):
	Try harder to show the attachment internally or externally using
	gnus-mime-view-part-as-type.

2006-05-02  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-from-style, message-signature-separator)
	(message-user-organization-file, message-send-mail-function)
	(message-citation-line-function, message-yank-prefix)
	(message-indent-citation-function, message-signature)
	(message-signature-file, message-signature-insert-empty-line):
	Remove autoloads.

	* gnus-art.el (gnus-buttonized-mime-types):
	Remove "multipart/signed".  Revert 2006-04-26 change.

2006-05-01  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus.el (gnus-version-number): Bump version.

2006-05-01  Lars Magne Ingebrigtsen  <lars@ingebrigtsen.no>

	* gnus.el: No Gnus v0.5 is released.

2006-04-30  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* nnweb.el (nnweb-request-article): Do proper xwfu encoding when
	fetching articles by message-id.

2006-04-30  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (hashcash): Require hashcash as normal.

	* ecomplete.el (ecomplete-highlight-match-line):
	Use point-at-eol.
	(ecomplete-highlight-match-line): Use `highlight', because that
	face exists in both Emacs and XEmacs.

	* message.el (message-display-abbrev): Use point-at-bol.

	* mail-source.el: Don't require timer/timer-funcs.

	* gnus-async.el: Ditto.

	* password.el: Ditto.

	* mm-url.el: Ditto.

	* mm-util.el: Require timer/timer-funcs.

2006-04-23  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* mm-url.el (mm-url-insert-file-contents): Don't set Connection:
	Close.

2006-04-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-uu.el (mm-uu-pgp-encrypted-extract-1): Assume buffer is made
	unibyte after clear-decrypt function runs.

	* mml2015.el (mml2015-pgg-clear-decrypt): Treat data which pgg
	returns as a unibyte string.

2006-04-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mml1991.el (mml1991-pgg-sign): No need to load pgg.el, which is
	always loaded by way of gnus-art.el -> mm-uu.el -> mml2015.el.
	(mml1991-pgg-encrypt): Ditto.

2006-04-26  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-user-organization-file): Check several
	locations of the organization file.

	* gnus-sum.el (gnus-summary-mime-map, gnus-summary-make-menu-bar):
	Add gnus-article-view-part-as-type.

	* gnus-art.el (gnus-article-view-part-as-type): New function.

	* message.el (message-valid-fqdn-regexp): Add TLDs .cat, jobs,
	.mobi and .travel.  Remove .nato, .bitnet and .uucp.

	* mml.el: Simplify autoload.
	(mml-mode): defvar dnd-protocol-alist instead of using
	symbol-value.
	(mml-default-directory): New variable.
	(mml-minibuffer-read-file): Use it.
	(mml-dnd-protocol-alist, mml-dnd-attach-options): Adjust :version.

	* message.el (message-citation-line-format): New variable.
	(message-insert-formated-citation-line): New function.
	(message-citation-line-function):
	Add `message-insert-formated-citation-line' to custom type.

	* mm-decode.el (mm-verify-option): Add gnus-buttonized-mime-types
	to doc string.

	* gnus-art.el (gnus-buttonized-mime-types): Add "multipart/signed"
	depending on mm-verify-option.

2006-04-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mml1991.el (mml1991-pgg-sign): Make sure to load pgg.el before
	binding pgg-* variables; reimplement the section which prevents
	MIME header from being signed.
	(mml1991-pgg-encrypt): Make sure to load pgg.el before binding
	pgg-text-mode; remove a blank line at the top of body.

	* mm-uu.el (mm-uu-pgp-encrypted-extract-1): Don't remove blank
	lines at the top of body; use gnus-newsgroup-charset if there's no
	Charset header.

2006-04-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-self-insert-commands): Doc fix.

	* mm-uu.el (mm-uu-pgp-signed-test): Erase prompt.
	(mm-uu-pgp-encrypted-test): Ditto.
	(mm-uu-pgp-encrypted-extract-1): Make sure there's a blank line
	between header and body; return application/pgp-encrypted handle
	if decryption failed; decode decrypted body by charset.

	* mm-decode.el (mm-automatic-display): Don't make application/pgp
	element match to application/pgp-*.

2006-04-23  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* nnweb.el (nnweb-google-wash-article): Sync up to new Google
	HTML.

2006-04-23  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mail-source.el (mail-source-call-script): Message the error
	string.

2006-04-22  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-util.el (gnus-byte-compile): Use it.

2006-04-22  xyblor  <fake@invalid.email>  (tiny change)

	* gnus-util.el (kill-empty-logs): New function.

2006-04-22  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-mail-alias-type): Doc fix.
	(message-mail-alias-type-p): New function.
	(message-send): Use it.
	(message-mode): Ditto.
	(message-strip-forbidden-properties): Ditto.

	* ecomplete.el (ecomplete-database-file-coding-system):
	New variable.
	(ecomplete-save): Use it.
	(ecomplete-setup): Use it.

2006-04-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-self-insert-commands): New variable.
	(message-strip-forbidden-properties): Use it.

2006-04-22  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-put-addresses-in-ecomplete): Use a regexp
	that doesn't make XEmacs choke.

2006-04-20  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-util.el (gnus-replace-in-string):
	Prefer replace-regexp-in-string over of replace-in-string.

2006-04-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-util.el (gnus-select-frame-set-input-focus):
	Use select-frame-set-input-focus if it is available in XEmacs; use
	definition defined in Emacs 22 for old Emacsen.

2006-04-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-view.el (mm-inline-text): Use equal instead of equalp.

2006-04-18  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-cache-save): Remove text
	properties when saving via the temp buffer.

2006-04-18  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-generate-hashcash): Honor custom type.

2006-04-18  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-generate-hashcash): Default to non-nil when
	hashcash is found.

	* gnus-sum.el (gnus-summary-expire-articles-now): Clarify prompt.
	(gnus-refer-thread-limit): Increase default to 500.

	* mm-view.el (mm-inline-text): Supply delsp to flow-fill.

	* flow-fill.el (fill-flowed): Allow delete-space.

2006-04-18  Reiner Steib  <Reiner.Steib@gmx.de>

	* deuglify.el (gnus-outlook-deuglify-unwrap-min)
	(gnus-outlook-deuglify-unwrap-max, gnus-outlook-display-hook):
	Remove autoloads.

2006-04-18  Simon Josefsson  <jas@extundo.com>

	* message.el (message-generate-hashcash): Default to.

2006-04-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2231.el (rfc2231-parse-string): Decode encoded value after
	concatenating segments rather than before concatenating them.

2006-04-17  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-group.el: Move comment to gnus-group-update-tool-bar.

	* imap.el (imap-quote-specials): New function.
	(imap-login-auth): Quote specials.

2006-04-17  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* rfc2231.el (rfc2231-parse-string): Sort the parameters first.

	* message.el (message-forward-make-body-plain):
	Allow message-forward-ignored-headers to be a list.
	(message-remove-ignored-headers): Factor out into function.
	(message-forward-make-body-mml): Use it.
	* rfc2231.el (rfc2231-parse-string): Remove dead code.
	(rfc2231-parse-string): Allow concatanation of parameters that
	aren't contiguous.  The test case is
	  (mail-header-parse-content-type "message/external-body;
	    name*0*=us-ascii''~%2ffoo%2fbar%2fbaz%2fxyzzy%2f;
	    access-type=LOCAL-FILE;
	    name*1*=plugh%2fhello-sailor%2fbing.pdf")

2006-04-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* nntp.el (nntp-accept-process-output): Return the value of
	`nnheader-accept-process-output'.

2006-04-17  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-art.el (gnus-article-treat-types): Add text/x-patch.
	(gnus-button-alist): Recognize more diff formats.
	(gnus-button-patch): Strip directory.

2006-04-17  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-util.el (gnus-select-frame-set-input-focus): Check for
	Emacs 22 when setting focus.

2006-04-17  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-art.el (gnus-article-treat-types): Do treatment of
	text/x-verbatim parts.
	(gnus-button-patch): New command.

	* ietf-drums.el (ietf-drums-parse-address): Attempt parsing
	addresses that contain invalid characters.

2006-04-16  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-put-addresses-in-ecomplete):
	Use gnus-replace-in-string.
	(message-is-yours-p): Use the more correct
	mail-header-parse-address instead of
	mail-extract-address-components.
	(message-put-addresses-in-ecomplete): Fix typo.

	* gnus-sum.el (gnus-summary-limit-to-bodies): New command and
	keystroke.

	* gnus-art.el (gnus-treatment-function-alist): Change order of
	newsgroups/generic header folding to avoid double-folding.

	* message.el (message-hidden-headers): Add X-Draft-From.

	* gnus-sum.el (gnus-summary-repeat-search-article-forward):
	New command.
	(gnus-summary-repeat-search-article-backward): New command.

	* gnus-topic.el (gnus-topic-display-missing-topic): Skip past
	groups in the parent topic.

2006-04-16  João Cachopo  <joao.cachopo@inesc-id.pt>  (tiny change)

	* spam.el (spam-necessary-extra-headers): Add X-CRM114-Status.
	(spam-extra-header-to-number): Return the CRM114 number as a
	number instead of a string.

2006-04-16  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-art.el (gnus-face-properties-alist): Move here from
	gnus-fun.

	* gnus-fun.el (gnus-face-properties-alist): Move to gnus-art.

2006-04-15  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-strip-forbidden-properties): Only display on
	self-insert-command.

	* hashcash.el (hashcash-insert-payment-async): Remove dead code;
	reindent.
	(hashcash-insert-payment-async-2): Make sure the buffer is alive.

2006-04-15  NAKAJI Hiroyuki  <nakaji@takamatsu-nct.ac.jp>  (tiny change)

	* smiley.el (smiley-style): Fix typo.

2006-03-23  Kenichi Handa  <handa@m17n.org>

	* rfc2231.el (rfc2231-encode-string): Use mm-disable-multibyte
	instead of set-buffer-multibyte.

2006-03-23  Kenichi Handa  <handa@m17n.org>

	* rfc2231.el (rfc2231-decode-encoded-string): Work on unibyte
	buffer and then decode the buffer text if necessary.
	(rfc2231-encode-string): Be sure to work on multibyte buffer at
	first, and after mm-encode-body, change the buffer to unibyte.

2006-04-15  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* hashcash.el (hashcash-insert-payment-async-2):
	Use message-goto-eoh instead of doing it manually.
	(mail-add-payment): Use message-narrow-to-header instead of trying
	to do the same itself.

	* message.el (message-hidden-headers): Add Face.

	* gnus-sum.el (gnus-summary-reparent-thread): Factor out
	reparenting code.
	(gnus-summary-reparent-children): Refactored out code.
	(gnus-summary-thread-map): New keystroke.
	(gnus-summary-reparent-children): Make into command.

	* smiley.el (smiley-style): Default to `medium' if using a large
	font.

	* gnus-sum.el (unmorse-region): Remove autoload, because morse.el
	does it itself.

	* message.el (message-point-in-header-p): Simplify definition.

2006-04-14  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnagent.el (nnagent-request-set-mark): Silence log file
	writing.
	(nnagent-request-set-mark): Use write-region instead of
	append-to-file.

	* gnus-sum.el (gnus-read-header): Fudge article number if using a
	strange select method.

	* ecomplete.el (ecomplete-display-matches): Get highlightling
	right.
	(ecomplete-display-matches): Use literals.
	(ecomplete-display-matches): Disable message logging.

	* message.el (message-display-abbrev): Small optimization.

	* ecomplete.el (ecomplete-display-matches): Allow automatic
	display.

	* message.el (message-strip-forbidden-properties):
	Display abbrevs.
	(message-display-abbrev): Get automatic display right.

	* ecomplete.el (ecomplete-display-matches): Use M-n/M-p
	keystrokes.

2006-04-13  Romain Francoise  <romain@orebokech.com>

	TODO: Backport to v5-10!

	* gnus-util.el (gnus-alist-to-hashtable, gnus-hashtable-to-alist):
	Move here (and rename) from gnus-registry.el.

	* gnus-registry.el: Require gnus-util.
	Use `gnus-alist-to-hashtable' and `gnus-hashtable-to-alist'.

2006-04-13  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-group.el (gnus-group-catchup-current):
	Change if-then-else-if-then-else into cond.
	(gnus-group-catchup): Indent.
	(group-name-at-point): New function.
	(gnus-fetch-group): Provide default from thing at point.

2006-04-12  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-display-abbrev): Fix regexp.

	* ecomplete.el (ecomplete-highlight-match-line):
	Reimplement choosing.
	(ecomplete-highlight-match-line): Fix up code rewrite, remove
	dead variables.

	* message.el (message-newline-and-indent): Remove debugging.
	(message-display-abbrev): Use new implementation.

2006-04-12  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (gnus-article-mode):
	Set cursor-in-non-selected-windows to nil.

	* smiley.el: Revert previous change.
	(smiley-data-directory): defvar it before using it in the
	defcustom of `smiley-style'.

2006-04-12  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-newline-and-indent): New function.

	* ecomplete.el: Implement more bits.

	* message.el (message-put-addresses-in-ecomplete): Clean up the
	string.

	* ecomplete.el (ecomplete-add-item): Chop off decimals.

	* gnus-sum.el (gnus-summary-save-parts):
	Bind gnus-summary-save-parts-counter and use it to make unique file
	names.

	* gnus-art.el (gnus-ignored-headers): Add some more headers.

	* ietf-drums.el (ietf-drums-parse-addresses): Take a RAWP
	parameter to say whether to actually parse the individual
	addresses.

	* message.el (message-put-addresses-in-ecomplete): New function.
	(ecomplete): Require.
	(message-mail-alias-type): Add ecomplete as an option.

2006-04-12  Ralf Angeli  <angeli@iwi.uni-sb.de>

	* flow-fill.el (fill-flowed): Remove trailing space from blank
	quoted lines.

2006-04-12  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* smiley.el (smiley-style): Move definition later to avoid a
	compilation warning.

2006-04-12  Kenichi Handa  <handa@m17n.org>

	* rfc2231.el (rfc2231-decode-encoded-string): Work on unibyte
	buffer and then decode the buffer text if necessary.
	(rfc2231-encode-string): Be sure to work on multibyte buffer at
	first, and after mm-encode-body, change the buffer to unibyte.
	Use mm-disable-multibyte instead of set-buffer-multibyte.

2006-04-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-mime-copy-part): Find name parameter in
	Content-Type header instead of Content-Disposition header.
	(gnus-mime-inline-part): Ditto.
	(gnus-mime-view-part-as-charset): Ignore charset that the part
	specifies.

	* mm-decode.el (mm-display-part): Work with external parts and
	usual parts similarly.

	* mm-extern.el (mm-inline-external-body): Use mm-display-part
	instead of gnus-display-mime.

	* mm-util.el (mm-decompress-buffer): Use mm-with-unibyte-buffer
	instead of with-temp-buffer.

	* gnus-uu.el (gnus-uu-save-article): Put mml tags instead of part
	tag to summarized topics part in order to encode non-ASCII text.

2006-04-11  Reiner Steib  <Reiner.Steib@gmx.de>

	* smiley.el (smiley-style): New variable.
	(smiley-directory): New function.
	(smiley-data-directory): Derive from `smiley-style' using
	`smiley-directory'.
	(smiley-regexp-alist): Add new entries.

	* gnus-art.el (gnus-button-valid-localpart-regexp): Exclude `@'.
	(gnus-article-browse-delete-temp): Add :version.

2006-04-11  Arne Jørgensen  <arne@arnested.dk>

	* gnus-sieve.el (gnus-sieve-generate): Delete from the start of
	the sieve region.

2006-04-11  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus.el (gnus-version-number): Bump version.

2006-04-11  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus.el: No Gnus v0.4 is released.

2006-04-11  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnslashdot.el (nnslashdot-retrieve-headers-1): Fix up to new
	layout.

	* rfc2047.el (rfc2047-decode-encoded-words): Don't message about
	unknown charset.

	* message.el (message-header-synonyms): Add Original-To to the
	default.

	* gnus-sum.el (gnus-get-newsgroup-headers-xover): group is an
	optional parameter.

2006-04-06  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-fun.el (gnus): Require it for gnus-directory.

2006-04-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-fun.el (gnus-face-properties-alist): Add :version.

2006-04-05  Daiki Ueno  <ueno@unixuser.org>

	* pgg-gpg.el (pgg-gpg-process-filter): Fix.

2006-04-05  Simon Josefsson  <jas@extundo.com>

	* password.el (password-reset): New function.

2006-04-05  Daiki Ueno  <ueno@unixuser.org>

	* pgg-gpg.el (pgg-gpg-encrypt-region, pgg-gpg-sign-region):
	Wait for BEGIN_SIGNING too, new in GnuPG 1.4.3.

2006-04-04  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* nnweb.el (nnweb-google-create-mapping): Update regexp.
	Some whitespace was matched into the url, which broke browsing hits
	> 100 when mm-url-use-external was nil.

2006-04-04  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-sum.el (gnus-summary-from-or-to-or-newsgroups):
	Check gnus-extra-headers for 'Newsgroups.

	* message.el (message-tool-bar-gnome): Check if `flyspell-mode' is
	bound.

2006-04-04  Daiki Ueno  <ueno@unixuser.org>

	* pgg-gpg.el: Clean up process buffers every time gpg processes
	complete.

2006-04-03  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-fun.el (gnus-convert-image-to-face-command): Fix typo in
	doc string.

2006-04-03  Daiki Ueno  <ueno@unixuser.org>

	* pgg-gpg.el (pgg-gpg-process-filter)
	(pgg-gpg-wait-for-completion): Check if buffer is alive.

	* pgg-gpg.el (pgg-gpg-process-sentinel): Don't remove GNUPG:
	lines, temporary fix.

2006-03-31  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-group.el (gnus-group-update-tool-bar): Add :initialize and :set.

2006-03-29  Daiki Ueno  <ueno@unixuser.org>

	* pgg-gpg.el (pgg-gpg-start-process): Don't bind
	default-enable-multibyte-characters.  This reverts the change from
	revision 6.17 which is no longer necessary because the passphrase
	is sent separately now.  GnuPG messages are unreadable under
	multibyte locales with default-enable-multibyte-characters set to
	nil.

2006-03-28  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-tool-bar-gnome): Move "spell".

2006-03-27  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-sum.el (gnus-summary-from-or-to-or-newsgroups): Don't use
	XEmacs-only `replace-in-string'.  Use `gnus-group-real-name'
	instead.

2006-03-27  Karl Kleinpaste  <karl@charcoal.com>

	* gnus-sum.el (gnus-summary-from-or-to-or-newsgroups):
	Improve newsgroups handling for NNTP overviews which don't include
	Newsgroups.

2006-03-26  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* message.el (message-resend): Bind message-generate-hashcash to nil.

2006-03-26  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* hashcash.el (hashcash-already-paid-p): Bind case-fold-search
	when searching for already-paid recipients.

2006-03-27  Daiki Ueno  <ueno@unixuser.org>

	* pgg-gpg.el: Invoke gpg asynchronous, to avoid querying for
	passphrases when it is not needed.
	(pgg-gpg-use-agent): Add, to hard code that pgg shouldn't wait for
	passphrase stuff from gpg, should only be necessary when you use
	gpg with a smartcard.

2006-03-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mml.el (mml-insert-mime): Ignore cached contents of
	message/external-body part.

	* mm-decode.el (mm-get-part): Add optional 'no-cache' argument.
	(mm-insert-part): Ditto.

2006-03-23  Simon Josefsson  <jas@extundo.com>

	* pgg-gpg.el (pgg-gpg-update-agent): Add again, with fixes from
	Reiner.
	(pgg-gpg-use-agent-p): Use it again.

2006-03-23  Simon Josefsson  <jas@extundo.com>

	* pgg-gpg.el (pgg-gpg-update-agent): Remove, doesn't work with
	older emacsen.
	(pgg-gpg-use-agent-p): Don't use it.

2006-03-23  Reiner Steib  <Reiner.Steib@gmx.de>

	* pgg-gpg.el (pgg-gpg-update-agent): Only use make-network-process
	if we can.

2006-03-22  Sascha Wilde  <wilde@sha-bang.de>

	* pgg-gpg.el (pgg-gpg-use-agent): Disable by default.
	(pgg-gpg-update-agent): New function.
	(pgg-gpg-use-agent-p): New function.
	(pgg-gpg-process-region, pgg-gpg-encrypt-region)
	(pgg-gpg-encrypt-symmetric-region, pgg-gpg-decrypt-region)
	(pgg-gpg-sign-region): Use it.

2006-03-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-map-articles): Don't funcall symbol macro.
	Reported by Ralf Wachinger <rwachinger@gmx.de>.

2006-03-21  Simon Josefsson  <jas@extundo.com>

	* pgg-gpg.el: Ideas below based on patch from Sascha Wilde
	<wilde@sha-bang.de>.
	(pgg-gpg-use-agent): New variable.
	(pgg-gpg-process-region): Use it.
	(pgg-gpg-encrypt-region): Likewise.
	(pgg-gpg-encrypt-symmetric-region): Likewise.
	(pgg-gpg-decrypt-region): Likewise.
	(pgg-gpg-sign-region): Likewise.
	(pgg-gpg-possibly-cache-passphrase): Don't cache a nil password.

2006-03-21  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-agent.el (gnus-agent-queue-mail): Fix custom tag for `t'.

	* spam.el (spam-mark-new-messages-in-spam-group-as-spam):
	Add comment on version.

2006-03-20  Reiner Steib  <Reiner.Steib@gmx.de>

	* smiley.el: Add missing test smiley.

2006-03-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-decode.el (mm-with-part): New macro.
	(mm-get-part): Use it; work with message/external-body as well.
	(mm-save-part): Treat name and filename equally.

	* mm-extern.el (mm-extern-cache-contents): New function.
	(mm-inline-external-body): Use it; force the part to be displayed;
	move undisplayer added to the cached handle to the parent.

	* gnus-art.el (gnus-mime-save-part-and-strip): Add name parameter.
	(gnus-mime-view-part-as-type): Work with message/external-body.

	* gnus-util.el (gnus-tool-bar-update): Bind tool-bar-mode.

2006-03-16  Reiner Steib  <Reiner.Steib@gmx.de>

	* gmm-utils.el (gmm-image-load-path-for-library): Prefer user's
	images in image-load-path.  [Sync with image.el, revision 1.60, in
	Emacs.]

2006-03-15  Reiner Steib  <Reiner.Steib@gmx.de>

	* gmm-utils.el (gmm-image-load-path-for-library): Pass value of
	path rather than symbol.  Always return list of directories.
	Guarantee that image directory comes first.  [Sync with image.el,
	revision 1.59, in Emacs.]

	* message.el (message-make-tool-bar): Adjust to new API of
	`gmm-image-load-path-for-library'.

	* gnus-sum.el (gnus-summary-make-tool-bar): Ditto.

	* gnus-group.el (gnus-group-make-tool-bar): Ditto.

2006-03-15  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* gnus-art.el (gnus-article-only-boring-p):
	Bind inhibit-point-motion-hooks to avoid infinite loop when entering
	intangible text.
	Reported by Ralf Wachinger <rwnewsmampfer@geekmail.de>.

2006-03-14  Reiner Steib  <Reiner.Steib@gmx.de>

	* gmm-utils.el (gmm-image-load-path-for-library): Fix typo.
	Use `defun' instead of `gmm-defun-compat'.

2006-03-14  Simon Josefsson  <jas@extundo.com>

	* message.el (message-unique-id): Don't use message-number-base36
	if (user-uid) is a float.
	Reported by Bjorn Solberg <bjorn_ding1@hekneby.org>.

2006-03-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-uu.el (mm-uu-dissect): Dissect all parts correctly.

	* gnus-art.el (gnus-mime-display-single): Make sure there is an
	empty line between a part and a message part.

2006-03-10  Reiner Steib  <Reiner.Steib@gmx.de>

	* smiley.el: Add more test smileys.
	(smiley-data-directory, smiley-regexp-alist)
	(gnus-smiley-file-types): Fix doc strings.
	(smiley-update-cache): Clear smiley-cached-regexp-alist before
	adding new elements.
	(smiley-mouse-map): Unused code.  Make it a comment.

2006-03-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-nocem.el (gnus-nocem-scan-groups): Add autoload cookie;
	scan latest NoCeM messages instead of old ones.
	(gnus-nocem-check-article): Fix regexps so as to match to PGP
	delimiters that are recently used.
	(gnus-nocem-load-cache): Add autoload cookie.

	* gnus.el (gnus-use-nocem): Enable it to be set to also a number.

	* gnus-start.el (gnus-setup-news): Scan NoCeM messages if a group
	level which is larger than gnus-use-nocem is specified.

	* gnus-group.el (gnus-group-get-new-news): Ditto.

2006-03-08  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-util.el (gnus-tool-bar-update): New function.

	* gnus-group.el (gnus-group-update-tool-bar): New variable.
	(gnus-group-insert-group-line): Add gnus-tool-bar-update.

	* gnus-topic.el (gnus-topic-prepare-topic): Add gnus-tool-bar-update.

	* gnus-group.el (gnus-group-redraw-when-idle)
	(gnus-group-redraw-check): Remove.
	(gnus-group-make-tool-bar): Remove gnus-group-redraw-check.

2006-03-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnmail.el (nnmail-split-it): Invert match-partial-words behavior
	if optional last element is specified in splits (FIELD VALUE...).

2006-03-07  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-make-tool-bar): Rename gmm-image-load-path
	to gmm-image-load-path-for-library.  Call with no-error argument.
	(message-tool-bar-gnome): Rename "mail/attach" to "attach".

	* gnus-sum.el (gnus-summary-make-tool-bar): Ditto.

	* gnus-group.el (gnus-group-make-tool-bar): Ditto.

	* gmm-utils.el (gmm-image-load-path): Remove alias.

2006-03-06  Reiner Steib  <Reiner.Steib@gmx.de>

	* gmm-utils.el (gmm-image-load-path): Add alias.

	* nnml.el (nnml-generate-nov-databases-directory): Rename from
	nnml-generate-nov-databases-1.
	(nnml-generate-nov-databases): Use it.
	(nnml-generate-nov-databases-directory): Document no-active
	argument.

	* gmm-utils.el (gmm-image-load-path-for-library): Return single
	directory if path is t.  Add no-error.

	* gnus-group.el (gnus-group-make-tool-bar): Use add-hook.
	Suggested by Stefan Monnier <monnier@iro.umontreal.ca>.

	* gnus-art.el (gnus-article-browse-delete-temp-files):
	Simplify resetting gnus-article-browse-html-temp-list.

	* gmm-utils.el (gmm-image-load-path-for-library): Sync with
	mh-compat.el revision 1.9 in Emacs.  Rename `gmm-image-load-path'.
	Add example to docstring.  Rename local variables.  Move error
	checks to default case in cond and simplify.

2006-03-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-view.el (mm-w3m-cid-retrieve-1): Check carefully whether
	handle is multipart when calling it recursively.
	(mm-w3m-cid-retrieve): Display warning if retrieving fails.

2006-03-03  Daniel Pittman  <daniel@rimspace.net>

	* nnimap.el (nnimap-request-update-info-internal): Optimize.
	Don't `gnus-uncompress-range' to avoid excessive memory usage.

2006-03-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-group.el (gnus-group-tool-bar-gnome): Check if gnus-topic.el
	is loaded.

	* gnus-sum.el (gnus-summary-tool-bar-gnome): Check if spam.el is
	loaded.

2006-03-03  Reiner Steib  <Reiner.Steib@gmx.de>

	* mm-util.el (mm-with-unibyte-current-buffer): Change "Emacs 23"
	to "Emacs 23 (unicode)" in doc string.

	* gnus-sum.el (gnus-summary-set-display-table): Change "Emacs 23" to
	"Emacs 23 (unicode)" in comment.

2006-03-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-decode.el (mm-get-part): Don't use mm-with-unibyte-current-buffer.

	* gnus-sum.el (gnus-summary-set-display-table): Don't nix out
	characters 160 through 255 in Emacs 23.

2006-03-02  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (gnus-article-browse-html-temp-list): Rename from
	gnus-article-browse-html-temp.
	(gnus-article-browse-delete-temp): Make it customizable.
	Add `file'.  Adjust doc string.
	(gnus-article-browse-delete-temp-files): Add argument.
	Allow query for each file.  Adjust doc string.
	(gnus-article-browse-html-parts):
	Add `gnus-article-browse-delete-temp-files' to
	`gnus-summary-prepare-exit-hook' and `gnus-exit-gnus-hook'.

2006-03-02  Hynek Schlawack  <hynek@ularx.de>

	* gnus-art.el (gnus-article-browse-html-temp)
	(gnus-article-browse-delete-temp): New variables.
	(gnus-article-browse-delete-temp-files): New function.
	(gnus-article-browse-html-parts): Use it.

2006-03-02  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-group.el (gnus-group-redraw-check): Remove redundant tests.

	* gmm-utils.el (gmm-image-load-path): Mention ../etc search in doc
	string.

	* gnus-sum.el (gnus-summary-tool-bar-gnome): Don't use
	gnus-summary-insert-new-articles when unplugged.
	Remove gnus-summary-search-article-forward.

	* gmm-utils.el (gmm-tool-bar-style): Test tool-bar-mode and
	display-visual-class instead of display-color-cells.

2006-03-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mml.el (mml-generate-mime-1): Encode parts other than text/* or
	message/* containing non-ASCII text properly.

2006-03-01  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el: Require gmm-utils, remove autoloads.
	(message-tool-bar): Set default based on
	gmm-tool-bar-style.
	(message-tool-bar-gnome): Add gmm-customize-mode.

	* gnus-sum.el (gnus-summary-tool-bar): Set default based on
	gmm-tool-bar-style.
	(gnus-summary-tool-bar-gnome): Add gmm-customize-mode.

	* gnus-group.el (gnus-group-tool-bar): Set default based on
	gmm-tool-bar-style.
	(gnus-group-tool-bar-gnome): Add gmm-customize-mode.

	* gmm-utils.el (gmm-image-directory): Rename variable from
	gmm-image-load-path.
	(gmm-image-load-path): Use gmm-image-directory.
	(gmm-customize-mode): New function.
	(gmm-tool-bar-style): New variable.

	* gnus-group.el (gnus-group-redraw-when-idle): Rename from
	gnus-group-redraw-line-number.
	(gnus-group-redraw-check): Simplify.
	(gnus-group-tool-bar-update): Remove redraw check.
	(gnus-group-make-tool-bar): Add redraw check.

2006-03-01  Michael Piotrowski  <mxp@dynalabs.de>  (tiny change)

	* gnus-art.el (gnus-button): Add missing parentheses.

2006-02-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-util.el (mm-with-unibyte-current-buffer): Add note.

2006-02-28  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (gnus-button): New face.
	(gnus-article-button-face): Use it.

	* gnus-sum.el (gnus-summary-tool-bar-gnome):
	Add gnus-summary-next-page.  Re-order.

	* gnus-group.el (gnus-group-tool-bar-gnome): prev-node and
	next-node are now included.
	(gnus-group-redraw-line-number): New internal variable.
	(gnus-group-redraw-check): Helper function for updating the tool
	bar.
	(gnus-group-tool-bar-update): Add gnus-group-redraw-check.

	* gmm-utils.el (gmm-tool-bar-item): Add TODO about modifiers.

	* spam.el (spam-spamassassin-score-regexp): New internal variable.
	(spam-extra-header-to-number, spam-check-spamassassin-headers):
	Use it to match format of Spamassassin 3.0 and later.
	Reported by IRIE Tetsuya <irie@t.email.ne.jp>.
	(spam-check-bogofilter)
	(spam-bogofilter-register-with-bogofilter): Fix args of
	`gnus-error' calls.

2006-02-28  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-draft.el (gnus-draft-send): Bind message-signature to avoid
	unnecessary interaction when sending queued mails.
	Reported by TAKAHASHI Yoshio <tkh@jp.fujitsu.com>.

2006-02-27  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-sum.el (gnus-sequence-of-unread-articles): Return nil if
	first or last are nil.

2006-02-24  Andreas Seltenreich  <uwi7@rz.uni-karlsruhe.de>

	* nnweb.el (nnweb-gmane-create-mapping): Don't choke on ^M.

2006-02-24  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-int.el (gnus-open-server): Respect gnus-batch-mode.

2006-02-24  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* dns.el (query-dns): Protect more against buggy tcp output.

2006-02-24  Reiner Steib  <Reiner.Steib@gmx.de>

	* nnweb.el (nnweb-type-definition, nnweb-gmane-search): Use new
	nov.php.

2006-02-24  Andreas Seltenreich  <uwi7@stud.uni-karlsruhe.de>

	* nnweb.el (nnweb-type-definition, nnweb-gmane-create-mapping)
	(nnweb-gmane-wash-article, nnweb-gmane-search): Fix Gmane web
	groups.  Kudos to Olly Betts <olly@survex.com> for providing NOV
	output on the server side.
	(nnweb-google-create-mapping): Update regexps and add some
	progress indication.

2006-02-23  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-group.el (gnus-group-tool-bar-gnome):
	Fix gnus-agent-toggle-plugged.  Re-order icons.
	(gnus-group-tool-bar-gnome):
	Add gnus-group-{prev,next}-unread-group.
	(gnus-group-tool-bar-gnome): Re-order icons.

	* gnus-sum.el (gnus-summary-tool-bar-gnome):
	Move gnus-summary-insert-new-articles.

	* message.el (message-tool-bar-gnome, message-tool-bar-retro):
	Fix comments.

	* utf7.el (utf7-utf-16-coding-system): Fix comment.  utf-16-be is
	also available in Emacs 21.3.

	* message.el (message-fix-before-sending): Change "Emacs 22" to
	"Emacs 23 (unicode)" in comment.

	* qp.el (quoted-printable-encode-region): Change "Emacs 22" to
	"Emacs 23 (unicode)" in comment.

	* mm-util.el: Change "Emacs 22" to "Emacs 23 (unicode)" in
	comment.
	(mm-coding-system-p): Add comment about no-MULE XEmacs.

	* mm-view.el (mm-fill-flowed): Add :version.

2006-02-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gmm-utils.el (gmm-image-load-path): Don't modify image-load-path
	and load-path.

2006-02-22  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el: Autoload gmm-image-load-path.
	(message-tool-bar-retro): Prepend "gnus/" subdirectory to some
	icon file names.  Use old Emacs 21 "mail_send.xpm" icon for
	consitency.

	* gmm-utils.el (gmm-image-load-path): Also search in
	"../etc/images".  Don't set gmm-image-load-path if we don't find
	the image.

2006-02-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gmm-utils.el (gmm-image-load-path): Don't make
	`gmm-image-load-path' include subdirectories which the second arg
	`image' might specify.

	* gnus-group.el (gnus-group-tool-bar-retro): Prepend the "gnus/"
	subdirectory to icon file names.

	* gnus-sum.el (gnus-summary-tool-bar-retro): Ditto.

2006-02-21  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-group.el (gnus-group-make-tool-bar): Add IMAGE argument to
	gmm-image-load-path calls.

	* gnus-sum.el (gnus-summary-make-tool-bar): Ditto.

	* message.el (message-make-tool-bar): Ditto.

	* mml.el (mml-preview): Add comment concerning tool bar icons.

	* gnus-group.el (gnus-group-tool-bar-gnome): Use new icon names.
	(gnus-group-make-tool-bar): Use `gmm-image-load-path'.

	* gnus-sum.el (gnus-summary-tool-bar-gnome): Use new icon names.
	(gnus-summary-make-tool-bar): Use `gmm-image-load-path'.

	* message.el (message-tool-bar-gnome): Use new icon names.
	(message-make-tool-bar): Use `gmm-image-load-path'.

	* gmm-utils.el (gmm-defun-compat, gmm-image-search-load-path):
	New functions from MH-E.
	(gmm-image-load-path): New variable from MH-E.
	(gmm-image-load-path): New function from MH-E.  Add arguments
	LIBRARY, IMAGE and PATH.  Don't modify paths.  Don't use
	*-image-load-path-called-flag.

2006-02-21  Milan Zamazal  <pdm@brailcom.org>

	* mm-view.el (mm-view-pkcs7-verify): Implement using smime.el.

2006-02-21  Wolfram Fenske  <wolfram.fenske@student.uni-magdeburg.de>  (tiny change)

	* nnimap.el (nnimap-request-move-article): Change folder back to
	source group before deleting.

2006-02-20  Reiner Steib  <Reiner.Steib@gmx.de>

	* mm-util.el (mm-charset-override-alist): Fix type in doc string.

	* gnus-art.el (mm-url-insert-file-contents-external):
	Autoload mm-url.

	* mm-uu.el (mm-uu-type-alist): Improve `LaTeX'.

2006-02-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2047.el (rfc2047-charset-to-coding-system): Don't check the
	coding system which mm-charset-to-coding-system returns for a
	given charset is valid.

2006-02-16  Juanma Barranquero  <lekktu@gmail.com>

	* html2text.el (html2text-remove-tag-list):
	* spam-stat.el (spam-stat-buffer-words): Fix typo in docstring.

2006-02-14  Chong Yidong  <cyd@stupidchicken.com>

	* gnus-cus.el: Revert 2005-10-17 change.

2006-02-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (article-strip-banner):
	Call article-really-strip-banner only when the regexp match is made.

2006-02-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (article-strip-banner):
	Use gnus-extract-address-components instead of
	mail-header-parse-addresses to make it work with non-ASCII text;
	remove mail-encode-encoded-word-string.

	* rfc2231.el (rfc2231-parse-string): Attempt to parse parameter
	values which are surrounded with \"...\"; make it never cause a
	Lisp error; give up parsing of parameters if it failed in
	extracting type.

2006-02-14  Arne Jørgensen  <arne@arnested.dk>

	* smime.el (smime-cert-by-ldap-1): Fix bug where
	`smime-ldap-search' returns results without userCertificates.

2006-02-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-util.el (mm-make-temp-file): Don't catch file-error in Emacs.

2006-02-14  Reiner Steib  <Reiner.Steib@gmx.de>

	* spam.el (spam-check-spamassassin-headers): Adapt format for
	Spamassassin 3.0 or later.  Reported by ARISAWA Akihiro
	<ari@mbf.ocn.ne.jp>.
	(spam-list-of-processors): Add spam-use-gmane.

2006-02-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-util.el (mm-make-temp-file): Import the Emacs 22 version of
	make-temp-file; make it work with XEmacs as well.

	* gnus-art.el (gnus-article-browse-html-parts): Use the 3rd arg of
	mm-make-temp-file.

	* mm-decode.el (mm-display-external): Use the 3rd arg of
	mm-make-temp-file.
	(mm-create-image-xemacs): Ditto.

2006-02-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-draft.el (gnus-draft-send): Replace message-narrow-to-head
	with message-narrow-to-headers.
	(gnus-draft-setup): Narrow to header to run message-fetch-field.
	(gnus-draft-check-draft-articles): New function.
	(gnus-draft-edit-message, gnus-draft-send-message): Use it.

2006-02-13  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (gnus-article-browse-html-parts):
	`hs-show-html-list' should read `gnus-article-browse-html-parts'.
	Don't use suffix argument for mm-make-temp-file for Emacs 21
	compatibility.  Remove useless `format'.

2006-02-13  Andreas Seltenreich  <uwi7@stud.uni-karlsruhe.de>

	* nnweb.el (nnweb-google-wash-article): Update regexps.
	(nnweb-group-alist): Use defvoo instead of defvar.

2006-02-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnoo.el (nnoo-declare): Don't generate duplicate entries when
	re-loading nn* modules.

2006-02-10  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-group.el (gnus-group-make-tool-bar): Remove duplicate check
	for `tool-bar-mode' and don't check it's default-value.

	* gnus-sum.el (gnus-summary-make-tool-bar): Ditto.

	* message.el (message-make-tool-bar): Ditto.

	* gnus-art.el (gnus-article-browse-html-parts): Remove useless
	`substring'.  Shorten tmp-file name.

	* gnus.el: Remove bogus comment.

2006-02-10  Hynek Schlawack  <hynek@ularx.de>

	* gnus-art.el (gnus-article-browse-html-parts): New function.
	(gnus-article-browse-html-article): New function for viewing html
	articles with a browser.

2006-02-09  Daiki Ueno  <ueno@unixuser.org>

	* mml2015.el (mml2015-pgg-sign): Enable pgg-text-mode.
	(mml2015-pgg-encrypt): Ditto.

	* mml1991.el (mml1991-pgg-sign): Enable pgg-text-mode.
	(mml1991-pgg-encrypt): Ditto.

2006-02-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnfolder.el (nnfolder-insert-newsgroup-line):
	Use message-make-date instead of current-time-string.

	* mm-view.el (mm-inline-message): Don't set gnus-newsgroup-charset
	to gnus-decoded which mm-uu might set.

2006-02-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2231.el (rfc2231-parse-string): Sort segmented parameters;
	don't decode quoted parameters; remove misimported Emacs code.
	Suggested by ARISAWA Akihiro <ari@mbf.ocn.ne.jp>.
	(rfc2231-decode-encoded-string): Don't use split-string which
	behaves differently according to Emacs version; use
	mm-decode-coding-region to convert charset to coding-system.
	Suggested by ARISAWA Akihiro <ari@mbf.ocn.ne.jp>.
	(rfc2231-encode-string): Remove misimported Emacs code.

2006-02-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (article-decode-charset): Don't use ignore-errors
	when calling mail-header-parse-content-type.
	(article-de-quoted-unreadable): Ditto.
	(article-de-base64-unreadable): Ditto.
	(article-wash-html): Ditto.

	* mm-decode.el (mm-dissect-buffer): Don't use ignore-errors when
	calling mail-header-parse-content-type and
	mail-header-parse-content-disposition.
	(mm-find-raw-part-by-type): Don't use ignore-errors when calling
	mail-header-parse-content-type.

	* mml.el (mml-insert-mime-headers): Use mml-insert-parameter to
	insert charset and format parameters; encode description after
	inserting it to buffer.
	(mml-insert-parameter): Fold lines properly even if a parameter is
	segmented into two or more lines; change the max column to 76.

	* rfc1843.el (rfc1843-decode-article-body): Don't use
	ignore-errors when calling mail-header-parse-content-type.

	* rfc2231.el (rfc2231-parse-string): Return at least type if
	possible; don't cause an error even if it fails in parsing of
	parameters.  Suggested by ARISAWA Akihiro <ari@mbf.ocn.ne.jp>.
	(rfc2231-encode-string): Don't break lines at the beginning, leave
	it to mml-insert-parameter.

	* webmail.el (webmail-yahoo-article): Don't use ignore-errors when
	calling mail-header-parse-content-type.

2006-02-06  Reiner Steib  <Reiner.Steib@gmx.de>

	* spam-report.el (spam-report-gmane-use-article-number):
	Improve doc string.
	(spam-report-gmane-internal): Check if a suitable header was found
	in the article.

2006-02-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2231.el (rfc2231-parse-string): Revert 2006-02-03 change.
	(rfc2231-encode-string): Make param*=value always begin with LWSP.

2006-02-05  Romain Francoise  <romain@orebokech.com>

	Update copyright notices of all files in the gnus directory.

2006-02-03  Andreas Seltenreich  <uwi7@stud.uni-karlsruhe.de>

	* nnweb.el (nnweb-request-group): Avoid growing overview files.

2006-02-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2231.el (rfc2231-parse-string): Add missing semicolons to
	segmented lines of parameter value to cope with Thunderbird 1.5
	bug (cf. https://bugzilla.mozilla.org/show_bug.cgi?id=323318).
	Suggested by ARISAWA Akihiro <ari@mbf.ocn.ne.jp>.
	(rfc2231-encode-string): Don't make lines exceeding 76 column.

2006-02-01  Max Froumentin  <max@lapin-bleu.net>  (tiny change)

	* mml.el (mml-generate-mime-1): Correct the order of inline signed
	parts.

2006-01-31  Andreas Seltenreich  <uwi7@stud.uni-karlsruhe.de>

	* nnweb.el (nnweb-group-alist): Use defvar instead of defvoo,
	there's only one active file for all servers.
	(nnweb-request-scan): Make sure nnweb-articles is initialized on
	solid groups.  Gnus might have used a FAST request to select the group.
	(nnweb-request-group, nnweb-google-parse-1): Don't keep nnweb-type
	and nnweb-search redundantly in the active file.
	(nnweb-request-list): Don't list bogus groups.  There can only be one.
	(nnweb-request-create-group): Don't use ARGS.
	(nnweb-possibly-change-server, nnweb-request-group): Remove some
	initializations.  Let nnoo do the work.

2006-01-31  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-uu.el (mm-uu-emacs-sources-extract, mm-uu-diff-extract):
	Say the part has been decoded.

	* mm-view.el (mm-display-inline-fontify): Get decoded part rightly.

2006-01-31  Kevin Ryde  <user42@zip.com.au>

	* mailcap.el (mailcap-viewer-passes-test): Don't put "(nil t)" into
	mailcap-viewer-test-cache when there's no 'test clause, since that
	will invert the meaning of a "nil" test previously determined by
	mailcap-mailcap-entry-passes-test.

2006-01-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-group.el: Bind tool-bar-mode instead of tool-bar-map when
	compiling.

	* gnus-sum.el: Ditto.

	* message.el: Don't bind tool-bar-map when compiling.

2006-01-30  Reiner Steib  <Reiner.Steib@gmx.de>

	* nnweb.el (nnweb-google-parse-1): Clarify some comments.

2006-01-30  Andreas Seltenreich  <uwi7@stud.uni-karlsruhe.de>

	* nnweb.el (nnweb-type-definition, nnweb-google-parse-1)
	(nnweb-google-create-mapping, nnweb-google-search): Adapt to
	current Google Groups.

2006-01-26  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-sum.el (gnus-summary-make-tool-bar): Add checks for XEmacs
	and tool-bar-mode.

	* gnus-group.el (gnus-group-make-tool-bar): Add checks for XEmacs
	and tool-bar-mode.

	* message.el (message-tool-bar-update): Simplify.
	(message-make-tool-bar): Add checks for XEmacs and tool-bar-mode.

	* gnus-sum.el (gnus-summary-tool-bar-update): Check for
	gnus-summary-buffer.
	(gnus-summary-tool-bar-gnome): Use "reply-author" icon for
	gnus-summary-reply.

	* gmm-utils.el (gmm): Add :version.

2006-01-26  Steve Youngs  <steve@sxemacs.org>

	* gmm-utils.el (gmm-tool-bar-item, gmm-tool-bar-zap-list):
	Don't autoload.

2006-01-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gmm-utils.el (gmm-verbose): Add :group.

2006-01-25  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el: Change some comments WRT tool-bars.

	* gnus-sum.el (gnus-summary-tool-bar)
	(gnus-summary-tool-bar-gnome, gnus-summary-tool-bar-retro)
	(gnus-summary-tool-bar-zap-list): New variables.
	(gnus-summary-make-tool-bar): Complete rewrite using
	`gmm-tool-bar-from-list'.

	* gnus-group.el (gnus-group-tool-bar, gnus-group-tool-bar-gnome)
	(gnus-group-tool-bar-retro, gnus-group-tool-bar-zap-list):
	New variables.
	(gnus-group-make-tool-bar): Complete rewrite using
	`gmm-tool-bar-from-list'.
	(gnus-group-tool-bar-update): New function.

	* message.el (message-mode-field-menu): Add "Show hidden Headers".

2006-01-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-uu.el (mm-uu-dissect-text-parts): Ignore it if a given part
	is dissected into a single part of which the type is the same as
	the given one; decode charset.

2006-01-21  Kevin Ryde  <user42@zip.com.au>

	* mailcap.el (mailcap-parse-mailcap-extras): "test" key must go
	into alists as symbol not string, since that's what
	mailcap-viewer-passes-test and mailcap-mailcap-entry-passes-test
	look for.

2006-01-24  Reiner Steib  <Reiner.Steib@gmx.de>

	* gmm-utils.el (gmm-tool-bar-item): Add "Separator".
	(gmm-tool-bar-from-list): Suppress tooltip for `gmm-ignore'.

	* message.el (message-tool-bar-gnome): Use gmm-ignore.

2006-01-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-mime-security-button-commands): New variable.
	(gnus-mime-security-button-menu): New definition.
	(gnus-mime-security-button-map): Use them.
	(gnus-mime-security-button-menu): New function.
	(gnus-insert-mime-security-button): Addition to help echo.
	(gnus-mime-security-run-function, gnus-mime-security-save-part)
	(gnus-mime-security-pipe-part): New functions.

	* mm-uu.el (mm-uu-buttonize-original-text-parts): Remove.
	(mm-uu-dissect-text-parts): Revert a part of 2006-01-23 change.

	* mm-decode.el (mm-handle-set-disposition): Remove.
	(mm-handle-set-description): Remove.

2006-01-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-view.el (mm-w3m-standalone-supports-m17n-p): New variable.
	(mm-w3m-standalone-supports-m17n-p): New function.
	(mm-inline-text-html-render-with-w3m-standalone): Use it to alter
	w3m usage.

	* gnus-art.el (gnus-article-wash-html-with-w3m-standalone):
	Use mm-w3m-standalone-supports-m17n-p to alter w3m usage.

2006-01-23  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-tool-bar-zap-list):
	Use gmm-tool-bar-zap-list as custom type.
	(message-tool-bar-update): New function.
	(message-tool-bar, message-tool-bar-gnome)
	(message-tool-bar-retro): Add message-tool-bar-update.
	(message-tool-bar-gnome): Add flyspell-buffer.

	* gnus-util.el (gnus-error): Describe `args'.

	* gmm-utils.el (gmm-error): Describe `args'.
	(gmm-tool-bar-zap-list): New widget.
	(gmm-tool-bar-from-list): Improve description of `zap-list'.

2006-01-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-uu.el (mm-uu-buttonize-original-text-parts): New variable.
	(mm-uu-dissect-text-parts): Buttonize original text parts; reduce
	the number of recursive calls.

	* mm-decode.el (mm-handle-set-disposition): New macro.
	(mm-handle-set-description): New macro.

2006-01-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-uu.el (mm-uu-dissect-text-parts): Decode content transfer
	encoding.

2006-01-20  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-tool-bar-zap-list, message-tool-bar)
	(message-tool-bar-gnome, message-tool-bar-retro): New variables.
	(message-tool-bar-local-item-from-menu): Remove.
	(message-tool-bar-map): Replace by `message-make-tool-bar'.
	(message-make-tool-bar): New function.
	(message-mode): Use `message-make-tool-bar'.

	* gmm-utils.el: New file.
	(gmm-verbose, gmm-message, gmm-error): From gnus-utils.el.
	(gmm-lazy): New widget copied from `nnmail.el'.
	(gmm-tool-bar-from-list): New function for creating customizable
	tool bars.
	(gmm-tool-bar-from-list): Fix typos in doc string.  Remove debug
	output.
	(gmm): Add :prefix to defgroup.

2006-01-20  Per Abrahamsen  <abraham@dina.kvl.dk>

	* gmm-utils.el (gmm-widget-p): New function.

2006-01-20  Reiner Steib  <Reiner.Steib@gmx.de>

	* mml.el (mml-attach-file): Describe `description' in doc string.
	(mml-menu): Add Emacs MIME manual and PGG manual.

2006-01-20  Richard M. Stallman  <rms@gnu.org>

	* mm-url.el (mm-url-load-url): Require url-parse and url-vars.

2006-01-20  Kevin Greiner  <kevin.greiner@compsol.cc>

	* nntp.el (nntp-end-of-line): Doc fix.

2006-01-20  Chong Yidong  <cyd@stupidchicken.com>

	* imap.el (imap-open): Handle case where buffer is a buffer
	object.

2005-01-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* gnus-delay.el (gnus-delay): Don't autoload.
	It's useless and could trigger a bug in cus-dep.el causing ldefs-boot
	to be re-loaded when customizing the `gnus-delay' group.

2005-01-20  Chong Yidong  <cyd@stupidchicken.com>

	* message.el (message-insert-citation-line): Use newlines.

2006-01-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-bodies.el (mm-decode-body): Don't decode decoded body.

	* mm-uu.el (mm-uu-dissect-text-parts): Dissect dissected parts.

2006-01-19  Mark D. Baushke  <mdb@gnu.org>

	* pgg-gpg.el (pgg-gpg-encrypt-region): Add --textmode to gpg args.

2006-01-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-decode.el (mm-inlined-types): Add application/pgp.
	(mm-automatic-display): Ditto.

	* mm-uu.el (mm-uu-dissect-text-parts): Recognize application/pgp
	part as text.

2006-01-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnrss.el: Update copyright.
	(nnrss-opml-import): Query whether to subscribe to each entry.

	* gnus-art.el:
	* gnus-sum.el:
	* mm-uu.el:
	* mm-view.el: Update copyright.

2006-01-16  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-info): New function.
	(message-mode-menu): Add it.
	Update copyright.

	* ChangeLog: Fix and update copyright.

2006-01-13  Romain Francoise  <romain@orebokech.com>

	* message.el (message-forward-subject-name-subject): Prefer the
	address to 'nowhere' if the sender has no name.
	Fix typo.  Update copyright year.

2006-01-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (article-wash-html):
	Use gnus-summary-show-article-charset-alist if a numeric arg is given.
	(gnus-article-wash-html-with-w3m-standalone): New function.

	* mm-view.el (mm-text-html-renderer-alist): Map w3m-standalone to
	mm-inline-text-html-render-with-w3m-standalone.
	(mm-text-html-washer-alist): Map w3m-standalone to
	gnus-article-wash-html-with-w3m-standalone.
	(mm-inline-text-html-render-with-w3m-standalone): New function.

2006-01-12  Reiner Steib  <Reiner.Steib@gmx.de>

	* mm-uu.el (mm-uu-type-alist): Fix previous message-marks commit.
	Improve LaTeX.

2006-01-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnrss.el (nnrss-wash-html-in-text-plain-parts): New variable.
	(nnrss-request-article): Render text/plain parts as HTML.

	* gnus-art.el (gnus-article-wash-html-with-w3m): No need to narrow
	the buffer.

2006-01-08  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-cus.el (gnus-group-parameters): Sync posting-style with
	custom definition of `gnus-posting-styles'.

	* gnus-start.el (gnus-gnus-to-quick-newsrc-format):
	Bind print-circle.  Suggested by Kalle Olavi Niemitalo <kon@iki.fi>.

2006-01-05  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-group.el (gnus-useful-groups): Use Gmane for ding.
	Use nntp for bug archive.

2006-01-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnrss.el (nnrss-request-article): Fix the way to fill text/plain
	parts.
	(nnrss-normalize-date): New function converts ISO 8601 date into
	RFC822 style.  Suggested by Mark Plaksin <happy@mcplaksin.org>.
	(nnrss-check-group): Use it.

2006-01-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-summary-work-articles): Remove useless `min'.

	* nnrss.el (nnrss-fetch): Make it fail gracefully when it can't
	fetch a feed.  Suggested by Mark Plaksin <happy@mcplaksin.org>.
	(nnrss-insert-w3): Ditto.

2005-12-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-uu.el (gnus-uu-digest-mail-forward): Reverse the order of
	the articles to be forwarded including the case where neither a
	number of articles nor a region is specified.

2005-12-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnrss.el (nnrss-request-article): Fix last change; fill
	text/plain parts.

2005-12-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnrss.el (nnrss-request-article): Replace <br />s with newlines
	in text/plain part.
	(nnrss-check-group): Don't add excessive newline to dc:subject.

2005-12-19  Mark Plaksin  <happy@mcplaksin.org>  (tiny change)

	* nnrss.el (nnrss-check-group): Put the RSS dc:subject in the
	article.

2005-12-18  Reiner Steib  <Reiner.Steib@gmx.de>

	* nnml.el: Don't require gnus-bcklg.  Autoload it.
	(nnml-use-compressed-files, nnml-save-mail): Support other
	comression programs such as bzip2.

2005-12-17  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* dns.el (query-dns): Make sure we check the buffer size before
	removing tcp headers.

2005-12-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-delete-text-of-type): Enable it to
	remove MIME buttons associated with multipart/alternative parts.
	(gnus-mime-display-alternative): Tag buttons using `article-type'
	text property.

	* gnus-msg.el (gnus-copy-article-buffer): Remove MIME buttons
	associated with multipart/alternative parts.

	* gnus-art.el (gnus-signature-separator): Fix custom type.

	* mm-decode.el (mm-inlined-types): Fix custom type.
	(mm-keep-viewer-alive-types): Ditto.
	(mm-automatic-display): Ditto.
	(mm-attachment-override-types): Ditto.
	(mm-inline-override-types): Ditto.
	(mm-automatic-external-display): Ditto.

2005-12-15  Reiner Steib  <Reiner.Steib@gmx.de>

	* spam-report.el (spam-report-user-mail-address)
	(spam-report-user-agent): New variables.
	(spam-report-url-ping-plain): Use spam-report-user-agent.

2005-12-14  Ralf Angeli  <angeli@iwi.uni-sb.de>

	* gnus-art.el (gnus-button-handle-custom): Do not just use
	`customize-apropos' for any "M-x customize-*" button but the
	function called for.  Accept both the function name and its
	argument in order to achieve this.
	(gnus-button-alist): Remove support for "custom:" URL's.
	Pass function name to `gnus-button-handle-custom' in case of "M-x
	customize-*" buttons.

2005-12-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-buttonized-mime-types): Mention addition of
	multipart/alternative and add xref to mm-discouraged-alternatives
	in doc string.

	* mm-decode.el (mm-discouraged-alternatives): Add xref to
	gnus-buttonized-mime-types in doc string.

2005-12-08  Reiner Steib  <Reiner.Steib@gmx.de>

	* mm-decode.el (mm-discouraged-alternatives): Fix custom type.
	Suggest image/.* in the doc string.

2005-12-12  Reiner Steib  <Reiner.Steib@gmx.de>

	* mm-uu.el (mm-uu-type-alist): Don't depend on message.el for
	message-marks (Debian bug #342521).

2005-12-12  Simon Josefsson  <jas@extundo.com>

	* password.el (password-read-from-cache): Add.
	(password-read): Use it.

2005-12-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2047.el (rfc2047-charset-to-coding-system):
	Recognize us-ascii as a MIME charset.

	* mm-bodies.el (mm-decode-content-transfer-encoding):
	Protect against the case where the 2nd arg TYPE is nil.

2005-12-09  Reiner Steib  <Reiner.Steib@gmx.de>

	* pop3.el (pop3-stream-type): Fix custom version.

	* mm-uu.el (mm-uu-type-alist): Simplify uu regexp.

2005-12-09  ARISAWA Akihiro  <ari@mbf.ocn.ne.jp>  (tiny change)

	* mm-decode.el (mm-display-external): Add missing cdr.

2005-12-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-decode.el (mm-display-external): Use nametemplate (defined in
	RFC1524) if it is in mailcap or add a suffix according to
	mailcap-mime-extensions when generating a temp filename; postpone
	deleting a temp file for 2 seconds for some wrappers, shell
	scripts, and so on, which might exit right after having started a
	viewer command as a background job.

2005-12-06  Reiner Steib  <Reiner.Steib@gmx.de>

	* nntp.el (nntp-marks-directory): Fix custom group.

	* gnus-fun.el (gnus-face-from-file): Decrease quant in smaller
	steps when < 10.

	* gnus-start.el (gnus-no-server-1):
	Mention `gnus-level-default-subscribed' in doc string.

2005-12-02  ARISAWA Akihiro  <ari@mbf.ocn.ne.jp>  (tiny change)

	* mm-view.el (mm-inline-text-html-render-with-w3m): Fix misplaced
	parens.

2005-11-26  Dave Love  <fx@gnu.org>

	* tls.el (open-tls-stream): Rename arg SERVICE to PORT.
	(tls-program, tls-success): Provide openssl alternative.

	* starttls.el: Doc fixes.
	(starttls-open-stream-gnutls, starttls-open-stream): Rename arg
	SERVICE to PORT.

	* pop3.el (pop3-open-server) <ssl>: Clarify a loop.  Deal with
	port null or service name.
	(starttls-negotiate): Autoload.

2005-11-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-kill-to-signature): Fix interactive spec.

2005-11-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* pop3.el (pop3-open-server): Recognize a string as a service name.

2005-11-24  Pascal Rigaux  <pixel@mandriva.com>  (tiny change)

	* rfc2231.el (rfc2231-parse-string): Support non-ascii chars.

2005-11-23  Dave Love  <fx@gnu.org>

	Add pop3s, pop3/starttls.

	* pop3.el (pop3-authentication-scheme): Clarify doc.
	(open-tls-stream, starttls-open-stream): Autoload.
	(pop3-stream-type): New.
	(pop3-open-server): Use it.

	* mail-source.el (mail-sources): Fix some :types.  Add stream type
	for POP.
	(mail-source-keyword-map): Add :stream for POP.
	(mail-source-fetch-pop): Use pop3-stream-type.

2005-11-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnmail.el (nnmail-fancy-expiry-target): Use current-time instead
	of current-time-string.

2005-11-20  Stefan Schimanski  <schimmi@debian.org>  (tiny change)

	* nnmail.el (nnmail-fancy-expiry-target): Protect against invalid
	date header.

2005-11-19  Kevin Greiner  <kevin.greiner@compsol.cc>

	* gnus-sum.el (gnus-fetch-old-headers): Updated docs to warn that
	it can seriously impact performance as it bypasses the agent's
	local caches.

2005-11-19  Kevin Greiner  <kevin.greiner@compsol.cc>

	* gnus-agent.el (gnus-agent-possibly-synchronize-flags): A server
	must be explicitly online rather than "not explicitly offline" for
	its flags to be synchronized.

	* gnus-sum.el (gnus-summary-remove-process-mark): Always return t so
	that gnus-uu-unmark-thread will function correctly.

	* gnus-group.el (gnus-total-fetched-for): Reduced cutoff so that
	1024K is instead displayed as 1M.

2005-11-17  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* flow-fill.el (fill-flowed): Bind adaptive-fill-mode to nil.

2005-11-16  Boris Samorodov  <bsam@ipt.ru>  (tiny change)

	* imap.el (imap-kerberos4-open): Ignore SSL stuff.

2005-11-13  Kevin Greiner  <kevin.greiner@compsol.cc>

	* gnus-agent.el (gnus-agent-read-local): Trivial fix to format of
	error message to display actual error condition.
	(gnus-agent-save-local): Avoid saving symbols that are bound to
	nil as they simply result in a warning message in
	gnus-agent-read-local.

2005-11-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-start.el (gnus-dribble-read-file): Use make-local-variable
	rather than make-variable-buffer-local for file-precious-flag.

2005-11-12  Kevin Greiner  <kevin.greiner@compsol.cc>

	* gnus-agent.el (gnus-agent-braid-nov): Now tests new nov entries
	for duplicates which are removed.  The invalid sort check then
	triggers a rescan after the sort as sorting may have moved
	duplicate entries such that they can be cheaply detected.

2005-11-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-start.el (gnus-dribble-read-file): Quote file-precious-flag.

2005-11-12  Kevin Greiner  <kevin.greiner@compsol.cc>

	* gnus-agent.el (gnus-agent-article-alist-save-format):
	Change internal variable to a custom variable.  Change default value
	from compressed(2) to uncompressed(1).
	(gnus-agent-read-agentview): Reversed revision 7.8 to restore
	support for uncompressed agentview files.  Taken together, reading
	the agentview file should now be 6-7 times faster.

2005-11-11  Jan Nieuwenhuizen  <janneke@gnu.org>

	* gnus-start.el (gnus-dribble-read-file): Set file-precious-flag,
	as a buffer-local variable.  This avoids creating truncated
	dribble files as a result of a hang up, eg.

2005-12-09  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-start.el (gnus-start-draft-setup):
	Enforce `gnus-draft-mode' for nndraft:drafts at startup.

	* gnus.el (gnus-splash): Change custom group.
	(gnus-group-get-parameter, gnus-group-parameter-value):
	Describe allow-list argument.

	* gnus-agent.el (gnus-agent-article-alist-save-format): Format doc
	string.

2005-12-06  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (gnus-default-article-saver): Add user-defined
	`function' to custom type.

2005-10-30  Chong Yidong  <cyd@stupidchicken.com>

	* imap.el (imap-open): Handle case where buffer is a buffer
	object.

2005-11-29  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-cache.el (gnus-cache-rename-group): Wrap doc strings and
	long lines.
	(gnus-cache-delete-group): Wrap doc strings.

	* gnus-agent.el (gnus-agent-rename-group)
	(gnus-agent-delete-group): Wrap doc strings.

2005-11-10  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-start.el (gnus-1): Add "native" to
	gnus-predefined-server-alist.

	* gnus.el (gnus-method-to-server): Don't add "native" to the
	lists here, because that leads to problems when
	gnus-select-method is bound.

2005-11-09  Simon Josefsson  <jas@extundo.com>

	* gnus-sum.el (gnus-article-sort-by-date-reverse): Remove,
	use (not sort-by-date) instead.

2005-11-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* gnus-delay.el (gnus-delay-group): Don't autoload.
	It's useless and could trigger a bug in cus-dep.el causing ldefs-boot
	to be re-loaded when customizing the `gnus-delay' group.

2005-11-19  Chong Yidong  <cyd@stupidchicken.com>

	* message.el: Revert last changes.
	(message-insert-citation-line): Use newlines.

2005-11-17  Chong Yidong  <cyd@stupidchicken.com>

	* message.el (message-courtesy-message)
	(message-mark-insert-begin, message-mark-insert-end)
	(message-elide-ellipsis, message-cancel-message)
	(message-add-header, message-change-subject)
	(message-cross-post-followup-to-header)
	(message-cross-post-insert-note, message-reduce-to-to-cc)
	(message-widen-reply, message-delete-not-region)
	(message-kill-to-signature, message-insert-signature)
	(message-insert-importance-high, message-insert-importance-low)
	(message-insert-or-toggle-importance)
	(message-insert-disposition-notification-to)
	(message-indent-citation, message-yank-original)
	(message-cite-original-without-signature, message-cite-original)
	(message-insert-citation-line, message-position-on-field)
	(message-fix-before-sending, message-send-mail-partially)
	(message-send-mail, message-send-mail-with-sendmail)
	(message-send-mail-with-qmail, message-send-news)
	(message-check-news-header-syntax, message-generate-headers)
	(message-insert-courtesy-copy, message-fill-address)
	(message-fill-header, message-shorten-references)
	(message-setup-1, message-cancel-news)
	(message-forward-make-body-plain, message-forward-make-body-mime)
	(message-forward-make-body-mml, message-encode-message-body)
	(message-forward-make-body-digest-plain)
	(message-forward-make-body-digest-mime)
	(message-use-alternative-email-as-from): Insert `hard-newline'
	instead of ordinary newlines.

2005-11-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-generate-headers): Downcase the argument
	given to message-check-element.

2005-11-08  Kevin Greiner  <kevin.greiner@compsol.cc>

	* nntp.el (nntp-authinfo-rejected): New error condition.
	(nntp-wait-for): Use new error condition to signal authentication
	error.
	(nntp-retrieve-data): Rethrow new error condition to break out of
	recursive call to nntp-send-authinfo.

2005-11-08  Romain Francoise  <romain@orebokech.com>

	* gnus-sum.el (gnus-summary-catchup-and-goto-prev-group): New function.
	(gnus-summary-exit-map): Bind to `Z p'.
	(gnus-summary-make-menu-bar): Add menu item.

2005-11-02  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (gnus-article-treat-custom): Add `first'.
	(gnus-treat-*): Add `first' in all doc strings.

	* gnus-group.el (gnus-group-compact-group): Fix typo.

2005-11-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus.el (gnus-parameters-case-fold-search): New variable.
	(gnus-parameters-get-parameter): Use it.

	* gnus-score.el (gnus-home-score-file): Doc fix.

2005-11-01  Xavier Maillard  <zedek@gnu-rox.org>  (tiny change)

	* gnus-score.el (gnus-update-score-entry-dates): Doc fix.

2005-10-31  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-util.el (mm-special-display-p): New function.

	* mml.el (mml-preview): Use it; doc fix.

2005-10-29  Romain Francoise  <romain@orebokech.com>

	* message.el (message-fix-before-sending): Fix comment.

2005-10-29  Jari Aalto  <jari.aalto@cante.net>

	* gnus-sum.el (gnus-article-sort-by-date-reverse): New function.

2005-10-29  Jari Aalto  <jari.aalto@cante.net>

	* score-mode.el (gnus-score-edit-done-hook): Introduce variable.
	Used in gnus-score.el.

2005-10-28  Reiner Steib  <Reiner.Steib@gmx.de>

	* mm-util.el (mm-codepage-setup): Remove bogus alias test.

2005-10-27  Reiner Steib  <Reiner.Steib@gmx.de>

	* flow-fill.el (fill-flowed-encode-tests): Restore trailing
	whitespace removed in revision 7.8.  Use concatenated string to
	protect trailing whitespace.

2005-10-27  Jouni K. Seppänen  <jks@iki.fi>

	* nnimap.el (nnimap-search-uids-not-since-is-evil): Add variable.
	(nnimap-request-expire-articles): Use it to avoid sending 'UID
	SEARCH UID ... NOT SINCE' queries, for inefficient servers like
	Courier IMAP ("some version from 2004").  Mostly based on similar
	code in the same function.

2005-10-26  Didier Verna  <didier@xemacs.org>

	* gnus-group.el (gnus-group-compact-group): Invalidate original
	article buffer.
	* gnus-srvr.el (gnus-server-compact-server): Ditto.
	* nnml.el (nnml-request-compact-group): Handle self Xref: field in
	NOV database and in article itself.
	Invalidate article backlog.

2005-10-26  Reiner Steib  <Reiner.Steib@gmx.de>

	* mm-uu.el (mm-uu-hide-markers): Fix XEmacs case.

2005-10-26  Simon Josefsson  <jas@extundo.com>

	* flow-fill.el (fill-flowed): Flow-fill unquoted lines too, revert
	part of 2004-07-25 change.

2005-10-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-display-completion-list): New function.
	(message-expand-group): Use it; make sure the Completions buffer
	is modifiable.

2005-10-30  Chong Yidong  <cyd@stupidchicken.com>

	* imap.el (imap-open): Handle case where buffer is a buffer object.

2005-10-24  Eli Zaretskii  <eliz@gnu.org>

	* pgg-def.el:
	* pgg-gpg.el:
	* pgg-parse.el:
	* pgg-pgp.el:
	* pgg-pgp5.el:
	* pgg.el: Move to the parent lisp directory.

2005-10-23  Chong Yidong  <cyd@stupidchicken.com>

	* gnus-sum.el (gnus-ignored-from-addresses): Handle case where
	user-mail-name is an empty string.

2005-10-25  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-score.el (gnus-default-adaptive-score-alist): Set defaults
	depending on gnus-score-decay-constant.

	* encrypt.el (encrypt-insert-file-contents)
	(encrypt-write-file-contents): Don't use `gnus-message'.

	* mm-uu.el (mm-uu-verbatim-marks-extract): Add four start and end
	arguments.
	(mm-uu-type-alist): Add message-marks and insert-marks.
	Pass arguments to mm-uu-verbatim-marks-extract.
	(mm-uu-hide-markers): New variable.
	(mm-uu-extract): Use face similar to `gnus-cite-3'.

	* gnus-fun.el (gnus-convert-image-to-x-face-command)
	(gnus-convert-image-to-face-command): Use "convert" by default to
	allow other input image formats.
	(gnus-x-face-from-file, gnus-face-from-file): Adjust doc strings
	accordingly.

2005-10-23  Simon Josefsson  <jas@extundo.com>

	* imap.el (imap-gssapi-program): Align command line parameters
	with latest GNU SASL.
	(imap-gssapi-open): Ignore 'Trying ...' messages from GNU SASL.

2005-10-21  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnslashdot.el (nnslashdot-retrieve-headers-1): Update to new
	HTML.
	(nnslashdot-request-article): Ditto.

2005-10-20  Hiroshi Fujishima  <hiroshi.fujishima@gmail.com>  (tiny change)

	* mail-source.el (mail-source-fetch-pop): Require pop3.
	(mail-source-check-pop): Ditto.

2005-10-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2047.el (rfc2047-decode-encoded-words): Fix the handling of
	errors.

2005-10-19  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (gnus-treat-strip-trailing-blank-lines)
	(gnus-treat-strip-leading-blank-lines): Improve doc string.

	* message.el (message-tool-bar-local-item-from-menu): Fix comment.

	* mm-bodies.el (mm-decode-string):
	Call `mm-charset-to-coding-system' with allow-override argument.

2005-10-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2047.el (rfc2047-allow-incomplete-encoded-text): New variable.
	(rfc2047-charset-to-coding-system): New function.
	(rfc2047-decode-encoded-words): New function.
	(rfc2047-decode-region): Use them.
	(rfc2047-decode-cte): Remove.
	(rfc2047-parse-and-decode): Remove.
	(rfc2047-decode): Remove.

2005-10-15  Kenichi Handa  <handa@m17n.org>

	* rfc2047.el (rfc2047-decode-cte): New function.
	(rfc2047-decode-region): Change the way to decode successive
	encoded-words: decode B- or Q-encoding in each encoded-word,
	concatenate them, and decode it as charset.

2005-10-17  Chong Yidong  <cyd@stupidchicken.com>

	* gnus-cus.el (gnus-custom-map): New variable.  Bind mouse-1 to
	widget-move-and-invoke.
	(gnus-custom-mode): Use gnus-custom-map.

2005-10-15  Bill Wohler  <wohler@newt.com>

	* message.el (message-tool-bar-map): Rename image file from
	mail_send to mail/send.

2005-10-16  Masatake YAMATO  <jet@gyve.org>

	* message.el (message-expand-group): Pass the common
	prefix substring of completion to `display-completion-list'.

2005-10-13  Reiner Steib  <Reiner.Steib@gmx.de>

	* mml-sec.el (mml-secure-method): New internal variable.
	(mml-secure-sign, mml-secure-encrypt, mml-secure-message-sign)
	(mml-secure-message-sign-encrypt, mml-secure-message-encrypt):
	New functions using mml-secure-method.

	* mml.el (mml-mode-map): Add key bindings for those functions.
	(mml-menu): Simplify security menu entries.  Suggested by Jesper
	Harder <harder@myrealbox.com>.
	(mml-attach-file, mml-attach-buffer, mml-attach-external):
	Goto end of message if point is the headers of the message.

	* message.el (message-in-body-p): New function.

	* assistant.el: Autoload gnus-util and netrc.

	* mm-util.el (mm-charset-to-coding-system): Add allow-override.
	Use `mm-charset-override-alist' only when decoding.

	* mm-bodies.el (mm-decode-body):
	Call `mm-charset-to-coding-system' with allow-override argument.

	* gnus-art.el (gnus-mime-view-part-as-type-internal): Try to fetch
	`filename' from Content-Disposition if Content-Type doesn't
	provide `name'.
	(gnus-mime-view-part-as-type): Set default instead of
	initial-input.

2005-10-09  Daniel Brockman  <daniel@brockman.se>

	* format-spec.el (format-spec): Propagate text properties of % spec.

2005-10-12  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (gnus-treat-predicate): Add `first'.

2005-10-11  Reiner Steib  <Reiner.Steib@gmx.de>

	* mm-util.el (mm-charset-synonym-alist): Improve doc string.
	(mm-charset-override-alist): New variable.
	(mm-charset-to-coding-system): Use it.
	(mm-codepage-setup): New helper function.
	(mm-charset-eval-alist): New variable.
	(mm-charset-to-coding-system): Use mm-charset-eval-alist.
	Warn about unknown charsets.

2005-10-04  David Hansen  <david.hansen@gmx.net>

	* nnrss.el (nnrss-request-article): Add support for the comments tag.
	(nnrss-check-group): Ditto.

2005-10-04  Reiner Steib  <Reiner.Steib@gmx.de>

	* mm-uu.el (mm-uu-verbatim-marks-extract, mm-uu-latex-extract):
	Rename x-gnus-verbatim to x-verbatim.
	(mm-uu-type-alist): Fix regexp for verbatim-marks.

	* mm-decode.el (mm-automatic-display): Rename x-gnus-verbatim to
	x-verbatim.

	* mm-url.el (mm-url-predefined-programs): Add switches for curl.

	* gnus-util.el (gnus-remove-duplicates): Remove.

	* nnmail.el (nnmail-article-group): Use mm-delete-duplicates
	instead of gnus-remove-duplicates.

	* message.el (message-remove-duplicates): Remove.
	(message-idna-to-ascii-rhs-1): Use mm-delete-duplicates instead of
	message-remove-duplicates.

	* mm-util.el (mm-delete-duplicates): Use `delete-dups' if
	available, else use implementation from `delete-dups'.

	* message.el (message-insert-expires): New function.
	(message-mode-map): Add key binding.
	(message-mode-field-menu): Add menu entry.
	(message-mode): Document it.
	(message-make-expires-date): Use `message-make-date'.

2005-10-04  Josh Huber  <huber@alum.wpi.edu>

	* message.el (message-make-expires-date): New function.

2005-10-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* time-date.el: Autoload parse-time-string, XEmacs needs it.

2005-09-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mm-decode.el (mm-inline-media-tests): Check presence of the diff-mode
	function rather than the diff-mode.el package.
	(mm-display-external): Use with-current-buffer.
	(mm-viewer-completion-map, mm-viewer-completion-map):
	Move initialization inside declaration.

2005-09-29  Simon Josefsson  <jas@extundo.com>

	* spam.el: Load hashcash when compiling, to avoid warnings.
	Don't autoload mail-check-payment.
	(spam-check-hashcash): Define unconditionally, since hashcash.el
	is part of Gnus now.  Ignore errors from payment checking.

2005-09-28  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-bold-region, message-unbold-region):
	Rename from `bold-region' and `unbold-region'.

	* message.el: Remove useless autoloads.

2005-09-28  Simon Josefsson  <jas@extundo.com>

	* message.el (message-use-idna): Default to t.
	(message-use-idna): Test whether encoding works too.  Doc fix.

2005-09-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nntp.el (nntp-warn-about-losing-connection): Remove.

2005-09-27  Reiner Steib  <Reiner.Steib@gmx.de>

	* mm-uu.el (mm-uu-emacs-sources-regexp): Make variable
	customizable.  Change default value.
	(mm-uu-diff-groups-regexp): Change default value.
	(mm-uu-type-alist): Add doc string.
	(mm-uu-configure): Add doc string.  Make it interactive.
	(mm-uu-tex-groups-regexp): New variable.
	(mm-uu-latex-extract, mm-uu-latex-test): New functions.
	(mm-uu-type-alist): Add LaTeX documents.
	(mm-uu-verbatim-marks-extract): Use "text/x-gnus-verbatim" instead
	of "text/verbatim".
	(mm-uu-diff-groups-regexp): Fix missing quotes from previous commit.

	* mm-decode.el (mm-automatic-display): Use "text/x-gnus-verbatim"
	instead of "text/verbatim".

	* message.el (message-mark-inserted-region)
	(message-mark-insert-file): Use slrn style marks when called with
	prefix argument.

2005-09-27  Simon Josefsson  <jas@extundo.com>

	* message.el (message-idna-to-ascii-rhs-1): Reformat.

2005-09-27  Arne Jørgensen  <arne@arnested.dk>

	* message.el (message-remove-duplicates): New function.
	Implementation borrowed from `gnus-remove-duplicates'.
	(message-idna-to-ascii-rhs): Also encode idna addresses in
	Reply-To:, Mail-Reply-To: and Mail-Followup-To:.
	(message-idna-to-ascii-rhs-1): When `message-use-idna' is 'ask
	only ask about the same idna domain once per header and also tell
	in what header to replace the idna domain.

	* gnus-art.el (article-decode-idna-rhs): Also decode idna
	addresses in Reply-To:, Mail-Reply-To: and Mail-Followup-To:.
	(article-decode-idna-rhs): Fix regexp so that all idna-address in
	a header is decoded and not just the last one.

2005-09-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-mime-display-single): Don't modify text if it
	has been decoded.

	* mm-decode.el (mm-automatic-display): Add text/verbatim.
	(mm-insert-part): Don't modify text if it has been decoded.

	* mm-uu.el (mm-uu-verbatim-marks-extract): Say text has been
	decoded.

	* mm-view.el (mm-inline-text): Don't strip text props unless
	decoding enriched or richtext parts.

2005-09-25  Romain Francoise  <romain@orebokech.com>

	* gnus-agent.el (gnus-agent-expire-group, gnus-agent-expire):
	* gnus-start.el (gnus-subscribe-interactively):
	* gnus-uu.el (gnus-uu-grab-articles):
	End `yes-or-no-p' and `y-or-n-p' prompts with question mark and
	space.

2005-09-24  Emilio C. Lopes  <eclig@gmx.net>

	* smime.el (smime-sign-buffer, smime-decrypt-buffer):
	* mm-view.el (mm-view-pkcs7-decrypt):
	* gnus-sum.el (gnus-summary-limit-to-extra)
	(gnus-summary-respool-article, gnus-read-move-group-name):
	* gnus-score.el (gnus-summary-increase-score):
	* gnus-util.el (gnus-completing-read-with-default):
	* gnus-art.el (gnus-read-save-file-name)
	(gnus-summary-save-in-rmail, gnus-summary-save-in-mail)
	(gnus-summary-save-in-file, gnus-summary-save-body-in-file):
	* message.el (message-check-news-header-syntax):
	Follow convention for reading with the minibuffer.

2005-09-22  Reiner Steib  <Reiner.Steib@gmx.de>

	* spam-report.el (spam-report-url-ping-plain):
	Use gnus-extended-version as User-Agent.

	* gnus-agent.el (gnus-agent-synchronize-flags): Explain why the
	default value is nil.

	* mm-uu.el (mm-uu-type-alist): Add slrn style verbatim-marks.
	(mm-uu-verbatim-marks-extract): New function.
	(mm-uu-extract): New face.
	(mm-uu-copy-to-buffer): Use it.

	* spam-report.el (spam-report-gmane-ham): Rename from
	`spam-report-gmane-unspam'.
	(spam-report-gmane-internal): Rename from `spam-report-gmane'.
	Simplify use of UNSPAM argument.  Fetch "X-Report-Unspam" header.

	* spam.el (spam-report-gmane-spam, spam-report-gmane-ham):
	Autoload.
	(spam-report-gmane-unregister-routine):
	Rename `spam-report-gmane-unspam' to `spam-report-gmane-ham'.

2005-09-21  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-use-gmane, spam-report-gmane-register-routine)
	(spam-report-gmane-unregister-routine): Add support for gmane
	unregistration.

	* spam-report.el (spam-report-gmane-unspam)
	(spam-report-gmane-spam): Add new wrappers around spam-report-gmane.
	(spam-report-gmane): Change to take a single article and do unspam
	registration.

2005-09-19  Reiner Steib  <Reiner.Steib@gmx.de>

	* mm-url.el (mm-url-decode-entities): Fix regexp.

2005-09-20  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-agent.el (gnus-agent-synchronize-flags): Switch the
	default to nil, to be able to use Gnus at all.  If the default
	switches to something else, then the function should be fixed not
	be exceedingly slow.

2005-09-20  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-start.el (gnus-activate-group): If the server is nil, don't
	fail hard.

	* spam-report.el: Add better Keywords line.

	* spam.el: Add Maintainer and better Keywords line.

2005-09-19  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (gnus-article-replace-part)
	(gnus-mime-replace-part): New functions.
	(gnus-mime-action-alist, gnus-mime-button-commands)
	(gnus-mime-save-part-and-strip): Add file argument.
	(gnus-article-part-wrapper): Add interactive argument.

	* gnus-sum.el (gnus-summary-mime-map):
	Add `gnus-article-replace-part'.

2005-09-19  Didier Verna  <didier@xemacs.org>

	The nnml compaction feature:
	* nnml.el (nnml-request-compact-group): New function.
	* nnml.el (nnml-request-compact): New function.
	* gnus-int.el (gnus-request-compact-group): New function.
	* gnus-int.el (gnus-request-compact): New function.
	* gnus-group.el (gnus-group-compact-group): New function.
	* gnus-group.el (gnus-group-group-map): Bind it to 'G z'.
	* gnus-group.el (gnus-group-make-menu-bar): Add an entry for it.
	* gnus-srvr.el (gnus-server-compact-server): New function.
	* gnus-srvr.el (gnus-server-mode-map): Bind it to 'z'.
	* gnus-srvr.el (gnus-server-make-menu-bar): Add an entry for it.

2005-09-18  Deepak Goel  <deego@gnufans.org>

	* sieve.el (sieve-help): Fix `message' call: first arg should be a
	format spec.

2005-09-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus.el (gnus-group-startup-message): Bind image-load-path.

2005-09-15  Romain Francoise  <romain@orebokech.com>

	* message.el (message-fill-paragraph): Clarify docstring.

2005-09-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-mime-display-part): Protect against broken
	MIME messages.

2005-09-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-summary-edit-article-done): Remove text props
	before parsing header.

2005-09-11  Jari Aalto  <jari.aalto@cante.net>

	* html2text.el (html2text-replace-list): Add new entities.

2005-09-11  Romain Francoise  <romain@orebokech.com>

	* message.el (message-alternative-emails): Improve docstring.
	(message-setup-1): Call `message-use-alternative-email-as-from'
	after `message-setup-hook' to give it precedence over posting
	styles, etc.
	(message-use-alternative-email-as-from): Add docstring.
	Remove the original From header if present.

	* nnml.el (nnml-compressed-files-size-threshold): New variable.
	(nnml-save-mail): Use it.

	* gnus-uu.el (gnus-uu-mark-series): Return number of marked
	articles.  Add new argument `silent'.
	(gnus-uu-mark-all): Report the total number of marked articles.

2005-09-10  Romain Francoise  <romain@orebokech.com>

	* gnus-uu.el (gnus-message-process-mark): Use gnus-message.
	(gnus-uu-mark-series): Likewise.

2005-09-10  Reiner Steib  <Reiner.Steib@gmx.de>

	* spam-report.el (spam-report-gmane): Fix generation of spam
	report URL.

2005-09-10  Simon Josefsson  <jas@extundo.com>

	* gnus-agent.el (gnus-agent-synchronize-flags): Make the default
	t, based on discussion on the ding list with Robert Epprecht
	<epprecht@solnet.ch>.

2005-09-07  Reiner Steib  <Reiner.Steib@gmx.de>

	* spam-report.el (spam-report-gmane): Make it work without
	X-Report-Spam header.  Gmane now only provides Archived-At.
	This is only used if `spam-report-gmane-use-article-number' is nil.
	(spam-report-gmane-spam-header): Remove.  Not used anymore.

	* gnus-sum.el (gnus-thread-sort-by-recipient): New function to
	make `gnus-summary-sort-by-recipient' work with threading.

	* nnweb.el (nnweb-google-wash-article): Print a message if article
	is not available.

2005-09-07  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* gnus-art.el (gnus-mime-display-single): Revert 2004-10-07
	change.  Decode text/* parts content before displaying.

2005-09-06  Reiner Steib  <Reiner.Steib@gmx.de>

	* mml-smime.el: Remove defvar of gnus-extract-address-components.

2005-09-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-view.el (mm-display-inline-fontify): Disable support modes.

2005-09-05  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-tab-body-function): Fix mismatched custom type.

	* gnus.el (gnus-group-change-level-function): Ditto.

	* gnus-msg.el (gnus-outgoing-message-group): Ditto.

	* gnus-art.el (gnus-signature-limit)
	(gnus-article-mime-part-function): Ditto.

2005-09-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mml.el (mml-mode): Silence the byte compiler.

	* gnus-art.el (gnus-article-jump-to-part): Redisplay the article
	using `(sit-for 0)' before moving the point to the specified part;
	skip unbuttonized parts.
	(gnus-article-part-wrapper): Don't use save-window-excursion; don't
	return to the summary window if gnus-auto-select-part is non-nil.

2005-09-04  Reiner Steib  <Reiner.Steib@gmx.de>

	* mml.el (mml-dnd-protocol-alist, mml-dnd-attach-options):
	New variables.
	(mml-dnd-attach-file, mml-mode): Use them.

	* nnweb.el (nnweb-type-definition, nnweb-google-wash-article):
	Make fetching article by MID work again for Google Groups.
	Add FIXME concerning gnus-group-make-web-group.

	* mml-smime.el (mml-smime-sign-query, mml-smime-get-dns-cert):
	Don't depend on Gnus by using mail-extract-address-components if
	gnus-extract-address-components is not bound.

2005-09-04  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-art.el (gnus-mime-display-security): Don't display the
	signature, but only the signed part.

2005-09-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-thread-hide-subtree): Doc fix.

	* gnus-msg.el (gnus-inews-insert-gcc): Fix the mistake of using
	list, not listp.

2005-09-02  Hrvoje Niksic  <hniksic@xemacs.org>

	* mm-encode.el (mm-encode-content-transfer-encoding):
	Likewise when encoding.

	* mm-bodies.el (mm-decode-content-transfer-encoding):
	De-canonicalize CRLF for all text content types, not just
	text/plain.

2005-09-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-part-wrapper): Error if there's no
	valid article; point arrow and cursor at the MIME button.

2005-08-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-mime-save-part-and-strip): Clarify prompt.
	Suggested by Dan Christensen <jdc@uwo.ca>.

	* mm-decode.el (mm-save-part): Enable change of prompt.

2005-08-29  Jari Aalto  <jari.aalto@cante.net>

	* gnus-msg.el (gnus-inews-add-send-actions):
	Make `message-post-method' lambda parameter ARG `&optional'.

2005-08-29  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-sum.el (gnus-summary-mime-map):
	Add gnus-article-save-part-and-strip, gnus-article-delete-part and
	gnus-article-jump-to-part.

	* gnus-art.el (gnus-article-edit-article): Add quiet argument.
	(gnus-article-edit-part): Use it.
	(gnus-article-part-wrapper): Add no-handle argument.
	(gnus-article-save-part-and-strip, gnus-article-delete-part):
	New functions.

2005-08-29  Romain Francoise  <romain@orebokech.com>

	* gnus-fun.el (gnus-convert-image-to-face-command): Fix typo in
	docstring.
	(gnus-face-from-file): Likewise.

2005-08-29  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (gnus-mime-save-part-and-strip): Don't prompt.
	(gnus-mime-delete-part): Don't prompt if `gnus-expert-user' is
	non-nil.
	(gnus-auto-select-part): New variable.
	(gnus-article-jump-to-part): New function.
	(gnus-article-edit-part, gnus-mime-save-part-and-strip)
	(gnus-mime-delete-part): Allow selecting specified part after
	deleting or stripping parts.
	(gnus-article-jump-to-part): Don't use `read-number'.  Use last
	part if argument is bogus.

2005-08-31  Juanma Barranquero  <lekktu@gmail.com>

	* gnus-art.el (w3m-minor-mode-map):
	* gnus-spec.el (gnus-newsrc-file-version):
	* gnus-util.el (nnmail-active-file-coding-system)
	(gnus-original-article-buffer, gnus-user-agent):
	* gnus.el (gnus-ham-process-destinations)
	(gnus-parameter-ham-marks-alist)
	(gnus-parameter-spam-marks-alist, gnus-spam-autodetect)
	(gnus-spam-autodetect-methods, gnus-spam-newsgroup-contents)
	(gnus-spam-process-destinations, gnus-spam-process-newsgroups):
	* mm-decode.el (gnus-current-window-configuration):
	* mm-extern.el (gnus-article-mime-handles):
	* mm-url.el (url-current-object, url-package-name)
	(url-package-version):
	* mm-view.el (gnus-article-mime-handles, gnus-newsgroup-charset)
	(smime-keys, w3m-cid-retrieve-function-alist)
	(w3m-current-buffer, w3m-display-inline-images)
	(w3m-minor-mode-map):
	* mml-smime.el (gnus-extract-address-components):
	* mml.el (gnus-article-mime-handles, gnus-mouse-2)
	(gnus-newsrc-hashtb, message-default-charset)
	(message-deletable-headers, message-options)
	(message-posting-charset, message-required-mail-headers)
	(message-required-news-headers):
	* mml1991.el (mc-pgp-always-sign):
	* mml2015.el (mc-pgp-always-sign):
	* nnheader.el (nnmail-extra-headers):
	* rfc1843.el (gnus-decode-encoded-word-function)
	(gnus-decode-header-function, gnus-newsgroup-name):
	* spam-stat.el (gnus-original-article-buffer): Add defvars.

2005-08-22  Karl Chen  <quarl@cs.berkeley.edu>

	* gnus-art.el (gnus-treatment-function-alist): Move date-lapsed to
	the end of the date treatments.

2005-08-15  Simon Josefsson  <jas@extundo.com>

	* pgg.el (url-insert-file-contents): Don't autoload it, Emacs has
	it in url-handlers.el and XEmacs in url.el.  Reported by Luca
	Capello and Romain Francoise.
	(pgg-fetch-key-function): Remove, not used?
	(pgg-insert-url-with-w3): Require url, to get
	url-insert-file-contents regardless of where it is defined.

2005-08-13  Romain Francoise  <romain@orebokech.com>

	* message.el (message-cite-original-1): New function.
	(message-cite-original): Use it.
	(message-cite-original-without-signature): Ditto.

2005-08-08  Romain Francoise  <romain@orebokech.com>

	* message.el (message-yank-empty-prefix): New variable.
	(message-indent-citation): Use it.
	(message-cite-original-without-signature): Respect X-No-Archive.

2005-08-08  Simon Josefsson  <jas@extundo.com>

	* pgg.el: Autoload url-insert-file-contents instead of loading
	w3/url.
	(pgg-insert-url-with-w3): Don't load url here.

2005-08-07  Jesper Harder  <harder@phys.au.dk>

	* message.el (message-kill-to-signature): Don't insert newline at
	bol.
	(message-newline-and-reformat): Bind fill-paragraph-function to nil.

2005-08-06  Romain Francoise  <romain@orebokech.com>

	* message.el (message-user-fqdn): Fix typo in docstring.

2005-08-05  Daiki Ueno  <ueno@unixuser.org>

	* mml2015.el (mml2015-pgg-sign): Make sure micalg is correct.

	* pgg-parse.el (pgg-parse-hash-algorithm-alist): Add SHA-2.

2005-08-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-bodies.el (mm-encode-body): Use coding system rather than
	charset to encode text.

	* mm-util.el (mm-find-mime-charset-region): Attempt to reduce the
	number of charsets if utf-8 is available (XEmacs).

2005-08-04  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (gnus-button-valid-localpart-regexp): New variable
	taken from `gnus-button-mid-or-mail-regexp'.
	(gnus-button-mid-or-mail-regexp, gnus-button-alist): Use it.
	(gnus-button-alist): Improve regexp for domain part of the MIDs
	for news:localpart@domain buttons.
	(gnus-button-ctan-directory-regexp): Update.

2005-08-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* sieve-manage.el (sieve-manage-interactive-login):
	Use make-local-variable rather than make-variable-buffer-local.
	(sieve-manage-open): Ditto.
	(sieve-manage-authenticate): Ditto.

	* mml.el (mml-generate-mime-1): Make the content type default to
	text/plain if the filename is not specified.

2005-08-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-uu.el (gnus-uu-save-article): Use insert-buffer-substring
	instead of insert-buffer.

	* message.el (message-yank-original): Ditto; set the mark at the
	end of the yanked message.

2005-07-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-next-page-1): Reduce the number of
	lines to scroll rather than to stop it.

	* mml.el (mml-generate-default-type): Add doc string.
	(mml-generate-mime-1): Use mm-default-file-encoding or make it
	default to application/octet-stream when determining the content
	type if it is not specified for the part or the mml contents; add
	a comment about mml-generate-default-type.

2005-07-29  Reiner Steib  <Reiner.Steib@gmx.de>

	* mml.el (mml-generate-mime-1): Use mm-default-file-encoding or
	make it default to application/octet-stream when determining the
	content type if it is not specified for the external contents.

2005-07-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2231.el (rfc2231-parse-string): Take care that not only a
	segmented parameter but also other parameters might be there.

2005-07-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-decode.el (mm-display-external): Delete temp file, directory
	and buffer immediately if the external process is exited.

2005-07-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-next-page-1): Don't scroll if there're
	fewer lines than that of scroll-margin.
	(gnus-article-prev-page): Narrow the range to bind scroll-in-place.

2005-07-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-next-page): Revert.
	(gnus-article-beginning-of-window): New macro.
	(gnus-article-next-page-1): Use it.
	(gnus-article-prev-page): Ditto.
	(gnus-article-edit-part): Use insert-buffer-substring instead of
	insert-buffer.
	(gnus-article-edit-exit): Ditto.

	* gnus-util.el (gnus-beginning-of-window): Remove.
	(gnus-end-of-window): Remove.

2005-07-25  Simon Josefsson  <jas@extundo.com>

	* pgg.el (pgg-insert-url-with-w3): Don't load w3, it is possible
	to have the url package without w3.  Reported by Daiki Ueno
	<ueno@unixuser.org> and Luigi Panzeri <matley@muppetslab.org>.

2005-07-20  Didier Verna  <didier@xemacs.org>

	* gnus-diary.el: Remove the description comment (nndiary is now
	properly documented in the Gnus manual).
	Fix the spelling of "Back End".
	* nndiary.el: Ditto.
	Fix the copyright notice.

2005-07-18  Romain Francoise  <romain@orebokech.com>

	* gnus-sum.el (gnus-summary-to-prefix)
	(gnus-summary-newsgroup-prefix): New variables.
	(gnus-summary-from-or-to-or-newsgroups): Use them.

2005-07-17  Romain Francoise  <romain@orebokech.com>

	* mml2015.el (mml2015-clean-buffer): Prefix buffer name with a
	space as it's generally not especially interesting to the user.

2005-07-16  Romain Francoise  <romain@orebokech.com>

	* nnfolder.el (nnfolder-save-buffer): Bind `copyright-update' to
	nil to avoid prompting and file modification if one of the
	messages at the top of the nnfolder file contains a copyright
	notice.
	Update copyright notice.

	* gnus-uu.el (gnus-uu-save-article): Use `message-make-date'
	instead of `current-time-string' as the latter creates a time
	string that is not RFC 2822 compliant (it lacks the zone).
	Update copyright notice.

2005-07-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mml.el (mml-minibuffer-read-disposition): Don't use inline by default
	for text/rtf.  Display default in prompt.  Pass default for M-n.

	* mm-uu.el (mm-uu-copy-to-buffer): Use with-current-buffer.

2005-07-16  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-msg.el (gnus-button-mailto):
	Remove save-selected-window-window hackery because it relies on
	save-selected-window internals.

2005-07-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-next-page): Use gnus-end-of-window.
	(gnus-article-next-page-1): Use gnus-beginning-of-window.
	(gnus-article-prev-page): Ditto.

	* gnus-util.el (gnus-beginning-of-window): New function.
	(gnus-end-of-window): New function.

2005-07-14  Hiroshi Fujishima  <hiroshi.fujishima@gmail.com>  (tiny change)

	* gnus-score.el (gnus-score-edit-all-score):
	Set gnus-score-edit-exit-function to gnus-score-edit-done and call
	gnus-message.

2005-07-14  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-msg.el (gnus-button-mailto):
	Remove save-selected-window-window hackery because it relies on
	save-selected-window internals.

2005-07-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-salt.el (gnus-pick-mode): Remove the 5th arg of
	add-minor-mode.
	(gnus-binary-mode): Ditto.

	* gnus-topic.el (gnus-topic-mode): Ditto.

2005-07-08  Ralf Angeli  <angeli@iwi.uni-sb.de>

	* gnus-art.el (gnus-article-next-page, gnus-article-next-page-1)
	(gnus-article-prev-page): Take scroll-margin into consideration.

2005-07-04  Lute Kamstra  <lute@gnu.org>

	Update FSF's address in GPL notices.

2005-07-04  Juanma Barranquero  <lekktu@gmail.com>

	* gnus.el (gnus-exit):
	* gnus-group.el (gnus-group-icons):
	* nnmail.el (nnmail-prepare): Fix typos in docstrings.

	* gnus-nocem.el (gnus-nocem):
	* message.el (message-various, message-buffers, message-sending)
	(message-interface, message-forwarding, message-insertion)
	(message-headers, message-news, message-mail):
	* pgg-gpg.el (pgg-gpg):
	* pgg-parse.el (pgg-parse):
	* pgg-pgp.el (pgg-pgp):
	* pgg-pgp5.el (pgg-pgp5):
	* pop3.el (pop3): Finish `defgroup' description with period.

2005-07-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (article-display-face): Improve the efficiency.
	(article-display-x-face): Ditto; remove gray x-face stuff.

2005-06-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (article-display-face): Correct the position in
	which Faces are inserted.

2005-06-29  Didier Verna  <didier@xemacs.org>

	* gnus-art.el (article-display-face): Display faces in correct
	order.

2005-06-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-nocem.el (gnus-nocem-verifyer): Default to pgg-verify.
	(gnus-fill-real-hashtb): Use hash table instead of obarray.
	(gnus-nocem-check-article): Fetch the Type header.
	(gnus-nocem-message-wanted-p): Fix the way to examine types.
	(gnus-nocem-verify-issuer): Use functionp instead of fboundp.
	(gnus-nocem-enter-article): Use hash tables rather than obarrays;
	make sure gnus-nocem-hashtb is initialized.
	(gnus-nocem-alist-to-hashtb): Use hash table instead of obarray.
	(gnus-nocem-unwanted-article-p): Ditto.

	* pgg.el (pgg-verify): Return the verification result.

2005-06-27  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-art.el (gnus-mime-copy-part): Check whether coding-system
	is ascii.

2005-06-24  Juanma Barranquero  <lekktu@gmail.com>

	* gnus-art.el (gnus-article-mode): Set `nobreak-char-display', not
	`show-nonbreak-escape'.

2005-06-23  Lute Kamstra  <lute@gnu.org>

	* gnus-art.el (gnus-article-mode): Use kill-all-local-variables.

	* dig.el (dig-mode):
	* smime.el (smime-mode): Use gnus-run-mode-hooks.

2005-06-21  Juanma Barranquero  <lekktu@gmail.com>

	* nnimap.el (nnimap-split-download-body): Fix spellings.

2005-06-16  Juanma Barranquero  <lekktu@gmail.com>

	* gnus-art.el (gnus-article-encrypt-body):
	* gnus-cus.el (gnus-score-customize):
	* mm-extern.el (mm-extern-local-file, mm-inline-external-body):
	* pop3.el (pop3-user): Don't use `format' on `error' arguments.

2005-06-16  Arne Jørgensen  <arne@arnested.dk>

	* smime.el (smime-cert-by-ldap-1): Detect PEM format without
	header by looking for magic "MII" at the beginning.

2005-06-16  Miles Bader  <miles@gnu.org>

	* assistant.el (assistant-field): Remove "-face" suffix from face name.
	(assistant-field-face): New backward-compatibility alias for renamed
	face.
	(assistant-render-text): Use renamed assistant-field face.

	* spam.el (spam): Remove "-face" suffix from face name.
	(spam-face): New backward-compatibility alias for renamed face.
	(spam-face, spam-initialize): Use renamed spam face.

	* message.el (message-header-to, message-header-cc)
	(message-header-subject, message-header-newsgroups)
	(message-header-other, message-header-name)
	(message-header-xheader, message-separator, message-cited-text)
	(message-mml): Remove "-face" suffix from face names.
	(message-header-to-face, message-header-cc-face)
	(message-header-subject-face, message-header-newsgroups-face)
	(message-header-other-face, message-header-name-face)
	(message-header-xheader-face, message-separator-face)
	(message-cited-text-face, message-mml-face):
	New backward-compatibility aliases for renamed faces.
	(message-font-lock-keywords): Use renamed message faces.

	* sieve-mode.el (sieve-control-commands, sieve-action-commands)
	(sieve-test-commands, sieve-tagged-arguments):
	Remove "-face" suffix from face names.
	(sieve-control-commands-face, sieve-action-commands-face)
	(sieve-test-commands-face, sieve-tagged-arguments-face):
	New backward-compatibility aliases for renamed faces.
	(sieve-control-commands-face, sieve-action-commands-face)
	(sieve-test-commands-face, sieve-tagged-arguments-face):
	Use renamed sieve faces.

	* gnus.el (gnus-group-news-1, gnus-group-news-1-empty)
	(gnus-group-news-2, gnus-group-news-2-empty, gnus-group-news-3)
	(gnus-group-news-3-empty, gnus-group-news-4)
	(gnus-group-news-4-empty, gnus-group-news-5)
	(gnus-group-news-5-empty, gnus-group-news-6)
	(gnus-group-news-6-empty, gnus-group-news-low)
	(gnus-group-news-low-empty, gnus-group-mail-1)
	(gnus-group-mail-1-empty, gnus-group-mail-2)
	(gnus-group-mail-2-empty, gnus-group-mail-3)
	(gnus-group-mail-3-empty, gnus-group-mail-low)
	(gnus-group-mail-low-empty, gnus-summary-selected)
	(gnus-summary-cancelled, gnus-summary-high-ticked)
	(gnus-summary-low-ticked, gnus-summary-normal-ticked)
	(gnus-summary-high-ancient, gnus-summary-low-ancient)
	(gnus-summary-normal-ancient, gnus-summary-high-undownloaded)
	(gnus-summary-low-undownloaded)
	(gnus-summary-normal-undownloaded, gnus-summary-high-unread)
	(gnus-summary-low-unread, gnus-summary-normal-unread)
	(gnus-summary-high-read, gnus-summary-low-read)
	(gnus-summary-normal-read, gnus-splash):
	Remove "-face" suffix from face names.
	(gnus-group-news-1-face, gnus-group-news-1-empty-face)
	(gnus-group-news-2-face, gnus-group-news-2-empty-face)
	(gnus-group-news-3-face, gnus-group-news-3-empty-face)
	(gnus-group-news-4-face, gnus-group-news-4-empty-face)
	(gnus-group-news-5-face, gnus-group-news-5-empty-face)
	(gnus-group-news-6-face, gnus-group-news-6-empty-face)
	(gnus-group-news-low-face, gnus-group-news-low-empty-face)
	(gnus-group-mail-1-face, gnus-group-mail-1-empty-face)
	(gnus-group-mail-2-face, gnus-group-mail-2-empty-face)
	(gnus-group-mail-3-face, gnus-group-mail-3-empty-face)
	(gnus-group-mail-low-face, gnus-group-mail-low-empty-face)
	(gnus-summary-selected-face, gnus-summary-cancelled-face)
	(gnus-summary-high-ticked-face, gnus-summary-low-ticked-face)
	(gnus-summary-normal-ticked-face)
	(gnus-summary-high-ancient-face, gnus-summary-low-ancient-face)
	(gnus-summary-normal-ancient-face)
	(gnus-summary-high-undownloaded-face)
	(gnus-summary-low-undownloaded-face)
	(gnus-summary-normal-undownloaded-face)
	(gnus-summary-high-unread-face, gnus-summary-low-unread-face)
	(gnus-summary-normal-unread-face, gnus-summary-high-read-face)
	(gnus-summary-low-read-face, gnus-summary-normal-read-face)
	(gnus-splash-face):
	New backward-compatibility aliases for renamed faces.
	(gnus-group-startup-message): Use renamed gnus faces.

	* gnus-srvr.el (gnus-server-agent, gnus-server-opened)
	(gnus-server-closed, gnus-server-denied, gnus-server-offline)
	(gnus-server-agent): Remove "-face" suffix from face names.
	(gnus-server-agent-face, gnus-server-opened-face)
	(gnus-server-closed-face, gnus-server-denied-face)
	(gnus-server-offline-face):
	New backward-compatibility aliases for renamed faces.
	(gnus-server-agent-face, gnus-server-opened-face)
	(gnus-server-closed-face, gnus-server-denied-face)
	(gnus-server-offline-face): Use renamed gnus faces.

	* gnus-picon.el (gnus-picon-xbm, gnus-picon):
	Remove "-face" suffix from face names.
	(gnus-picon-xbm-face, gnus-picon-face):
	New backward-compatibility aliases for renamed faces.

	* gnus-cite.el (gnus-cite-attribution, gnus-cite-1, gnus-cite-2)
	(gnus-cite-3, gnus-cite-4, gnus-cite-5, gnus-cite-6)
	(gnus-cite-7, gnus-cite-8, gnus-cite-9, gnus-cite-10)
	(gnus-cite-11): Remove "-face" suffix from face names.
	(gnus-cite-attribution-face, gnus-cite-face-1, gnus-cite-face-2)
	(gnus-cite-face-3, gnus-cite-face-4, gnus-cite-face-5)
	(gnus-cite-face-6, gnus-cite-face-7, gnus-cite-face-8)
	(gnus-cite-face-9, gnus-cite-face-10, gnus-cite-face-11):
	New backward-compatibility aliases for renamed faces.
	(gnus-cite-attribution-face, gnus-cite-face-list)
	(gnus-article-boring-faces): Use renamed gnus faces.

	* gnus-art.el (gnus-signature, gnus-header-from)
	(gnus-header-subject, gnus-header-newsgroups, gnus-header-name)
	(gnus-header-content): Remove "-face" suffix from face names.
	(gnus-signature-face, gnus-header-from-face)
	(gnus-header-subject-face, gnus-header-newsgroups-face)
	(gnus-header-name-face, gnus-header-content-face):
	New backward-compatibility aliases for renamed faces.
	(gnus-signature-face, gnus-header-face-alist): Use renamed gnus faces.

	* gnus-sum.el (gnus-summary-selected-face)
	(gnus-summary-highlight): Use renamed gnus faces.
	* gnus-group.el (gnus-group-highlight): Likewise.

2005-06-14  Juanma Barranquero  <lekktu@gmail.com>

	* gnus-sieve.el (gnus-sieve-article-add-rule):
	* legacy-gnus-agent.el (gnus-agent-unlist-expire-days):
	* spam-stat.el (spam-stat-buffer-change-to-spam)
	(spam-stat-buffer-change-to-non-spam): Follow error conventions.

	* message.el (message-is-yours-p):
	* gnus-sum.el (gnus-auto-select-subject): Fix quoting in docstring.

2005-06-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-view.el (mm-inline-text): Withdraw the last change.

2005-06-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-view.el (mm-inline-text): Turn off adaptive-fill-mode while
	executing enriched-decode.

2005-06-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-util.el (mm-find-buffer-file-coding-system): Don't examine
	charset of tar files.

2005-06-04  Luc Teirlinck  <teirllm@auburn.edu>

	* gnus-art.el (article-update-date-lapsed): Use `save-match-data'.

2005-06-04  Lute Kamstra  <lute@gnu.org>

	* nnfolder.el (nnfolder-read-folder): Make sure that undo
	information is never recorded.

2005-06-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* gnus-art.el (gnus-emphasis-alist): Disable the strikethru thingy.

2005-06-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* pop3.el (pop3-apop): Run md5 in the binary mode.

	* starttls.el (starttls-set-process-query-on-exit-flag):
	Use eval-and-compile.

2005-05-31  Simon Josefsson  <jas@extundo.com>

	* smime.el (smime-replace-in-string): Define.
	(smime-cert-by-ldap-1): Use it.

2005-05-31  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (article-display-x-face): Replace
	process-kill-without-query by gnus-set-process-query-on-exit-flag.

	* gnus-util.el (gnus-set-process-query-on-exit-flag): Alias to
	set-process-query-on-exit-flag or process-kill-without-query.

	* html2text.el (html2text-fix-paragraphs): Use `while - re-search'
	loop instead of replace-regexp.

	* imap.el (imap-ssl-open): Use set-process-query-on-exit-flag
	instead of process-kill-without-query if it is available.

	* mm-util.el (mm-insert-file-contents): Bind find-file-hook
	instead of find-file-hooks if it is available.

	* mml1991.el: Bind pgg-default-user-id when compiling.

	* mml2015.el: Bind pgg-default-user-id when compiling.

	* nndraft.el (nndraft-request-associate-buffer):
	Use write-contents-functions instead of write-contents-hooks if it is
	available.

	* nnheader.el (nnheader-find-file-noselect): Bind find-file-hook
	instead of find-file-hooks if it is available.

	* nntp.el (nntp-open-connection): Replace
	process-kill-without-query by gnus-set-process-query-on-exit-flag.
	(nntp-open-ssl-stream): Ditto.
	(nntp-open-tls-stream): Ditto.

	* starttls.el (starttls-set-process-query-on-exit-flag): Alias to
	set-process-query-on-exit-flag or process-kill-without-query.
	(starttls-open-stream-gnutls): Use it instead of
	process-kill-without-query.
	(starttls-open-stream): Ditto.

2005-05-31  Ulf Stegemann  <ulf@zeitform.de>  (tiny change)

	* smime.el (smime-cert-by-ldap-1): Don't use
	replace-regexp-in-string.

2005-05-31  Arne Jørgensen  <arne@arnested.dk>

	* smime-ldap.el (smime-ldap-search): Add compatibility for XEmacs.

	* smime.el (smime-cert-by-ldap-1): Handle certificates distributed
	in PEM format.  Adjust to the XEmacs compatibility.

2005-05-30  Reiner Steib  <Reiner.Steib@gmx.de>

	* encrypt.el (encrypt-xor-process-buffer): Replace `string-to-int'
	by `string-to-number'.
	* gnus-agent.el (gnus-agent-regenerate-group)
	(gnus-agent-fetch-articles): Ditto.
	* gnus-art.el (gnus-button-fetch-group): Ditto.
	* gnus-cache.el (gnus-cache-generate-active)
	(gnus-cache-articles-in-group): Ditto.
	* gnus-group.el (gnus-group-set-current-level)
	(gnus-group-insert-group-line): Ditto.
	* gnus-score.el (gnus-score-set-expunge-below)
	(gnus-score-set-mark-below, gnus-summary-score-effect)
	(gnus-summary-score-entry): Ditto.
	* gnus-soup.el (gnus-soup-send-packet, gnus-soup-parse-areas)
	(gnus-soup-pack): Ditto.
	* gnus-spec.el (gnus-xmas-format): Ditto.
	* gnus-start.el (gnus-newsrc-to-gnus-format): Ditto.
	* gnus-sum.el (gnus-create-xref-hashtb): Ditto.
	* gnus-uu.el (gnus-uu-expand-numbers): Ditto.
	* nnbabyl.el (nnbabyl-article-group-number): Ditto.
	* nndb.el (nndb-get-remote-expire-response): Ditto.
	* nndiary.el (nndiary-parse-schedule-value)
	(nndiary-string-to-number, nndiary-request-replace-article)
	(nndiary-request-article): Ditto.
	* nndoc.el (nndoc-rnews-body-end, nndoc-mbox-body-end): Ditto.
	* nndraft.el (nndraft-articles, nndraft-request-group): Ditto.
	* nneething.el (nneething-make-head): Ditto.
	* nnfolder.el (nnfolder-request-article)
	(nnfolder-retrieve-headers): Ditto.
	* nnheader.el (nnheader-file-to-number): Ditto.
	* nnkiboze.el (nnkiboze-request-article): Ditto.
	* nnmail.el (nnmail-process-unix-mail-format)
	(nnmail-process-babyl-mail-format): Ditto.
	* nnmbox.el (nnmbox-read-mbox, nnmbox-article-group-number): Ditto.
	* nnmh.el (nnmh-update-gnus-unreads, nnmh-active-number)
	(nnmh-request-create-group, nnmh-request-list-1)
	(nnmh-request-group, nnmh-request-article): Ditto.
	* nnml.el (nnml-request-replace-article, nnml-request-article): Ditto.
	* nnrss.el (nnrss-find-rss-via-syndic8): Ditto.
	* nnsoup.el (nnsoup-make-active): Ditto.
	* nnspool.el (nnspool-find-id, nnspool-request-group): Ditto.
	* nntp.el (nntp-find-group-and-number)
	(nntp-retrieve-headers-with-xover): Ditto.
	* pgg-gpg.el (pgg-gpg-snarf-keys-region): Ditto.
	* pgg-parse.el (pgg-read-body, pgg-read-bytes)
	(pgg-format-key-identifier): Ditto.
	* pop3.el (pop3-last, pop3-stat): Ditto.
	* qp.el (quoted-printable-decode-region): Ditto.

	* spam-report.el (spam-report-url-ping-mm-url): Use format instead
	of concat.

2005-05-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-agent.el (gnus-category-mode): Use gnus-run-mode-hooks.

	* gnus-art.el (gnus-article-mode): Use gnus-run-mode-hooks.

	* gnus-cus.el (gnus-custom-mode): Use gnus-run-mode-hooks.

	* gnus-eform.el (gnus-edit-form-mode): Use gnus-run-mode-hooks.

	* gnus-group.el (gnus-group-mode): Use gnus-run-mode-hooks.

	* gnus-kill.el (gnus-kill-file-mode): Use gnus-run-mode-hooks.

	* gnus-salt.el (gnus-tree-mode): Use gnus-run-mode-hooks.
	(gnus-carpal-mode): Ditto.

	* gnus-srvr.el (gnus-server-mode): Use gnus-run-mode-hooks.
	(gnus-browse-mode): Ditto.

	* gnus-sum.el (gnus-summary-mode): Use gnus-run-mode-hooks.

	* gnus-util.el (gnus-run-mode-hooks): Save current buffer.

2005-05-29  Richard M. Stallman  <rms@gnu.org>

	* gnus-cite.el (gnus-cite-add-face): Set overlay's evaporate property.

2005-05-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-util.el (gnus-run-mode-hooks): New function.

	* score-mode.el (gnus-score-mode): Use gnus-run-mode-hooks.

2005-05-26  Luc Teirlinck  <teirllm@auburn.edu>

	* gnus-agent.el (gnus-agent-make-mode-line-string):
	Use mode-line-highlight as mouse-face.

2005-05-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* canlock.el (canlock): Change the parent group to news.

	* deuglify.el (gnus-outlook-deuglify): Add :group.

	* dig.el (dig): Add :group.

	* dns-mode.el (dns-mode): Add :group.

	* encrypt.el (encrypt): Add :group.

	* gnus-cite.el (gnus-cite-attribution-face): Add :group.
	(gnus-cite-face-1, gnus-cite-face-2, gnus-cite-face-3): Ditto.
	(gnus-cite-face-4, gnus-cite-face-5, gnus-cite-face-6): Ditto.
	(gnus-cite-face-7, gnus-cite-face-8, gnus-cite-face-9): Ditto.
	(gnus-cite-face-10, gnus-cite-face-11): Ditto.

	* gnus-diary.el (gnus-diary): Add :group.

	* gnus.el (gnus-group-news-1-face): Add :group.
	(gnus-group-news-1-empty-face): Ditto.
	(gnus-group-news-2-face, gnus-group-news-2-empty-face): Ditto.
	(gnus-group-news-3-face, gnus-group-news-3-empty-face): Ditto.
	(gnus-group-news-4-face, gnus-group-news-4-empty-face): Ditto.
	(gnus-group-news-5-face, gnus-group-news-5-empty-face): Ditto.
	(gnus-group-news-6-face, gnus-group-news-6-empty-face): Ditto.
	(gnus-group-news-low-face, gnus-group-news-low-empty-face): Ditto.
	(gnus-group-mail-1-face, gnus-group-mail-1-empty-face): Ditto.
	(gnus-group-mail-2-face, gnus-group-mail-2-empty-face): Ditto.
	(gnus-group-mail-3-face, gnus-group-mail-3-empty-face): Ditto.
	(gnus-group-mail-low-face, gnus-group-mail-low-empty-face): Ditto.
	(gnus-summary-selected-face, gnus-summary-cancelled-face): Ditto.
	(gnus-summary-high-ticked-face): Ditto.
	(gnus-summary-low-ticked-face): Ditto.
	(gnus-summary-normal-ticked-face): Ditto.
	(gnus-summary-high-ancient-face): Ditto.
	(gnus-summary-low-ancient-face): Ditto.
	(gnus-summary-normal-ancient-face): Ditto.
	(gnus-summary-high-undownloaded-face): Ditto.
	(gnus-summary-low-undownloaded-face): Ditto.
	(gnus-summary-normal-undownloaded-face): Ditto.
	(gnus-summary-high-unread-face): Ditto.
	(gnus-summary-low-unread-face): Ditto.
	(gnus-summary-normal-unread-face): Ditto.
	(gnus-summary-high-read-face, gnus-summary-low-read-face): Ditto.
	(gnus-summary-normal-read-face, gnus-splash-face): Ditto.

	* hashcash.el (hashcash): New custom group.
	(hashcash-default-payment): Add :group.
	(hashcash-payment-alist): Ditto.
	(hashcash-default-accept-payment): Ditto.
	(hashcash-accept-resources): Ditto.
	(hashcash-path): Ditto.
	(hashcash-extra-generate-parameters): Ditto.
	(hashcash-double-spend-database): Ditto.
	(hashcash-in-news): Ditto.

	* message.el (message-minibuffer-local-map): Add :group.

	* netrc.el (netrc): Add :group.

	* sieve-manage.el (sieve-manage-log): Add :group.
	(sieve-manage-default-user): Diito.
	(sieve-manage-server-eol, sieve-manage-client-eol): Ditto.
	(sieve-manage-streams, sieve-manage-stream-alist): Ditto.
	(sieve-manage-authenticators): Ditto.
	(sieve-manage-authenticator-alist): Ditto.
	(sieve-manage-default-port): Ditto.

	* sieve-mode.el (sieve-control-commands-face): Add :group.
	(sieve-action-commands-face): Ditto.
	(sieve-test-commands-face): Ditto.
	(sieve-tagged-arguments-face): Ditto.

	* smime.el (smime): Add :group.

	* spam-report.el (spam-report): Add :group.

	* spam.el (spam, spam-face): Add :group.

2005-05-16  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nntp.el (nntp-next-result-arrived-p): Some news servers may
	return \n.\n.\n at the end of articles.  Protect against that.
	(nntp-with-open-group): Allow debugging.

	* nnheader.el (mail-header-set-extra): Make into a function
	because I just could't understand how to quote the list properly.

	* dns.el (query-dns-cached): New function.

2005-05-26  Lute Kamstra  <lute@gnu.org>

	* score-mode.el (gnus-score-mode): Use run-mode-hooks.

2005-05-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el: Don't autoload mail-extract-address-components.

	* gnus.el: Remove duplicated autoload for message-y-or-n-p; use
	eval-and-compile to evaluate it.

	* hashcash.el: Don't autoload executable-find.

	* nndb.el: Don't declare the nndb back end two or more times; don't
	autoload news-reply-mode, news-setup, cancel-timer and telnet.

	* nntp.el: Autoload format-spec instead of format; use
	eval-and-compile to evaluate autoload forms.

2005-05-09  Georg C. F. Greve  <greve@gnu.org>  (tiny change)

	* pgg-gpg.el (pgg-gpg-possibly-cache-passphrase): Fix PIN caching.

2005-05-01  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus.el (gnus-version-number): Bump version.

2005-05-01  Lars Magne Ingebrigtsen  <lars@ingebrigtsen.no>

	* gnus.el: No Gnus v0.3 is released.

2005-04-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-edit-part): Disable undo.

2005-04-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (article-date-ut): Don't delete X-Sent header when
	gnus-article-date-lapsed-new-header is t if date timer is active;
	skip headers in which the original date value is empty.
	(gnus-article-save-original-date): Redefine it as a macro.
	(gnus-display-mime): Use it.

2005-04-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (article-date-ut): Support converting date in
	forwarded parts as well.
	(gnus-article-save-original-date): New function.
	(gnus-display-mime): Use it.

2005-04-22  David Hansen  <david.hansen@physik.fu-berlin.de>

	* nnrss.el (nnrss-check-group, nnrss-request-article): Support the
	enclosure element of <item>.

2005-04-21  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-kill-buffer-query): Rename from
	`message-kill-buffer-query-if-modified'.  Add :version.

2005-04-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mml.el (mml-preview): Bind gnus-message-buffer while setting the
	window layout.

2005-04-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mml.el: Autoload dnd when compiling.

2005-04-18  Reiner Steib  <Reiner.Steib@gmx.de>

	* mml.el (mml-mode, mml-dnd-attach-file): Use dnd-* instead of
	x-dnd-*.

2005-04-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* qp.el (quoted-printable-encode-region): Save excursion.

2005-04-14  Teodor Zlatanov  <tzz@lifelogs.com>

	* message.el (message-kill-buffer-query-if-modified): Add new variable
	so the user can kill a modified message buffer quickly.
	(message-kill-buffer): Use it.

2005-04-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-mime-inline-part): Use mm-string-to-multibyte.
	* qp.el (quoted-printable-encode-region): Use mm-string-to-multibyte.

2005-04-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnrss.el (nnrss-node-text): Replace CRLFs (which might be
	contained in text because xml.el decodes entities) with LFs.

2005-04-11  Lute Kamstra  <lute@gnu.org>

	* nnimap.el (nnimap-date-days-ago): Handle byte-compiler warnings
	differently.

2005-04-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mm-util.el (mm-detect-coding-region): Typo.

2005-04-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-read-summary-keys): Fix misplaced parens.

2005-04-06  Deepak Goel  <deego@gnufans.org>

	* spam-stat.el (spam-stat-score-buffer): Add a call to a
	user-function allow user modifications of the scores.
	(spam-stat-score-buffer-user): New function, to allow
	user-computed modifications to the score.
	(spam-stat-score-buffer-user-functions): List of additional
	scoring functions.
	(spam-stat-error-holder): Global temporary error holder.
	(spam-stat-split-fancy): Use the new `spam-stat-error-holder'
	variable.

2005-04-06  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-clean-empty-function)
	(gnus-registry-trim, gnus-registry-fetch-groups)
	(gnus-registry-delete-group): Groups that match
	`gnus-registry-ignored-groups' are removed from the registry
	entries, not just ignored for splitting.  This helps clean up the
	registry.  Also, `gnus-registry-fetch-groups' is a convenient way
	to get all the groups a message ID is in.

	* spam-stat.el (spam-stat-split-fancy-spam-threshold)
	(spam-stat-split-fancy): Change "threshhold" to "threshold".
	(spam-stat-score-buffer-user-functions): Add :number custom type.

2005-04-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-util.el (mm-coding-system-p): Don't return binary for the nil
	argument in XEmacs.

	* nnrss.el (nnrss-compatible-encoding-alist): New variable.
	(nnrss-request-group): Decode group name first.
	(nnrss-request-article): Make a text/plain article if mml-to-mime
	failed.
	(nnrss-get-encoding): Return a compatible encoding according to
	nnrss-compatible-encoding-alist.
	(nnrss-find-el): Use consp instead of listp.
	(nnrss-opml-export, nnrss-order-hrefs, nnrss-find-el): Use dolist.

2005-04-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* time-date.el (time-to-seconds): Don't use the #xhhhh syntax
	which Emacs 20 doesn't support.
	(seconds-to-time, days-to-time, time-subtract, time-add): Ditto.

2005-04-04  Reiner Steib  <Reiner.Steib@gmx.de>

	* nnimap.el (nnimap-date-days-ago): Add defvars in order to
	silence the byte compiler inside the defun.

	* gnus-demon.el (parse-time-string): Add autoload.

	* gnus-delay.el (parse-time-string): Add autoload.

	* gnus-art.el (parse-time-string): Add autoload.

	* nnultimate.el (parse-time): Require for `parse-time-string'.

2005-03-31  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (gnus-copy-article-ignored-headers): Update :version.

	* gnus-score.el (gnus-adaptive-pretty-print): Ditto.

	* smime.el (smime-ldap-host-list): Add :version.

2005-03-21  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-srvr.el (gnus-browse-select-group): Add NUMBER argument and
	pass it to `gnus-browse-read-group'.
	(gnus-browse-read-group): Add NUMBER argument and pass it to
	`gnus-group-read-ephemeral-group'.

	* gnus-group.el (gnus-group-read-ephemeral-group): Add NUMBER
	argument and pass it to `gnus-group-read-group'.

2005-03-19  Aidan Kehoe  <kehoea@parhasard.net>

	* mm-util.el (mm-xemacs-find-mime-charset): Only call
	mm-xemacs-find-mime-charset-1 if we have the mule feature
	available at runtime.

2005-03-25  Werner Lemberg  <wl@gnu.org>

	* nnmaildir.el: Replace `illegal' with `invalid'.

2005-03-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* gnus-start.el (gnus-display-time-event-handler):
	Check display-time-timer at runtime rather than only at load time
	in case display-time-mode is turned off in the mean time.

2005-03-16  Reiner Steib  <Reiner.Steib@gmx.de>

	* nnimap.el (nnimap-open-connection): Print which authinfo file is
	used.

	* nneething.el (nneething-map-file-directory): Derive from
	`gnus-directory'.

	* gnus-art.el (gnus-header-button-alist): Use `gnus-msg-mail' for
	the To/Cc button.

2005-03-15  Reiner Steib  <Reiner.Steib@gmx.de>

	* nnmaildir.el (nnmaildir-request-accept-article):
	Use `nnheader-cancel-timer' for compatibility with current XEmacs.

2005-03-13  Andrey Slusar  <anrays@gmail.com>  (tiny change)

	* gnus-async.el: Require timer-funcs at compile time when in
	XEmacs for `run-with-idle-timer'.

2005-03-13  Andrey Slusar  <anrays@gmail.com>  (tiny change)

	* gnus.el: Don't try and mark `gnus-agent-save-groups' as an
	autoloaded function.

2005-03-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* nnimap.el (nnimap-retrieve-headers-from-server): Fix last change.

2005-03-10  Arne Jørgensen  <arne@arnested.dk>  (tiny change)

	* nnimap.el (nnimap-retrieve-headers-from-server): Fix off-by-one flaw.

2005-03-09  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-msg.el (gnus-confirm-mail-reply-to-news):
	Add gnus-expert-user to default.

2005-03-08  Juergen Kreileder  <jk@blackdown.de>  (tiny change)

	* nnimap.el (nnimap-open-server): Ditto.

	* imap.el (imap-authenticate): Fix typo.

2005-03-08  Bjorn Solberg  <bjorn_ding@hekneby.org>  (tiny change)

	* nnimap.el (nnimap-retrieve-headers-from-server): Sort NOV
	buffer (since IMAP server might return FETCH response out of
	order, and the nntp buffer must be sorted).

2005-03-06  Kevin Greiner  <kevin.greiner@compsol.cc>

	* gnus-start.el (gnus-convert-old-newsrc): Fix numeric
	comparison on string.

	* gnus-agent.el (gnus-agent-long-article, gnus-agent-short-article)
	(gnus-agent-score): Rename category keywords to match gnus-cus.
	(gnus-agent-summary-fetch-series): Modify to protect against
	gnus-agent-summary-fetch-group clearing processable flags.
	(gnus-agent-synchronize-group-flags): Update live group buffer as
	synchronization may occur due to the user toggle the plugged
	status.
	(gnus-agent-fetch-group-1): Clear downloadable flag when article
	successfully downloaded.
	(gnus-agent-expire-group-1): Avoid using markers when the overview
	is in ascending order; greatly improves performance.
	(gnus-agent-regenerate-group):
	Use gnus-agent-synchronize-group-flags to reset read status in both
	gnus and server.
	(gnus-agent-update-files-total-fetched-for): Fix initial size.

2005-03-04  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el: Don't autoload former message-utils variables.
	(message-strip-subject-trailing-was): Change doc string.

	* nnweb.el: Fixes for `gnus-group-make-web-group'.
	(nnweb-type-definition): Don't add "hl=en" in `address'.  Add `base'.
	(nnweb-google-search): Add "hl=en" here.
	(nnweb-google-parse-1, nnweb-google-create-mapping):
	Don't hardcode URL.

2005-03-03  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-get-reply-headers, message-followup):
	Mention related variables `message-use-followup-to' and
	`message-use-mail-followup-to', in the information buffer.

	* nnweb.el (nnweb-type-definition): Use groups.google.de instead
	of broken groups(-beta).google.com.

2005-03-03  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-sum.el (gnus-summary-move-article): Pass move-is-internal
	parameter to invoked gnus-request-move-article; remove the
	redundant gnus-sum-hint-move-is-internal variable; apply the marks
	all at once instead of once per article.
	(gnus-summary-remove-process-mark): Accept a list of articles as
	well as a single article for processing.

	* gnus-int.el (gnus-request-move-article): Add move-is-internal
	parameter.

	* nnml.el (nnml-request-move-article): Add move-is-internal parameter.

	* nnmh.el (nnmh-request-move-article): Add move-is-internal parameter.

	* nnmbox.el (nnmbox-request-move-article): Add move-is-internal
	parameter.

	* nnmaildir.el (nnmaildir-request-move-article): Add move-is-internal
	parameter.

	* nnimap.el (nnimap-request-move-article): Add move-is-internal
	parameter and remove the gnus-sum-hint-move-is-internal variable.

	* nnfolder.el (nnfolder-request-move-article): Add move-is-internal
	parameter.

	* nndraft.el (nndraft-request-move-article): Add move-is-internal
	parameter.

	* nndiary.el (nndiary-request-move-article): Add move-is-internal
	parameter.

	* nndb.el (nndb-request-move-article): Add move-is-internal parameter.

	* nnbabyl.el (nnbabyl-request-move-article): Add move-is-internal
	parameter.

	* nnagent.el (nnagent-request-move-article): Add move-is-internal
	parameter.

2005-03-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* gnus-sum.el (gnus-summary-exit): Undo last change and fix it in
	a more conservative way.

2005-02-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* gnus-sum.el (gnus-summary-exit): Move point after displaying the
	buffer, so it moves the window's cursor.

2005-02-26  Arne Jørgensen  <arne@arnested.dk>

	* mm-decode.el (mm-dissect-buffer): Pass the from field on to
	`mm-dissect-multipart' and receive the from field as an (optional)
	argument from `mm-dissect-multipart'.
	(mm-dissect-multipart): Receive the from field as an argument and
	pass it on when we call `mm-dissect-buffer' on MIME parts.
	Fixes verification/decryption of signed/encrypted MIME parts.

2005-02-25  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-sum.el (gnus-summary-move-article):
	Set gnus-sum-hint-move-is-internal for gnus-request-move-article and
	whatever it calls (right now, only nnimap-request-move article
	respects it).

	* nnimap.el (nnimap-request-move-article):
	When gnus-sum-hint-move-is-internal is set, don't do the extra
	nnimap-request-article.

2005-02-24  Reiner Steib  <Reiner.Steib@gmx.de>

	* nnheader.el (nnheader-find-file-noselect): Add doc string.

	* nnfolder.el (nnfolder-read-folder): Use RAWFILE for
	`nnheader-find-file-noselect' to avoid `large-file-warning-threshold'.

	* gnus-sum.el (gnus-summary-caesar-message):
	Apply `gnus-treat-article' after rotation.

	* gnus-group.el (gnus-group-clear-data): Mention process/prefix in
	doc string.

2005-02-22  Simon Josefsson  <jas@extundo.com>

	* encrypt.el (encrypt-password-cache-expiry): Remove (use
	`password-cache-expiry' instead).  Reported by Arne Jørgensen
	<arne@arnested.dk>.
	(encrypt): Add password-cache and password-cache-expiry as group
	members.

2005-02-22  Arne Jørgensen  <arne@arnested.dk>

	* smime.el (smime-ldap-host-list): Doc fix.
	(smime-ask-passphrase): Use `password-read-and-add' to read (and
	cache) password.
	(smime-sign-region): Use it.
	(smime-decrypt-region): Use it.
	(smime-sign-buffer): Signal an error if `smime-sign-region' fails.
	(smime-encrypt-buffer): Signal an error if `smime-encrypt-region'
	fails.
	(smime-cert-by-ldap-1): Use `base64-encode-string' to convert
	certificate from DER to PEM format rather than calling openssl.

	* mml-smime.el (mml-smime-encrypt-query): Remove obsolete comment.

	* mml-sec.el (mml-secure-message): Insert keyfile/certfile tags
	for signing/encryption.

	* mml.el (mml-parse-1): Use them.

2005-02-21  Arne Jørgensen  <arne@arnested.dk>

	* nnrss.el (nnrss-verbose): Remove.
	(nnrss-request-group): Use `nnheader-message' instead.

2005-02-19  Mark Plaksin  <happy@usg.edu>  (tiny change)

	* nnrss.el (nnrss-verbose): New variable.
	(nnrss-request-group): Make it say nnrss is requesting a group.

2005-02-21  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (gnus-parse-news-url, gnus-button-handle-news):
	Handle news URL with given port correctly.

2005-02-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-msg.el (gnus-copy-article-buffer): Quote decoded words
	containing special characters.

	* gnus-sum.el (gnus-summary-edit-article): Ditto.

	* mml.el (mime-to-mml): Ditto.

	* rfc2047.el (rfc2047-encode-parameter): Use ietf-drums-tspecials.
	(rfc2047-quote-decoded-words-containing-tspecials): New variable.
	(rfc2047-decode-region): Quote decoded words containing special
	characters when rfc2047-quote-decoded-words-containing-tspecials
	is non-nil.

2005-02-16  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-delete-group): Add minor bug fix.

	* gnus.el (gnus-install-group-spam-parameters): Add minor doc fix.

2005-02-15  Simon Josefsson  <jas@extundo.com>

	* nnimap.el (nnimap-debug): Doc fix.

	* imap.el (imap-debug): Doc fix.

2005-02-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el: Avoid "Recursive load suspected" error in Emacs 21.1.

2005-02-14  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus.el (spam-contents): Improve docs for spam-contents
	parameter in its variable incarnation.

2005-02-14  Simon Josefsson  <jas@extundo.com>

	* smime-ldap.el: Use require instead of load-library for ldap.
	(smime-ldap-search): Indent.
	(smime-ldap-search-internal): Shorten line.

	* smime.el (smime-cert-by-dns): Add doc-string.
	(smime-cert-by-ldap-1): Indent.

	* mml-smime.el (mml-smime-get-ldap-cert): Rename from
	mml-smime-get-dns-ldap.
	(mml-smime-encrypt-query): Use new function.  Default to ldap.

2005-02-14  Arne Jørgensen  <arne@arnested.dk>

	* smime.el: Require smime-ldap.
	(smime-ldap-host-list): New variable.
	(smime-cert-by-ldap, smime-cert-by-ldap-1): New functions.

	* mml-smime.el (mml-smime-encrypt-query): New function.
	(mml-smime-encrypt-query): Use it.

	* smime-ldap.el: New file.

2005-02-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-agent.el: Remove garbage made while merging the Emacs trunk.

2005-02-14  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-group.el (gnus-group-make-doc-group): Mention prefix
	argument in doc string.  Make query for type more clear.

2005-02-13  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus.el (gnus-group-startup-message): Search for gnus images in
	etc/images/gnus.
	* mm-util.el (mm-image-load-path): Likewise.
	* smiley.el (smiley-data-directory): Search for smilies in
	etc/images/smilies.

2005-02-09  Kim F. Storm  <storm@cua.dk>

	Change Emacs release version from 21.4 to 22.1 throughout.
	Change Emacs development version from 21.3.50 to 22.0.50.

2005-02-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-mime-copy-part): Don't decode compressed parts.

	* mm-util.el (mm-coding-system-to-mime-charset): Make it work with
	non-Mule XEmacs as well.
	(mm-decompress-buffer): Signal an error intentionally if it does
	not decompress compressed data because auto-compression-mode is
	disabled.

2005-02-11  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-delete-group): Fix bug: leaves
	an ID in the registry even if it has no groups.

2005-02-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-mime-jka-compr-maybe-uncompress): Remove;
	merge it into mm-decompress-buffer.
	(gnus-mime-copy-part): Use the MIME part charset, the value which
	a user specified or gnus-newsgroup-charset for decoding, like
	gnus-mime-inline-part does; set buffer-file-coding-system to tell
	save-buffer what was used.  Suggested by Kevin Ryde
	<user42@zip.com.au>.
	(gnus-mime-inline-part): Allow the name parameter as well as the
	filename parameter; force decompressing of compressed data; always
	display contents being not decoded as unibyte.

	* mm-view.el (mm-display-inline-fontify): Allow the name parameter
	as well as the filename parameter.

	* mm-util.el (mm-decompress-buffer):
	Merge gnus-mime-jka-compr-maybe-uncompress.
	(mm-find-buffer-file-coding-system): Doc fix; force decompressing
	of compressed data.

2005-02-08  Simon Josefsson  <jas@extundo.com>

	* imap.el (imap-log): Doc fix.

2005-02-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-mime-inline-part): Decode parts according to
	the coding cookies; decompress compressed parts.

	* mml.el (mml-generate-mime-1): Add the charset parameter according
	to the value which a user specified manually or the coding cookie.

	* mm-util.el (mm-string-to-multibyte): New function.
	(mm-detect-mime-charset-region): Work with Emacs 22 as well.
	(mm-coding-system-to-mime-charset): New function.
	(mm-decompress-buffer): New function.
	(mm-find-buffer-file-coding-system): New function.

	* mm-view.el (mm-insert-inline): Make sure a part ends with a newline.
	(mm-display-inline-fontify): Rewrite for decoding and decompressing
	parts.

2005-02-07  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* mm-view.el (mm-display-inline-fontify): Decode a part according
	to the charset parameter.

2005-02-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-mime-inline-part): Show the raw contents if a
	prefix arg is neither nil nor a number, as info specifies.

2005-02-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nntp.el (nntp-marks-changed-p): Use time-less-p to compare the
	timestamps.

2005-02-02  Jari Aalto  <jari.aalto@cante.net>

	* gnus-sum.el (gnus-list-of-unread-articles): Improve active
	groups error checking and notify user.

2005-02-02  Jari Aalto  <jari.aalto@poboxes.com>

	* message.el (message-send-mail-function): Check existence of
	sendmail-program first before using default value
	`message-send-mail-with-sendmail'.  Otherwise use more generic
	`smtpmail-send-it'.

2005-02-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nntp.el (nntp-request-update-info): Always return nil.

2005-01-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* gnus-art.el (gnus-article-mode): Turn off the "\ " non-break space.

2005-01-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* message.el (message-beginning-of-line): Change the behavior when
	invoked between BOL and : so that it first moves backward.

2005-01-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-setup-buffer): Kill and re-create the
	article buffer when editing of the article is discarded.
	(gnus-article-prepare): Revert.

2005-01-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-prepare):
	Remove message-strip-forbidden-properties from the local hook.

2005-01-27  Simon Josefsson  <jas@extundo.com>

	* password.el (password-cache-add): Only start one timer per key.
	Reported by Derek Atkins <warlord@MIT.EDU>.

2005-01-26  Steve Youngs  <steve@sxemacs.org>

	* run-at-time.el: Remove.  It is no longer needed as
	timer-funcs.el in the xemacs-base package has a working version of
	`run-at-time'.

	* password.el: Require timer-funcs instead of run-at-time in
	XEmacs.
	Remove `password-run-at-time' macro.
	(password-cache-add): Use `run-at-time' instead of
	`password-run-at-time'.

	* mail-source.el: Require timer-funcs instead of itimer in XEmacs
	for `run-with-idle-timer'.

	* gnus-demon.el: Require timer-funcs instead of itimer in XEmacs
	for `run-at-time'.

	* mm-url.el: Require timer-funcs at compile time when in XEmacs
	for `with-timeout'.

2005-01-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mml.el (mml-generate-mime-1): Convert string into unibyte when
	inserting " *mml*" buffer's contents into a unibyte temp buffer.

2005-01-24  Harald Meland  <harald.meland@usit.uio.no>  (tiny change)

	* mail-source.el (mail-source-fetch-imap): Search for ^From case
	sensitively.

2005-01-21  Derek Atkins  <warlord@MIT.EDU>  (tiny change)

	* pgg-pgp.el (pgg-pgp-decrypt-region): Use passphrase cache.

2005-01-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-decode.el (mm-insert-part): Switch the multibyteness of data
	which will be inserted according to the multibyteness of a buffer
	rather than the type of contents.  Suggested by ARISAWA Akihiro
	<ari@mbf.ocn.ne.jp>.

	* nnrss.el (nnrss-find-el): Check carefully whether there's a list
	of string which old xml.el may return rather than a string.

2005-01-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-summary-idna-message): Silence byte compiler.

2005-01-16  Simon Josefsson  <jas@extundo.com>

	* gnus-sum.el (gnus-summary-idna-message): Fail gracefully if
	idn/idna.el isn't available.
	(gnus-summary-idna-message): Doc fix.  Suggested by Michael Cook
	<michael@waxrat.com>.

	* hashcash.el: Remove non-FSF copyright header.

	* hashcash.el (hashcash-extra-generate-parameters): New variable.
	(hashcash-generate-payment): Use it.
	(hashcash-generate-payment-async): Use it.

2005-01-15  Simon Josefsson  <jas@extundo.com>

	* message.el (message-idna-to-ascii-rhs): Decode Reply-To too.
	Suggested by Raymond Scholz <ray-2005@zonix.de>.

	* gnus-sum.el (gnus-summary-wash-map): Bind "W i" to
	gnus-summary-idna-message.
	(gnus-summary-make-menu-bar): Add De-IDNA menu entry.
	(gnus-summary-idna-message): New function.

2005-01-13  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-msg.el (gnus-confirm-mail-reply-to-news): Change default to
	gnus-novice-user.

2005-01-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnrss.el (nnrss-request-delete-group): Delete entries in
	nnrss-group-alist as well.
	(nnrss-save-server-data): Insert newline.

2005-01-10  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus.el (gnus-user-agent): Use list of symbols instead of
	symbols.  Display full version number for (S)XEmacs.
	Optionally display (S)XEmacs codename.

	* gnus-util.el (gnus-emacs-version): Update for new
	`gnus-user-agent'.

	* gnus-msg.el (gnus-extended-version): Make it possible to omit
	Gnus version.

2005-01-05  Reiner Steib  <Reiner.Steib@gmx.de>

	* spam.el (spam-face): New face.  Don't use `gnus-splash-face'
	which is unreadable in some setups.

2005-01-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-spec.el (gnus-update-format-specifications): Flush the
	group format spec cache if it doesn't support decoded group names.

2005-01-03  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-score.el (gnus-decay-scores, gnus-score-load-file):
	Allow to apply decay on score files matching a regexp.

2004-12-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-group.el (gnus-group-line-format-alist): Keep the forward
	compatibility in %g and %c.

2004-12-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-group.el (gnus-group-line-format-alist): Use decoded group
	name for only %g and %c.
	(gnus-group-insert-group-line): Bind gnus-tmp-decoded-group instead
	of gnus-tmp-group to decoded group name.
	(gnus-group-make-rss-group): Exclude `/'s from group names.

2004-12-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnrss.el (nnrss-get-encoding): Fix regexp.

2004-12-27  Simon Josefsson  <jas@extundo.com>

	* mm-bodies.el (mm-body-encoding): Don't permit 7-bit to be used when
	mm-use-ultra-safe-encoding is enabled (e.g., for PGP/MIME) and we have
	trailing white space.  Reported by Werner Koch <wk@gnupg.org>.

2004-12-17  Kim F. Storm  <storm@cua.dk>

	* gnus-group.el (gnus-group-mode-map): Map follow-link to mouse-face.

	* gnus-sum.el (gnus-summary-mode-map): Likewise.

2004-12-26  Tsuyoshi AKIHO  <akiho@kawachi.zaq.ne.jp>

	* gnus-sum.el (gnus-summary-walk-group-buffer): Decode group name.

2004-12-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnrss.el: Require rfc2047 and mml.
	(nnrss-file-coding-system): New variable.
	(nnrss-format-string): Redefine it as an inline function.
	(nnrss-decode-group-name): New function.
	(nnrss-string-as-multibyte): Remove.
	(nnrss-retrieve-headers): Decode group name; don't use
	nnrss-format-string.
	(nnrss-request-group): Decode group name.
	(nnrss-request-article): Decode group name; allow a Message-ID as
	well as an article number; don't use nnrss-format-string; encode a
	Message-ID string which may contain non-ASCII characters; use
	mml-to-mime to compose a MIME article.
	(nnrss-request-expire-articles): Decode group name.
	(nnrss-request-delete-group): Decode group name.
	(nnrss-fetch): Clarify error message.
	(nnrss-read-server-data): Use insert-file-contents instead of load;
	bind file-name-coding-system; use multibyte buffer.
	(nnrss-save-server-data): Bind coding-system-for-write to the
	value of nnrss-file-coding-system; bind file-name-coding-system;
	add coding cookie.
	(nnrss-read-group-data): Use insert-file-contents instead of load;
	bind file-name-coding-system; use multibyte buffer.
	(nnrss-save-group-data): Bind coding-system-for-write to the
	value of nnrss-file-coding-system; bind file-name-coding-system.
	(nnrss-decode-entities-string): Rename from n-d-e-unibyte-string;
	make it work with non-ASCII text.
	(nnrss-find-el): Make it work with old xml.el as well.

2004-12-26  Tsuyoshi AKIHO  <akiho@kawachi.zaq.ne.jp>

	* nnrss.el (nnrss-get-encoding): New function.
	(nnrss-fetch): Use unibyte buffer initially; bind
	coding-system-for-read while performing mm-url-insert; remove ^Ms;
	decode contents according to the encoding attribute.
	(nnrss-save-group-data): Add coding cookie.
	(nnrss-mime-encode-string): New function.
	(nnrss-check-group): Use it to encode subject and author.

2004-12-23  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-check-BBDB): Don't get the symbol-value of an
	imaginary variable.

2004-12-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-spec.el (gnus-spec-tab): Make a Lisp form which works
	correctly even if there are wide characters.

2004-12-21  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-check-BBDB): Fix the BBDB caching code to use
	downcased symbol names; make a new cache instead of reusing
	bbdb-hashtable.

2004-12-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2231.el (rfc2231-parse-string): Decode encoded value after
	concatenating segments rather than before concatenating them.
	Suggested by ARISAWA Akihiro <ari@mbf.ocn.ne.jp>.

	* message.el (message-get-reply-headers): Bind `extra'.

2004-12-21  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-extra-wide-headers): New variable.
	(message-get-reply-headers): Use it.

2004-12-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-agent.el (gnus-agent-group-path): Decode group name.
	(gnus-agent-group-pathname): Ditto.

	* gnus-cache.el (gnus-cache-file-name): Decode group name.

	* gnus-group.el (gnus-group-make-group): Decode group name.
	(gnus-group-make-rss-group): Register the group data after opening
	the nnrss group.

2004-12-17  Paul Jarc  <prj@po.cwru.edu>

	* nnmaildir.el (nnmaildir-request-expire-articles): Articles moved
	by expiry now get marked as read.

2004-12-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-util.el (mm-xemacs-find-mime-charset): New macro.

2004-12-17  Aidan Kehoe  <kehoea@parhasard.net>

	* mm-util.el (mm-xemacs-find-mime-charset-1): New function used to
	unify Latin characters in XEmacs.
	(mm-find-mime-charset-region): Use it.

2004-12-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-util.el (gnus-delete-directory): New function.

	* gnus-agent.el (gnus-agent-delete-group): Use it.

	* gnus-cache.el (gnus-cache-delete-group): Use it.

2004-12-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-group.el (gnus-group-make-rss-group): Unify non-ASCII group
	names.

2004-12-16  Simon Josefsson  <jas@extundo.com>

	* hashcash.el (hashcash-payment-alist): Fix custom :type.

2004-12-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-url.el (mm-url-predefined-programs): Add --silent arg to curl.

	* gnus-group.el (gnus-group-expire-articles-1): Decode group name.
	(gnus-group-set-current-level): Decode group name.

2004-12-15  Maciek Pasternacki  <maciekp@japhy.fnord.org>  (tiny change)

	* nnrss.el (nnrss-fetch): Signal an error if w3-parse-buffer also
	failed.

2004-12-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-group.el (gnus-group-delete-group): Decode group name.
	(gnus-group-make-rss-group): Encode group name.
	(gnus-group-catchup-current): Decode group name.
	(gnus-group-kill-group): Decode group name.

2004-12-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* gnus-art.el (gnus-narrow-to-page): Don't hardcode point-min.

2004-12-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-group.el (gnus-group-make-rss-group):
	Use gnus-group-make-group instead of gnus-group-unsubscribe-group.

	* gnus-start.el (gnus-setup-news): Honor user's setting to
	gnus-message-archive-method.  Suggested by Lute Kamstra
	<lute@gnu.org>.

2004-12-10  Arnaud Giersch  <arnaud.giersch@free.fr>  (tiny change)

	* gnus-sum.el (gnus-summary-exit-no-update): Don't clear the
	global counterparts of the buffer-local variables.

2004-11-16  Romain Francoise  <romain@orebokech.com>

	* gnus-sum.el (gnus-summary-exit): Don't clear the global
	counterparts of the buffer-local variables.

2004-11-25  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-forbidden-properties): Fix typo in doc
	string.

2004-11-25  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-util.el (gnus-replace-in-string): Add doc string.

	* nnmail.el (nnmail-split-header-length-limit): Increase to 2048
	to avoid problems when splitting mails with many recipients.

2004-11-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* gnus-sum.el (gnus-summary-exit): Remove redundant and harmful
	pop-to-buffer, covered by the subsequent gnus-configure-windows.

2004-12-05  Nelson Ferreira  <nelson.ferreira@ieee.org>

	* spam-stat.el (spam-stat-save): Load the hashtable from disk only
	if there is no hashtable in memory or file modification time is
	newer than cached timestamp.

2004-12-03  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-sum.el (gnus-summary-limit-to-recipient):
	Implement not-matching option.

2004-12-02  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-sum.el (gnus-summary-limit-to-recipient): New function.
	Suggested David Mazieres in analogy to rmail-summary-by-recipients.
	(gnus-summary-limit-map, gnus-summary-make-menu-bar): Add it.
	(gnus-article-sort-by-recipient, gnus-summary-sort-by-recipient):
	New functions.  Suggested by Uwe Brauer <oub@mat.ucm.es>.
	(gnus-summary-mode-map, gnus-summary-make-menu-bar): Add it.

2004-12-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-forward-make-body-mml): Remove headers
	according to message-forward-ignored-headers if a message is decoded.

2004-12-02  Romain Francoise  <romain@orebokech.com>

	* message.el (message-forward-make-body-plain): Always remove
	headers according to message-forward-ignored-headers.

2004-12-01  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-summary-prepare-exit): Remove the
	gnus-summary-limit pop for now, it has problems with ham marks for
	me.

2004-11-29  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-summary-prepare-exit): Use gnus-summary-limit
	correctly.

2004-11-28  Carl Henrik Lunde  <chlunde+bugs+@ping.uio.no>  (tiny change)

	* format-spec.el (format-spec): Message the char.

2004-11-26  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-art.el (gnus-split-methods): Reformat comments.

	* spam.el (spam-summary-prepare-exit): Remove article limits
	before exiting the summary buffer.

2004-11-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnrss.el (nnrss-string-as-multibyte): Redefine it as a macro in
	order to silence the byte compiler.

	* spam.el: Fix the way to silence the byte compiler, which
	complained about bbdb-buffer, bbdb-create-internal, bbdb-records,
	bbdb-search-simple, spam-BBDB-register-routine,
	spam-enter-ham-BBDB, spam-stat-buffer-change-to-non-spam,
	spam-stat-buffer-change-to-spam, spam-stat-buffer-is-non-spam,
	spam-stat-buffer-is-spam, spam-stat-load,
	spam-stat-register-ham-routine, spam-stat-register-spam-routine,
	spam-stat-save and spam-stat-split-fancy.

2004-11-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* canlock.el (canlock-password): Remove `:size 0' or `:size 1'
	which may confuse users.
	(canlock-password-for-verify): Ditto.

	* deuglify.el (gnus-outlook-deuglify-unwrap-stop-chars): Ditto.

	* gnus-art.el (gnus-emphasis-alist): Ditto.

	* gnus-registry.el (gnus-registry-max-entries): Ditto.

	* gnus-score.el (gnus-adaptive-word-length-limit): Ditto.

	* gnus-start.el (gnus-save-killed-list): Ditto.

	* gnus-sum.el (gnus-thread-hide-subtree): Ditto.
	(gnus-sum-thread-tree-root): Ditto.
	(gnus-sum-thread-tree-false-root): Ditto.
	(gnus-sum-thread-tree-single-indent): Ditto.

	* message.el (message-courtesy-message): Ditto.
	(message-archive-note): Ditto.
	(message-subscribed-address-file): Ditto.
	(message-user-fqdn): Ditto.

	* spam-report.el (spam-report-gmane-regex): Ditto.

	* spam.el (spam-blackhole-good-server-regex): Ditto.

2004-11-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mml.el (mml-preview): Widen the message buffer before copying
	the contents to the preview buffer; sort headers before previewing.

	* message.el (message-hidden-headers): Fix the way to avoid a bug
	in the `repeat' widget in Emacs 21.3 or earlier.

2004-11-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-hidden-headers): Default to "^References:".
	Improve customization type.  Suggested by Reiner Steib
	<Reiner.Steib@gmx.de>.

2004-11-25  Romain Francoise  <romain@orebokech.com>

	* message.el (message-strip-forbidden-properties): Remove check for
	obsolete `message-hidden' text property, hidden headers are not
	accessible in the buffer anymore.

2004-11-22  Romain Francoise  <romain@orebokech.com>

	* message.el (message-header-format-alist): Add `From' in list
	so that it can be sorted.
	(message-fix-before-sending): Widen and sort headers before
	sending.
	(message-hide-headers): Use narrowing to hide headers by moving
	them to the top of the buffer and narrowing to the region
	underneath.

2004-11-23  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-strip-forbidden-properties):
	Bind buffer-read-only (etc) to nil.

2004-11-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2047.el (rfc2047-header-encoding-alist): Add In-Reply-To to
	address-mime.  Suggested by ARISAWA Akihiro <ari@mbf.ocn.ne.jp>.

2004-11-22  Marek Martin  <marek.martin@mum.pri.ee>  (tiny change)

	* nnfolder.el (nnfolder-request-create-group): Save current buffer.

2004-11-19  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* dns.el (query-dns): Use sit-for to time instead of
	accept-process-output, since that doesn't seem to work on udp
	sockets.

2004-11-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2047.el (rfc2047-encode-region): Encode bogus delimiters.

2004-11-15  Jesper Harder  <harder@ifa.au.dk>

	* pop3.el (pop3-leave-mail-on-server): Don't quote nil in
	doc string.  Improve doc string.

2004-11-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nntp.el (nntp-request-update-info): Return nil if
	nntp-marks-is-evil is true so that gnus-get-unread-articles-in-group
	may not call gnus-activate-group which uselessly issues the GROUP
	commands for all nntp groups and wastes time.  Reported by Romain
	Francoise <romain@orebokech.com>.

	* gnus-start.el (gnus-get-unread-articles): Remove redundant test.

2004-11-15  Simon Josefsson  <jas@extundo.com>

	* gnus-art.el (gnus-header-button-alist): Handle URLs in OpenPGP:
	headers separately.
	(gnus-button-openpgp): New function, inspired by Jochen Küpper
	<jochen-+It19tn3Rl9sbm7dSapR3bNAH6kLmebB@public.gmane.org>.

2004-11-14  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-start.el (gnus-convert-old-newsrc):
	Assign legacy-gnus-agent to 5.10.7.

2004-11-14  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-art.el (article-unsplit-urls): Don't anchor urls to the
	start of the lines.

2004-11-14  Magnus Henoch  <mange@freemail.hu>

	* hashcash.el (hashcash-default-payment): Change default to 20.
	(hashcash-default-accept-payment): Change default to 20.
	(hashcash-process-alist): New variable.
	(hashcash-generate-payment-async): Add.
	(hashcash-already-paid-p): Add.
	(hashcash-insert-payment): Don't generate payments twice.
	(hashcash-insert-payment-async): Add.
	(hashcash-insert-payment-async-2): Add.
	(hashcash-cancel-async): Add.
	(hashcash-wait-async): Add.
	(hashcash-processes-running-p): Add.
	(hashcash-wait-or-cancel): Add.
	(mail-add-payment): New optional argument.  Conditionally start
	asynchronous calculation.
	(mail-add-payment-async): Add.

	* message.el (message-send-mail): Wait for asynchronous hashcash
	results.  Don't clobber existing X-Hashcash headers.
	(message-setup-1): Call mail-add-payment-async when
	message-generate-hashcash is non-nil.

2004-11-11  ARISAWA Akihiro  <ari@mbf.ocn.ne.jp>  (tiny change)

	* message.el (message-use-alternative-email-as-from): Examine the
	From header as well; use message-make-from in order to include a
	user's full name.

2004-11-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-emphasis-alist): Don't hide asterisks by
	default; improve customization type.
	(gnus-emphasis-custom-with-format): New macro.
	(gnus-emphasis-custom-value-to-external): New function.
	(gnus-emphasis-custom-value-to-internal): New function.

2004-11-09  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* dns.el (query-dns): Resolve reverse addresses.

2004-10-23  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-group.el (gnus-group-get-new-news): Use it.

	* gnus-start.el (gnus-check-reasonable-setup): New function.

2004-11-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-msg.el (gnus-configure-posting-styles): Don't cause the
	"Args out of range" error.  Reported by Arnaud Giersch
	<arnaud.giersch@free.fr>.

2004-11-07  Stefan Wiens  <s.wi@gmx.net>  (tiny change)

	* gnus-sum.el (gnus-summary-clear-local-variables): Use symbolp.

2004-11-04  Richard M. Stallman  <rms@gnu.org>

	* spam.el (spam group): Add :version.

	* pgg-def.el (pgg group): Add :version.

2004-11-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-edit-article): Don't associate the
	article buffer with a draft file.  This is a temporary measure
	against the 2004-08-22 change to gnus-article-edit-mode.

2004-11-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* html2text.el (html2text-get-attr): Remove unused argument `tag'.
	(html2text-format-tags): Remove unused variable `attr'.

2004-11-01  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-msg.el (gnus-summary-resend-default-address): Add :version.

	* spam-stat.el (spam-stat): Add :version.

	* sieve.el (sieve): Add :version.

	* sha1.el (sha1): Add :version.
	(sha1-use-external): Remove redundant version.

	* nnmail.el (nnmail-split-fancy-with-parent-ignore-groups)
	(nnmail-cache-ignore-groups, nnmail-spool-hook)
	(nnmail-split-fancy-match-partial-words)
	(nnmail-split-lowercase-expanded): Add :version.

	* nndiary.el (nndiary): Add :version.

	* mml2015.el (mml2015-unabbrev-trust-alist): Add :version.

	* mml-sec.el (mml-default-sign-method)
	(mml-default-encrypt-method, mml-signencrypt-style-alist):
	Add :version.

	* mm-uu.el (mm-uu-diff-groups-regexp): Add :version.

	* mm-url.el (mm-url-use-external, mm-url-program)
	(mm-url-arguments): Add :version.

	* mm-decode.el (mm-inline-text-html-with-w3m-keymap)
	(mm-attachment-file-modes, mm-decrypt-option)
	(mm-w3m-safe-url-regexp): Add :version.

	* message.el (message-cite-prefix-regexp)
	(message-sendmail-envelope-from, message-minibuffer-local-map)
	(message-user-fqdn, message-completion-alist): Add :version.

	* gnus-win.el (gnus-configure-windows-hook)
	(gnus-use-frames-on-any-display): Add :version.

	* gnus-art.el (gnus-article-address-banner-alist)
	(gnus-treat-unsplit-urls, gnus-treat-unfold-headers)
	(gnus-treat-from-picon, gnus-treat-mail-picon)
	(gnus-treat-x-pgp-sig): Add :version.

	* gnus-sum.el (gnus-spam-mark, gnus-recent-mark)
	(gnus-undownloaded-mark, gnus-summary-article-move-hook)
	(gnus-summary-article-delete-hook)
	(gnus-summary-display-while-building): Add :version.

	* gnus-start.el (gnus-subscribe-newsgroup-hooks)
	(gnus-get-top-new-news-hook): Add :version.

	* gnus-srvr.el (gnus-server-agent-face, gnus-server-opened-face)
	(gnus-server-closed-face, gnus-server-denied-face): Add :version.

	* gnus-registry.el (gnus-registry): Add :version.

	* gnus-spec.el (gnus-use-correct-string-widths)
	(gnus-make-format-preserve-properties): Add :version.

	* gnus.el (gnus-group-charter-alist)
	(gnus-group-fetch-control-use-browse-url)
	(gnus-install-group-spam-parameters): Add :version.

	* gnus-diary.el (gnus-diary): Add :version.

	* gnus-delay.el (gnus-delay): Add :version.

	* gnus-cite.el (gnus-cite-unsightly-citation-regexp)
	(gnus-cite-ignore-quoted-from, gnus-cite-attribution-face)
	(gnus-cite-blank-line-after-header, gnus-article-boring-faces):
	Add :version.

	* gnus-agent.el (gnus-agent-max-fetch-size)
	(gnus-agent-enable-expiration, gnus-agent-queue-mail)
	(gnus-agent-prompt-send-queue): Add :version.

	* deuglify.el (gnus-outlook-deuglify): Add :version.

	* html2text.el: Beautify code.  Improve doc strings.
	Some checkdoc cleanup.
	(html2text-get-attr, html2text-fix-paragraph): Simplify code.

2004-11-01  Alfred M. Szmidt  <ams@kemisten.nu>  (tiny change)

	* html2text.el (html2text-format-tag-list): Add "strong" and "em".

2004-10-29  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-hashtb): Create the registry
	when package is loaded.

	* spam.el (spam-summary-score-preferred-header): Add global preference
	for people who want to override the default SpamAssassin over
	Bogofilter preference (when both are set).
	(spam-necessary-extra-headers): Add spam-use-bogofilter as an option.
	(spam-user-format-function-S):
	Check spam-summary-score-preferred-header.
	(spam-extra-header-to-number): Add X-Bogosity header parsing.
	(spam-user-format-function-S): Format the score correctly.

2004-10-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-msg.el (gnus-configure-posting-styles): Work with empty
	signature file.  Suggested by Manoj Srivastava
	<srivasta@golden-gryphon.com>.

	* mm-util.el (mm-coding-system-priorities): Prefer iso-8859-1 than
	iso-2022-jp even in the Japanese language environment.
	Suggested by Jason Rumney <jasonr@gnu.org>.

2004-10-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-update-summary-mark-positions): Allow users to
	use the same characters as the dummy marks; make it free from
	getting affected by the language environment.
	(gnus-summary-read-group-1): Update mark positions only when the
	format spec is updated.

	* gnus-spec.el (gnus-update-format-specifications): Return a list
	of updated types.

2004-10-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-start.el (gnus-check-reasonable-setup): Use fboundp instead
	of boundp to check if display-warning is available.

2004-10-26  Teodor Zlatanov  <tzz@lifelogs.com>

	* nnimap.el (nnimap-open-connection): Fix prog1/prog2 bug.

2004-10-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnspool.el (nnspool-spool-directory): Use news-path if the
	news-directory variable is not bound.

	* gnus-start.el (gnus-check-reasonable-setup): Use an alternative
	function instead of display-warning if it is not available.

2004-10-26  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-agent.el (gnus-agent-expire-group-1): Fix last merge from
	v5-10: Use `point-at-bol'.

2004-10-26  Simon Josefsson  <jas@extundo.com>

	* hashcash.el: Fix URL in comment, reported by Cheng Gao
	<chenggao@gmail.com>.

2004-10-25  Reiner Steib  <Reiner.Steib@gmx.de>

	* html2text.el (html2text-buffer-head): Remove.  Use `goto-char'
	instead.

2004-10-25  Teodor Zlatanov  <tzz@lifelogs.com>

	* nnimap.el (nnimap-remove-server-from-buffer-alist): Add function
	to remove a server from the nnimap-server-buffer-alist.
	(nnimap-open-connection, nnimap-close-server): Use it.

	* gnus-encrypt.el: Remove file in favor of encrypt.el.

2004-10-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-view.el (mm-display-inline-fontify): Inhibit font-lock when
	running the major-mode function.

2004-10-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-update-summary-mark-positions): Search for
	dummy marks in the right way.

2004-10-18  David Edmondson  <dme@dme.org>

	* mm-view.el (mm-w3m-cid-retrieve-1): Don't use recursive call
	excessively.

2004-10-18  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-util.el (gnus-split-references): Accept a nil references
	string and go on blissfully.

	* gnus-registry.el (gnus-registry-split-fancy-with-parent): Catch
	cases where the references string is non-nil but has no references.

	* encrypt.el: Add autoload tags.

	* spam.el (spam-resolve-registrations-routine): Remove article
	from unregistration list too.  Reported by David Hanak
	<dhanak@isis.vanderbilt.edu>

2004-10-18  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (gnus-copy-article-ignored-headers): Default to
	nil.  Change custom type.

2004-10-17  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (gnus-copy-article-ignored-headers): New variable.

	* gnus-sum.el (gnus-summary-move-article): Use it.

2004-10-15  Teodor Zlatanov  <tzz@lifelogs.com>

	* encrypt.el: Add autoload cookies.

	* spam.el (spam-backend-article-list-property)
	(spam-backend-get-article-todo-list)
	(spam-backend-put-article-todo-list)
	(spam-summary-prepare-exit, spam-resolve-registrations-routine):
	Resolve registrations separately.
	(spam-register-routine): Format comments.
	(spam-unregister-routine, spam-register-routine): Always call with
	specific-articles, no default list.
	(spam-summary-prepare-exit): Use the spam-classifications function.

	* netrc.el (autoload, netrc-parse): Use encrypt.el instead of
	gnus-encrypt.el.

	* encrypt.el: Copied from gnus-encrypt.el.

	* gnus-encrypt.el: Commented that it's obsolete.

2004-10-15  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-score.el (gnus-adaptive-pretty-print): New variable.
	(gnus-score-save): Use it.

	* message.el (message-bury): Use `window-dedicated-p'.

2004-10-15  Simon Josefsson  <jas@extundo.com>

	* pop3.el (top-level): Don't require nnheader.
	(pop3-read-timeout): Add.
	(pop3-accept-process-output): Add.
	(pop3-read-response, pop3-retr): Use it.

2004-10-14  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-register-routine): Move comment.
	(spam-verify-bogofilter): Use 'unknown for the initial
	spam-bogofilter-valid state, not 'never.

	* netrc.el (netrc-machine-user-or-password): Add convenience wrapper
	for netrc-machine.

	* nnimap.el (nnimap-open-connection):
	Use netrc-machine-user-or-password.

2004-10-17  Richard M. Stallman  <rms@gnu.org>

	* gnus-registry.el (gnus-registry-unload-hook):
	Set as a variable with add-hook.

	* nnspool.el (nnspool-spool-directory): Use news-directory instead
	of news-path.

	* spam-stat.el (spam-stat-unload-hook): Set as a variable w/ add-hook.

	* spam.el: Delete duplicate `provide'.
	(spam-unload-hook): Set as a variable with add-hook.

2004-10-15  Reiner Steib  <Reiner.Steib@gmx.de>

	* pop3.el (pop3-leave-mail-on-server): Describe possible problems
	in the doc string.

	* message.el (message-ignored-news-headers)
	(message-ignored-supersedes-headers)
	(message-ignored-resent-headers)
	(message-forward-ignored-headers): Improve custom type.

2004-10-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-tokenize-header): Fix 2004-09-06 change
	which used point-min in the wrong place.

2004-10-12  Simon Josefsson  <jas@extundo.com>

	* tls.el (tls-certtool-program): New variable.
	(tls-certificate-information): New function, based on
	ssl-certificate-information.

2004-10-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* compface.el: Move the version of ELisp-based uncompface program
	to the contrib directory because of the copyright problem.

2004-10-12  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-kill-buffer): Raise the current frame.

2004-10-10  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-sum.el: Mention that multibyte characters don't work as marks.

	* gnus.el (message-y-or-n-p): Autoload.

	* pop3.el (pop3-maildrop, pop3-mailhost, pop3-port)
	(pop3-password-required, pop3-authentication-scheme)
	(pop3-leave-mail-on-server): Make customizable.
	(pop3): New custom group.
	(pop3-retr): Remove `sleep-for' statements.
	Suggested by Dave Love <fx@gnu.org>.

	* nnheader.el (nnheader-read-timeout): Explain 1.0 timeout for
	Windows/DOS.

	* imap.el (imap-parse-flag-list, imap-parse-body-extension)
	(imap-parse-body): Fix incorrect use of `assert'.
	Suggested by Dave Love <fx@gnu.org>.

	* mml.el (mml-minibuffer-read-disposition): Require match.
	Suggested by Dave Love <fx@gnu.org>.

2004-10-11  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-group.el (gnus-group-delete-group): Change "\t." to "  " in
	doc string.

2004-10-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-uu.el (mm-uu-dissect-text-parts): Support all text/* types.

2004-10-07  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* gnus-art.el (gnus-mime-display-single): Call `mm-display-inline'
	instead of calling `mm-insert-inline', to decode text/* parts
	before displaying them.

2004-10-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-uu.el (mm-uu-text-plain-type): New variable.
	(mm-uu-pgp-signed-extract-1): Use it.
	(mm-uu-pgp-encrypted-extract-1): Use it.
	(mm-uu-dissect): Allow MIME type and parameters as an optional arg;
	bind mm-uu-text-plain-type with that value.
	(mm-uu-dissect-text-parts): Pass MIME type and parameters to
	mm-uu-dissect.

2004-10-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-group.el (gnus-update-group-mark-positions):
	* gnus-sum.el (gnus-update-summary-mark-positions):
	* message.el (message-check-news-body-syntax):
	* gnus-msg.el (gnus-debug): Use mm-string-as-multibyte instead
	of string-as-multibyte.

2004-10-05  Juri Linkov  <juri@jurta.org>

	* gnus-group.el (gnus-update-group-mark-positions):
	* gnus-sum.el (gnus-update-summary-mark-positions):
	* message.el (message-check-news-body-syntax):
	* gnus-msg.el (gnus-debug): Use `string-as-multibyte' to convert
	8-bit unibyte values to a multibyte string for search functions.

2004-10-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-uu.el (mm-uu-dissect): Allow optional arg.
	(mm-uu-dissect-text-parts): New function.

	* gnus-art.el (gnus-display-mime): Use mm-uu-dissect-text-parts to
	dissect text parts.

	* gnus-sum.el (gnus-summary-insert-subject): Remove redundant setq.
	(gnus-summary-force-verify-and-decrypt): Revert 2004-08-18 change.

	* mm-decode.el (mm-dissect-singlepart): Revert 2004-08-18 change.

	* gnus-topic.el (gnus-topic-hierarchical-parameters):
	Use gnus-current-topics instead of gnus-current-topic.

2004-10-06  Jesper Harder  <harder@ifa.au.dk>

	* gnus-sum.el (gnus-summary-show-article): Use with-current-buffer.

2004-10-05  Jesper Harder  <harder@ifa.au.dk>

	* nnsoup.el (nnsoup-read-active-file): Use dolist, mapc or last
	where appropriate.

	* nnml.el (nnml-generate-active-info): do.

	* nndiary.el (nndiary-generate-active-info): do.

	* gnus-topic.el (gnus-topic-hierarchical-parameters): do.
	(gnus-topic-move): do.

	* gnus-sum.el (gnus-data-enter-list, gnus-summary-process-mark-set)
	(gnus-summary-set-local-parameters, gnus-summary-read-document): do.

	* gnus-srvr.el (gnus-server-prepare)
	(gnus-server-open-all-servers): do.

	* gnus-msg.el (gnus-summary-cancel-article)
	(gnus-summary-resend-message)
	(gnus-summary-mail-crosspost-complaint): do.

	* gnus-move.el (gnus-change-server): do.

	* gnus-group.el (gnus-group-unmark-all-groups)
	(gnus-group-set-current-level): do.

2004-10-04  Simon Josefsson  <jas@extundo.com>

	* message.el (message-generate-hashcash): Doc fix.

2004-10-02  Kevin Greiner  <kgreiner@compsol.cc>

	* nnagent.el (nnagent-request-type): Bind gnus-agent to nil to
	avoid infinite recursion via gnus-get-function.

2004-10-02  Jesper Harder  <harder@ifa.au.dk>

	* mm-partial.el (mm-partial-find-parts): Use with-current-buffer.

	* nnfolder.el (nnfolder-generate-active-file): Use dolist.

	* nnmail.el (nnmail-split-history): do.

	* nnml.el (nnml-generate-nov-databases-1, nnml-request-rename-group)
	(nnml-request-delete-group): do.

	* nnslashdot.el (nnslashdot-read-groups): do.

	* nnsoup.el (nnsoup-delete-unreferenced-message-files): do.
	(nnsoup-unpack-packets, nnsoup-make-active): Simplify.

	* nnspool.el (nnspool-find-id): Use with-temp-buffer.
	(nnspool-sift-nov-with-sed): Use last.
	(nnspool-retrieve-headers-with-nov): Use mapc.
	(nnspool-request-newgroups): Use dolist.
	(nnspool-request-group): Use last.

	* nntp.el (nntp-read-server-type): Use dolist.

	* nnvirtual.el (nnvirtual-create-mapping)
	(nnvirtual-update-read-and-marked): Use dolist.
	(nnvirtual-convert-headers): Simplify.

2004-10-01  Kevin Greiner  <kgreiner@compsol.cc>

	* gnus-agent.el (gnus-agent-synchronize-group-flags):
	Add support for sync'ing tick marks.

2004-10-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-summary-toggle-header): Make it work even if
	there's no visible header.

2004-10-01  Kevin Greiner  <kgreiner@compsol.cc>

	* gnus-agent.el (gnus-agent-synchronize-group-flags):
	When necessary, pass full group name to gnus-request-set-marks.

2004-10-01  Simon Josefsson  <jas@extundo.com>

	* mailcap.el (mailcap-mime-data): Add pdf.  Remove non-free
	acroread.

2004-10-01  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* spam-report.el (spam-report-gmane): Fix interactive.

	* gnus-art.el (gnus-treat-body-boundary): Only do stuff under X.

	* gnus-agent.el (gnus-agent-synchronize-flags-server): Be silent
	when writing file.
	(gnus-agent-synchronize-flags): Don't default to being
	interactive.

2004-09-30  Simon Josefsson  <jas@extundo.com>

	* message.el (message-generate-hashcash): Add.
	(message-send-mail): Use it, call mail-add-payment.

2004-09-29  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-verify-bogofilter): Use -V, not -sV option.

2004-09-28  Kevin Greiner  <kgreiner@compsol.cc>

	* gnus-agent.el (gnus-agent-synchronize-group-flags): Replace
	gnus-request-update-info with explicit code to sync the in-memory
	info read flags with the marks being sync'd to the backend.

	* gnus-util.el (gnus-pp): Add optional stream to match pp API.

2004-09-28  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-verify-bogofilter): Add new function.
	(spam-check-bogofilter)
	(spam-bogofilter-register-with-bogofilter): Use it.
	(spam-verify-bogofilter): Add small fixes.

2004-09-28  Simon Josefsson  <jas@extundo.com>

	* hashcash.el (hashcash-generate-payment): Revert.

2004-09-28  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-split-fancy-with-parent):
	Use gnus-extract-references instead of gnus-split-references.

	* gnus-util.el (gnus-extract-references): Add new function, analogous
	to gnus-split-references but extracts only the message-ID without
	anything extra.

	* hashcash.el (hashcash-generate-payment)
	(hashcash-check-payment): Do the right thing if hashcash-path is
	nil (because the hashcash program could not be found).

	* spam.el (spam-use-hashcash): Remove comment.

2004-09-27  Jesper Harder  <harder@ifa.au.dk>

	* gnus-cache.el (gnus-cache-possibly-remove-articles-1)
	(gnus-cache-enter-article, gnus-cache-remove-article)
	(gnus-cache-braid-heads, gnus-cache-generate-active): Use dolist.

	* gnus-async.el (gnus-async-prefetch-remove-group): do.

	* gnus-art.el (article-hide-boring-headers)
	(article-translate-strings, article-display-face)
	(gnus-article-mime-match-handle-first)
	(gnus-article-highlight-headers)
	(gnus-article-add-buttons-to-head): do.

2004-09-27  Simon Josefsson  <jas@extundo.com>

	* hashcash.el: New version, from
	http://users.actrix.co.nz/mycroft/hashcash.el.  Previously in
	../contrib/.

2004-09-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-decode.el (mm-copy-to-buffer): Don't use set-buffer-multibyte.

2004-09-26  Jesper Harder  <harder@ifa.au.dk>

	* gnus-dup.el (gnus-dup-open): Use mapc.
	(gnus-dup-enter-articles, gnus-dup-suppress-articles): Use dolist.

	(gnus-dup-enter-articles): Remove excess ID's from gnus-dup-hashtb.
	Reported by Stefan Wiens <s.wi@gmx.net>.

	* gnus.el (gnus-shutdown): Use dolist.

	* gnus-undo.el (gnus-undo): Use mapc.

	* nnrss.el (nnrss-generate-active): do.

	* message.el (message-cite-original-without-signature)
	(message-cite-original): Use mapc.
	(message-do-actions, message-make-forward-subject): Use dolist.

2004-09-25  Kevin Greiner  <kgreiner@compsol.cc>

	* gnus-agent.el (gnus-agent-check-overview-buffer): Fix range of
	deletion to remove entire duplicate line.  Fixes merged article
	number bug.

2004-09-25  Kevin Greiner  <kgreiner@compsol.cc>

	* gnus-agent.el (gnus-agent-possibly-synchronize-flags): Ignore
	servers that are offline.  Avoids having gnus-agent-toggle-plugged
	first ask if you want to open a server and then, even when you
	responded with no, asking if you want to synchronize the server's
	flags.
	(gnus-agent-synchronize-flags-server): Rewrote read loop to handle
	multi-line expressions.
	(gnus-agent-synchronize-group-flags): New internal function.
	Updates marks in memory (in the info structure) AND in the
	backend.

	* gnus-util.el (gnus-remassoc): Fix typo in documentation.

	* nnagent.el (nnagent-request-set-mark):
	Use gnus-agent-synchronize-group-flags, not backend's request-set-mark
	method, to ensure that synchronization updates marks in the
	backend and in the info (in memory) structure.

2004-09-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-uu.el (gnus-uu-digest-mail-forward): Obey the process/prefix
	convention fully; don't miss the root article of a thread; make
	the X-Draft-From header with correct article numbers.

2004-09-23  Kevin Greiner  <kgreiner@compsol.cc>

	* gnus-agent.el (gnus-agent-synchronize-flags-server): Do nothing
	unless plugged.  Disable the agent so that an open failure causes
	an error.

	* gnus-int.el (gnus-request-set-mark, gnus-request-update-mark):
	Revert 2004-09-21 change.  The backend must be opened while
	synchronizing flags even when the backend stores the flags
	locally.

2004-09-23  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-msg.el (gnus-configure-posting-styles): Narrow to headers
	in `header' match.  Reported by Svend Tollak Munkejord.

	* message.el (message-cite-original): Fix use of
	`message-cite-articles-with-x-no-archive'.

2004-09-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-win.el (gnus-buffer-configuration): Add mml-preview.
	(gnus-window-to-buffer): Ditto.

	* mml.el (mml-preview-buffer): New variable.
	(mml-preview): Manage window layout with gnus-buffer-configuration.

	* gnus-msg.el (gnus-setup-message): Put article numbers into the
	X-Draft-From header even if those articles aren't quoted.

2004-09-21  Kevin Greiner  <kgreiner@compsol.cc>

	* gnus-int.el (gnus-servers-that-use-local-marks): New variable.
	(gnus-request-set-mark, gnus-request-update-mark): Use new
	g-s-t-u-l-m to decide to use backend even when unplugged.

2004-09-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-msg.el (gnus-inews-make-draft-meta-information): Don't add
	a trailing whitespace.  Suggested by Cheng Gao <chenggao@gmail.com>.

2004-09-20  Simon Josefsson  <jas@extundo.com>

	* mm-util.el (mm-charset-synonym-alist): Map "unicode" to
	"utf-16-le".

2004-09-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mm-decode.el (mm-copy-to-buffer): Preserve the data's unibyteness.

2004-09-19  Reiner Steib  <Reiner.Steib@gmx.de>

	* uudecode.el (uudecode-use-external): Add :version.

	* smime.el (smime-CA-file, smime-encrypt-cipher)
	(smime-dns-server): Add :version.

	* smiley.el (gnus-smiley-file-types): Add :version.

	* sha1.el (sha1-use-external): Add :version.

	* pgg-def.el (pgg-query-keyserver): Add :version.

	* nnmail.el (nnmail-fancy-expiry-targets)
	(nnmail-mail-splitting-charset, nnmail-mail-splitting-decodes):
	Add :version.

	* nnimap.el (nnimap-split-download-body, nnimap-dont-close)
	(nnimap-retrieve-groups-asynchronous): Add :version.
	(nnimap-close-asynchronous): Add :version.  Fix typo in doc string.

	* mml.el (mml-content-disposition-parameters)
	(mml-insert-mime-headers-always): Add :version.

	* mm-util.el (mm-coding-system-priorities): Add :version.

	* mm-decode.el (mm-inline-text-html-with-images)
	(mm-keep-viewer-alive-types, mm-external-terminal-program)
	(mm-verify-option): Add :version.
	(mm-text-html-renderer): Change :version.

	* message.el (message-fcc-externalize-attachments)
	(message-required-headers, message-draft-headers)
	(message-subject-trailing-was-query)
	(message-subject-trailing-was-ask-regexp)
	(message-subject-trailing-was-regexp, message-mark-insert-begin)
	(message-mark-insert-end, message-archive-header)
	(message-archive-note, message-cross-post-default)
	(message-cross-post-note, message-followup-to-note)
	(message-cross-post-note-function, message-use-mail-followup-to)
	(message-subscribed-address-functions)
	(message-subscribed-address-file, message-subscribed-addresses)
	(message-subscribed-regexps, message-allow-no-recipients)
	(message-yank-cited-prefix, message-signature-insert-empty-line)
	(message-hidden-headers, message-hierarchical-addresses)
	(message-mail-user-agent, message-use-idna)
	(message-valid-fqdn-regexp)
	(message-strip-special-text-properties, message-header-synonyms)
	(message-beginning-of-line, message-tab-body-function): Add :version.
	(message-insert-canlock, message-wide-reply-confirm-recipients):
	Change :version.

	* mail-source.el (mail-source-ignore-errors): Add :group, :type
	and :version.
	(mail-source-delete-old-incoming-confirm)
	(mail-source-movemail-program): Add :version.

	* gnus.el (gnus-parameters, gnus-user-agent): Add :version.
	(gnus-agent-cache, gnus-agent): Change :version.

	* gnus-util.el (gnus-use-byte-compile): Change :version.

	* gnus-sum.el (gnus-summary-make-false-root-always)
	(gnus-summary-default-high-score)
	(gnus-summary-default-low-score, gnus-auto-goto-ignores)
	(gnus-forwarded-mark, gnus-unseen-mark, gnus-no-mark)
	(gnus-read-all-available-headers, gnus-article-emulate-mime)
	(gnus-sum-thread-tree-root, gnus-sum-thread-tree-false-root)
	(gnus-sum-thread-tree-single-indent)
	(gnus-sum-thread-tree-vertical, gnus-sum-thread-tree-indent)
	(gnus-sum-thread-tree-leaf-with-other)
	(gnus-sum-thread-tree-single-leaf): Add :version.
	(gnus-summary-display-arrow, gnus-summary-muttprint-program)
	(gnus-article-loose-mime): Change :version.

	* gnus-start.el (gnus-backup-startup-file)
	(gnus-save-startup-file-via-temp-buffer): Add :version.

	* gnus-srvr.el (gnus-server-browse-in-group-buffer)
	(gnus-server-offline-face): Add :version.

	* gnus-score.el (gnus-adaptive-word-length-limit): Add :version.

	* gnus-msg.el (gnus-gcc-externalize-attachments)
	(gnus-debug-files, gnus-debug-exclude-variables)
	(gnus-discouraged-post-methods): Change :version.
	(gnus-confirm-mail-reply-to-news)
	(gnus-confirm-treat-mail-like-news): Add :version.

	* gnus-int.el (gnus-server-unopen-status): Add :version.

	* gnus-group.el (gnus-group-jump-to-group-prompt)
	(gnus-large-ephemeral-newsgroup)
	(gnus-fetch-old-ephemeral-headers): Add :version.

	* gnus-fun.el (gnus-x-face-directory)
	(gnus-convert-pbm-to-x-face-command)
	(gnus-convert-image-to-x-face-command)
	(gnus-convert-image-to-face-command): Add :version.

	* gnus-delay.el (gnus-delay-default-hour): Add :version.

	* gnus-cite.el (gnus-cite-blank-line-after-header)
	(gnus-article-boring-faces): Add :version.

	* gnus-art.el (gnus-buttonized-mime-types)
	(gnus-inhibit-mime-unbuttonizing)
	(gnus-treat-display-face)
	(gnus-treat-body-boundary): Change :version.
	(gnus-body-boundary-delimiter, gnus-picon-databases)
	(gnus-treat-strip-cr, gnus-treat-leading-whitespace)
	(gnus-treat-date-english, gnus-treat-fold-headers)
	(gnus-article-skip-boring, gnus-treat-fold-newsgroups)
	(gnus-treat-mail-picon, gnus-treat-wash-html)
	(gnus-article-encrypt-protocol)
	(gnus-use-idna, gnus-article-over-scroll)
	(gnus-mime-display-multipart-alternative-as-mixed)
	(gnus-mime-display-multipart-related-as-mixed)
	(gnus-button-valid-fqdn-regexp, gnus-button-man-handler)
	(gnus-ctan-url, gnus-button-ctan-handler)
	(gnus-button-handle-ctan-bogus-regexp)
	(gnus-button-ctan-directory-regexp)
	(gnus-button-mid-or-mail-regexp, gnus-button-prefer-mid-or-mail)
	(gnus-button-mid-or-mail-heuristic-alist, gnus-button-tex-level)
	(gnus-button-man-level, gnus-button-emacs-level)
	(gnus-button-message-level, gnus-button-browse-level): Add :version.

	* gnus-agent.el (gnus-agent-fetched-hook): Add :version.
	(gnus-agent-go-online): Change :version.
	(gnus-agent-expire-unagentized-dirs)
	(gnus-agent-auto-agentize-methods): Add :version.

	* flow-fill.el (fill-flowed-display-column)
	(fill-flowed-encode-column): Add :version.

	* deuglify.el (gnus-outlook-deuglify-unwrap-min)
	(gnus-outlook-deuglify-unwrap-max)
	(gnus-outlook-deuglify-cite-marks)
	(gnus-outlook-deuglify-unwrap-stop-chars)
	(gnus-outlook-deuglify-no-wrap-chars)
	(gnus-outlook-deuglify-attrib-cut-regexp)
	(gnus-outlook-deuglify-attrib-verb-regexp)
	(gnus-outlook-deuglify-attrib-end-regexp)
	(gnus-outlook-display-hook): Add :version.

	* binhex.el (binhex-use-external): Add :version.

2004-09-16  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-sum.el (gnus-fetch-old-headers): Add custom choices `t'
	and `invisible'.

2004-09-10  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-trim): Watch out for negatives
	in gnus-registry-trim.

2004-09-13  Simon Josefsson  <jas@extundo.com>

	* dns-mode.el: Add XEmacs auto-mode-alist autoload cookie.

	* nnimap.el (nnimap-demule): Revert 2004-08-30 change.

	* dns-mode.el (dns-mode): Fix menu for XEmacs, reported by Steve
	Youngs <steve@youngs.au.com> and suggested by Katsumi Yamaoka
	<yamaoka@jpl.org>.
	(dns-mode-font-lock-keywords): Fix faces, reported by Steve Youngs
	<steve@youngs.au.com> and suggested by Katsumi Yamaoka
	<yamaoka@jpl.org>.

	* sieve.el (sieve-manage-mode): Ditto.

2004-09-13  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-sum.el (gnus-summary-copy-article): Fix doc string.

2004-09-11  Simon Josefsson  <jas@extundo.com>

	* dns-mode.el: Add.

	* mm-view.el (mm-display-dns-inline): Add.

	* mm-decode.el (mm-inline-media-tests): Add text/dns.
	(mm-automatic-display): Ditto.

	* mailcap.el (mailcap-mime-data): Add text/dns.
	(mailcap-mime-extensions): Map .soa to text/dns.

2004-09-10  Miles Bader  <miles@gnu.ai.mit.edu>

	* gnus-art.el (article-decode-mime-words, article-babel)
	(gnus-article-highlight-signature, gnus-article-add-buttons)
	(gnus-signature-toggle): Remove unnecessary bindings of
	`inhibit-read-only' inherited from v5.10 merge.

2004-09-08  Reiner Steib  <Reiner.Steib@gmx.de>

	* nntp.el (nntp): New customization group.
	(nntp-authinfo-file): Add customization group.

	* mml2015.el (mml2015-unabbrev-trust-alist): Add customization group.

	* mml-sec.el (mml-signencrypt-style-alist): Ditto.

	* gnus.el (to-address, to-list, subscribed)
	(large-newsgroup-initial): Ditto.

	* flow-fill.el (fill-flowed-display-column)
	(fill-flowed-encode-column): Ditto.

2004-09-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* message.el (message-tokenize-header, message-send-mail-with-qmail):
	Use point-min rather than 1.
	(message-send-mail): Use buffer-size rather than point-max.

	* gnus-sum.el (gnus-summary-search-article-forward):
	Signal a specific `search-failed' rather than a generic `error'.

	* gnus-salt.el (gnus-pick-mouse-pick-region): Switch 1 => point-min.
	(gnus-generate-vertical-tree): Usue `bobp' rather than compare to 1.
	(gnus-highlight-selected-tree): Use point-min rather than 1 and 2.

2004-09-10  Simon Josefsson  <jas@extundo.com>

	* nndb.el (require): Remove tcp and duplicate cl.

2004-09-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-agent.el (directory-files-and-attributes): Move forward.

2004-09-09  Kevin Greiner  <kgreiner@compsol.cc>

	* gnus-agent.el (directory-files-and-attributes):
	Optionally defined to support XEmacs.

2004-09-09  Kevin Greiner  <kgreiner@compsol.cc>

	* gnus-agent.el (gnus-agent-cat-groups): Rewrote avoiding defsetf
	to avoid run-time CL dependencies.
	(gnus-agent-unfetch-articles): New function.
	(gnus-agent-fetch-headers): Use gnus-agent-braid-nov to validate
	article numbers even when local .overview file is missing.
	(gnus-agent-read-article-number): New function.  Only accepts
	27-bit article numbers.
	(gnus-agent-copy-nov-line, gnus-agent-uncached-articles):
	Use gnus-agent-read-article-number.
	(gnus-agent-braid-nov): Rewrote to validate article numbers coming
	from backend while recognizing that article numbers in .overview
	must be valid.
	(gnus-agent-update-files-total-fetched-for):
	Use directory-files-and-attributes to improve performance.
	* gnus-int.el (gnus-request-move-article):
	Use gnus-agent-unfetch-articles in place of gnus-agent-expire to
	improve performance.

	* gnus-start.el (gnus-convert-old-newsrc): Change message text as
	some users confused by references to .newsrc when they only have a
	.newsrc.eld file.
	(gnus-convert-mark-converter-prompt)
	(gnus-convert-converter-needs-prompt): Fix use of property list.
	* legacy-gnus-agent.el (gnus-agent-convert-to-compressed-agentview-prompt):
	New function.  Used internally to only display 'gnus converting
	files' message when actually necessary.

	* gnus-sum.el (): Remove (require 'gnus-agent) as required
	methods now autoloaded.

2004-09-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-sum.el (gnus-summary-insert-subject): Remove list
	identifiers.

2004-09-02  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-picon.el: Fix indentation and closing parenthesis.

2004-09-01  Simon Josefsson  <jas@extundo.com>

	* message.el (message-canlock-generate): Require sha1, not
	sha1-el.  (Can we get rid of this require altogether?  It is ugly
	to require within a function.  Sadly, if sha1.el isn't loaded, the
	let binding in m-c-g will hide the defcustom definition, which is
	bad.)

	* canlock.el: Require sha1, not sha1-el.

	* message.el: Don't autoload sha1 (there is a autoload cookie in
	sha1.el).

	* sha1-el.el: Rename to sha1.el.

2004-08-30  Juanma Barranquero  <lektu@terra.es>

	* ietf-drums.el (ietf-drums-remove-whitespace): Fix character constant.

2004-08-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* nnimap.el (nnimap-demule): Avoid string-as-multibyte.

2004-08-30  Kim F. Storm  <storm@cua.dk>

	* nntp.el (nntp-authinfo-file): Add :group 'nntp.

	* nnimap.el (nnimap-authinfo-file, nnimap-prune-cache):
	Add :group 'nnimap.

2004-08-30  Andreas Schwab  <schwab@suse.de>

	* rfc2231.el (rfc2231-parse-string): Restore whitespace syntax for
	?* and ?\;.

	* ietf-drums.el (ietf-drums-syntax-table): Set syntax of ?* ?\;
	and ?\' to symbol instead of whitespace.

2004-08-30  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-agent.el (gnus-agent-restore-gcc): Use ^ and regexp-quote.

	* gnus-sum.el (gnus-summary-morse-message): Use search-forward
	instead of re-search-forward.

	* gnus-uu.el (gnus-uu-save-article): Ditto.
	(gnus-uu-post-encode-uuencode): Ditto.

	* html2text.el (html2text-clean-list-items): Ditto.
	(html2text-clean-dtdd): Ditto.
	(html2text-format-tags): Ditto.

	* message.el (message-send-mail-with-sendmail): Fix regexp.
	(message-fill-field-general): Use search-forward instead of
	re-search-forward.
	(unbold-region): Ditto.

	* nnrss.el (nnrss-request-article): Ditto.

	* nnslashdot.el (nnslashdot-request-article): Ditto.

	* nnweb.el (nnweb-gmane-wash-article): Ditto.

	* gnus-sum.el (gnus-summary-make-menu-bar): Avoid the
	"Unrecognized menu descriptor" error in XEmacs.

2004-08-26  Stefan Wiens  <s.wi@gmx.net>  (tiny change)

	* gnus-sum.el (gnus-read-header): Don't remove a header for the
	parent article of a sparse article in the thread hashtb.

2004-08-26  David Hedbor  <dhedbor@real.com>  (tiny change)

	* nnmail.el (nnmail-split-lowercase-expanded): New user option.
	(nnmail-expand-newtext): Lowercase expanded entries if
	nnmail-split-lowercase-expanded is non-nil.

2004-08-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nndoc.el (nndoc-type-alist): Fix regexp in the rfc822-forward entry.

	* gnus-group.el (gnus-group-line-format-alist): Convert the value
	of gnus-tmp-news-method into string under XEmacs.  It will be
	passed to gnus-correct-length which takes only a string argument.

2004-08-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-util.el (gnus-bind-print-variables): New macro.
	(gnus-prin1): Use it.
	(gnus-prin1-to-string): Use it.
	(gnus-pp): New function.
	(gnus-pp-to-string): New function.

	* gnus-cus.el (gnus-agent-cat-prepare-category-field):
	Replace pp-to-string with gnus-pp-to-string.
	* gnus-eform.el (gnus-edit-form): Replace pp with gnus-pp.
	* gnus-group.el (gnus-group-make-kiboze-group): Ditto.
	* gnus-msg.el (gnus-debug): Ditto.
	* gnus-score.el (gnus-score-save): Ditto.
	* gnus-spec.el (gnus-update-format): Replace pp-to-string with
	gnus-pp-to-string.
	* legacy-gnus-agent.el (gnus-agent-unlist-expire-days): Replace pp
	with gnus-pp.
	* score-mode.el (gnus-score-pretty-print): Ditto.
	* webmail.el (webmail-debug): Ditto.

2004-08-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (article-display-face, article-display-x-face):
	Use buffer-read-only.

2004-08-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (article-hide-list-identifiers):
	Bind inhibit-read-only as t.

2004-08-22  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-mlspl.el (gnus-group-split-update): Fix docstring.

2004-08-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* gnus-art.el: Use inhibit-read-only instead of buffer-read-only.
	(gnus-narrow-to-page): Don't assume point-min == 1.
	(gnus-article-edit-mode): Derive from message-mode.

	* gnus-score.el (gnus-score-find-bnews): Simplify and don't assume
	point-min == 1.

	* imap.el (imap-parse-address-list, imap-parse-body-ext):
	Disable incorrect use of `assert'.

	* message.el (message-mode): Set comment-start-skip.

2004-08-22  Sam Steingold  <sds@gnu.org>

	* pop3.el (pop3-leave-mail-on-server): New user variable.
	(pop3-movemail): Delete mail only when it is nil.

2004-08-21  Reiner Steib  <Reiner.Steib@gmx.de>

	* nntp.el (nntp-marks-is-evil): Fix typo in docstring.

	* mml.el (mml-preview): Use `pop-to-buffer'.

	* message.el (message-goto-mail-followup-to): Insert after "To".
	(message-carefully-insert-headers): Add comment.

	* gnus.el: Remove unused variable `gnus-article-check-size'.

	* gnus-sum.el (gnus-summary-make-menu-bar): Add help texts.

	* gnus-art.el (gnus-button-alist):
	Improve `gnus-button-handle-library' entry.

2004-08-19  Sebastian Freundt  <hroptatyr@gna.org>  (tiny change)

	* nnmaildir.el (nnmaildir--emlink-p, nnmaildir--enoent-p):
	Use downcase, since XEmacs capitalizes error messages differently.

2004-08-18  Jesper Harder  <harder@ifa.au.dk>

	* nntp.el: Add (require 'gnus) due to reference to
	`gnus-directory'.  Reported by Matt Swift <swift@alum.mit.edu>.

2004-08-18  Florian Weimer  <fw@deneb.enyo.de>

	* gnus-sum.el (gnus-summary-force-verify-and-decrypt):
	Bind `mm-fill-flowed'.

	* mm-decode.el (mm-dissect-singlepart): Check it.

2004-08-17  Teodor Zlatanov  <tzz@lifelogs.com>

	* nnimap.el (nnimap-open-connection): Add 'imaps' synonym to
	'imap' for netrc parsing.

2004-08-16  Reiner Steib  <Reiner.Steib@gmx.de>

	* mailcap.el (mailcap-mime-data): Mark as risky.

2004-08-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2047.el (rfc2047-encode-region): Assume the close parenthesis
	may be included in the encoded word.
	(rfc2047-encode): Don't append a space if the encoded word
	includes close parenthesis.

2004-08-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2047.el (rfc2047-encode-1, rfc2047-encode): Improve encoding
	of text within parentheses.

2004-08-06  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-encrypt.el (gnus-encrypt-insert-file-contents)
	(gnus-encrypt-write-file-contents): Make the password key the file
	name PLUS the cipher, not just the cipher.  Also remove failed
	passwords from the cache.

2004-08-06  Simon Josefsson  <jas@extundo.com>

	* gnus-sum.el (gnus-article-loose-mime): Change default to t.
	Doc fix.

2004-08-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2047.el (rfc2047-fold-region): Use trailing whitespace as
	LWSP.

2004-08-04  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-split-fancy-with-parent):
	Try to append in-reply-to: data to the references: header.

	* netrc.el: Remove old encryption support, autoload gnus-encrypt.el.
	(netrc-parse): Use gnus-encrypt.el functions.

	* gnus-encrypt.el: Add new file for encryption support; currently
	does only a few GPG ciphers and an internal XOR cipher.

	* password.el: Add comments on using password-read-and-add.
	(password-read-and-add): Add function to read and add the
	password to the cache at once.

2004-07-28  Simon Josefsson  <jas@extundo.com>

	* pgg-pgp5.el (pgg-pgp5-encrypt-region): Accept sign
	parameter (but don't use it, for now).

	* imap.el (imap-ssl-open): Use imap-process-connection-type,
	instead of hard coding to nil.

2004-07-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-view.el (mm-inline-image-emacs): Open lines under an image
	as mm-inline-image-xemacs does.

2004-07-26  Simon Josefsson  <jas@extundo.com>

	* gnus-group.el (gnus-group-group-map, gnus-group-make-menu-bar):
	Revert part of 2004-07-17 change below.

2004-07-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2047.el (rfc2047-encode-region): Don't infloop.
	Suggested by Hiroshi Fujishima <pooh@nature.tsukuba.ac.jp>.

2004-07-25  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* flow-fill.el (fill-flowed): Remove space stuffing, and only do
	quotes that actually start with ">" at the beginning of the
	lines.

2004-07-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2047.el (rfc2047-encode-region): Fix last change.
	(rfc2047-encode-parameter): Remove useless concat.

2004-07-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2047.el (rfc2047-encode-region): Check carefully whether to
	encode special characters; fix some kind of misconfigured headers;
	signal a real error if debug-on-quit or debug-on-error is non-nil.
	(rfc2047-encode-max-chars): New variable.
	(rfc2047-encode-1): Use it.
	(rfc2047-encode-parameter): New function.

	* mml.el (mml-insert-parameter): Remove an excessive space.

2004-07-17  Simon Josefsson  <jas@extundo.com>

	* gnus-group.el (gnus-group-make-group-simple): Add, suggested by
	Kai Grossjohann <kai@emptydomain.de>.
	(gnus-group-group-map): Use it, instead of gnus-group-make-group.
	(gnus-group-make-menu-bar): Ditto.

	* gnus-util.el (gnus-group-server): Add.

2004-07-16  Jesper Harder  <harder@ifa.au.dk>

	* message.el (message-clone-locals): Clone sendmail and smtp
	variables.

2004-07-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2047.el (rfc2047-encode-region): Fix last change.

2004-07-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2047.el (rfc2047-encode-region): Treat backslash-quoted
	characters as non-special.

2004-07-09  Simon Josefsson  <jas@extundo.com>

	* gnus-agent.el (gnus-agent-synchronize-flags): Revert to ask.
	Users will lose all flag changes made while unplugged with
	e.g. nntp unless flag synchronization happens, thus `nil' is not a
	good default.  See numerous reports on ding mailing list.

2004-07-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nndoc.el (nndoc-type-alist): Improve regexp for article-begin,
	add generate-head-function and generate-article-function to the
	rfc822-forward entry.
	(nndoc-rfc822-forward-generate-article): New function.
	(nndoc-rfc822-forward-generate-head): New function.

	* mm-decode.el (mm-dissect-buffer): Simplify cleaning of CTE.

2004-07-06  Dan Christensen  <jdc@uwo.ca>

	* gnus-sum.el (gnus-summary-read-group-1): When summary is unthreaded,
	respect display group parameter and gnus-summary-expunge-below.
	(gnus-articles-to-read): Remove unused reference to display group
	parameter.

2004-07-03  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nnheader.el (nnheader-uniquify-message-id): New experimental
	variable.
	(nnheader-nov-read-message-id): Use it.

	* spam-report.el (spam-report-gmane): Add interactive.

2004-07-02  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-encode.el (mm-content-transfer-encoding-defaults):
	Use qp-or-base64 for the application/* types.

2004-07-02  Joakim Verona  <joakim@verona.se>  (tiny change)

	* nnrss.el (nnrss-read-group-data): Fix off-by-one error.

2004-06-30  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-trim): Don't allow a negative
	trim value.

2004-01-25  Paul Jarc  <prj@po.cwru.edu>

	* nnmaildir.el (nnmaildir--condcase, nnmaildir--enoent-p):
	New macro and function.
	(nnmaildir--new-number, nnmaildir-request-set-mark): Use them.

2004-06-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-util.el (mm-enrich-utf-8-by-mule-ucs): Fix cleaning of
	after-load-alist.

2004-06-29  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-group.el (gnus-group-get-new-news-this-group):
	Don't update info that isn't there.

2004-06-29  Ilya N. Golubev  <gin@mo.msk.ru>

	* mm-util.el (mm-mime-mule-charset-alist): Add the windows-1251
	entry.

2004-06-29  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-view.el (mm-inline-render-with-function): Use multibyte
	buffer; decode html source by charset.

	* mm-encode.el (mm-content-transfer-encoding-defaults): Doc fix.

	* mm-util.el (mm-enrich-utf-8-by-mule-ucs): New function run when
	Mule-UCS is loaded under XEmacs.
	(mm-mime-mule-charset-alist): Avoid duplicated entries.

2004-06-28  Jesper Harder  <harder@ifa.au.dk>

	* nnheader.el (nnheader-max-head-length): Increase to 8192.

2004-06-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-util.el (mm-coding-system-p): Return a coding-system.
	(mm-mime-mule-charset-alist): Use shift_jis instead of
	iso-2022-jp-2 for the katakana-jisx0201 mule charset; add new
	entries for the mime charsets iso-2022-jp-3 and shift_jis.
	(mm-coding-system-priorities): Use shift_jis and iso-8859-1
	instead of japanese-shift-jis and iso-latin-1 respectively in
	order to share the default value with both Emacs and XEmacs-mule.
	(mm-mule-charset-to-mime-charset):
	Make mm-coding-system-priorities effective.
	(mm-sort-coding-systems-predicate): Canonicalize coding-systems
	while predicating of candidates upon the priorities.

2004-06-27  Jesper Harder  <harder@ifa.au.dk>

	* gnus-sum.el (gnus-summary-make-menu-bar):
	Add gnus-uu-invert-processable.

	* gnus.el: Autoload gnus-uu-invert-processable.

2004-06-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-util.el (mm-with-multibyte-buffer): New macro.

	* rfc2047.el (rfc2047-encode-string): Use it.
	(rfc2047-encode-region): Move point to the end of the region after
	encoding.  Suggested by IRIE Tetsuya <irie@t.email.ne.jp>.

2004-06-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-cite.el (gnus-cite-parse): Don't ignore case when finding
	">From ".  Thanks to Reiner Steib <Reiner.Steib@gmx.de>.

2004-06-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-cite.el (gnus-cite-ignore-quoted-from): New user option.
	(gnus-cite-parse): Ignore quoted envelope From_.
	Suggested by Karl Chen <quarl@nospam.quarl.org>.

2004-06-23  Jesper Harder  <harder@ifa.au.dk>

	* message.el (message-idna-to-ascii-rhs-1): Don't choke on
	invalid addresses.

2004-06-21  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el: Change section markers, revise TODO list.
	(spam-backends): Make new master list of all installed backends.
	(spam-summary-exit-behavior): Add new variable to determine how
	messages moves are done at summary exit.
	(spam-move-spam-nonspam-groups-only)
	(spam-process-ham-in-nonham-groups)
	(spam-process-ham-in-spam-groups): Remove variables, the
	spam-summary-exit-behavior variable should be used to manage this
	behavior.
	(spam-old-ham-articles, spam-old-spam-articles): Remove.
	(spam-old-articles): Add variable, replacing spam-old-ham-articles
	and spam-old-spam-articles.
	(spam-use-copy, spam-use-move, spam-use-gmane, spam-use-resend):
	Add empty variables, placeholders for the backends they represent.
	(spam-set-difference): Move, unchanged.
	(spam-list-of-processors): Declare OBSOLETE, not used anymore
	unless the user has a processor variable.
	(spam-classifications, spam-classification-valid-p)
	(spam-backend-properties, spam-backend-property-valid-p)
	(spam-backend-function-type-valid-p)
	(spam-process-type-valid-p, spam-list-articles): Add helper functions.
	(spam-report-articles-gmane, spam-report-articles-resend):
	Remove functions, they are not needed.
	(spam-install-backend-super, spam-backend-list)
	(spam-backend-check, spam-backend-valid-p, spam-backend-info)
	(spam-backend-function, spam-backend-ham-registration-function)
	(spam-backend-spam-registration-function)
	(spam-backend-ham-unregistration-function)
	(spam-backend-spam-unregistration-function)
	(spam-backend-statistical-p, spam-backend-mover-p)
	(spam-install-backend-alias, spam-install-checkonly-backend)
	(spam-install-mover-backend, spam-install-nocheck-backend)
	(spam-install-backend, spam-install-statistical-backend)
	(spam-install-statistical-checkonly-backend): Add backend installation
	support.
	(spam-summary-prepare-exit): Rewrite to use the new backend code.
	(spam-group-processor-p): Use the new backend code and respect the
	summary exit behavior.
	(spam-mark-spam-as-expired-and-move-routine): Remove.
	(spam-summary-prepare): Change to use the new spam-old-articles
	variable.
	(spam-copy-or-move-routine, spam-copy-spam-routine)
	(spam-move-spam-routine, spam-copy-ham-routine)
	(spam-move-ham-routine): Add code to copy/move ham or spam.
	(spam-fetch-field-fast): Improve doc and code, plus allow the
	'number request.
	(spam-list-of-checks, spam-list-of-statistical-checks):
	Remove variables.
	(spam-split, spam-find-spam): Use the new backend code.
	(spam-registration-functions): Remove variable.
	(spam-unregister-routine): Add convenience wrapper.
	(spam-log-undo-registration, spam-register-routine)
	(spam-log-processing-to-registry)
	(spam-log-unregistration-needed-p): Rename "check" to "backend"
	where possible.
	(spam-check-gmane-xref, spam-check-regex-headers)
	(spam-check-blackholes, spam-check-stat, spam-check-ifile)
	(spam-check-BBDB, spam-check-whitelist, spam-check-blacklist)
	(spam-check-bogofilter-headers, spam-check-spamoracle)
	(spam-check-spamassassin-headers, spam-check-bsfilter-headers)
	(spam-check-crm114-headers): Use the spam-split-group that
	spam-split prepares, no need to determine it every time.

	* nnimap.el (nnimap-retrieve-headers-progress): Add the message number
	to the nnheader-parse-naked-head call.

	* nnheader.el (nnheader-generate-fake-message-id): Fix indentation.

	* gnus-sum.el (gnus-nov-parse-line): Add the message number to
	the nnheader-nov-read-message-id call.

2004-06-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-group.el (gnus-group-get-new-news-this-group): Don't call
	gnus-activate-group twice.  Suggested by Markus Peter
	<warp@spin.de>.

2004-06-18  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-time-format): Exchange the order of
	day and month in the default value; fix customization type.
	(article-date-ut): Use add-text-properties.
	(article-make-date-line): Use message-make-date instead of
	current-time-string.

	* message.el (message-fetch-field): Don't use set-text-properties.
	(message-make-date): Simplify.

2004-06-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2047.el (rfc2047-syntax-table): Treat `(' and `)' as is.
	(rfc2047-encode-region): Treat text within parentheses as special;
	show the original text when error has occurred.

	* gnus-group.el (gnus-group-get-new-news-this-group): Pass the
	already-computed method to gnus-activate-group.

	* gnus-start.el (gnus-make-hashtable-from-newsrc-alist): Make the
	same select-methods identical Lisp objects.

	* gnus-srvr.el (gnus-server-set-info): Don't make a new Lisp
	object when modifying the info.

2004-06-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-srvr.el (gnus-server-set-info): Remove the server from
	gnus-opened-servers since it has never been opened with the new
	configuration yet.

2004-06-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnheader.el (nnheader-nov-read-message-id): Pass the optional
	arg to nnheader-generate-fake-message-id.

2004-06-14  Teodor Zlatanov  <tzz@lifelogs.com>

	* nnheader.el (nnheader-generate-fake-message-id): Accept a
	number and build a fake message ID localized to a group and
	article number (so it's repeatable from that point on).
	(nnheader-fake-message-id-p): Change regex to accommodate new fake
	ID format.

	* gnus-sum.el (gnus-get-newsgroup-headers):
	Call nnheader-generate-fake-message-id with the article number.

2004-06-12  YAGI Tatsuya  <ynyaaa@ybb.ne.jp>  (tiny change)

	* gnus-art.el (gnus-article-next-page): Fix the way to find a real
	end-of-buffer.

2004-06-12  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-ignored-supersedes-headers): Add Approved.

2004-06-11  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2047.el (rfc2047-encode-message-header): Remove useless
	goto-char.
	(rfc2047-encode): Fold the line before encoding.

2004-06-10  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* rfc2047.el (rfc2047-encode-message-header): Disabled header
	folding -- not all headers can be folded, and this should be done
	by the message composition mode.  Probably.  I think.

2004-06-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-util.el (gnus-remove-text-with-property): Make it slightly
	fast.

	* gnus-ems.el (gnus-remove-image): Don't use
	message-text-with-property; remove only the image found first.

2004-06-09  Jesper Harder  <harder@ifa.au.dk>

	* message.el (message-send-mail-with-sendmail): Use with-current-buffer.

2004-06-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-text-with-property): Make it fast and accept
	optional arguments.
	(message-strip-forbidden-properties): Use it.
	(message-fix-before-sending): Follow the m-t-w-p change.

	* gnus-ems.el (gnus-remove-image): Follow the m-t-w-p change.

2004-06-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (article-hide-headers): Don't change the buffer
	mistakenly when performing mml-preview even if
	gnus-single-article-buffer is nil.

2004-06-08  Kai Grossjohann  <kgrossjo@eu.uu.net>

	* message.el (message-expand-name-databases): New user option.
	(message-expand-name): Use it.

2004-06-07  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-report-articles-resend)
	(spam-report-resend-register-routine): Allow ham reporting.
	(spam-report-resend-register-ham-routine): Add wrapper.
	(spam-registration-functions): Add ham resending functions.
	(spam-list-of-processors): Add ham resend processor.

	* gnus.el (ham-resend-to): Add new group parameter.
	(spam-process): Add ham resend option.

	* spam-report.el (spam-report-resend): Allow reporting ham.
	(spam-report-resend-ham): Add wrapper.

2004-06-06  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-cite-articles-with-x-no-archive):
	New variable.
	(message-cite-original): Use it.

2004-06-04  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-cite-original): Respect X-No-Archive.

2004-06-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (article-hide-headers): Refer to the values for
	gnus-ignored-headers and gnus-visible-headers in the summary
	buffer since a user may have set them as group parameters.

2004-06-03  Teodor Zlatanov  <tzz@lifelogs.com>

	* assistant.el (assistant-node-name): Add convenience function.
	(assistant-render-text, assistant-render-node): Add error handling,
	plus handle multiple next nodes.
	(assistant-find-next-node): Comment out for now.
	(assistant-find-next-nodes): Add function, returns list of next
	nodes.

2004-06-02  Reiner Steib  <Reiner.Steib@gmx.de>

	* mail-source.el (mail-source-directory): Fix doc-string.

2004-05-29  Teodor Zlatanov  <tzz@lifelogs.com>

	* assistant.el (assistant-render-text, assistant-eval): Add :set
	widget type, which is different because it takes and returns a
	list.  Much hilarity ensues.

2004-05-28  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (gnus-button-alist): Fix regexp for manual links.

	* gnus-group.el (gnus-group-get-new-news-this-group):
	Add doc-string.

	* gnus-start.el (gnus-activate-group): Add doc-string.

2004-05-28  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-encode.el (mm-safer-encoding): Consider 7bit is safe.

2004-05-27  Teodor Zlatanov  <tzz@lifelogs.com>

	* assistant.el (assistant-render-text): Try to add a :set
	widget, more to come.

	* spam.el (spam-group-spam-contents-p): Handle empty groupname
	strings.
	(spam-report-articles-resend)
	(spam-register-routine): Do registration iff any articles warrant
	it.
	(spam-summary-prepare-exit): Change log message for nil group
	destinations.

2004-05-27  Daniel Pittman  <daniel@rimspace.net>

	* spam.el (spam-report-resend-register-routine):
	Allow spam-report-resend-to to be a group parameter or a global value.

2004-05-26  Simon Josefsson  <jas@extundo.com>

	* starttls.el: Merge with my GnuTLS based starttls.el.
	(starttls-gnutls-program, starttls-use-gnutls)
	(starttls-extra-arguments, starttls-process-connection-type)
	(starttls-connect, starttls-failure, starttls-success):
	New variables.
	(starttls-program, starttls-extra-args): Doc fix.
	(starttls-negotiate-gnutls, starttls-open-stream-gnutls):
	New functions.
	(starttls-negotiate, starttls-open-stream):
	Check `starttls-use-gnutls' and pass on to corresponding *-gnutls
	function if it is set.

2004-05-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2047.el (rfc2047-encode-region): Encode encoded words in
	structured fields.

2004-05-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-resend): Bind rfc2047-encode-encoded-words.

2004-05-26  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-mark-new-messages-in-spam-group-as-spam):
	Add variable.
	(spam-mark-junk-as-spam-routine): Use it.  Allow to disable
	assigning the spam-mark to new messages.

2004-05-26  Adam Sjøgren  <asjo@koldfront.dk>  (tiny change)

	* spam.el (spam-ham-copy-or-move-routine): Don't declare `todo' twice.

2004-05-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2047.el (rfc2047-encodable-p): Don't move point.
	(rfc2047-decode): Treat the ascii coding-system as raw-text by
	default.

2004-05-25  Anand Mitra  <mitramc@yahoo.com>  (tiny change)

	* gnus-sum.el (gnus-summary-delete-article): Invoke hook with
	correct data.

2004-05-24  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-list-of-processors): Use nil for nonexistent processors.
	(spam-group-processor-p): Fix function.
	(spam-group-processor-multiple-p)
	(spam-group-spam-processor-report-gmane-p)
	(spam-group-spam-processor-report-resend-p)
	(spam-group-spam-processor-bogofilter-p)
	(spam-group-spam-processor-blacklist-p)
	(spam-group-spam-processor-ifile-p)
	(spam-group-ham-processor-ifile-p)
	(spam-group-spam-processor-spamoracle-p)
	(spam-group-spam-processor-crm114-p)
	(spam-group-ham-processor-bogofilter-p)
	(spam-group-spam-processor-stat-p)
	(spam-group-ham-processor-stat-p)
	(spam-group-ham-processor-whitelist-p)
	(spam-group-ham-processor-BBDB-p)
	(spam-group-ham-processor-spamoracle-p)
	(spam-group-ham-processor-copy-p): Remove functions with some
	prejudice against unneeded code.
	(spam-report-articles-resend)
	(spam-report-resend-register-routine): Allow the group/topic
	spam-resend-to value to override spam-report-resend-to.
	(spam-summary-prepare-exit): Invoke spam-group-processor-p
	properly now.

	* gnus.el (spam-resend-to): Add group/topic parameter.
	(spam-process): Move the OBSOLETE processors to the end of the
	choices.

2004-05-24  Daniel Pittman  <daniel@rimspace.net>

	* spam-report.el (spam-report-resend-to, spam-report-resend):
	Start with resend-to set to nil, and then ask the user if necessary.
	(spam-report-resend): spam-report-resend takes a list of articles, not
	separate article numbers.

2004-05-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-decode.el (mm-text-html-renderer): Make sure w3m exists in
	addition to emacs-w3m.

2004-05-23  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* assistant.el (assistant-authinfo-data): New function.
	(assistant-eval): Eval for entire assistant.

	* netrc.el (netrc-services-file): New variable.
	(netrc-parse-services): New function.
	(netrc-find-service-name): New function.
	(netrc-find-service-number): New function.
	(netrc-port-equal): New function.
	(netrc-machine): Use it.

	* nnimap.el (nnimap-open-connection): Use netrc.

	* gnus-util.el (gnus-netrc-get): Remove aliases.

	* gnus-sum.el (gnus-auto-center-summary): Change default to 2.

	* assistant.el (wid-edit): Fix compilation.

	* gnus-util.el (gnus-set-file-modes): Just ignore errors.

2004-05-23  Paul Stodghill  <stodghil@cs.cornell.edu>

	* gnus-util.el (gnus-set-file-modes): New function.  (small
	patch).

2004-05-23  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-topic.el (gnus-topic-jump-to-topic): Goto missing topic.

	* assistant.el (assistant-render-node): Fix up rendering and
	read-only text.
	(assistant-render-node): Reset.
	(assistant-make-read-only): Not sticky.

2004-05-20  Danny Siu  <dsiu@adobe.com>

	* gnus-sum.el (gnus-summary-recenter): Summery buffer was not auto
	centered even when gnus-auto-center-summary is t

2004-05-22  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* dns.el (dns-get-txt-answer): New function.
	(dns-read-txt): Ditto.
	(query-dns): Use it.

2004-05-21  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-start.el (gnus-get-unread-articles): Don't invalidate
	active for foreign groups even if the group level is higher than
	the specified value.

2004-05-21  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-group.el (gnus-group-jump-to-group): Don't prompt for
	non-active groups.

	* gnus-art.el (gnus-picon-databases): Add /usr/share/picons.

2004-05-20  Magnus Henoch  <mange@freemail.hu>

	* dns.el (dns-read-type): Add support for SVR.  (small patch)

2004-05-20  Adam Sjøgren  <asjo@koldfront.dk>

	* spam.el (spam-use-crm114, spam-crm114, spam-crm114-program)
	(spam-crm114-header, spam-crm114-spam-switch)
	(spam-crm114-spam-strong-switch, spam-crm114-ham-strong-switch)
	(spam-crm114-positive-spam-header)
	(spam-crm114-database-directory, spam-list-of-processors)
	(spam-group-spam-processor-crm114-p)
	(spam-group-ham-processor-crm114-p, spam-extra-header-to-number)
	(spam-generic-score, spam-list-of-checks)
	(spam-list-of-statistical-checks, spam-registration-functions)
	(spam-check-crm114-headers, spam-crm114-score)
	(spam-check-crm114, spam-crm114-register-with-crm114)
	(spam-crm114-register-spam-routine)
	(spam-crm114-unregister-spam-routine)
	(spam-crm114-register-ham-routine)
	(spam-crm114-unregister-ham-routine): Add CRM114 support.

2004-05-20  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus.el: Add spam-use-crm114.

	* spam.el (spam-list-of-processors, spam-registration-functions):
	Add spam-use-resend.
	(spam-group-spam-processor-report-resend-p): Add utility wrapper.
	(spam-report-articles-gmane): Add doc fix.
	(spam-report-articles-resend, spam-report-resend-register-routine):
	Add wrappers around spam-report-resend-to.

	* spam-report.el (spam-report-resend-to, spam-report-resend):
	Add support for resending spam.
	(spam-report-gmane): Fix line length >80.

	* gnus.el (spam-process): Add spam-use-resend.

2004-05-20  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* spam.el (spam-mark-spam-as-expired-and-move-routine): Return the
	number of processed spam messages.
	(spam-ham-copy-or-move-routine): Return the number of processed
	ham messages.
	(spam-summary-prepare-exit): Use the above values to decide
	whether status messages shouled be displayed.

2004-05-20  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2047.el (rfc2047-encode-function-alist): Rename from
	`rfc2047-encoding-function-alist' in order to avoid conflicting
	with the old version.
	(rfc2047-encode-region): Concatenate words containing non-ASCII
	characters in structured fields; don't encode space-delimited
	ASCII words even in unstructured fields; don't break words at
	char-category boundaries.
	(rfc2047-encode-1): New function.
	(rfc2047-encode): Use it; encode text so that it occupies the
	maximum width within 76-column; work correctly on Q encoding for
	iso-2022-* charsets.
	(rfc2047-fold-region): Use existing whitespace for LWSP; make it
	sure not to break a line just after the header name.
	(rfc2047-b-encode-region): Remove.
	(rfc2047-b-encode-string): New function.
	(rfc2047-q-encode-region): Remove.
	(rfc2047-q-encode-string): New function.

	* mm-util.el (mm-replace-in-string): New function.

2004-05-20  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-msg.el (gnus-inews-make-draft-meta-information):
	Really get it right.
	(gnus-inews-make-draft): Really.

2004-05-19  Ben Menasha  <bmenasha@benmenasha.net>

	* nnmh.el (nnmh-request-list-1): Don't check the link count
	before descending.  (small patch)

2004-05-19  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-msg.el (gnus-inews-make-draft-meta-information): Fix quote
	stuff.

	* gnus-start.el (gnus-subscribe-hierarchical-interactive):
	Match on real group name.

	* gnus-art.el (gnus-signature-limit): Doc fix.

	* gnus-msg.el (gnus-inews-make-draft): Quote list.

2004-05-19  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-draft.el (gnus-draft-send):
	Bind rfc2047-encode-encoded-words.

	* rfc2047.el (rfc2047-encode-region): Encode =? strings.
	(rfc2047-encodable-p): Say that =? needs encoding.
	(rfc2047-encode-encoded-words): New variable.

	* gnus-group.el (gnus-group-select-group): Doc fix.

	* gnus-draft.el (gnus-draft-setup): Mark all replied as replied.

	* gnus-group.el (gnus-group-mode): Set show-trailing-whitespace
	to nil.

	* gnus-cache.el (gnus-cache-possibly-enter-article): Use it.

	* nnheader.el (nnheader-get-lines-and-char): New function.

2004-05-19  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-msg.el (gnus-summary-followup-with-original):
	Document yanking of region when active.

2004-05-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-start.el (gnus-get-unread-articles): Do nothing for foreign
	groups if the group level is higher than the specified value.

2004-05-18  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-group.el (gnus-group-jump-to-group-prompt): Allow an alist.
	(gnus-group-jump-to-group): Add prefix argument using
	`gnus-group-jump-to-group-prompt'.  Query before jumping to
	non-active group.

	* compface.el (uncompface): Be verbose when changing
	`uncompface-use-external'.

	* gnus-art.el (gnus-button-handle-man, gnus-button-alist): Try to
	handle manual section.

2004-05-18  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-art.el (gnus-button-alist): Revert previous change.

2004-05-18  Reiner Steib  <Reiner.Steib@gmx.de>

	* message.el (message-idna-to-ascii-rhs-1): Fix typo.

2004-05-18  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-msg.el (gnus-inews-do-gcc): Don't use read-only-p to see
	whether backend can accept message.

	* message.el (message-idna-to-ascii-rhs-1): Don't use equalp.

2004-05-18  Kai Grossjohann  <kgrossjo@eu.uu.net>

	* nntp.el (nntp-request-set-mark, nntp-request-update-info):
	Avoid creating directory when nntp-marks-is-evil is true.
	Reported by Reiner Steib.

2004-05-18  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-picon.el (gnus-picon-insert-glyph):
	Add optional `nostring' argument.

2004-05-18  Jesper Harder  <harder@ifa.au.dk>

	* gnus-picon.el (gnus-picon-style): New variable.
	(gnus-picon-transform-address): Support `gnus-picon-style'.

2004-05-18  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-fill-field): Return point.
	(message-generate-headers): Go to end of field.

	* gnus-start.el (gnus-get-unread-articles-in-group): Don't do
	stuff for non-living groups.

2004-05-18  Jesper Harder  <harder@ifa.au.dk>

	* gnus-art.el (gnus-article-followup-with-original)
	(gnus-article-reply-with-original): gnus-mark-active-p ->
	gnus-region-active-p.

2004-05-17  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-summary-prepare-exit): Fix messages, so they show
	only when there is spam or ham to be processed.

2004-05-17  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mail-source.el (mail-source-delete-crash-box): Refactor.
	(mail-source-fetch): Use it.
	(mail-source-fetch-file): Ditto.
	(mail-source-fetch-directory): Run PostScript in loop.
	(mail-source-fetch-pop): Delete.
	(mail-source-fetch-maildir): Ditto.
	(mail-source-fetch-imap): Ditto.

	* imap.el (imap-authenticators): Comment out sasl.

	* message.el (message-skip-to-next-address): New function.
	(message-fill-header-address): Refactor.
	(message-fill-address): Use it.
	(message-delete-address): Use it.
	(message-fill-header-general): Refactor.
	(message-fill-field-address): Rename.
	(message-narrow-to-field): Find the start of the header.
	(message-header-format-alist): Don't pre-fill.
	(message-fill-header): Remove.
	(message-insert-header): New function.
	(message-shorten-references): Use it.

	* rfc2047.el (rfc2047-field-value): Strip props.

	* mail-parse.el (mail-header-make-address): New alias.

	* ietf-drums.el (ietf-drums-make-address): New function.

	* imap.el: Add compiler directives.

	* gnus-score.el (gnus-score-edit-done): run-hook->run-hooks.

	* gnus-art.el (article-decode-idna-rhs): Don't use
	message-idna-inside-rhs-p.

2004-05-16  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* message.el (message-idna-inside-rhs-p): Remove.
	(message-idna-to-ascii-rhs-1): Use proper address parsing.

	* gnus-art.el (gnus-emphasis-alist): Remove strikethru; too many
	false positives.

2004-05-16  Kim-Minh Kaplan  <kmkaplan-AwwS6Bc0PDVoiYX5Tdu9fQ@public.gmane.org>

	* imap.el (imap-sasl-make-mechanisms): Use sasl.

2004-05-16  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* nneething.el (nneething-file-name): Don't create spurious
	files.

	* gnus-msg.el (gnus-inews-do-gcc): Ignore read-only groups.
	(gnus-inews-do-gcc): Remove sleep.

	* gnus-art.el (gnus-mime-delete-part): Error message when no MIME
	part under point.

	* gnus-agent.el (gnus-agent-synchronize-flags): Default to nil.
	(gnus-agent-regenerate-group): Using nil messages aren't valid.

2004-05-15  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-summary-prepare-exit): Fix (length).

2004-05-14  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-summary-prepare-exit): Fix to produce "marking spam
	as expired without moving it" message when there are spam
	messages left.

2004-05-14  Nelson Ferreira  <nelson.ferreira@verizon.net>  (tiny change)

	* gnus-dup.el (gnus-dup-unsuppress-article): Don't assume the mail
	header is not nil.

2004-05-14  Kai Grossjohann  <kgrossjo@eu.uu.net>

	* nntp.el (nntp-request-set-mark, nntp-request-update-info):
	Call nntp-possibly-create-directory, not nntp-possibly-change-group.
	(nntp-marks-changed-p): New arg SERVER.
	(nntp-request-update-info): Adjust caller.

2004-05-14  Kai Grossjohann  <kai@emptydomain.de>

	* nntp.el (nntp-save-marks): Pass missing arg.

2004-05-13  Kai Grossjohann  <kai.grossjohann@gmx.net>

	* nntp.el: Support marks.
	(nntp-marks-is-evil, nntp-marks-file-name, nntp-marks)
	(nntp-marks-modtime, nntp-marks-directory): New variables.
	(nntp-request-set-mark, nntp-request-update-info)
	(nntp-possibly-create-directory, nntp-marks-changed-p)
	(nntp-save-marks, nntp-open-marks, nntp-marks-directory):
	New functions.

2004-05-12  Jesper Harder  <harder@ifa.au.dk>

	* gnus-score.el (gnus-score-insert-help):
	Use gnus-select-lowest-window.

	* gnus-ems.el (gnus-select-lowest-window): Copy definition of
	appt-select-lowest-window and rename to gnus-select-lowest-window.

	* gnus.el: do.

2004-05-12  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* rfc2047.el (rfc2047-encode): Use uppercase letters to specify
	encodings of MIME-encoded words, in order to improve
	interoperability with several broken MUAs.

2004-05-07  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* mm-view.el (mm-inline-text-html-render-with-w3): Check META
	tags, only when charsets are not specified in headers.
	(mm-inline-text-html-render-with-w3m): Ditto.

2004-05-06  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* gnus-art.el (article-strip-banner): Use MIME-encoded from fields
	instead of MIME-decoded from fields when checking
	`gnus-article-address-banner-alist'.

2004-05-03  Jesper Harder  <harder@ifa.au.dk>

	* nnrss.el (nnrss-check-group, nnrss-read-group-data): Hash on
	description rather than subject.

2004-05-01  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus.el (gnus-version-number): Bump.

2004-05-01  Lars Magne Ingebrigtsen  <lars@ingebrigtsen.no>

	* gnus.el: No Gnus v0.2 is released.

2004-05-01  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-agent.el (gnus-agent-read-agentview):
	Inline gnus-uncompress-range.

2004-05-01  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* spam.el (spam-bsfilter-path): Use `executable-find' instead of
	`exec-installed-p'.

2004-04-30  TSUCHIYA Masatoshi  <tsuchiya@namazu.org>

	* gnus.el (spam-process, spam-autodetect-methods):
	Add bsfilter and bsfilter-headers.

	* spam.el (spam-bsfilter): New customize group.
	(spam-use-bsfilter, spam-use-bsfilter-headers, spam-bsfilter-path)
	(spam-bsfilter-header, spam-bsfilter-probability-header)
	(spam-bsfilter-spam-switch, spam-bsfilter-ham-switch)
	(spam-bsfilter-spam-strong-switch, spam-bsfilter-ham-strong-switch)
	(spam-bsfilter-database-directory): New options.
	(spam-install-hooks, spam-list-of-processors, spam-list-of-checks)
	(spam-list-of-statistical-checks, spam-registration-functions):
	Add `spam-use-bsfilter' and `spam-use-bsfilter-headers'.
	(spam-bsfilter-score): New command.
	(spam-check-bsfilter-headers, spam-check-bsfilter)
	(spam-bsfilter-register-with-bsfilter)
	(spam-bsfilter-register-spam-routine)
	(spam-bsfilter-unregister-spam-routine)
	(spam-bsfilter-register-ham-routine)
	(spam-bsfilter-unregister-ham-routine): New functions.
	(spam-generic-score): Support bsfilter; Accept an optional argument
	to recalcurate spam score even if scoring header has already been
	added.
	(spam-bogofilter-score, spam-spamassassin-score): Accept an
	optional argument to recalcurate spam score even if scoring header
	has already been added.

2004-04-29  Jesper Harder  <harder@ifa.au.dk>

	* nnrss.el (nnrss-get-namespace-prefix): Use string= to compare
	strings!  Reported by David D. Smith <davidsmith@acm.org>.
	(nnrss-check-group, nnrss-read-group-data): Hash on Subject if
	link is missing.

2004-04-28  Jesper Harder  <harder@ifa.au.dk>

	* html2text.el (html2text-replace-list): Add &amp; and &apos;.
	(html2text-get-attr): Rewrite.

	* message.el (message-setup-1): Remove redundant put-text-property
	on mail-header-separator.

2004-04-27  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-cache-whitespace)
	(gnus-registry-action, gnus-registry-spool-action)
	(gnus-registry-split-fancy-with-parent): Change message levels
	from 5 to 3 or 7, as needed.

	* spam.el (spam-summary-prepare-exit)
	(spam-mark-junk-as-spam-routine, spam-fetch-field-fast)
	(spam-split, spam-find-spam, spam-log-undo-registration)
	(spam-check-blackholes, spam-enter-ham-BBDB): Change message
	level from 5 to 6.

2004-04-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-ems.el: Autoload appt-select-lowest-window (revert
	2004-03-04 change).

2004-04-25  Jesper Harder  <harder@ifa.au.dk>

	* sieve-manage.el (sieve-manage-open):
	* nnweb.el (nnweb-insert-html):
	* nnvirtual.el (nnvirtual-catchup-group, nnvirtual-partition-sequence)
	(nnvirtual-partition-sequence, nnvirtual-create-mapping):
	* nnspool.el (nnspool-request-group):
	* nnrss.el (nnrss-opml-export, nnrss-find-el, nnrss-order-hrefs):
	* nnml.el (nnml-request-update-info):
	* nnmh.el (nnmh-request-group, nnmh-request-list-1, nnmh-active-number)
	(nnmh-request-create-group, nnmh-update-gnus-unreads):
	* nnimap.el (nnimap-request-close, nnimap-acl-edit)
	(nnimap-request-set-mark):
	* nnfolder.el (nnfolder-request-update-info):
	* mm-view.el (mm-pkcs7-signed-magic, mm-pkcs7-enveloped-magic):
	* mml.el (mml-destroy-buffers, mml-compute-boundary-1):
	* gnus-uu.el (gnus-uu-find-articles-matching):
	* gnus-topic.el (gnus-topic-check-topology, gnus-topic-remove-group):
	* gnus-sum.el (gnus-summary-fetch-faq, gnus-read-move-group-name):
	* gnus-score.el (gnus-score-load-file, gnus-sort-score-files):
	* gnus-nocem.el (gnus-nocem-scan-groups):
	* gnus-int.el (gnus-start-news-server):
	* gnus-group.el (gnus-group-make-kiboze-group)
	(gnus-group-browse-foreign-server):
	* spam-stat.el (spam-stat-score-buffer): Simplify mapcar usage.
	Use mapc when appropriate.

2004-04-22  Dan Christensen  <jdc@uwo.ca>
	    Adam Sjøgren  <asjo@koldfront.dk>
	    Wes Hardaker  <wes@hardakers.net>
	    Michael Shields  <shields@msrl.com>

	* spam.el (spam-necessary-extra-headers): Get the extra headers we
	may need for spam sorting and scoring.
	(spam-user-format-function-S): Add user format function suitable for
	general use.
	(spam-article-sort-by-spam-status): Add sorting function for summary
	sorting.
	(spam-extra-header-to-number): Add function to get a score from a
	header.
	(spam-summary-score): Add function to get a numeric score from the
	headers.
	(spam-generic-score): Fix function doc, was in wrong place.
	(spam-initialize): Take symbols when it's run, and install the
	extra headers that spam-necessary-extra-headers thinks we need.

2004-04-21  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-summary-prepare-exit): Add logic and message fix.
	Reported by bojohan+news@dd.chalmers.se (Johan Bockgård).

2004-04-17  Jesper Harder  <harder@ifa.au.dk>

	* gnus-sum.el (gnus-set-global-variables)
	(gnus-build-all-threads, gnus-get-newsgroup-headers)
	(gnus-article-get-xrefs, gnus-summary-best-group)
	(gnus-summary-next-article, gnus-summary-enter-digest-group)
	(gnus-summary-set-bookmark, gnus-offer-save-summaries)
	(gnus-summary-update-info, gnus-kill-or-deaden-summary):
	Use with-current-buffer.

2004-04-16  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-summary-prepare-exit): Simplify logic.
	(spam-fetch-article-header): Read the article header if it's not
	available.
	(spam-list-articles): Simplify logic.
	(spam-filelist-register-routine): Fix bug with unregister-list.

	* gnus-registry.el: Fix comments at beginning.

2004-04-16  Jesper Harder  <harder@ifa.au.dk>

	* message.el (message-cater-to-broken-inn): Remove.
	(message-shorten-references): Make sure the total folded length of
	References is shorter than 998 characters to cater to a bug in INN
	2.3.  Also, don't pretend that references aren't folded -- this
	hasn't worked for a while.

2004-04-15  Kevin Greiner  <kgreiner@xpediantsolutions.com>

	* gnus-agent.el (gnus-agentize):
	gnus-agent-send-mail-real-function no longer set to current value
	of message-send-mail-function but rather a lambda that calls
	message-send-mail-function.  The change makes the agent real-time
	responsive to user changes to message-send-mail-function.

2004-04-15  Kevin Greiner  <kgreiner@xpediantsolutions.com>

	* legacy-gnus-agent.el
	(gnus-agent-convert-to-compressed-agentview): Fix typos with
	help from Florian Weimer <fw@deneb.enyo.de>

2004-04-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnmail.el (nnmail-cache-insert): Revert last change.

2004-04-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nnmail.el (nnmail-cache-insert): Always check whether
	nnmail-cache-ignore-groups matches a group name.

2004-04-13  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-fetch-field-fast, spam-generate-fake-headers)
	(spam-find-spam, spam-log-processing-to-registry)
	(spam-log-registered-p, spam-log-unregistration-needed-p)
	(spam-log-undo-registration): Use gnus-message instead of
	gnus-error, none of these errors are fatal.

	* gnus-registry.el (gnus-registry-clean-empty-function)
	(gnus-registry-clean-empty): Remove only empty entries without
	extra data.

2004-04-12  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam-stat.el (spam-stat-buffer-change-to-spam)
	(spam-stat-buffer-change-to-non-spam): Change (error) to
	(gnus-message 8) invocation.

2004-04-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nntp.el (nntp-via-netcat-command): New variable.
	(nntp-via-netcat-switches): New variable.
	(nntp-open-via-rlogin-and-netcat): New function.
	(nntp-open-connection-function): Doc fix.
	(nntp-telnet-command): Doc fix.
	(nntp-end-of-line): Doc fix.
	(nntp-via-rlogin-command): Doc fix.
	(nntp-via-user-name): Doc fix.
	(nntp-via-address): Doc fix.

2004-04-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mml2015.el (mml2015-use): Avoid the "Recursive load suspected"
	error in Emacs 21.1.

2004-04-08  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-start.el (gnus-get-unread-articles): Fix last commit.

2004-04-07  Kevin Greiner  <kgreiner@xpediantsolutions.com>

	* gnus-agent.el (gnus-agent-total-fetched-hashtb): New variable.
	(gnus-agent-with-refreshed-group): New macro.
	(gnus-agent-rename-group): New function.
	(gnus-agent-delete-group): New function.
	(gnus-agent-save-group-info): Use gnus-command-method when
	`method' parameter is nil.  Don't write nil entries into the
	active file.
	(gnus-agent-get-group-info): New function.
	(gnus-agent-fetch-articles):
	Use gnus-agent-update-files-total-fetched-for to increment disk space
	used.
	(gnus-agent-fetch-headers, gnus-agent-save-alist):
	Use gnus-agent-update-view-total-fetched-for to increment disk space
	used.
	(gnus-agent-get-local): Add optional parameters to avoid calling
	gnus-group-real-name and gnus-find-method-for-group.
	(gnus-agent-set-local): Delete stored entry if either min, or max,
	are nil.
	(gnus-agent-fetch-session): Reworded error/quit messages.
	On quit, use gnus-agent-regenerate-group to record existence of any
	articles fetched to disk before the quit occurred.
	(gnus-agent-expire-group-1): Use gnus-agent-with-refreshed-group,
	gnus-agent-update-view-total-fetched-for, and
	gnus-agent-update-files-total-fetched-for to decrement disk space
	used.
	(gnus-agent-retrieve-headers):
	Use gnus-agent-update-view-total-fetched-for to increment disk space
	used.
	(gnus-agent-regenerate-group): Replace gnus-group-update-group
	with gnus-agent-update-files-total-fetched-for to decrement disk
	space and fresh group buffer.
	(gnus-agent-inhibit-update-total-fetched-for): New variable.
	(gnus-agent-need-update-total-fetched-for): New variable.
	(gnus-agent-update-files-total-fetched-for): New function.
	(gnus-agent-update-view-total-fetched-for): New function.
	(gnus-agent-total-fetched-for): New function.

	* gnus-cache.el (gnus-cache-save-buffers):
	Use gnus-cache-update-overview-total-fetched-for to change disk space
	used by this group.
	(gnus-cache-possibly-enter-article):
	Use gnus-cache-update-file-total-fetched-for to increment disk space
	used by this group.
	(gnus-cache-possibly-remove-article):
	Use gnus-cache-update-file-total-fetched-for to decrement disk space
	used by this group.
	(gnus-cache-generate-nov-databases): Purge total fetched cache.
	(gnus-cache-rename-group): New function.
	(gnus-cache-delete-group): New function.
	(gnus-cache-inhibit-update-total-fetched-for): New variable.
	(gnus-cache-need-update-total-fetched-for): New variable.
	(gnus-cache-with-refreshed-group): New macro.
	(gnus-cache-update-file-total-fetched-for): New function.
	(gnus-cache-update-overview-total-fetched-for): New function.
	(gnus-cache-rename-group-total-fetched-for): New function.
	(gnus-cache-delete-group-total-fetched-for): New function.
	(gnus-cache-total-fetched-for): New function.

	* gnus-group.el: Require gnus-sum and autoload functions to
	resolve warnings when gnus-group.el compiled alone.
	(gnus-group-line-format): Documented new %F.
	(size of Fetched data) group line format; identifies disk space
	used by agent and cache.
	(gnus-group-line-format-alist): Defined new F format.
	(gnus-total-fetched-for): New function.
	(gnus-group-delete-group): No longer update
	gnus-cache-active-altered as gnus-request-delete-group now keeps
	the cache in sync.
	(gnus-group-list-active): Let the agent store a server's active
	list if currently plugged.

	* gnus-int.el (gnus-request-delete-group):
	Use gnus-cache-delete-group and gnus-agent-delete-group to keep the
	local disk in sync with the server.
	(gnus-request-rename-group):
	Use gnus-cache-rename-group and gnus-agent-rename-group to keep the
	local disk in sync with the server.

	* gnus-start.el (gnus-get-unread-articles):
	Cosmetic simplification to logic.

	* gnus-util.el (gnus-rename-file): New function.

2004-04-07  Christian Neukirchen  <chneukirchen@yahoo.de>  (tiny change)

	* mm-util.el (mm-image-load-path): Handle nil in load-path.

2004-04-07  Jesper Harder  <harder@ifa.au.dk>

	* rfc2047.el (rfc2047-encoded-word-regexp): Remove unnecessary
	'+'.  Reported by Stefan Wiens <s.wi@gmx.net>.

2004-04-06  Jesper Harder  <harder@ifa.au.dk>

	* gnus-cache.el (gnus-cache-save-buffers): Check if buffer is
	alive.  Reported by Laurent Martelli <laurent@aopsys.com>.

2004-04-03  Jesper Harder  <harder@ifa.au.dk>

	* gnus.el (gnus-getenv-nntpserver): Strip whitespace.

2004-04-02  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-set-difference): Add function to replace
	gnus-set-difference in spam.el.
	(spam-summary-prepare-exit): Use spam-set-difference.

2004-03-29  Teodor Zlatanov  <tzz@lifelogs.com>

	* gnus-registry.el (gnus-registry-cache-file): Update to use
	gnus-dribble-directory OR gnus-home-directory OR ~.
	(gnus-registry-split-fancy-with-parent): Fix doc.

2004-03-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-exchange-point-and-mark):
	Use message-mark-active-p.  Suggested by Jesper Harder
	<harder@ifa.au.dk>.

2004-03-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-exchange-point-and-mark): Don't activate
	region if it was inactive.  Suggested by Hiroshi Fujishima
	<pooh@nature.tsukuba.ac.jp>.

2004-03-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (article-display-face): Display Faces in the same
	order as X-Faces.

2004-03-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* nndoc.el (nndoc-forward-type-p): Recognize envelope From_.

2004-03-23  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-mime-recompute-hierarchical-structure): Remove.
	(gnus-mime-multipart-functions): Revert 2004-03-19 change.
	(gnus-article-mime-hierarchy): Remove.
	(gnus-article-mime-hierarchy-next): Remove.
	(gnus-article-mode): Revert 2004-03-19 change.
	(gnus-article-setup-buffer): Revert 2004-03-19 change.
	(gnus-insert-mime-button): Revert 2004-03-19 change.
	(gnus-mime-accumulate-hierarchy): Remove.
	(gnus-mime-enter-multipart): Remove.
	(gnus-mime-leave-multipart): Remove.
	(gnus-mime-display-part): Revert 2004-03-19 change.
	(gnus-mime-display-alternative): Revert 2004-03-19 change.

	* mml.el (mml-preview): Revert 2004-03-19 change.

2004-03-18  Helmut Waitzmann  <Helmut.Waitzmann@web.de>  (tiny change)

	* gnus-sum.el (gnus-newsgroup-variables): Doc fix.

2004-03-22  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-decode.el (mm-save-part): Bind enable-multibyte-characters to
	t while entering a file name using the mm-with-multibyte macro.
	Suggested by Hiroshi Fujishima <pooh@nature.tsukuba.ac.jp>.

	* mm-util.el (mm-with-multibyte): New macro.

2004-03-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-mime-recompute-hierarchical-structure):
	New user option.
	(gnus-mime-multipart-functions): Doc and customization fix.
	(gnus-article-mime-hierarchy): New variable.
	(gnus-article-mime-hierarchy-next): New variable.
	(gnus-article-mode): Make gnus-article-mime-hierarchy buffer-local.
	(gnus-article-setup-buffer): Set gnus-article-mime-hierarchy and
	gnus-article-mime-hierarchy-next to nil.
	(gnus-insert-mime-button): Show hierarchy numbers.
	(gnus-mime-accumulate-hierarchy): New function.
	(gnus-mime-enter-multipart): New function.
	(gnus-mime-leave-multipart): New function.
	(gnus-mime-display-part): Recompute hierarchical MIME structure.
	(gnus-mime-display-alternative): Show hierarchy numbers.

	* mml.el (mml-preview): Set gnus-article-mime-hierarchy and
	gnus-article-mime-hierarchy-next to nil.

2004-03-19  Steve Youngs  <sryoungs@bigpond.net.au>

	* dns.el: Don't require gnus-xmas.

2004-03-17  Jesper Harder  <harder@ifa.au.dk>

	* mml.el (mml-generate-mime-1): Don't use format=flowed with
	inline PGP.
	(mml-menu): Disable mml-quote-region if mark is inactive.

2004-03-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-agent.el (gnus-agent-regenerate-group): Activate the group
	when the group's active is not available.

2004-03-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-agent.el (gnus-agent-read-agentview): Add a missing arg to
	error.

2004-03-12  Reiner Steib  <Reiner.Steib@gmx.de>

	* imap.el (imap-store-password): New variable.
	(imap-interactive-login): Use it.
	Suggested by Mark Plaksin <happy@mcplaksin.org>.

2004-03-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-read-summary-keys): Restore new
	window-start and hscroll to summary window.

2004-03-12  Kevin Greiner  <kgreiner@xpediantsolutions.com>

	* gnus-start.el (gnus-convert-old-newsrc): Only write the
	conversion message to newsrc-dribble when an actual conversion is
	performed.

2004-03-10  Malcolm Purvis  <malcolmpurvis@optushome.com.au>  (tiny change)

	* spam-stat.el (spam-stat-coding-system): Use mm-coding-system-p.

2004-03-10  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-decode.el (mm-complicated-handles): New function reviving
	former definition of mm-multiple-handles.

	* gnus-art.el (gnus-mime-save-part-and-strip): Use it.
	(gnus-mime-delete-part): Use it.

2004-03-09  Kevin Greiner  <kgreiner@xpediantsolutions.com>

	* gnus-agent.el (gnus-agent-read-local):
	Bind nnheader-file-coding-system to gnus-agent-file-coding-system to
	avoid the implicit assumption that they will always be equal.
	(gnus-agent-save-local): Bind buffer-file-coding-system, not
	coding-system-for-write, as the with-temp-file macro first prints
	to a buffer then saves the buffer.

2004-03-09  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-edit-part): New function.
	(gnus-mime-save-part-and-strip): Use it; do query instead of
	signaling an error; don't use mm-multiple-handles.
	(gnus-mime-delete-part): Ditto.

2004-03-08  Kevin Greiner  <kgreiner@xpediantsolutions.com>

	* gnus-agent.el (gnus-agent-read-agentview): Remove support for
	old file versions.
	(gnus-group-prepare-hook): Remove function that converted list
	form of gnus-agent-expire-days to group properties.

	* gnus-int.el: Autoload gnus-agent-regenerate-group.
	(gnus-request-accept-article): Re-indented.

	* gnus-start.el (gnus-convert-old-newsrc): Registered new
	converters to handle old agent file formats.  Add logic for a
	"backup before upgrading warning".
	(gnus-convert-mark-converter-prompt): Developers can mark
	functions as needing (default), or not needing,
	gnus-convert-old-newsrc's "backup before upgrading warning".
	(gnus-convert-converter-needs-prompt): Tests whether the user
	should be protected from potentially irreversable changes by the
	function.

	* legacy-gnus-agent.el: New.  Provides converters that are only
	loaded when gnus-convert-old-newsrc needs to call them.

2004-03-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mail-source.el (mail-source-touch-pop): Doc fix.

	* message.el (message-smtpmail-send-it): Doc fix.

2004-03-05  Jesper Harder  <harder@ifa.au.dk>

	* sha1-el.el (sha1-maximum-internal-length): Doc fix.

	* nnmail.el (nnmail-split-fancy): do.

	* gnus-kill.el (gnus-kill, gnus-execute): do.

2004-03-05  Per Abrahamsen  <abraham@dina.kvl.dk>

	* gnus-sum.el (gnus-widget-reversible-match)
	(gnus-widget-reversible-to-internal)
	(gnus-widget-reversible-to-external): New functions.
	(gnus-widget-reversible): New widget.
	(gnus-article-sort-functions, gnus-thread-sort-functions): Use it.

2004-03-05  Kai Grossjohann  <kgrossjo@eu.uu.net>

	* gnus-sum.el (gnus-thread-sort-functions)
	(gnus-article-sort-functions): Document `(not F)' items.

2004-03-04  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-use-gmane-xref): Add new backend.
	(spam-gmane-xref-spam-group): Add variable to control the name of the
	Gmane spam group.
	(spam-blackhole-servers, spam-blackhole-good-server-regex)
	(spam-regex-headers-spam, spam-regex-headers-ham)
	(spam-regex-body-spam, spam-regex-body-ham): Clarify docs.
	(spam-list-of-checks): Add spam-use-gmane-xref to list of
	backends and checks.
	(spam-check-gmane-xref): Add function for spam-use-gmane-xref.

	* gnus.el (spam-autodetect-methods): Add spam-use-gmane-xref as
	an autodetect method.

2004-03-04  Kevin Greiner  <kgreiner@xpediantsolutions.com>

	* gnus-int.el (gnus-request-accept-article): Inform the agent that
	articles are being added to a group.
	(gnus-request-replace-article): Inform the agent that articles
	need to be uncached as the cached contents are no longer valid.

2004-03-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* binhex.el: Don't autoload executable-find.

	* canlock.el: Don't autoload mail-fetch-field.

	* gnus-ems.el: Don't autoload appt-select-lowest-window.

	* gnus-msg.el: Don't autoload news-reply-mode, news-setup,
	rmail-dont-reply-to and rmail-output.

	* gnus-score.el: Don't autoload ffap-string-at-point.

	* gnus-setup.el: Don't autoload sc-cite-original.

	* imap.el: Don't autoload base64-decode-string,
	base64-encode-string and md5.

	* message.el: Autoload rmail-dont-reply-to, rmail-msg-is-pruned
	and rmail-msg-restore-non-pruned-header.

	* mm-decode.el: Don't autoload executable-find.

	* mm-url.el: Don't autoload executable-find.

	* mm-view.el: Don't autoload diff-mode.

	* nndb.el: Don't autoload news-reply-mode, news-setup,
	cancel-timer and telnet.

	* password.el: Don't autoload run-at-time for Emacs.

	* sha1-el.el: Don't autoload executable-find.

	* sieve-mode.el: Don't autoload c-mode.

	* uudecode.el: Don't autoload executable-find.

2004-03-04  Kevin Greiner  <kgreiner@xpediantsolutions.com>

	* gnus-agent.el (gnus-agent-file-header-cache): Remove.
	(gnus-agent-possibly-alter-active): Avoid null in numeric
	comparison.
	(gnus-agent-set-local): Refuse to save null in local object table.
	(gnus-agent-regenerate-group): The REREAD parameter can now be a
	list of articles that will be marked as unread.

2004-03-04  Katsumi Yamaoka  <yamaoka@jpl.org>

	* rfc2047.el (rfc2047-encoded-word-regexp): Mismatched paren.

2004-03-04  Jesper Harder  <harder@ifa.au.dk>

	* rfc2047.el (rfc2047-encoded-word-regexp): Support RFC 2231
	language tags.

2004-03-03  Per Abrahamsen  <abraham@dina.kvl.dk>

	* gnus-agent.el (gnus-agent-read-local, gnus-agent-save-local):
	Don't bind "obarray".

	* gnus-sum.el (gnus-thread-sort-functions):
	Add `gnus-thread-sort-by-most-recent-number' and
	`gnus-thread-sort-by-most-recent-date'.
	Reported by Kai Grossjohann <kai@emptydomain.de>.

2004-03-03  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-cus.el (gnus-agent-customize-category): Mismatched paren.

2004-03-02  Kevin Greiner  <kgreiner@xpediantsolutions.com>

	* gnus-cus.el (gnus-agent-customize-category):
	Remove ignore-errors macro reference that required cl to be loaded at
	run-time.

	* gnus-range.el (gnus-sorted-range-intersection): Now accepts
	single-interval range of the form (min . max).  Previously the
	range had to look like ((min . max)).  Likewise, return
	(min . max) rather than ((min . max)).
	(gnus-range-map): Use gnus-range-normalize to accept
	single-interval range.

	* gnus-sum.el (gnus-summary-highlight-line): Articles stored in
	the cache, but not the agent, now appear with their usual face.

2004-03-01  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-wash-html-with-w3m): Don't make the
	w3m-safe-url-regexp variable buffer-local.

	* mm-view.el (mm-inline-text-html-render-with-w3m): Ditto.

2004-02-27  Simon Josefsson  <jas@extundo.com>

	* gnus-sum.el (gnus-move-group-prefix-function): Add, default to
	gnus-group-real-prefix.
	(gnus-summary-move-article): Use it, instead of
	gnus-group-real-prefix.

2004-02-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-wash-html-with-w3m): Make the
	w3m-safe-url-regexp variable buffer-local and set it as the value
	of mm-w3m-safe-url-regexp.

	* mm-view.el (mm-inline-text-html-render-with-w3m): Ditto.

	* gnus-msg.el (gnus-setup-message): Ignore an article copy while
	parsing gnus-posting-styles when the message is not for replying.

	* nnrss.el (nnrss-opml-export):
	Use mm-set-buffer-file-coding-system instead of
	set-buffer-file-coding-system.

2004-02-27  Jesper Harder  <harder@ifa.au.dk>

	* spam-stat.el: Pedantic docstring and whitespace fixes (courtesy
	of checkdoc.el).
	* nnrss.el: do.
	* gnus-mlspl.el: do.
	* gnus-ml.el: do.
	* gnus-srvr.el: do.

	* nnrss.el (nnrss-opml-export): Turn on sgml-mode.

2004-02-27  Kevin Ryde  <user42@zip.com.au>  (tiny change)

	* gnus.el (gnus-group, gnus-summary, gnus-summary-sort):
	Corrections to custom-manual links.

	* gnus-art.el (gnus-article): Ditto.

	* mm-decode.el (mime-display, mime-security): Ditto.

2004-02-26  Jesper Harder  <harder@ifa.au.dk>

	* flow-fill.el: Typo.

2004-02-26  Andrew Cohen  <cohen@andy.bu.edu>

	* spam-wash.el: New file.

2004-02-26  Mark A. Hershberger  <mah@everybody.org>

	* nnrss.el (nnrss-opml-import, nnrss-opml-export): New functions.

2004-02-26  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-summary-prepare-exit): Fix gnus-set-difference: needs
	to be run with new-articles as LIST1, not LIST2.
	(spam-registration-functions): Add spam-use-ham-copy as a nil
	registration backend.

2004-02-26  Jesper Harder  <harder@ifa.au.dk>

	* spam-stat.el (spam-stat-washing-hook): New option.
	(spam-stat-buffer-words): Use it.
	(spam-stat-process-directory, spam-stat-test-directory):
	Use insert-file-contents-literally.
	(spam-stat-coding-system): New variable.
	(spam-stat-load, spam-stat-save): Use it.

2004-02-25  Katsumi Yamaoka  <yamaoka@jpl.org>

	* spam-report.el (spam-report-plug-agent):
	Quote spam-report-url-to-file and spam-report-url-ping-plain.

2004-02-25  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (gnus-button-alist, gnus-header-button-alist):
	Allow / in mailto URLs.

2004-02-24  Reiner Steib  <Reiner.Steib@gmx.de>

	* spam-report.el (spam-report-process-queue): Fix interactive use.
	(spam-report-url-ping-temp-agent-function, spam-report-plug-agent)
	(spam-report-unplug-agent): Doc fixes.
	(spam-report-url-ping-mm-url, spam-report-url-to-file)
	(spam-report-agentize, spam-report-deagentize):
	Autoload 2004-02-24  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-setup-fill-variables): Add mml tags to
	paragraph-start and paragraph-separate.  Suggested by Andrew Korty
	<ajk@iu.edu>.
	(message-mode): Don't modify paragraph-separate there.

2004-02-17  Katsumi Yamaoka  <yamaoka@jpl.org>

	* compface.el (uncompface-use-external): Default to undecided.
	(uncompface-use-external-threshold): New variable.
	(uncompface-float-time): New macro.
	(uncompface): Determine whether to use the external decoder if
	uncompface-use-external is undecided.

2004-02-15  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* mm-view.el (mm-inline-image-emacs): Don't insert blank lines
	after images.

	* gnus-art.el (gnus-mime-display-single): Remove dead code.

2004-02-14  Jesper Harder  <harder@ifa.au.dk>

	* nnrss.el (nnrss-request-article, nnrss-find-el): Cleanup.

	* html2text.el (html2text-get-attr, html2text-fix-paragraph): do.

	* gnus-sum.el (gnus-summary-limit-to-age)
	(gnus-summary-limit-children): do.

	* gnus-int.el (gnus-request-scan): do.

	* gnus-group.el (gnus-group-suspend): do.

	* gnus-cus.el (gnus-agent-cat-prepare-category-field): do.

	* gnus-cite.el (gnus-cite-parse-attributions): do.

	* gnus-agent.el (gnus-summary-set-agent-mark)
	(gnus-agent-regenerate-group): do.

	* deuglify.el (gnus-article-outlook-unwrap-lines): do.

	* binhex.el (binhex-decode-region-internal): do.

2004-02-12  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-fun.el (gnus-face-properties-alist): New user option.
	(gnus-display-x-face-in-from): Use it.

	* gnus-art.el (article-display-face): Ditto.

	* compface.el (uncompface-use-external): Default to nil.

2004-02-12  Jesper Harder  <harder@ifa.au.dk>

	* nntp.el (nntp-erase-buffer): New function.
	(nntp-retrieve-data, nntp-send-command)
	(nntp-send-buffer, nntp-retrieve-groups, nntp-handle-authinfo)
	(nntp-possibly-change-group): Use it.

	* nnnil.el (nnnil-retrieve-headers, nnnil-request-list):
	Use with-current-buffer.

2004-02-12  TAKAI Kousuke  <tak@kmc.gr.jp>

	* compface.el: Merge the ELisp-based uncompface program.
	(compface): New customization group.
	(uncompface-use-external): New user option.
	(uncompface): Call uncompface-internal if uncompface-use-external
	is nil.
	(uncompface-internal): New function.  Note that there are also
	some other functions and variables added for this function.

2004-02-10  Jesper Harder  <harder@ifa.au.dk>

	* nnrss.el (nnrss-read-group-data): Initialize nnrss-group-hashtb
	if necessary.

2004-02-09  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam-report.el (spam-report-unplug-agent)
	(spam-report-plug-agent, spam-report-deagentize)
	(spam-report-agentize, spam-report-url-ping-temp-agent-function):
	Add support for the Agent in spam-report: when unplugged, report to a
	file; when plugged, submit all the requests.

	* spam.el (spam-register-routine): Fix message about
	registration.

2004-02-09  Jesper Harder  <harder@ifa.au.dk>

	* rfc2047.el (rfc2047-qp-or-base64): New function to reduce
	dependencies.
	(rfc2047-encode): Use it.

	* gnus-art.el (gnus-button-marker-list): Move before first
	reference.

	* imap.el (imap-parse-flag-list, imap-parse-body-extension)
	(imap-parse-body): Fix format string mismatch.

	* gnus-score.el (gnus-summary-increase-score): do.

	* nnrss.el (nnrss-close): New function.

2004-02-08  Jesper Harder  <harder@ifa.au.dk>

	* nnrss.el (nnrss-make-filename): New function.
	(nnrss-request-delete-group, nnrss-read-server-data)
	(nnrss-save-server-data, nnrss-read-group-data)
	(nnrss-save-group-data): Use it.
	(nnrss-save-server-data, nnrss-save-group-data): Use gnus-prin1.
	(nnrss-read-server-data, nnrss-read-group-data): Use load.
	(nnrss-group-hashtb): Make it a hash table rather than an obarray.

2004-02-07  Jesper Harder  <harder@ifa.au.dk>

	* mml.el (mml-compute-boundary-1): Don't uncompress files.

2004-02-06  Jesper Harder  <harder@ifa.au.dk>

	* mml.el (mml-mode, mml-x-dnd-attach-file): Attach drop and drag
	files.

	* message.el (message-generate-headers-first): Don't quote nil
	and t in docstrings.

	* imap.el (imap-id): do.

	* gnus-agent.el (gnus-agent-consider-all-articles)
	(gnus-agent-queue-mail): do.

2004-02-05  Reiner Steib  <Reiner.Steib@gmx.de>

	* spam-report.el (spam-report-process-queue): New function.
	Process requests from `spam-report-requests-file'.
	(spam-report-process-queue): Doc fix.

2004-02-05  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-register-routine)
	(spam-log-processing-to-registry, spam-log-registered-p)
	(spam-log-unregistration-needed-p, spam-log-undo-registration):
	Change "check" to "spam-check" for semi-clarity.

2004-02-05  Jesper Harder  <harder@ifa.au.dk>

	* pop3.el: Require nnheader.

	* mml-smime.el: Require cl.  Autoload message-fetch-field.

	* mml-sec.el (mml-signencrypt-style): Don't depend on Gnus.

	* gnus-picon.el: Require cl.

	* gnus-fun.el: Require gnus-ems and gnus-util.

	* gnus.el (gnus-method-to-server): Move defsubst before first use.

	* gnus-diary.el (gnus-diary-header-schedule): caddr -> car (cddr

	* gnus-art.el (gnus-article-edit-mode): Define before first
	reference.

2004-02-04  Jesper Harder  <harder@ifa.au.dk>

	* gnus-uu.el (gnus-uu-check-correct-stripped-uucode): Simplify.
	(gnus-uu-post-encoded): Use point-at-bol.

	* gnus-topic.el (gnus-group-active-topic-p): do.

	* gnus-start.el (gnus-newsrc-to-gnus-format): do.

	* gnus-group.el (gnus-group-kill-region): do.

	* gnus-art.el (article-date-ut): do.

	* message.el (message-fetch-field): Remove redundant
	case-fold-search binding.
	(message-narrow-to-field): Simplify.

2004-02-03  Reiner Steib  <Reiner.Steib@gmx.de>

	* spam.el (spam-directory): Derive from `gnus-directory'.

	* spam-report.el (spam-report-url-to-file)
	(spam-report-requests-file): New function and variable for offline
	reporting.
	(spam-report-url-ping-function): Add `spam-report-url-to-file'
	and user defined function.
	(spam-report-url-ping-mm-url): Remove doubled slash.

2004-02-03  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-list-of-processors): Fix spamassassin variable names.

2004-02-03  Jesper Harder  <harder@ifa.au.dk>

	* spam.el (spam-check-spamoracle, spam-spamoracle-learn):
	Fix format string mismatch.

	* sieve.el (sieve-deactivate-all): do.

	* nnfolder.el (nnfolder-request-set-mark, nnfolder-save-marks): do.

	* nnlistserv.el (nnlistserv-kk-wash-article): do.

	* nnml.el (nnml-request-set-mark, nnml-save-marks): do.

	* mm-bodies.el (mm-7bit-chars): Don't include \r.

2004-02-02  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-list-of-checks): Add spam-use-BBDB-eclusive to
	the list of checks.

2004-01-31  Jesper Harder  <harder@ifa.au.dk>

	* rfc2047.el (rfc2047-pad-base64): Deal with more cases of invalid
	padding.

2004-01-27  Ralf Angeli  <angeli@iwi.uni-sb.de>

	* mm-view.el (mm-fill-flowed): New variable.
	(mm-inline-text): Use it.

2004-01-27  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-spamassassin-register-ham-routine)
	(spam-spamassassin-register-spam-routine): Fix function names.

2004-01-27  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus.el (gnus-tmp-grouplens): Remove.
	(gnus-summary-line-format): Remove grouplens.

	* gnus-group.el (gnus-group-line-format): Ditto.

	* gnus-spec.el (gnus-format-specs): Ditto.
	(gnus-update-format-specifications): Flush the group format spec
	cache if there's the grouplens stuff.
	(gnus-parse-simple-format): Replace %l with the empty string.

2004-01-27  Jerry James  <james@xemacs.org>  (tiny change)

	* gnus-spec.el (gnus-parse-simple-format): Fix setq value
	omission.

2004-01-26  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-msg.el (gnus-summary-resend-message-edit): Call mime-to-mml.
	Suggested by Hiroshi Fujishima <pooh@nature.tsukuba.ac.jp>.

2004-01-25  Paul Jarc  <prj@po.cwru.edu>

	* nnmaildir.el (nnmaildir--num-file, nnmaildir--mkfile)
	(nnmaildir--emlink-p, nnmaildir--eexist-p, nnmaildir--new-number):
	New macros and functions.
	* nnmaildir.el (nnmaildir--group-maxnum, nnmaildir--update-nov):
	Handle > NLINK_MAX messages.
	* nnmaildir.el (nnmaildir-request-set-mark):
	Use nnmaildir--emlink-p and nnmaildir--eexist-p.

2004-01-25  Alex Schroeder  <alex@gnu.org>

	* spam-stat.el (spam-stat-process-directory-age): New option.
	(spam-stat-process-directory): Use it.

2004-01-24  Hiroshi Fujishima  <pooh@nature.tsukuba.ac.jp>  (tiny change)

	* spam-stat.el (spam-stat-reduce-size): Set spam-stat-dirty.
	(spam-stat-save): Accept prefix argument.

2004-01-23  Paul Jarc  <prj@po.cwru.edu>

	* nnmaildir.el (nnmaildir-request-set-mark): Handle the "too many
	links" error.

2004-01-23  Jesper Harder  <harder@ifa.au.dk>

	* gnus.el (gnus-tmp-grouplens): Define for the sake of backward
	compatibility with old .newsrc.eld files.

	* gnus-sum.el (gnus-summary-line-format-alist): Remove grouplens.

	* gnus-start.el (gnus-1): do.

	* gnus-group.el (gnus-group-line-format-alist): do.

	* gnus.el (gnus-use-grouplens, gnus-visual): do.

	* gnus-gl.el: Remove.

2004-01-23  Kevin Greiner  <kgreiner@xpediantsolutions.com>

	* gnus-sum.el (gnus-adjust-marks): Now correctly handles a list of
	marks consisting of a single range {for example, (3 . 5)} rather
	than a list of a single range { ((3 . 5)) }.

2004-01-23  Jesper Harder  <harder@ifa.au.dk>

	* spam-stat.el (spam-stat-store-gnus-article-buffer):
	Use with-current-buffer.
	(spam-stat-store-current-buffer): Use insert-buffer-substring to
	avoid consing a string.

	* mm-util.el (mm-charset-synonym-alist): Add ks_c_5601-1987.
	Remove obsolete entries for big5 and gb2312.

2004-01-22  Kevin Greiner  <kgreiner@xpediantsolutions.com>

	* gnus-sum.el (gnus-adjust-marks): Avoid splicing null INTO the
	uncompressed list.

2004-01-22  Jesper Harder  <harder@ifa.au.dk>

	* spam-stat.el (spam-stat-strip-xref): New function.
	(spam-stat-process-directory): Use it.

	* gnus-util.el (gnus-fetch-field): Don't bind case-fold-search
	here -- it's done in message-fetch-field.

2004-01-21  Kevin Greiner  <kgreiner@xpediantsolutions.com>

	* gnus-agent.el (gnus-agent-queue-mail)
	(gnus-agent-prompt-send-queue): New variables.
	(gnus-agent-send-mail): Use gnus-agent-queue-mail.
	* gnus-draft.el (gnus-group-send-queue): Pass the group name
	"nndraft:queue" along to gnus-draft-send.
	Use gnus-agent-prompt-send-queue.
	(gnus-draft-send): Rebind gnus-agent-queue-mail to nil when group
	is "nndraft:queue".  Suggested by Gaute Strokkenes
	<gs234@srcf.ucam.org>

	* gnus-agent.el (agent-disable-undownloaded-faces): Remove.
	(agent-enable-undownloaded-faces): Add.
	(gnus-agent-cat-groups): Use eval-and-compile, not
	eval-when-compile, to define gnus-agent-set-cat-groups as the setf
	method of gnus-agent-cat-groups even when the buffer has been
	evalled.
	(gnus-agent-save-active, gnus-agent-save-active-1): Merge to
	delete gnus-agent-save-active-1.
	(gnus-agent-save-groups): Delete.  Identical to
	gnus-agent-save-active.
	(gnus-agent-write-active): No longer adjust agent's copy of active
	file as agent's adjustments are now stored in their own
	file.  Remove optional parameter.
	(gnus-agent-possibly-alter-active): Ignore groups of unagentized
	servers.  Add use of min/max range limits from server's local
	file.
	(gnus-agent-save-alist): Remove unused optional argument.
	(gnus-agent-load-local, gnus-agent-read-and-cache-local)
	(gnus-agent-read-local, gnus-agent-save-local, gnus-agent-get-local)
	(gnus-agent-set-local): A per-server file that keeps min/max range
	limits for articles known to the agent.  Provides a fast mechanism
	for altering many active ranges.
	(gnus-agent-expire-group, gnus-agent-expire): No longer save the
	active file (local makes it unnecessary).
	(gnus-agent-regenerate-group): Fix XEmacs compatibility.

	* gnus-cus.el (agent-disable-undownloaded-faces): Remove.
	(agent-enable-undownloaded-faces): Add.

	* gnus-draft.el (gnus-draft-send): Bind gnus-agent-queue-mail to
	disable it when sending to "nndraft:queue".
	(gnus-group-send-queue): Add safety check to avoid sending queue
	when unplugged.

	* gnus-group.el (gnus-group-catchup): Use new
	gnus-sequence-of-unread-articles, not
	gnus-list-of-unread-articles, to avoid exhausting memory with huge
	numbers of articles.  Use gnus-range-map to avoid having to
	uncompress the unread list.
	(gnus-group-archive-directory, gnus-group-recent-archive-directory):
	Fix invalid ange-ftp reference.

	* gnus-range.el (gnus-range-map): Iterate over list or sequence.
	(gnus-sorted-range-intersection): Intersection of two ranges
	without requiring that they first be uncompressed.

	* gnus-start.el (gnus-activate-group): Unless blocked by the
	caller, possibly expand the active range to include both cached
	and agentized articles.
	(gnus-convert-old-newsrc): Rewrote in anticipation of having
	multiple version-dependent converters.
	(gnus-groups-to-gnus-format): Replace gnus-agent-save-groups with
	gnus-agent-save-active.
	(gnus-save-newsrc-file): Save dirty agent range limits.

	* gnus-sum.el (gnus-select-newgroup): Replace inline code with
	gnus-agent-possibly-alter-active.
	(gnus-adjust-marked-articles): Faster handling of simple lists

2004-01-21  Jesper Harder  <harder@ifa.au.dk>

	* spam-stat.el (spam-stat-test-directory): New optional argument
	displays a list of files detected.  Suggested by Andrew Cohen
	<cohen@andy.bu.edu>.
	(spam-stat-buffer-words-with-scores): Don't narrow and change
	syntax table here.  Reported by Andrew Cohen <cohen@andy.bu.edu>.

2004-01-20  Hubert Chan  <hubert@uhoreg.ca>

	* spam.el (spam-use-spamassassin, spam-use-spamassassin-headers)
	(spam-install-hooks, spam-spamassassin, spam-spamassassin-path)
	(spam-spamassassin-arguments)
	(spam-spamassassin-spam-flag-header)
	(spam-spamassassin-positive-spam-flag-header)
	(spam-spamassassin-spam-status-header, spam-sa-learn-path)
	(spam-sa-learn-rebuild, spam-sa-learn-spam-switch)
	(spam-sa-learn-ham-switch, spam-sa-learn-unregister-switch)
	(spam-list-of-processors, spam-list-of-checks)
	(spam-list-of-statistical-checks, spam-registration-functions)
	(spam-check-spamassassin-headers, spam-check-spamassassin)
	(spam-spamassassin-score)
	(spam-spamassassin-register-with-sa-learn)
	(spam-spamassassin-register-spam-routine)
	(spam-spamassassin-register-ham-routine)
	(spam-assassin-register-spam-routine)
	(spam-assassin-register-ham-routine): Add SpamAssassin support.
	(spam-bogofilter-score): Fix to show article before scoring.

2004-01-20  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (gnus-summary-mode-map): Make spam-generic-score the
	default scoring function.
	(spam-generic-score): Call spam-spamassassin-score if
	spam-use-spamassassin or spam-use-spamassassin-headers is on;
	spam-bogofilter-score otherwise.

	* gnus.el (spam-process, spam-autodetect-methods):
	Add spamassassin and spamassassin-headers.

2004-01-20  Nevin Kapur  <nkapur@cs.caltech.edu>

	* gnus-registry.el (gnus-registry-split-fancy-with-parent):
	Suppress unnecessary messages.

2004-01-20  Jesper Harder  <harder@ifa.au.dk>

	* spam-stat.el (spam-stat-to-hash-table): Use :size keyword in
	make-hash-table.

2004-01-19  Katsumi Yamaoka  <yamaoka@jpl.org>

	* canlock.el (base64-encode-string): Don't autoload it.

2004-01-16  Katsumi Yamaoka  <yamaoka@jpl.org>

	* run-at-time.el: Remove useless (require 'itimer),
	eval-and-compile and (featurep 'xemacs).

2004-01-16  Jesper Harder  <harder@ifa.au.dk>

	* gnus-msg.el (gnus-post-news): Use blank Newsgroups line if
	GROUP is a virtual group.

2004-01-16  Steve Youngs  <sryoungs@bigpond.net.au>

	* gnus.el: Autoload `message-y-or-n-p'.

2004-01-15  Jesper Harder  <harder@ifa.au.dk>

	* pgg-parse.el: Remove unnecessary (require 'custom).

	* pgg-def.el: do.

	* nnmail.el: do.

	* gnus-undo.el: do.

	* gnus-picon.el: do.

	* gnus-util.el: do.

2004-01-15  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-sum.el (gnus-pick-line-number): Add autoload.

2004-01-15  Katsumi Yamaoka  <yamaoka@jpl.org>

	* mm-decode.el (mm-multiple-handles): Recognize a string as a mime
	handle, as well as a list.

	* mm-view.el (mm-w3m-cid-retrieve-1): Call itself recursively.
	Suggested by ARISAWA Akihiro <ari@mbf.sphere.ne.jp>.
	(mm-w3m-cid-retrieve): Simplify.

2004-01-14  Vasily Korytov  <deskpot@myrealbox.com>

	* message.el (message-kill-to-signature): Allow prefix arg to
	specify number of lines to keep before signature.

2004-01-14  Kai Grossjohann  <kai@emptydomain.de>

	* message.el (message-kill-to-signature): Change docstring.

2004-01-14  Katsumi Yamaoka  <yamaoka@jpl.org>

	* canlock.el: Always require sha1-el.
	(canlock-sha1): Bind sha1-maximum-internal-length to nil.

	* message.el: Autoload sha1 only when compiling.

2004-01-13  Katsumi Yamaoka  <yamaoka@jpl.org>

	* message.el (message-canlock-generate): Require sha1-el.

2004-01-13  Jesper Harder  <harder@ifa.au.dk>

	* message.el (message-expand-name): Silence the byte compiler.

2004-01-13  Simon Josefsson  <jas@extundo.com>

	* gnus-score.el (gnus-score-edit-all-score): Fix prototype.
	Invoke gnus-score-mode.
	Reported by bojohan+news@dd.chalmers.se (Johan Bockgård).

	* gnus-range.el (gnus-compress-sequence): Doc fix.
	Suggested by Jim Blandy <jimb@redhat.com> (tiny change).

2004-01-12  Jesper Harder  <harder@ifa.au.dk>

	* gnus-srvr.el (gnus-browse-foreign-server): Reduce consing.

2004-01-12  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-get-article-as-string): Update to use
	gnus-request-article-this-buffer, much simpler.
	(spam-get-article-as-buffer): Remove.

2004-01-12  Kai Grossjohann  <kai.grossjohann@mci.com>

	* message.el (message-expand-name): Use EUDC if the user uses that.

2004-01-12  Jesper Harder  <harder@ifa.au.dk>

	* rfc2047.el (rfc2047-parse-and-decode, rfc2047-decode): Use a
	character for the encoding to avoid consing a string.

	* rfc2047.el (rfc2047-decode-string): Don't cons a string
	unnecessarily.

	* mm-util.el (mm-replace-chars-in-string): Remove.

	* rfc2047.el (rfc2047-decode): Use mm-subst-char-in-string instead
	of mm-replace-chars-in-string.

2004-01-11  Jesper Harder  <harder@ifa.au.dk>

	* gnus.sum.el (gnus-remove-odd-characters): Don't cons two new strings.

	* mm-util.el (mm-subst-char-in-string): Support inplace.

	* gnus-sum.el (gnus-summary-remove-list-identifiers): Don't cons
	a new string in every iteration.  Use shy groups.

2004-01-10  Jesper Harder  <harder@ifa.au.dk>

	* gnus-srvr.el (gnus-browse-unsubscribe-group):
	* gnus-soup.el (gnus-soup-group-brew):
	* gnus-msg.el (gnus-put-message):
	* gnus-move.el (gnus-group-move-group-to-server):
	* gnus-kill.el (gnus-batch-score):
	* gnus-group.el (gnus-group-prepare-flat, gnus-group-delete-group)
	(gnus-group-update-group-line, gnus-group-insert-group-line-info)
	(gnus-group-update-group, gnus-group-read-group)
	(gnus-group-make-group, gnus-group-make-help-group)
	(gnus-group-make-archive-group, gnus-group-make-directory-group)
	(gnus-group-make-empty-virtual, gnus-group-sort-selected-flat)
	(gnus-group-sort-by-unread, gnus-group-catchup)
	(gnus-group-unsubscribe-group, gnus-group-kill-group)
	(gnus-group-yank-group, gnus-group-set-info)
	(gnus-group-list-groups):
	* gnus.el (gnus-generate-new-group-name):
	* gnus-delay.el (gnus-delay-send-queue):
	* nnvirtual.el (nnvirtual-catchup-group):
	* nnkiboze.el (nnkiboze-generate-group, nnkiboze-generate-group):
	* gnus-topic.el (gnus-topic-find-groups, gnus-topic-clean-alist)
	(gnus-group-prepare-topics, gnus-topic-check-topology):
	* gnus-sum.el (gnus-update-read-articles, gnus-select-newsgroup)
	(gnus-mark-xrefs-as-read, gnus-compute-read-articles)
	(gnus-summary-walk-group-buffer, gnus-summary-move-article)
	(gnus-group-make-articles-read):
	* gnus-start.el (gnus-subscribe-newsgroup, gnus-start-draft-setup)
	(gnus-group-change-level, gnus-kill-newsgroup)
	(gnus-check-bogus-newsgroups, gnus-get-unread-articles-in-group)
	(gnus-get-unread-articles, gnus-make-articles-unread)
	(gnus-make-ascending-articles-unread): Use accessor
	macros (gnus-group-entry, gnus-group-unread, gnus-info-marks etc.)
	to get group information for improved readability.

2004-01-09  Jesper Harder  <harder@ifa.au.dk>

	* gnus-art.el (article-decode-mime-words, article-babel)
	(gnus-article-highlight-signature, gnus-article-add-buttons)
	(gnus-signature-toggle): Use gnus-with-article-buffer.

	* gnus-art.el (gnus-article-highlight-headers)
	(gnus-article-add-buttons-to-head): Use gnus-with-article-headers.

	* gnus-art.el (gnus-mm-display-part, gnus-article-wash-status)
	(gnus-article-set-globals, gnus-request-article-this-buffer)
	(gnus-button-message-id, gnus-article-maybe-hide-headers)
	(gnus-mime-view-part-externally, gnus-mime-view-part-internally)
	(gnus-mime-display-alternative): Use with-current-buffer.

2004-01-09  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-generate-fake-headers): Rewrite to be simpler,
	also under 80 char limit, and call gnus-error if needed.
	(spam-fetch-article-header): Fix - it was a
	buffer-local variable (gnus-newsgroup-data).
	(spam-find-spam): Use spam-generate-fake-headers, forget about
	spam-insert-fake-headers.
	(spam-insert-fake-headers): Remove.

2004-01-09  Jesper Harder  <harder@ifa.au.dk>

	* deuglify.el (gnus-article-outlook-unwrap-lines)
	(gnus-outlook-rearrange-article)
	(gnus-outlook-repair-attribution-outlook)
	(gnus-outlook-repair-attribution-block)
	(gnus-outlook-repair-attribution-other): Remove redundant
	save-excursion.

2004-01-09  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-fetch-field-fast, spam-fetch-field-from-fast)
	(spam-fetch-field-subject-fast)
	(spam-fetch-field-message-id-fast, spam-generate-fake-headers)
	(spam-fetch-article-header): Add functions to deal with Gnus
	internals for fast retrieval of article header data.
	(spam-initialize): Put spam-find-spam in the gnus-summary-prepared-hook.

2004-01-09  Jesper Harder  <harder@ifa.au.dk>

	* pop3.el (pop3-md5): Remove.
	(pop3-apop): Replace pop3-md5 with md5.

	* mm-bodies.el: base64 is always built-in.

	* gnus-sum.el (gnus-summary-from-or-to-or-newsgroups):
	Use with-current-buffer.

2004-01-08  Katsumi Yamaoka  <yamaoka@jpl.org>

	* canlock.el (canlock-insert-header): Remove excessive grouping in
	regexp.

	* gnus-sum.el (gnus-summary-read-document): Ditto.

	* gnus-uu.el (gnus-uu-part-number): Ditto.

	* html2text.el (html2text-remove-tags): Ditto.
	(html2text-format-tags): Ditto.
	(html2text-format-single-elements): Ditto.

	* mml.el (mml-parse-1): Ditto.

2004-01-08  Jesper Harder  <harder@ifa.au.dk>

	* gnus-sum.el (gnus-summary-update-mark): Revert previous change.

	* gnus-group.el (gnus-group-mark-group): Fix for multibyte marks.

	* gnus-sum.el (gnus-summary-update-mark): Fix for multibyte marks.

	* gnus-util.el (gnus-replace-in-string): Remove Emacs 20 code.

2003-11-15  Simon Josefsson  <jas@extundo.com>

	* pgg-gpg.el (pgg-gpg-lookup-all-secret-keys)
	(pgg-gpg-lookup-key): Use regexp match instead of
	split-string (split-string is different between emacs 21.2 and
	22.1).  Reported by ultrasoul@ultrasoul.com (David D. Smith).

2004-01-08  Jesper Harder  <harder@ifa.au.dk>

	* gnus-art.el (gnus-mime-view-all-parts)
	(gnus-article-part-wrapper, gnus-article-view-part):
	Use with-current-buffer.

2004-01-07  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-disable-spam-split-during-ham-respool)
	(spam-spamoracle-database, spam-cache-lookups)
	(spam-split-last-successful-check, spam-clear-cache, spam-xor)
	(spam-group-ham-mark-p, spam-group-spam-mark-p)
	(spam-group-ham-marks, spam-group-spam-marks)
	(spam-group-spam-contents-p, spam-group-ham-contents-p)
	(spam-list-of-processors, spam-list-of-statistical-checks): Fix doc,
	also add spam-use-blackholes to the statistical checks.
	(spam-fetch-field-fast): Add interface to fetching fields, may
	become a macro.
	(spam-fetch-field-from-fast, spam-fetch-field-subject-fast)
	(spam-fetch-field-message-id-fast): Use spam-fetch-field-fast.
	(spam-insert-fake-headers): Fake an article when needed.
	(spam-find-spam): Fake article when possible.
	(spam-check-blackholes, spam-check-BBDB, spam-from-listed-p)
	(spam-check-bogofilter-headers): Use message-fetch-field instead
	of nnmail-fetch-field.

2004-01-07  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-score.el (gnus-score-find-trace): Add `k' (kill-buffer).

2004-01-07  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-split): Do not require spam-use-CHECK to be
	enabled if that check is passed to spam-split explicitly; also
	fix so 'spam doesn't get converted to spam-split-group when
	spam-split-symbolic-return is t.
	(spam-find-spam): Find registrations of the article and use those
	instead of re-running spam-split to find the spam/ham
	classification of the article.
	(spam-log-processing-to-registry, spam-log-registered-p)
	(spam-log-unregistration-needed-p, spam-log-undo-registration):
	Use gnus-error instead of gnus-message.
	(spam-log-registration-type): Add function to determine the
	classification of a message based on registry entries; will
	return nil if both 'spam and 'ham are found.
	(spam-check-BBDB): Expand all the BBDB macros here so we can have
	a reasonably fast local cache without the loading errors.
	(spam-cache-lookups): Set to t by default.
	(spam-find-spam): Don't try to guess spam-cache-lookups.
	(spam-enter-whitelist, spam-enter-blacklist): Clear the
	spam-caches entry.
	(spam-filelist-build-cache, spam-filelist-check-cache):
	Fix caching of whitelist/blacklist entries.
	(spam-check-whitelist, spam-check-blacklist):
	Invoke spam-from-listed-p with a type, not a cache variable.
	(spam-from-listed-p): Wrap around spam-filelist-check-cache.

2004-01-07  Jesper Harder  <harder@ifa.au.dk>

	* message.el (message-cite-prefix-regexp): Use with-syntax-table.

	* nnmail.el (nnmail-split-fancy): do.

	* mml.el (mml-parse): do.

	* gnus-score.el (gnus-enter-score-words-into-hashtb)
	(gnus-score-adaptive): do.

2004-01-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-treat-emphasize): Ignore Emacs version number.
	(gnus-mime-button-map): Don't set keymap parent.
	(gnus-button-ctan-directory-regexp): Use shy grouping.
	(gnus-prev-page-map): Don't set keymap parent.
	(gnus-prev-page-map): Remove duplicated one.
	(gnus-next-page-map): Don't set keymap parent.
	(gnus-mime-security-button-map): Ditto.

	* nnheader.el (nnheader-directory-files-is-safe): Ignore Emacs
	version number.

	* sha1-el.el (sha1-string-external): Use with-temp-buffer.

2004-01-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* canlock.el (canlock-sha1-function): Remove.
	(canlock-sha1-function-for-verify): Remove.
	(canlock-openssl-program): Remove.
	(canlock-openssl-args): Remove.
	(canlock-ignore-errors): Remove.
	(canlock-sha1-with-openssl): Remove.
	(canlock-sha1): Use sha1 instead of to call canlock-sha1-function.
	(canlock-verify): Don't use canlock-ignore-errors.

	* sha1-el.el (sha1-string-external): Make it can return a string
	in binary form.
	(sha1-region-external): Ditto.
	(sha1-string-internal): Ditto.
	(sha1-region-internal): Ditto.
	(sha1-region): Ditto.
	(sha1-string): Ditto.
	(sha1): Ditto.

2004-01-07  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* spam.el (spam-report-articles-gmane): New command.

2004-01-07  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus.el: Don't make unnecessary *Group* buffer when loading.

	* run-at-time.el (run-at-time-saved): Remove.
	(run-at-time): Doc fix.

2004-01-07  Jesper Harder  <harder@ifa.au.dk>

	* gnus-sum.el (gnus-summary-limit-to-replied): New command.
	(gnus-summary-limit-map): Add it.
	(gnus-summary-make-menu-bar): do.

2004-01-06  Teodor Zlatanov  <tzz@lifelogs.com>

	* spam.el (spam-cache-lookups, spam-caches, spam-clear-cache):
	Make attempt at some caching support (done for BBDB only now).
	(spam-find-spam): Set spam-cache-lookups if there are more than 2
	addresses to be checked.
	(spam-clear-cache-BBDB): Add function, to be invoked by
	bbdb-change-hook, and triggering spam-clear-cache of 'spam-use-BBDB.
	(spam-check-BBDB): Check and use the caches, if
	spam-cache-lookups is on, remove superfluous (provide).

2004-01-06  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (gnus-treat-ansi-sequences): Change default.

2004-01-07  Steve Youngs  <sryoungs@bigpond.net.au>

	* run-at-time.el (run-at-time-saved): Move to after the definition
	of `run-at-time'.

2004-01-06  Katsumi Yamaoka  <yamaoka@jpl.org>

	* gnus-art.el (gnus-article-wash-html-with-w3m): Don't use
	mm-w3m-local-map-property.

	* mm-view.el (mm-w3m-mode-map): Remove.
	(mm-w3m-local-map-property): Remove.
	(mm-inline-text-html-render-with-w3m): Don't use
	mm-w3m-local-map-property.

2004-01-06  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* run-at-time.el: New file.

	* gnus.el ((fboundp 'gnus-set-text-properties)): Remove definition
	of gnus-set-text-properties.

	* gnus-uu.el (gnus-uu-save-article): Ditto.

	* gnus-salt.el (gnus-carpal-setup-buffer): Ditto.

	* gnus-cite.el (gnus-cite-parse): Ditto.

	* gnus-art.el (gnus-button-push): Use set-text-properties instead
	of gnus-.

	* gnus.el: Change calls to nnheader-run-at-time and
	password-run-at-time throughout to use run-at-time directly.

	* password.el: Remove definition of run-at-time.

2004-01-05  Karl Pflästerer  <sigurd@12move.de>  (tiny change)

	* mml.el (mml-minibuffer-read-disposition): Show attachment type
	in prompt.

2004-01-06  Steve Youngs  <sryoungs@bigpond.net.au>

	* gnus-ems.el (gnus-mode-line-modified): Don't conditionalize on
	XEmacs version.

	* dns.el (dns-make-network-process): Use `open-network-stream'
	instead of `gnus-xmas-open-network-stream'.

	* .cvsignore: Add auto-autoloads.el, custom-load.el.

2004-01-06  Jesper Harder  <harder@ifa.au.dk>

	* gnus-art.el (gnus-mime-display-alternative)
	(gnus-insert-mime-button, gnus-insert-mime-security-button)
	(gnus-insert-prev-page-button, gnus-insert-next-page-button):
	Don't use gnus-local-map-property.

	* gnus-util.el (gnus-local-map-property): Remove.

	* mm-view.el (mm-view-pkcs7-decrypt):
	Replace gnus-completing-read-maybe-default with completing-read.

	* gnus-util.el (gnus-completing-read): do.
	(gnus-completing-read-maybe-default): Remove.

2004-01-06  Steve Youngs  <sryoungs@bigpond.net.au>

	* password.el: Only autoload `run-at-time' if not XEmacs.
	Only autoload the itimer functions if XEmacs.

2004-01-06  Jesper Harder  <harder@ifa.au.dk>

	* gnus-art.el (gnus-read-string): Remove.
	(gnus-summary-pipe-to-muttprint): Replace gnus-read-string with
	read-string.

2004-01-05  Teodor Zlatanov  <tzz@lifelogs.com>

	* netrc.el: Autoload password-read.
	(netrc): Add configuration group.
	(netrc-encoding-method, netrc-openssl-path):
	Add variables for encoding and decoding of files with symmetric
	ciphers.
	(netrc-encode): Add assistant function to encode a file with
	netrc-encoding-method.
	(netrc-parse): Add interactive parameter, added optional
	decoding if netrc-encoding-method is non-nil but otherwise
	behavior is standard.
	(netrc-encrypting-method, netrc-encrypt, netrc-parse):
	Do s/encode/encrypt/ everywhere.

	* spam.el: Remove executable-find autoload.

2004-01-05  Jesper Harder  <harder@ifa.au.dk>

	* gnus-registry.el: Remove Emacs 20 hash table compatibility code.

	* gnus-uu.el (gnus-uu-post-encoded): bury-buffer is always fbound.

2004-01-05  Reiner Steib  <Reiner.Steib@gmx.de>

	* gnus-art.el (gnus-treat-ansi-sequences)
	(article-treat-ansi-sequences): New variable and function.
	Suggested by Dan Jacobson <jidanni@jidanni.org>.

	* gnus-sum.el (gnus-summary-wash-map, gnus-summary-make-menu-bar):
	Use it.

2004-01-05  Jesper Harder  <harder@ifa.au.dk>

	* mm-util.el (mm-quote-arg): Remove.

	* mm-decode.el (mm-mailcap-command): Replace mm-quote-arg with
	shell-quote-argument.

	* gnus-uu.el (gnus-uu-command): do.

	* gnus-sum.el (gnus-summary-insert-pseudos): do.

	* ietf-drums.el (ietf-drums-token-to-list): Replace mm-make-char
	with make-char.

	* mm-util.el (mm-make-char): Remove.

	* mml.el (mml-mode): Replace gnus-add-minor-mode with
	add-minor-mode.

	* gnus-undo.el (gnus-undo-mode): do.

	* gnus-topic.el (gnus-topic-mode): do.

	* gnus-sum.el (gnus-dead-summary-mode): do.

	* gnus-start.el (gnus-slave-mode): do.

	* gnus-salt.el (gnus-binary-mode, gnus-pick-mode): do.

	* gnus-ml.el (gnus-mailing-list-mode): do.

	* gnus-gl.el (gnus-grouplens-mode): do.

	* gnus-draft.el (gnus-draft-mode): do.

	* gnus-dired.el (gnus-dired-mode): do.

	* gnus-ems.el (gnus-add-minor-mode): Remove.

	* gnus-spec.el (gnus-correct-length, gnus-correct-substring):
	Replace gnus-char-width with char-width.

	* gnus-ems.el (gnus-char-width): Remove.

	* gnus-spec.el (gnus-correct-length, gnus-correct-substring):
	Replace gnus-char-width with char-width.

	* gnus-ems.el (gnus-char-width): Remove.

	* spam-stat.el (with-syntax-table): Remove with-syntax-table
	definition.
	Remove Emacs 20 hash table compatibility code.

	* rfc2047.el (with-syntax-table): Remove with-syntax-table Emacs
	20 compatibility code.

	* spam.el (spam-point-at-eol): Replace with point-at-eol.

	* smime.el (smime-point-at-eol): Replace with point-at-eol.

	* rfc2047.el (rfc2047-point-at-bol, rfc2047-point-at-eol):
	Replace with point-at-{eol,bol}.

	* netrc.el (netrc-point-at-eol): Replace with point-at-eol.

	* imap.el (imap-point-at-eol): Replace with point-at-eol.

	* flow-fill.el (fill-flowed-point-at-bol)
	(fill-flowed-point-at-eol): Replace with point-at-{eol,bol}.

	* gnus-util.el (gnus-point-at-bol, gnus-point-at-eol): Remove.
	Replace with point-at-{eol,bol} throughout all files.

2004-01-05  Katsumi Yamaoka  <yamaoka@jpl.org>

	* ntlm.el (ntlm-string-as-unibyte): New macro.
	(ntlm-build-auth-response): Use it.

	Remove Emacs 20 stuff:
	* gnus-msg.el (gnus-summary-news-other-window): Use remove instead
	of delq and copy-sequence.
	* gnus-art.el (popup-menu): Remove the compiler macro.
	* nnmail.el (nnmail-split-fancy): Don't support customizing with
	Emacs 20.

2004-01-05  Simon Josefsson  <jas@extundo.com>

	* ntlm.el: Fix namespace.  Change smb-passwd-hash into
	ntlm-smb-passwd-hash, smb-owf-encrypt into ntlm-smb-owf-encrypt,
	smb-passwd-hash into ntlm-smb-passwd-hash, smbdes-e-p16 into
	ntlm-smb-des-e-p16, smbdes-e-p24 into ntlm-smb-des-e-p24, smbhash
	into ntlm-smb-hash, smb-sp8 into ntlm-smb-sp8, smb-str-to-key into
	ntlm-smb-str-to-key, smb-dohash into ntlm-smb-dohash, smb-perm1
	into ntlm-smb-perm1, smb-perm2 into ntlm-smb-perm2, smb-perm3 into
	ntlm-smb-perm3, smb-perm4 into ntlm-smb-perm4, smb-perm5 into
	ntlm-smb-perm5, smb-perm6 into ntlm-smb-perm6, smb-sc into
	ntlm-smb-sc, smb-sbox into ntlm-smb-sbox, string-permute into
	ntlm-string-permute, string-lshift into ntlm-string-lshift,
	string-xor into ntlm-string-xor.
	Suggested by Jesper Harder <harder@myrealbox.com>.

	* ntlm.el: Don't include poem.

	* md4.el (print-int32, print-string-hexa): Remove.
	Suggested by Jesper Harder <harder@myrealbox.com>.

	* sasl-ntlm.el, ntlm.el, md4.el: New files.

	* hmac-md5.el (md5-binary): Fix byte compile warning.  (This
	probably breaks emacs with DL patch, but do we care? Is anyone
	still using the DL stuff?)

	* sieve-manage.el: Use the password package.
	(sieve-manage-read-passwd): Remove.
	(sieve-manage-interactive-login): Use password.  Re-add
	condition-case around loop.

	* pgg.el (pgg-passphrase-cache, pgg-run-at-time): Remove.
	(pgg-add-passphrase-cache, pgg-remove-passphrase-cache):
	Use the password package.

2003-02-19  Simon Josefsson  <jas@extundo.com>

	* sieve-manage.el (sieve-sasl-auth): Quote optional initial SASL
	token.

2002-08-07  Simon Josefsson  <jas@extundo.com>

	* sieve-manage.el (require): Use SASL, not RFC2104/MD5.
	(sieve-manage-authenticators):
	(sieve-manage-authenticator-alist): Add some SASL mechs.
	(sieve-sasl-auth): New function.
	(sieve-manage-cram-md5-auth):
	(sieve-manage-plain-auth): Rewrite using SASL library.
	(sieve-manage-digest-md5-p, sieve-manage-digest-md5-auth)
	(sieve-manage-scram-md5-p, sieve-manage-scram-md5-auth)
	(sieve-manage-ntlm-p, sieve-manage-ntlm-auth)
	(sieve-manage-login-p, sieve-manage-login-auth): Add wrappers.

2004-01-05  Simon Josefsson  <jas@extundo.com>

	* sasl.el, sasl-cram.el, sasl-digest.el, hmac-md5.el, hmac-def.el:
	New files.

2004-01-04  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus-group.el (gnus-no-groups-message): Update.

	* gnus-sum.el (gnus-summary-insert-new-articles): Remove .

2003-11-09  Simon Josefsson  <jas@extundo.com>

	* imap.el: Support for ID IMAP extension (RFC 2971).
	(imap-local-variables): Add imap-id.
	(imap-id): New variable.
	(imap-id): New function.
	(imap-parse-response): Parse untagged ID response.
	* nnimap.el (nnimap-id): New variable.
	(nnimap-open-connection): Use it.

2003-12-28  Simon Josefsson  <jas@extundo.com>

	* gnus-score.el (gnus-score-edit-all-score): New.
	* gnus-group.el (gnus-group-score-map): Bind it to W e.

2004-01-04  Simon Josefsson  <jas@extundo.com>

	* password.el: Add.

2004-01-04  Mario Lang  <lang@zid.tugraz.at>

	* dns.el (dns-query-types): Fix typo.
	(dns-query-types): New function.
	(dns-read-type): Add support for AAAA records, see RFC 3596.  Parse MX,
	PTR and SOA replies, see RFC 1035.

2004-01-04  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus.el (gnus-logo-color-style): Change colors to `no'.

	* Move to Changelog.2.

2004-01-04  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus.el (gnus-version-number): Bump version.

2004-01-04  Lars Magne Ingebrigtsen  <lars@ingebrigtsen.no>

	* gnus.el: No Gnus v0.1 is released.

2004-01-04  Lars Magne Ingebrigtsen  <lars@ingebrigtsen.no>

	* gnus.el: No Gnus v0.0 is released.

2004-01-04  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* gnus.el (gnus-version-number): Bump.
	(gnus-version): No.

See ChangeLog.2 for earlier changes.

  Copyright (C) 2004-2012  Free Software Foundation, Inc.

  This file is part of GNU Emacs.

  GNU Emacs is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  GNU Emacs is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with GNU Emacs.  If not, see <http://www.gnu.org/licenses/>.

;; Local Variables:
;; coding: utf-8
;; fill-column: 79
;; add-log-time-zone-rule: t
;; End:
